This file is a merged representation of a subset of the codebase, containing specifically included files, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of a subset of the repository's contents that is considered the most important context.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Only files matching these patterns are included: .devcontainer, .devcontainer/devcontainer.json, .github, .repomix, .vscode, backend, data, frontend, infra, infrastructure, node_modules, notebooks, scripts, static, tests, tools, .env.sample, .gitattributes, .gitignore, app.py, azure.yaml, CODE_OF_CONDUCT.md, gunicorn.conf.py, LICENSE, package-lock.json, package.json, README_azd.md, README.md, requirements-dev.txt, requirements.txt, SECURITY.md, start.cmd, start.sh, startDEV.cmd, SUPPORT.md, TEST_CASE_FLOWS.md, WebApp.Dockerfile, WebApp.dockerignore
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.devcontainer/devcontainer.json
.env.sample
.gitattributes
.github/dependabot.yml
.github/ISSUE_TEMPLATE/bug_report.md
.github/ISSUE_TEMPLATE/feature_request.md
.github/pull_request_template.md
.github/workflows/check-static-files.yml
.github/workflows/check-test-updates.yml
.github/workflows/docker-image-build.yml
.github/workflows/docker-image-publish.yml
.github/workflows/node.js.yml
.github/workflows/python-app.yml
.github/workflows/sample-app-github-cd.yml
.github/workflows/stale-issues.yml
.gitignore
.repomix/bundles.json
app.py
azure.yaml
backend/auth/__init__.py
backend/auth/auth_utils.py
backend/auth/sample_user.py
backend/history/cosmosdbservice.py
backend/security/__init__.py
backend/security/ms_defender_utils.py
backend/settings.py
backend/utils.py
CODE_OF_CONDUCT.md
data/employee_handbook.pdf
frontend/.eslintignore
frontend/.eslintrc.json
frontend/.prettierignore
frontend/.prettierrc.json
frontend/authConfig.d.ts
frontend/authConfig.js
frontend/AuthRedirect.tsx
frontend/eslint.config.ts
frontend/index.html
frontend/jest.config.ts
frontend/LogOffButton.tsx
frontend/package.json
frontend/polyfills.js
frontend/public/favicon.ico
frontend/SignInButton.tsx
frontend/SignOutButton.tsx
frontend/src/api/api.ts
frontend/src/api/index.ts
frontend/src/api/models.ts
frontend/src/assets/Azure.svg
frontend/src/assets/BYCP.png
frontend/src/assets/Contoso.svg
frontend/src/assets/csudh_brand_kit.svg
frontend/src/assets/CSUDH-Mark-4C-RGB.png
frontend/src/assets/csudhsvg.svg
frontend/src/assets/Send.svg
frontend/src/components/Answer/Answer.module.css
frontend/src/components/Answer/Answer.tsx
frontend/src/components/Answer/AnswerParser.test.ts
frontend/src/components/Answer/AnswerParser.tsx
frontend/src/components/Answer/index.ts
frontend/src/components/AuthButtonsBar.module.css
frontend/src/components/AuthButtonsBar.tsx
frontend/src/components/ChatHistory/ChatHistoryList.tsx
frontend/src/components/ChatHistory/ChatHistoryListItem.tsx
frontend/src/components/ChatHistory/ChatHistoryPanel.module.css
frontend/src/components/ChatHistory/ChatHistoryPanel.tsx
frontend/src/components/common/Button.module.css
frontend/src/components/common/Button.tsx
frontend/src/components/QuestionInput/index.ts
frontend/src/components/QuestionInput/QuestionInput.module.css
frontend/src/components/QuestionInput/QuestionInput.tsx
frontend/src/constants/chatHistory.tsx
frontend/src/constants/sanatizeAllowables.ts
frontend/src/index.css
frontend/src/index.tsx
frontend/src/pages/chat/Chat.module.css
frontend/src/pages/chat/Chat.tsx
frontend/src/pages/layout/Layout.module.css
frontend/src/pages/layout/Layout.tsx
frontend/src/pages/NoPage.tsx
frontend/src/state/AppProvider.tsx
frontend/src/state/AppReducer.tsx
frontend/src/styles/custom.css
frontend/src/utils/resizeImage.ts
frontend/src/vite-env.d.ts
frontend/tsconfig.json
frontend/tsconfig.node.json
frontend/vite.config.ts
gunicorn.conf.py
infra/abbreviations.json
infra/core/ai/cognitiveservices.bicep
infra/core/database/cosmos/cosmos-account.bicep
infra/core/database/cosmos/sql/cosmos-sql-account.bicep
infra/core/database/cosmos/sql/cosmos-sql-db.bicep
infra/core/database/cosmos/sql/cosmos-sql-role-assign.bicep
infra/core/database/cosmos/sql/cosmos-sql-role-def.bicep
infra/core/host/appservice.bicep
infra/core/host/appserviceplan.bicep
infra/core/search/search-services.bicep
infra/core/security/role.bicep
infra/core/storage/storage-account.bicep
infra/db.bicep
infra/docprep.bicep
infra/main.bicep
infra/main.parameters.json
infrastructure/deployment.json
LICENSE
notebooks/AzureOpenAI_OnYourData_Elasticsearch.ipynb
package.json
README_azd.md
README.md
requirements-dev.txt
requirements.txt
scripts/.env.sample
scripts/aml_config.json
scripts/auth_init.ps1
scripts/auth_init.py
scripts/auth_init.sh
scripts/auth_update.ps1
scripts/auth_update.py
scripts/auth_update.sh
scripts/chunk_documents.py
scripts/chunk_documents.yml
scripts/conda.yml
scripts/config_multiple_url.json
scripts/config.json
scripts/cosmos_config.json
scripts/cosmos_mongo_vcore_data_preparation.py
scripts/data_preparation.py
scripts/data_utils.py
scripts/datastore.yml
scripts/embed_documents.py
scripts/embed_documents.yml
scripts/loadenv.ps1
scripts/loadenv.sh
scripts/pinecone_config.json
scripts/pinecone_data_preparation.py
scripts/pipeline.yml
scripts/prepdocs.ps1
scripts/prepdocs.py
scripts/prepdocs.sh
scripts/push_documents_acs.yml
scripts/push_only_pipeline.yml
scripts/push_to_acs.py
scripts/readme.md
scripts/role_assignment.sh
scripts/run_batch_create_index.py
SECURITY.md
start.cmd
start.sh
startDEV.cmd
static/favicon.ico
static/Hsi-Chatbot-Logo.svg
static/index.html
SUPPORT.md
TEST_CASE_FLOWS.md
tests/conftest.py
tests/integration_tests/conftest.py
tests/integration_tests/dotenv_templates/dotenv.jinja2
tests/integration_tests/test_datasources.py
tests/unit_tests/dotenv_data/dotenv_no_datasource_1
tests/unit_tests/dotenv_data/dotenv_no_datasource_2
tests/unit_tests/dotenv_data/dotenv_with_azure_search_success
tests/unit_tests/dotenv_data/dotenv_with_elasticsearch_success
tests/unit_tests/test_settings.py
tests/unit_tests/test_utils.py
tools/data_collection.py
WebApp.Dockerfile
WebApp.dockerignore
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".devcontainer/devcontainer.json">
{
    "name": "Azure Developer CLI",
    "image": "mcr.microsoft.com/devcontainers/python:3.10",
    "features": {
        "ghcr.io/devcontainers/features/node:1": {
            "version": "16",
            "nodeGypDependencies": false
        },
        "ghcr.io/devcontainers/features/azure-cli:1.0.8": {},
        "ghcr.io/azure/azure-dev/azd:latest": {}
    },
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-azuretools.azure-dev",
                "ms-azuretools.vscode-bicep",
                "ms-python.python"
            ]
        },
        "codespaces": {
            "openFiles": [
              "README.md"
            ]
        }
    },
    "forwardPorts": [
        5000
    ],
    "remoteUser": "vscode",
    "hostRequirements": {
        "memory": "8gb"
    }
}
</file>

<file path=".gitattributes">
* text=auto eol=lf
*.{cmd,[cC][mM][dD]} text eol=crlf
*.{bat,[bB][aA][tT]} text eol=crlf
</file>

<file path=".github/dependabot.yml">
# To get started with Dependabot version updates, you'll need to specify which
# package ecosystems to update and where the package manifests are located.
# Please see the documentation for all configuration options:
# https://docs.github.com/github/administering-a-repository/configuration-options-for-dependency-updates

version: 2
updates:
  - package-ecosystem: "pip" # See documentation for possible values
    directory: "/" # Location of package manifests
    schedule:
      interval: "weekly"
</file>

<file path=".github/ISSUE_TEMPLATE/feature_request.md">
---
name: Feature request
about: Suggest an idea for this project
title: ''
labels: enhancement
assignees: ''

---

**Is your feature request related to this sample app, or to an Azure service, such as Azure OpenAI or Azure AI Search?**
Describe the scope of your request. This forum is focused on features relating to this sample app and its functionality, not the functionality of underlying Azure services.

**Is your feature request related to a problem? Please describe.**
A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]

**Describe the solution you'd like**
A clear and concise description of what you want to happen.

**Is this feature specific to your use case or your organization, or would it apply broadly across other uses of this app?**
Describe how you and others might leverage this feature.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**Additional context**
Add any other context or screenshots about the feature request here.
</file>

<file path=".github/pull_request_template.md">
### Motivation and Context

<!-- Thank you for your contribution to this repo!
Please help reviewers and future users, providing the following information:
  1. Why is this change required? 
  2. What problem does it solve?
  3. What scenario does it contribute to?
  4. If it fixes an open issue, please link to the issue here.
  5. Does this solve an issue or add a feature that *all* users of this sample app can benefit from? Contributions will only be accepted that apply across all users of this app.
-->

### Description

<!-- Describe your changes, the overall approach, the underlying design.
     These notes will help understanding how your code works. Thanks! -->


### Contribution Checklist

<!-- Before submitting this PR, please make sure: -->

- [ ] I have built and tested the code locally and in a deployed app
- [ ] For frontend changes, I have pulled the latest code from main, built the frontend, and committed all static files.
- [ ] This is a change for all users of this app. No code or asset is specific to my use case or my organization.
- [ ] I didn't break any existing functionality :smile:
</file>

<file path="azure.yaml">
# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-dev/main/schemas/v1.0/azure.yaml.json

name: sample-app-aoai-chatgpt
metadata:
  template: sample-app-aoai-chatgpt@0.0.1-beta
services:
  backend:
    project: .
    language: py
    host: appservice
    hooks:
      prepackage:
        windows:
          shell: pwsh
          run:  cd ./frontend;npm install;npm run build
          interactive: true
          continueOnError: false
        posix:
          shell: sh
          run:  cd ./frontend;npm install;npm run build
          interactive: true
          continueOnError: false
hooks:
    preprovision:
      windows:
        shell: pwsh
        run: ./scripts/auth_init.ps1
        interactive: true
        continueOnError: false
      posix:
        shell: sh
        run: ./scripts/auth_init.sh
        interactive: true
        continueOnError: false
    postprovision:
      windows:
        shell: pwsh
        run: ./scripts/auth_update.ps1;./scripts/prepdocs.ps1;
        interactive: true
        continueOnError: false
      posix:
        shell: sh
        run: ./scripts/auth_update.sh;./scripts/prepdocs.sh;
        interactive: true
        continueOnError: false
</file>

<file path="backend/auth/__init__.py">

</file>

<file path="backend/auth/sample_user.py">
sample_user = {
  "Accept": "*/*",
  "Accept-Encoding": "gzip, deflate, br",
  "Accept-Language": "en",
  "Client-Ip": "22.222.222.2222:64379",
  "Content-Length": "192",
  "Content-Type": "application/json",
  "Cookie": "AppServiceAuthSession=/AuR5ENU+pmpoN3jnymP8fzpmVBgphx9uPQrYLEWGcxjIITIeh8NZW7r3ePkG8yBcMaItlh1pX4nzg5TFD9o2mxC/5BNDRe/uuu0iDlLEdKecROZcVRY7QsFdHLjn9KB90Z3d9ZeLwfVIf0sZowWJt03BO5zKGB7vZgL+ofv3QY3AaYn1k1GtxSE9HQWJpWar7mOA64b7Lsy62eY3nxwg3AWDsP3/rAta+MnDCzpdlZMFXcJLj+rsCppW+w9OqGhKQ7uCs03BPeon3qZOdmE8cOJW3+i96iYlhneNQDItHyQqEi1CHbBTSkqwpeOwWP4vcwGM22ynxPp7YFyiRw/X361DGYy+YkgYBkXq1AEIDZ44BCBz9EEaEi0NU+m6yUOpNjEaUtrJKhQywcM2odojdT4XAY+HfTEfSqp0WiAkgAuE/ueCu2JDOfvxGjCgJ4DGWCoYdOdXAN1c+MenT4OSvkMO41YuPeah9qk9ixkJI5s80lv8rUu1J26QF6pstdDkYkAJAEra3RQiiO1eAH7UEb3xHXn0HW5lX8ZDX3LWiAFGOt5DIKxBKFymBKJGzbPFPYjfczegu0FD8/NQPLl2exAX3mI9oy/tFnATSyLO2E8DxwP5wnYVminZOQMjB/I4g3Go14betm0MlNXlUbU1fyS6Q6JxoCNLDZywCoU9Y65UzimWZbseKsXlOwYukCEpuQ5QPT55LuEAWhtYier8LSh+fvVUsrkqKS+bg0hzuoX53X6aqUr7YB31t0Z2zt5TT/V3qXpdyD8Xyd884PqysSkJYa553sYx93ETDKSsfDguanVfn2si9nvDpvUWf6/R02FmQgXiaaaykMgYyIuEmE77ptsivjH3hj/MN4VlePFWokcchF4ciqqzonmICmjEHEx5zpjU2Kwa+0y7J5ROzVVygcnO1jH6ZKDy9bGGYL547bXx/iiYBYqSIQzleOAkCeULrGN2KEHwckX5MpuRaqTpoxdZH9RJv0mIWxbDA0kwGsbMICQd0ZODBkPUnE84qhzvXInC+TL7MbutPEnGbzgxBAS1c2Ct4vxkkjykOeOxTPxqAhxoefwUfIwZZax6A9LbeYX2bsBpay0lScHcA==",
  "Disguised-Host": "your_app_service.azurewebsites.net",
  "Host": "your_app_service.azurewebsites.net",
  "Max-Forwards": "10",
  "Origin": "https://your_app_service.azurewebsites.net",
  "Referer": "https://your_app_service.azurewebsites.net/",
  "Sec-Ch-Ua": "\"Microsoft Edge\";v=\"113\", \"Chromium\";v=\"113\", \"Not-A.Brand\";v=\"24\"",
  "Sec-Ch-Ua-Mobile": "?0",
  "Sec-Ch-Ua-Platform": "\"Windows\"",
  "Sec-Fetch-Dest": "empty",
  "Sec-Fetch-Mode": "cors",
  "Sec-Fetch-Site": "same-origin",
  "Traceparent": "00-24e9a8d1b06f233a3f1714845ef971a9-3fac69f81ca5175c-00",
  "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Edg/113.0.1774.42",
  "Was-Default-Hostname": "your_app_service.azurewebsites.net",
  "X-Appservice-Proto": "https",
  "X-Arr-Log-Id": "4102b832-6c88-4c7c-8996-0edad9e4358f",
  "X-Arr-Ssl": "2048|256|CN=Microsoft Azure TLS Issuing CA 02, O=Microsoft Corporation, C=US|CN=*.azurewebsites.net, O=Microsoft Corporation, L=Redmond, S=WA, C=US",
  "X-Client-Ip": "22.222.222.222",
  "X-Client-Port": "64379",
  "X-Forwarded-For": "22.222.222.22:64379",
  "X-Forwarded-Proto": "https",
  "X-Forwarded-Tlsversion": "1.2",
  "X-Ms-Client-Principal": "your_base_64_encoded_token",
  "X-Ms-Client-Principal-Id": "00000000-0000-0000-0000-000000000000",
  "X-Ms-Client-Principal-Idp": "aad",
  "X-Ms-Client-Principal-Name": "testusername@constoso.com",
  "X-Ms-Token-Aad-Id-Token": "your_aad_id_token",
  "X-Original-Url": "/chatgpt",
  "X-Site-Deployment-Id": "your_app_service",
  "X-Waws-Unencoded-Url": "/chatgpt"
}
</file>

<file path="CODE_OF_CONDUCT.md">
# Microsoft Open Source Code of Conduct

This project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).

Resources:

- [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/)
- [Microsoft Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/)
- Contact [opencode@microsoft.com](mailto:opencode@microsoft.com) with questions or concerns
</file>

<file path="frontend/index.html">
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/x-icon" href="{{ favicon }}" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ title }}</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/index.tsx"></script>
  </body>
</html>
</file>

<file path="frontend/src/assets/Azure.svg">
<svg width="100%" height="100%" viewBox="0 0 65 65" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M20.1149 7.70779C20.4813 6.62237 21.4992 5.8916 22.6447 5.8916H39.6279L22.0159 58.0753C21.6495 59.1607 20.6316 59.8915 19.4861 59.8915H6.22202C4.39538 59.8915 3.1081 58.0984 3.69222 56.3677L20.1149 7.70779Z" fill="url(#paint0_linear_2532_530598)"/>
<path d="M47.2237 40.9922H20.5139C19.3879 40.9922 18.847 42.3738 19.6737 43.1383L37.0252 59.1825C37.5186 59.6388 38.1659 59.8922 38.8379 59.8922H53.8027L47.2237 40.9922Z" fill="#0078D4"/>
<path d="M22.6446 5.8916C21.499 5.8916 20.4811 6.62237 20.1148 7.70779L3.69208 56.3677C3.10796 58.0984 4.39525 59.8915 6.22189 59.8915H19.4859C20.6315 59.8915 21.6494 59.1607 22.0157 58.0753L25.2833 48.3936L36.8335 59.1738C37.328 59.6352 37.979 59.8918 38.6553 59.8918H53.8029L47.2238 40.9919H27.7814L39.6277 5.8916H22.6446Z" fill="url(#paint1_linear_2532_530598)"/>
<path d="M44.2909 7.70779C43.9245 6.62237 42.9066 5.8916 41.7611 5.8916H22.7529H22.8396C23.998 5.8916 25.0273 6.63058 25.3978 7.7282L41.8002 56.3281C42.3909 58.0783 41.0892 59.8915 39.242 59.8915H38.9529H58.1838C60.0104 59.8915 61.2977 58.0984 60.7136 56.3677L44.2909 7.70779Z" fill="url(#paint2_linear_2532_530598)"/>
<defs>
<linearGradient id="paint0_linear_2532_530598" x1="22.5507" y1="7.76073" x2="4.93883" y2="59.7904" gradientUnits="userSpaceOnUse">
<stop stop-color="#114A8B"/>
<stop offset="1" stop-color="#0669BC"/>
</linearGradient>
<linearGradient id="paint1_linear_2532_530598" x1="36.6217" y1="40.9974" x2="32.5513" y2="42.374" gradientUnits="userSpaceOnUse">
<stop stop-opacity="0.3"/>
<stop offset="0.0711768" stop-opacity="0.2"/>
<stop offset="0.321031" stop-opacity="0.1"/>
<stop offset="0.623053" stop-opacity="0.05"/>
<stop offset="1" stop-opacity="0"/>
</linearGradient>
<linearGradient id="paint2_linear_2532_530598" x1="33.7164" y1="7.76081" x2="53.0487" y2="59.2668" gradientUnits="userSpaceOnUse">
<stop stop-color="#3CCBF4"/>
<stop offset="1" stop-color="#2892DF"/>
</linearGradient>
</defs>
</svg>
</file>

<file path="frontend/src/assets/Contoso.svg">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   version="1.1"
   id="svg1"
   width="374"
   height="373"
   viewBox="0 0 374 373"
   sodipodi:docname="OIP (1).svg"
   inkscape:version="1.3.1 (91b66b0783, 2023-11-16)"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <g
     inkscape:groupmode="layer"
     inkscape:label="Image"
     id="g1">
    <path
       style="fill:#334768;fill-opacity:1"
       d="M 161.69374,371.28839 C 126.08408,365.82165 94.611558,351.69376 67.752618,329.11859 39.404638,305.29186 18.614697,273.11205 8.7848067,237.84501 3.1245969,217.53765 2.2979969,211.08189 2.2993869,187.19373 c 10e-4,-20.16709 0.23008,-23.08309 2.74744,-35 C 13.173897,113.72098 30.404107,81.692832 57.173028,55.299653 84.822558,28.03823 116.87433,11.595302 157.19374,3.9878768 c 12.75307,-2.406236 47.29049,-2.397531 60.5,0.01525 51.38306,9.3853562 95.40886,37.8203662 123.87736,80.0088552 11.30618,16.755028 22.95873,43.797958 27.08627,62.861058 5.59726,25.85106 5.40202,56.86111 -0.51884,82.40668 -14.22632,61.3795 -60.08391,112.40255 -119.79978,133.29417 -20.47735,7.16401 -32.85607,9.25793 -57.14501,9.66632 -13.97813,0.23502 -23.84219,-0.0832 -29.5,-0.95182 z m 43,-34.22532 c 52.37453,-10.56041 88.63765,-49.67707 95.05226,-102.53193 1.30877,-10.78396 0.83914,-14.20461 -1.21407,-8.84288 -3.18321,8.31257 -11.01588,23.077 -15.91819,30.00547 -2.91868,4.125 -9.31688,11.47715 -14.21821,16.33811 -38.59976,38.28184 -92.00972,55.58185 -140.86615,45.62792 -11.52275,-2.34762 -25.75651,-6.87877 -32.765502,-10.43049 -6.32537,-3.20531 -6.44194,-2.14065 -0.27754,2.53496 13.630782,10.33878 35.154762,21.0451 50.241382,24.99075 18.8225,4.92271 42.48231,5.83338 59.96602,2.30809 z m -98.90103,-66.11934 c -18.289582,-18.16232 -27.190922,-33.79517 -33.167562,-58.25 -3.14391,-12.86407 -3.18827,-36.85921 -0.1,-54.08078 10.4835,-58.46039 47.718262,-102.764157 102.090082,-121.471839 9.29268,-3.19732 9.44422,-3.29775 5.0785,-3.36563 -9.59776,-0.14922 -32.41602,4.39968 -44.5,8.871242 -40.522322,14.99491 -72.399832,45.427999 -87.888992,83.906617 -1.40799,3.49779 -3.79951,11.14779 -5.31448,17 -2.50382,9.67209 -2.7564,12.27842 -2.77551,28.64039 -0.0165,14.09008 0.3838,19.73774 1.84268,26 8.14824,34.97652 30.51977,62.98444 63.136302,79.04317 6.05,2.97872 11.54704,5.42507 12.21565,5.43634 0.6686,0.0113 -4.1089,-5.26701 -10.61668,-11.72951 z m 103.40103,-0.77297 c 7.33382,-2.00991 20.78428,-8.20051 26.77943,-12.32528 15.59144,-10.72719 28.52397,-28.96631 33.93555,-47.86027 3.05462,-10.66486 3.26192,-34.42989 0.38636,-44.29148 -9.09798,-31.20105 -31.671,-53.09728 -63.60134,-61.69443 -9.87826,-2.65969 -31.02119,-2.40611 -41.25939,0.49485 -30.09076,8.52613 -52.97575,31.49968 -60.96367,61.19958 -3.01659,11.21598 -3.04923,31.68026 -0.0679,42.56549 8.61821,31.46617 32.41536,55.12441 62.29096,61.92736 4.125,0.9393 7.95,1.88309 8.5,2.09732 2.56945,1.00081 28.52354,-0.61227 34,-2.11314 z m 125.8197,-40.47703 c 4.67253,-16.25634 5.99878,-27.76219 5.35877,-46.48989 -0.69704,-20.39671 -2.27876,-28.18915 -9.48979,-46.75198 -12.21458,-31.44312 -41.17384,-59.750598 -71.18868,-69.586438 -17.39968,-5.701869 -39.25419,-7.564409 -56.15596,-4.785869 -10.0457,1.65145 -25.84506,6.180259 -25.84266,7.407679 7.6e-4,0.38857 5.28826,0.73041 11.75,0.75964 17.44682,0.0789 31.17554,3.34767 49.56758,11.80183 58.47504,26.878868 95.42192,85.186448 92.27475,145.623058 -0.74512,14.30901 0.0676,14.75004 3.72599,2.02197 z"
       id="path1" />
  </g>
</svg>
</file>

<file path="frontend/src/assets/Send.svg">
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M1.7899 0.624791C0.827158 0.165808 -0.231189 1.04584 0.0444367 2.07616L2.05964 9.60921C2.16316 9.99621 2.48766 10.2841 2.88425 10.3407L12.7676 11.7526C13.0538 11.7935 13.0538 12.2067 12.7676 12.2476L2.88529 13.6594C2.4887 13.716 2.16421 14.0039 2.06068 14.3909L0.0444365 21.9278C-0.231191 22.9582 0.827162 23.8382 1.7899 23.3792L23.2875 13.1303C24.2369 12.6777 24.2369 11.3263 23.2875 10.8737L1.7899 0.624791Z" fill="url(#paint0_radial_2280_119090)"/>
<defs>
<radialGradient id="paint0_radial_2280_119090" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(24.0234 21.2469) rotate(-142.006) scale(33.4402 32.3913)">
<stop offset="0.336272" stop-color="#0F6CBD"/>
<stop offset="0.703125" stop-color="#2D87C3"/>
<stop offset="1" stop-color="#8DDDD8"/>
</radialGradient>
</defs>
</svg>
</file>

<file path="frontend/src/vite-env.d.ts">
/// <reference types="vite/client" />
</file>

<file path="frontend/tsconfig.node.json">
{
  "compilerOptions": {
    "composite": true,
    "module": "ESNext",
    "moduleResolution": "Node",
    "allowSyntheticDefaultImports": true
  },
  "include": ["vite.config.ts"]
}
</file>

<file path="gunicorn.conf.py">
import multiprocessing

max_requests = 1000
max_requests_jitter = 50
log_file = "-"
bind = "0.0.0.0"

timeout = 230
# https://learn.microsoft.com/en-us/troubleshoot/azure/app-service/web-apps-performance-faqs#why-does-my-request-time-out-after-230-seconds

num_cpus = multiprocessing.cpu_count()
workers = (num_cpus * 2) + 1
worker_class = "uvicorn.workers.UvicornWorker"
</file>

<file path="infra/abbreviations.json">
{
  "analysisServicesServers": "as",
  "apiManagementService": "apim-",
  "appConfigurationConfigurationStores": "appcs-",
  "appManagedEnvironments": "cae-",
  "appContainerApps": "ca-",
  "authorizationPolicyDefinitions": "policy-",
  "automationAutomationAccounts": "aa-",
  "blueprintBlueprints": "bp-",
  "blueprintBlueprintsArtifacts": "bpa-",
  "cacheRedis": "redis-",
  "cdnProfiles": "cdnp-",
  "cdnProfilesEndpoints": "cdne-",
  "cognitiveServicesAccounts": "cog-",
  "cognitiveServicesFormRecognizer": "cog-fr-",
  "cognitiveServicesTextAnalytics": "cog-ta-",
  "computeAvailabilitySets": "avail-",
  "computeCloudServices": "cld-",
  "computeDiskEncryptionSets": "des",
  "computeDisks": "disk",
  "computeDisksOs": "osdisk",
  "computeGalleries": "gal",
  "computeSnapshots": "snap-",
  "computeVirtualMachines": "vm",
  "computeVirtualMachineScaleSets": "vmss-",
  "containerInstanceContainerGroups": "ci",
  "containerRegistryRegistries": "cr",
  "containerServiceManagedClusters": "aks-",
  "databricksWorkspaces": "dbw-",
  "dataFactoryFactories": "adf-",
  "dataLakeAnalyticsAccounts": "dla",
  "dataLakeStoreAccounts": "dls",
  "dataMigrationServices": "dms-",
  "dBforMySQLServers": "mysql-",
  "dBforPostgreSQLServers": "psql-",
  "devicesIotHubs": "iot-",
  "devicesProvisioningServices": "provs-",
  "devicesProvisioningServicesCertificates": "pcert-",
  "documentDBDatabaseAccounts": "cosmos-",
  "eventGridDomains": "evgd-",
  "eventGridDomainsTopics": "evgt-",
  "eventGridEventSubscriptions": "evgs-",
  "eventHubNamespaces": "evhns-",
  "eventHubNamespacesEventHubs": "evh-",
  "hdInsightClustersHadoop": "hadoop-",
  "hdInsightClustersHbase": "hbase-",
  "hdInsightClustersKafka": "kafka-",
  "hdInsightClustersMl": "mls-",
  "hdInsightClustersSpark": "spark-",
  "hdInsightClustersStorm": "storm-",
  "hybridComputeMachines": "arcs-",
  "insightsActionGroups": "ag-",
  "insightsComponents": "appi-",
  "keyVaultVaults": "kv-",
  "kubernetesConnectedClusters": "arck",
  "kustoClusters": "dec",
  "kustoClustersDatabases": "dedb",
  "logicIntegrationAccounts": "ia-",
  "logicWorkflows": "logic-",
  "machineLearningServicesWorkspaces": "mlw-",
  "managedIdentityUserAssignedIdentities": "id-",
  "managementManagementGroups": "mg-",
  "migrateAssessmentProjects": "migr-",
  "networkApplicationGateways": "agw-",
  "networkApplicationSecurityGroups": "asg-",
  "networkAzureFirewalls": "afw-",
  "networkBastionHosts": "bas-",
  "networkConnections": "con-",
  "networkDnsZones": "dnsz-",
  "networkExpressRouteCircuits": "erc-",
  "networkFirewallPolicies": "afwp-",
  "networkFirewallPoliciesWebApplication": "waf",
  "networkFirewallPoliciesRuleGroups": "wafrg",
  "networkFrontDoors": "fd-",
  "networkFrontdoorWebApplicationFirewallPolicies": "fdfp-",
  "networkLoadBalancersExternal": "lbe-",
  "networkLoadBalancersInternal": "lbi-",
  "networkLoadBalancersInboundNatRules": "rule-",
  "networkLocalNetworkGateways": "lgw-",
  "networkNatGateways": "ng-",
  "networkNetworkInterfaces": "nic-",
  "networkNetworkSecurityGroups": "nsg-",
  "networkNetworkSecurityGroupsSecurityRules": "nsgsr-",
  "networkNetworkWatchers": "nw-",
  "networkPrivateDnsZones": "pdnsz-",
  "networkPrivateLinkServices": "pl-",
  "networkPublicIPAddresses": "pip-",
  "networkPublicIPPrefixes": "ippre-",
  "networkRouteFilters": "rf-",
  "networkRouteTables": "rt-",
  "networkRouteTablesRoutes": "udr-",
  "networkTrafficManagerProfiles": "traf-",
  "networkVirtualNetworkGateways": "vgw-",
  "networkVirtualNetworks": "vnet-",
  "networkVirtualNetworksSubnets": "snet-",
  "networkVirtualNetworksVirtualNetworkPeerings": "peer-",
  "networkVirtualWans": "vwan-",
  "networkVpnGateways": "vpng-",
  "networkVpnGatewaysVpnConnections": "vcn-",
  "networkVpnGatewaysVpnSites": "vst-",
  "notificationHubsNamespaces": "ntfns-",
  "notificationHubsNamespacesNotificationHubs": "ntf-",
  "operationalInsightsWorkspaces": "log-",
  "portalDashboards": "dash-",
  "powerBIDedicatedCapacities": "pbi-",
  "purviewAccounts": "pview-",
  "recoveryServicesVaults": "rsv-",
  "resourcesResourceGroups": "rg-",
  "searchSearchServices": "srch-",
  "serviceBusNamespaces": "sb-",
  "serviceBusNamespacesQueues": "sbq-",
  "serviceBusNamespacesTopics": "sbt-",
  "serviceEndPointPolicies": "se-",
  "serviceFabricClusters": "sf-",
  "signalRServiceSignalR": "sigr",
  "sqlManagedInstances": "sqlmi-",
  "sqlServers": "sql-",
  "sqlServersDataWarehouse": "sqldw-",
  "sqlServersDatabases": "sqldb-",
  "sqlServersDatabasesStretch": "sqlstrdb-",
  "storageStorageAccounts": "st",
  "storageStorageAccountsVm": "stvm",
  "storSimpleManagers": "ssimp",
  "streamAnalyticsCluster": "asa-",
  "synapseWorkspaces": "syn",
  "synapseWorkspacesAnalyticsWorkspaces": "synw",
  "synapseWorkspacesSqlPoolsDedicated": "syndp",
  "synapseWorkspacesSqlPoolsSpark": "synsp",
  "timeSeriesInsightsEnvironments": "tsi-",
  "webServerFarms": "plan-",
  "webSitesAppService": "app-",
  "webSitesAppServiceEnvironment": "ase-",
  "webSitesFunctions": "func-",
  "webStaticSites": "stapp-"
}
</file>

<file path="infra/core/ai/cognitiveservices.bicep">
param name string
param location string = resourceGroup().location
param tags object = {}

param customSubDomainName string = name
param deployments array = []
param kind string = 'OpenAI'
param publicNetworkAccess string = 'Enabled'
param sku object = {
  name: 'S0'
}

resource account 'Microsoft.CognitiveServices/accounts@2023-05-01' = {
  name: name
  location: location
  tags: tags
  kind: kind
  properties: {
    customSubDomainName: customSubDomainName
    publicNetworkAccess: publicNetworkAccess
  }
  sku: sku
}

@batchSize(1)
resource deployment 'Microsoft.CognitiveServices/accounts/deployments@2023-05-01' = [for deployment in deployments: {
  parent: account
  name: deployment.name
  properties: {
    model: deployment.model
    raiPolicyName: contains(deployment, 'raiPolicyName') ? deployment.raiPolicyName : null
  }
  sku: {
    name: 'Standard'
    capacity: deployment.capacity
  }
}]

output endpoint string = account.properties.endpoint
output id string = account.id
output name string = account.name
output skuName string = account.sku.name
output key string = account.listKeys().key1
</file>

<file path="infra/core/database/cosmos/cosmos-account.bicep">
metadata description = 'Creates an Azure Cosmos DB account.'
param name string
param location string = resourceGroup().location
param tags object = {}

@allowed([ 'GlobalDocumentDB', 'MongoDB', 'Parse' ])
param kind string

resource cosmos 'Microsoft.DocumentDB/databaseAccounts@2022-08-15' = {
  name: name
  kind: kind
  location: location
  tags: tags
  properties: {
    consistencyPolicy: { defaultConsistencyLevel: 'Session' }
    locations: [
      {
        locationName: location
        failoverPriority: 0
        isZoneRedundant: false
      }
    ]
    databaseAccountOfferType: 'Standard'
    enableAutomaticFailover: false
    enableMultipleWriteLocations: false
    apiProperties: (kind == 'MongoDB') ? { serverVersion: '4.0' } : {}
    capabilities: [ { name: 'EnableServerless' } ]
  }
}

output endpoint string = cosmos.properties.documentEndpoint
output id string = cosmos.id
output name string = cosmos.name
</file>

<file path="infra/core/database/cosmos/sql/cosmos-sql-account.bicep">
metadata description = 'Creates an Azure Cosmos DB for NoSQL account.'
param name string
param location string = resourceGroup().location
param tags object = {}

module cosmos '../../cosmos/cosmos-account.bicep' = {
  name: 'cosmos-account'
  params: {
    name: name
    location: location
    tags: tags
    kind: 'GlobalDocumentDB'
  }
}

output endpoint string = cosmos.outputs.endpoint
output id string = cosmos.outputs.id
output name string = cosmos.outputs.name
</file>

<file path="infra/core/database/cosmos/sql/cosmos-sql-db.bicep">
metadata description = 'Creates an Azure Cosmos DB for NoSQL account with a database.'
param accountName string
param databaseName string
param location string = resourceGroup().location
param tags object = {}

param containers array = []
param principalIds array = []

module cosmos 'cosmos-sql-account.bicep' = {
  name: 'cosmos-sql-account'
  params: {
    name: accountName
    location: location
    tags: tags
  }
}

resource database 'Microsoft.DocumentDB/databaseAccounts/sqlDatabases@2022-05-15' = {
  name: '${accountName}/${databaseName}'
  properties: {
    resource: { id: databaseName }
  }

  resource list 'containers' = [for container in containers: {
    name: container.name
    properties: {
      resource: {
        id: container.id
        partitionKey: { paths: [ container.partitionKey ] }
      }
      options: {}
    }
  }]

  dependsOn: [
    cosmos
  ]
}

module roleDefinition 'cosmos-sql-role-def.bicep' = {
  name: 'cosmos-sql-role-definition'
  params: {
    accountName: accountName
  }
  dependsOn: [
    cosmos
    database
  ]
}

// We need batchSize(1) here because sql role assignments have to be done sequentially
@batchSize(1)
module userRole 'cosmos-sql-role-assign.bicep' = [for principalId in principalIds: if (!empty(principalId)) {
  name: 'cosmos-sql-user-role-${uniqueString(principalId)}'
  params: {
    accountName: accountName
    roleDefinitionId: roleDefinition.outputs.id
    principalId: principalId
  }
  dependsOn: [
    cosmos
    database
  ]
}]

output accountId string = cosmos.outputs.id
output accountName string = cosmos.outputs.name
output databaseName string = databaseName
output endpoint string = cosmos.outputs.endpoint
output roleDefinitionId string = roleDefinition.outputs.id
</file>

<file path="infra/core/database/cosmos/sql/cosmos-sql-role-assign.bicep">
metadata description = 'Creates a SQL role assignment under an Azure Cosmos DB account.'
param accountName string

param roleDefinitionId string
param principalId string = ''

resource role 'Microsoft.DocumentDB/databaseAccounts/sqlRoleAssignments@2022-05-15' = {
  parent: cosmos
  name: guid(roleDefinitionId, principalId, cosmos.id)
  properties: {
    principalId: principalId
    roleDefinitionId: roleDefinitionId
    scope: cosmos.id
  }
}

resource cosmos 'Microsoft.DocumentDB/databaseAccounts@2022-08-15' existing = {
  name: accountName
}
</file>

<file path="infra/core/database/cosmos/sql/cosmos-sql-role-def.bicep">
metadata description = 'Creates a SQL role definition under an Azure Cosmos DB account.'
param accountName string

resource roleDefinition 'Microsoft.DocumentDB/databaseAccounts/sqlRoleDefinitions@2022-08-15' = {
  parent: cosmos
  name: guid(cosmos.id, accountName, 'sql-role')
  properties: {
    assignableScopes: [
      cosmos.id
    ]
    permissions: [
      {
        dataActions: [
          'Microsoft.DocumentDB/databaseAccounts/readMetadata'
          'Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/items/*'
          'Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/*'
        ]
        notDataActions: []
      }
    ]
    roleName: 'Reader Writer'
    type: 'CustomRole'
  }
}

resource cosmos 'Microsoft.DocumentDB/databaseAccounts@2022-08-15' existing = {
  name: accountName
}

output id string = roleDefinition.id
</file>

<file path="infra/core/host/appservice.bicep">
param name string
param location string = resourceGroup().location
param tags object = {}

// Reference Properties
param applicationInsightsName string = ''
param appServicePlanId string
param keyVaultName string = ''
param managedIdentity bool = !empty(keyVaultName)

// Runtime Properties
@allowed([
  'dotnet', 'dotnetcore', 'dotnet-isolated', 'node', 'python', 'java', 'powershell', 'custom'
])
param runtimeName string
param runtimeNameAndVersion string = '${runtimeName}|${runtimeVersion}'
param runtimeVersion string

// Microsoft.Web/sites Properties
param kind string = 'app,linux'

// Microsoft.Web/sites/config
param allowedOrigins array = []
param alwaysOn bool = true
param appCommandLine string = ''
param appSettings object = {}
param authClientId string
@secure()
param authClientSecret string
param authIssuerUri string
param clientAffinityEnabled bool = false
param enableOryxBuild bool = contains(kind, 'linux')
param functionAppScaleLimit int = -1
param linuxFxVersion string = runtimeNameAndVersion
param minimumElasticInstanceCount int = -1
param numberOfWorkers int = -1
param scmDoBuildDuringDeployment bool = false
param use32BitWorkerProcess bool = false
param ftpsState string = 'FtpsOnly'
param healthCheckPath string = ''

resource appService 'Microsoft.Web/sites@2022-03-01' = {
  name: name
  location: location
  tags: tags
  kind: kind
  properties: {
    serverFarmId: appServicePlanId
    siteConfig: {
      linuxFxVersion: linuxFxVersion
      alwaysOn: alwaysOn
      ftpsState: ftpsState
      appCommandLine: appCommandLine
      numberOfWorkers: numberOfWorkers != -1 ? numberOfWorkers : null
      minimumElasticInstanceCount: minimumElasticInstanceCount != -1 ? minimumElasticInstanceCount : null
      use32BitWorkerProcess: use32BitWorkerProcess
      functionAppScaleLimit: functionAppScaleLimit != -1 ? functionAppScaleLimit : null
      healthCheckPath: healthCheckPath
      cors: {
        allowedOrigins: union([ 'https://portal.azure.com', 'https://ms.portal.azure.com' ], allowedOrigins)
      }
    }
    clientAffinityEnabled: clientAffinityEnabled
    httpsOnly: true
  }

  identity: { type: managedIdentity ? 'SystemAssigned' : 'None' }

  resource configAppSettings 'config' = {
    name: 'appsettings'
    properties: union(appSettings,
      {
        SCM_DO_BUILD_DURING_DEPLOYMENT: string(scmDoBuildDuringDeployment)
        ENABLE_ORYX_BUILD: string(enableOryxBuild)
      },
      !empty(applicationInsightsName) ? { APPLICATIONINSIGHTS_CONNECTION_STRING: applicationInsights.properties.ConnectionString } : {},
      !empty(keyVaultName) ? { AZURE_KEY_VAULT_ENDPOINT: keyVault.properties.vaultUri } : {},
      !empty(authClientSecret) ? { AUTH_CLIENT_SECRET: authClientSecret } : {}
    )
  }

  resource configLogs 'config' = {
    name: 'logs'
    properties: {
      applicationLogs: { fileSystem: { level: 'Verbose' } }
      detailedErrorMessages: { enabled: true }
      failedRequestsTracing: { enabled: true }
      httpLogs: { fileSystem: { enabled: true, retentionInDays: 1, retentionInMb: 35 } }
    }
    dependsOn: [
      configAppSettings
    ]
  }

  resource configAuth 'config' = if (!(empty(authClientId))) {
    name: 'authsettingsV2'
    properties: {
      globalValidation: {
        requireAuthentication: true
        unauthenticatedClientAction: 'RedirectToLoginPage'
        redirectToProvider: 'azureactivedirectory'
      }
      identityProviders: {
        azureActiveDirectory: {
          enabled: true
          registration: {
            clientId: authClientId
            clientSecretSettingName: 'AUTH_CLIENT_SECRET'
            openIdIssuer: authIssuerUri
          }
          validation: {
            defaultAuthorizationPolicy: {
              allowedApplications: []
            }
          }
        }
      }
      login: {
        tokenStore: {
          enabled: true
        }
      }
    }
  }
}

resource keyVault 'Microsoft.KeyVault/vaults@2022-07-01' existing = if (!(empty(keyVaultName))) {
  name: keyVaultName
}

resource applicationInsights 'Microsoft.Insights/components@2020-02-02' existing = if (!empty(applicationInsightsName)) {
  name: applicationInsightsName
}

output identityPrincipalId string = managedIdentity ? appService.identity.principalId : ''
output name string = appService.name
output uri string = 'https://${appService.properties.defaultHostName}'
</file>

<file path="infra/core/host/appserviceplan.bicep">
param name string
param location string = resourceGroup().location
param tags object = {}

param kind string = ''
param reserved bool = true
param sku object

resource appServicePlan 'Microsoft.Web/serverfarms@2022-03-01' = {
  name: name
  location: location
  tags: tags
  sku: sku
  kind: kind
  properties: {
    reserved: reserved
  }
}

output id string = appServicePlan.id
output name string = appServicePlan.name
</file>

<file path="infra/core/search/search-services.bicep">
param name string
param location string = resourceGroup().location
param tags object = {}

param sku object = {
  name: 'standard'
}

param authOptions object = {}
param semanticSearch string = 'disabled'

resource search 'Microsoft.Search/searchServices@2021-04-01-preview' = {
  name: name
  location: location
  tags: tags
  identity: {
    type: 'SystemAssigned'
  }
  properties: {
    authOptions: authOptions
    disableLocalAuth: false
    disabledDataExfiltrationOptions: []
    encryptionWithCmk: {
      enforcement: 'Unspecified'
    }
    hostingMode: 'default'
    networkRuleSet: {
      bypass: 'None'
      ipRules: []
    }
    partitionCount: 1
    publicNetworkAccess: 'Enabled'
    replicaCount: 1
    semanticSearch: semanticSearch
  }
  sku: sku
}

output id string = search.id
output endpoint string = 'https://${name}.search.windows.net/'
output name string = search.name
output skuName string = sku.name
output adminKey string = search.listAdminKeys().primaryKey
</file>

<file path="infra/core/security/role.bicep">
param principalId string

@allowed([
  'Device'
  'ForeignGroup'
  'Group'
  'ServicePrincipal'
  'User'
])
param principalType string = 'ServicePrincipal'
param roleDefinitionId string

resource role 'Microsoft.Authorization/roleAssignments@2022-04-01' = {
  name: guid(subscription().id, resourceGroup().id, principalId, roleDefinitionId)
  properties: {
    principalId: principalId
    principalType: principalType
    roleDefinitionId: resourceId('Microsoft.Authorization/roleDefinitions', roleDefinitionId)
  }
}
</file>

<file path="infra/core/storage/storage-account.bicep">
param name string
param location string = resourceGroup().location
param tags object = {}

@allowed([ 'Hot', 'Cool', 'Premium' ])
param accessTier string = 'Hot'
param allowBlobPublicAccess bool = false
param allowCrossTenantReplication bool = true
param allowSharedKeyAccess bool = true
param defaultToOAuthAuthentication bool = false
param deleteRetentionPolicy object = {}
@allowed([ 'AzureDnsZone', 'Standard' ])
param dnsEndpointType string = 'Standard'
param kind string = 'StorageV2'
param minimumTlsVersion string = 'TLS1_2'
@allowed([ 'Enabled', 'Disabled' ])
param publicNetworkAccess string = 'Disabled'
param sku object = { name: 'Standard_LRS' }

param containers array = []

resource storage 'Microsoft.Storage/storageAccounts@2022-05-01' = {
  name: name
  location: location
  tags: tags
  kind: kind
  sku: sku
  properties: {
    accessTier: accessTier
    allowBlobPublicAccess: allowBlobPublicAccess
    allowCrossTenantReplication: allowCrossTenantReplication
    allowSharedKeyAccess: allowSharedKeyAccess
    defaultToOAuthAuthentication: defaultToOAuthAuthentication
    dnsEndpointType: dnsEndpointType
    minimumTlsVersion: minimumTlsVersion
    networkAcls: {
      bypass: 'AzureServices'
      defaultAction: 'Allow'
    }
    publicNetworkAccess: publicNetworkAccess
  }

  resource blobServices 'blobServices' = if (!empty(containers)) {
    name: 'default'
    properties: {
      deleteRetentionPolicy: deleteRetentionPolicy
    }
    resource container 'containers' = [for container in containers: {
      name: container.name
      properties: {
        publicAccess: contains(container, 'publicAccess') ? container.publicAccess : 'None'
      }
    }]
  }
}

output name string = storage.name
output primaryEndpoints object = storage.properties.primaryEndpoints
</file>

<file path="infra/db.bicep">
param accountName string
param location string = resourceGroup().location
param tags object = {}

param databaseName string = 'db_conversation_history'
param collectionName string = 'conversations'
param principalIds array = []

param containers array = [
  {
    name: collectionName
    id: collectionName
    partitionKey: '/userId'
  }
]

module cosmos 'core/database/cosmos/sql/cosmos-sql-db.bicep' = {
  name: 'cosmos-sql'
  params: {
    accountName: accountName
    databaseName: databaseName
    location: location
    containers: containers
    tags: tags
    principalIds: principalIds
  }
}


output databaseName string = cosmos.outputs.databaseName
output containerName string = containers[0].name
output accountName string = cosmos.outputs.accountName
output endpoint string = cosmos.outputs.endpoint
</file>

<file path="infra/docprep.bicep">
targetScope = 'subscription'

param resourceGroupName string
param location string
param tags object = {}
param principalId string
param resourceToken string

param formRecognizerServiceName string = ''
param formRecognizerResourceGroupName string = ''
param formRecognizerResourceGroupLocation string = location
param formRecognizerSkuName string = 'S0'

var abbrs = loadJsonContent('abbreviations.json')

resource resourceGroup 'Microsoft.Resources/resourceGroups@2021-04-01' existing = {
  name: resourceGroupName
}

resource formRecognizerResourceGroup 'Microsoft.Resources/resourceGroups@2021-04-01' existing = if (!empty(formRecognizerResourceGroupName)) {
  name: !empty(formRecognizerResourceGroupName) ? formRecognizerResourceGroupName : resourceGroup.name
}

module formRecognizer 'core/ai/cognitiveservices.bicep' = {
  name: 'formrecognizer'
  scope: formRecognizerResourceGroup
  params: {
    name: !empty(formRecognizerServiceName) ? formRecognizerServiceName : '${abbrs.cognitiveServicesFormRecognizer}${resourceToken}'
    kind: 'FormRecognizer'
    location: formRecognizerResourceGroupLocation
    tags: tags
    sku: {
      name: formRecognizerSkuName
    }
  }
}

module formRecognizerRoleUser 'core/security/role.bicep' = {
  scope: formRecognizerResourceGroup
  name: 'formrecognizer-role-user'
  params: {
    principalId: principalId
    roleDefinitionId: 'a97b65f3-24c7-4388-baec-2e87135dc908'
    principalType: 'User'
  }
}

// Used by prepdocs
// Form recognizer
output AZURE_FORMRECOGNIZER_SERVICE string = formRecognizer.outputs.name
output AZURE_FORMRECOGNIZER_RESOURCE_GROUP string = formRecognizerResourceGroup.name
output AZURE_FORMRECOGNIZER_SKU_NAME string = formRecognizerSkuName
</file>

<file path="infra/main.parameters.json">
{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "environmentName": {
      "value": "${AZURE_ENV_NAME}"
    },
    "location": {
      "value": "${AZURE_LOCATION}"
    },
    "principalId": {
      "value": "${AZURE_PRINCIPAL_ID}"
    },
    "openAiResourceName": {
      "value": "${AZURE_OPENAI_RESOURCE}"
    },
    "openAiResourceGroupName": {
      "value": "${AZURE_OPENAI_RESOURCE_GROUP}"
    },
    "openAiSkuName": {
      "value": "${AZURE_OPENAI_SKU_NAME}"
    },
    "searchServiceName": {
      "value": "${AZURE_SEARCH_SERVICE}"
    },
    "searchServiceResourceGroupName": {
      "value": "${AZURE_SEARCH_SERVICE_RESOURCE_GROUP}"
    },
    "searchServiceSkuName": {
      "value": "${AZURE_SEARCH_SKU_NAME}"
    },
    "formRecognizerServiceName": {
      "value": "${AZURE_FORMRECOGNIZER_SERVICE}"
    },
    "formRecognizerResourceGroupName": {
      "value": "${AZURE_FORMRECOGNIZER_RESOURCE_GROUP}"
    },
    "formRecognizerSkuName": {
      "value": "${AZURE_FORMRECOGNIZER_SKU_NAME}"
    },
    "authClientId": {
      "value": "${AUTH_CLIENT_ID}"
    },
    "authClientSecret": {
      "value": "${AUTH_CLIENT_SECRET}"
    }
  }
}
</file>

<file path="LICENSE">
MIT License

    Copyright (c) Microsoft Corporation.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE
</file>

<file path="notebooks/AzureOpenAI_OnYourData_Elasticsearch.ipynb">
{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "5f84108f",
   "metadata": {},
   "source": [
    "# Microsoft Azure OpenAI On Your Data with Elasticsearch\n",
    "\n",
    "In this notebook we'll use Elasticsearch indices to provide grounding data for queries to Azure OpenAI models using the Azure OpenAI On Your Data service.\n",
    "\n",
    "The Azure OpenAI On Your Data service currently supports three search scenarios for retrieval of documents that will be sent to the LLM for processing:\n",
    "\n",
    "1) full text search\n",
    "2) vector search using Elasticsearch Machine Learning models\n",
    "3) vector search using embeddings generated using Azure OpenAI (Ada).\n",
    "\n",
    "Each of these examples will be covered in the following sections."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c26cd732",
   "metadata": {},
   "source": [
    "## Requirements\n",
    "\n",
    "For this example, you will need:\n",
    "* Python 3.6 or later\n",
    "* An Elastic deployment meeting the following criteria: with machine learning node\n",
    "    * API version 8.x\n",
    "    * A machine learning node for following the example for vector search using an Elasticsearch text embedding model\n",
    "* An Azure OpenAI Resource\n",
    "    * At minimum, one chat model should be deployed for your resource to enable chatting about your data.\n",
    "    * Optionally, if you would like to try out vector search using the Azure OpenAI Ada model, you will also need to deploy an Ada model to your resource.  The examples below will assume you are using the model `text-embedding-ada-002`, but can be updated to suit your needs.\n",
    "* The [Elastic Python client](https://www.elastic.co/guide/en/elasticsearch/client/python-api/current/installation.html)\n",
    "* The [OpenAI Python Client](https://platform.openai.com/docs/api-reference/introduction?lang=python)\n",
    "\n",
    "### Create Elastic Deployment\n",
    "\n",
    "If you don't have an Elastic deployment, you can read more about how to get started here in the official [\"Getting Started\" guide for Elastic Cloud](https://www.elastic.co/getting-started).\n",
    "\n",
    "\n",
    "### Configure Azure OpenAI Resource\n",
    "\n",
    "If you don't have an Azure OpenAI resource, detailed information about how to obtain one can be found in the [official documentation](https://learn.microsoft.com/en-us/azure/ai-services/openai/use-your-data-quickstart?tabs=command-line&pivots=programming-language-python) for the Azure OpenAI On Your Data service."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cfff496a",
   "metadata": {},
   "source": [
    "## Install packages and initialize environment\n",
    "\n",
    "The first step is to use `pip` to install all of the packages we need to connect to Elasticsearch and Azure OpenAI services."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "65760c02",
   "metadata": {},
   "outputs": [],
   "source": [
    "!pip install -qU elasticsearch openai==0.28.1 requests"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "42a5580b",
   "metadata": {},
   "source": [
    "Here we will also define a few helper classes and functions that will be reused throughout the notebook."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f940364d",
   "metadata": {},
   "outputs": [],
   "source": [
    "import math\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import statistics\n",
    "from io import StringIO\n",
    "from time import sleep, perf_counter\n",
    "from urllib.request import urlopen\n",
    "\n",
    "\n",
    "class SampleCsvDatasets(object):\n",
    "    datasets = {\n",
    "        \"msmarco\": {\n",
    "            \"url\": \"https://github.com/mayya-sharipova/msmarco/raw/main/msmarco-passagetest2019-unique.tsv\",\n",
    "            \"fieldnames\": [\"id\", \"text\"],\n",
    "            \"delimiter\": \"\\t\"\n",
    "        }\n",
    "    }\n",
    "    def __init__(self):\n",
    "        self._values = {}\n",
    "        for name, config in self.datasets.items():\n",
    "            url = config.get(\"url\")\n",
    "            response = urlopen(url)\n",
    "            self._values[name] = self._create_dataframe(name, response.read().decode(\"utf-8\"))\n",
    "    \n",
    "    def _create_dataframe(self, dataset_name, value):\n",
    "        return pd.read_csv(\n",
    "            StringIO(value),\n",
    "            delimiter=self.datasets.get(dataset_name).get(\"delimiter\"),\n",
    "            names=self.datasets.get(dataset_name).get(\"fieldnames\")\n",
    "        )\n",
    "    \n",
    "    def get_dataframe(self, dataset_name, add_aoai_embeddings=False):\n",
    "        return self._values[name]\n",
    "    \n",
    "    def get_dataframe_with_aoai_embeddings(\n",
    "        self,\n",
    "        dataset_name,\n",
    "        embedding_model_deployment_name,\n",
    "        text_column_name=\"text\",\n",
    "        embeddings_column_name=\"text_embedding.aoai_predicted_value\",\n",
    "        model_name=\"text-embedding-ada-002\"\n",
    "    ):\n",
    "        df = self._values[dataset_name]\n",
    "        \n",
    "        # 16 is the current maximum batch size for embeddings, so we'll partition the dataframe by 16 rows.\n",
    "        maximum_batch_size = 16\n",
    "        \n",
    "        # This value can be manipulated if rate limiting errors occur while producing embeddings.\n",
    "        throttling_interval = 0.5\n",
    "        \n",
    "        # Occasionally the server will become overloaded, so retrying can ensure success.\n",
    "        retry_count = 30\n",
    "        \n",
    "        number_of_buckets = math.ceil(len(df) / maximum_batch_size)\n",
    "        partitions = np.array_split(df, number_of_buckets)\n",
    "        embeddings = []\n",
    "        request_times = []\n",
    "        \n",
    "        start = perf_counter()\n",
    "        for partition in partitions:\n",
    "            success = False\n",
    "            for i in range(retry_count):\n",
    "                try:\n",
    "                    request_start = perf_counter()\n",
    "                    text_embedding_response = openai.Embedding.create(\n",
    "                        deployment_id=embedding_model_deployment_name,\n",
    "                        input=partition[text_column_name].tolist(),\n",
    "                        api_version=\"2023-03-15-preview\"\n",
    "                    )\n",
    "                    embeddings.extend([result[\"embedding\"] for result in text_embedding_response[\"data\"]])\n",
    "                    sleep(throttling_interval)\n",
    "                    request_end = perf_counter()\n",
    "                    request_times.append(request_end-request_start)\n",
    "                    success = True\n",
    "\n",
    "                except Exception as e:\n",
    "                    print(f\"Encountered the following exception when creating embeddings (retrying): {str(e)}\")\n",
    "                    sleep(5)\n",
    "            \n",
    "            if not success:\n",
    "                raise Exception(\"Unable to generate embeddings (see previous error output for more information.)\")\n",
    "        \n",
    "        end = perf_counter()\n",
    "        df[text_embeddings_column_name] == embeddings\n",
    "        print(f\"Average request time for {len(partition)} records: {statistics.mean(request_times)}\")\n",
    "        print(f\"Total time: {end-start}\")\n",
    "\n",
    "def create_index(\n",
    "    elastic_client,\n",
    "    index_name: str,\n",
    "    **properties\n",
    "):\n",
    "    mappings = {\n",
    "        \"properties\": properties\n",
    "    }\n",
    "\n",
    "    # Clean up any previously created index with the same name\n",
    "    elastic_client.indices.delete(index=index_name, ignore_unavailable=True)\n",
    "\n",
    "    # Create the index\n",
    "    elastic_client.indices.create(index=index_name, mappings=mappings)\n",
    "\n",
    "\n",
    "def index_data(\n",
    "    elastic_client,\n",
    "    dataset_reader,\n",
    "    index_name\n",
    "):\n",
    "    # Use the bulk API to index data in chunks of 10000 documents\n",
    "    operations_chunks = []\n",
    "    chunk = []\n",
    "    max_operations_chunk_size = 10000\n",
    "    chunk_size = 0\n",
    "\n",
    "    for row in dataset_reader:\n",
    "\n",
    "        if chunk_size < max_operations_chunk_size:\n",
    "            chunk.append({\"index\": {\"_index\": index_name}})\n",
    "            chunk.append(row)\n",
    "            chunk_size += 1\n",
    "            \n",
    "        else:\n",
    "            operations_chunks.append(chunk)\n",
    "            chunk = []\n",
    "            chunk_size = 0\n",
    "\n",
    "    if len(chunk) > 0:\n",
    "        operations_chunks.append(chunk)\n",
    "\n",
    "    for chunk in operations_chunks:\n",
    "        elastic_client.bulk(index=index_name, operations=chunk, refresh=True)\n",
    "\n",
    "def chat_with_my_data(\n",
    "    chat_query,\n",
    "    aoai_deployment_name,\n",
    "    elasticsearch_endpoint,\n",
    "    elasticsearch_api_key,\n",
    "    index_name,\n",
    "    **embedding_config\n",
    "):\n",
    "    elasticsearch_embedding_model = embedding_config.get(\"elasticsearch_embedding_model\", None)\n",
    "    aoai_embedding_model = embedding_config.get(\"aoai_embedding_model\", None)\n",
    "    aoai_embedding_key = embedding_config.get(\"aoai_embedding_key\", None)\n",
    "    aoai_embedding_endpoint = None if not aoai_embedding_model and not aoai_embedding_key \\\n",
    "        else  f\"{openapi.api_base}/openai/deployments/{aoai_embedding_model}/embeddings?api-version=2023-03-15-preview\"\n",
    "    \n",
    "    query_type = \"vector\" if (aoai_embedding_endpoint and aoai_embedding_key) or elasticsearch_embedding_model else \"simple\"\n",
    "    \n",
    "    completion = openai.ChatCompletion.create(\n",
    "        messages=[\n",
    "            {\n",
    "                \"role\": \"user\",\n",
    "                \"content\": chat_query\n",
    "            }\n",
    "        ],\n",
    "        dataSources=[\n",
    "            {\n",
    "                \"type\": \"Elasticsearch\",\n",
    "                \"parameters\": {\n",
    "                    \"endpoint\": elasticsearch_endpoint,\n",
    "                    \"encodedApiKey\": elasticsearch_api_key,\n",
    "                    \"indexName\": index_name,\n",
    "                    \"queryType\": query_type,\n",
    "                    \"embeddingModelId\": elasticsearch_embedding_model,\n",
    "                    \"embeddingEndpoint\":  aoai_embedding_endpoint,\n",
    "                    \"embeddingKey\": aoai_embedding_key\n",
    "                }\n",
    "            }\n",
    "        ],\n",
    "        deployment_id=aoai_deployment_name\n",
    "    )\n",
    "    print(completion.choices[0].message.content)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3c2fdccc",
   "metadata": {},
   "source": [
    "Next, let's set some variables for configuring access to the services."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "36f42661",
   "metadata": {},
   "outputs": [],
   "source": [
    "import getpass\n",
    "import openai\n",
    "from elasticsearch import Elasticsearch\n",
    "\n",
    "# Elasticsearch Configuration\n",
    "elasticsearch_endpoint = input(\"Elasticsearch endpoint: \")\n",
    "elasticsearch_api_key = getpass.getpass(\"Elasticsearch API Key: \")\n",
    "\n",
    "# Azure OpenAI Configuration\n",
    "openai.api_base = input(\"Azure OpenAI resource endpoint: \")\n",
    "openai.api_key = getpass.getpass(\"Azure OpenAI resource key: \")\n",
    "chat_model_deployment_name = input(\"Azure OpenAI chat model deployment name: \")\n",
    "embedding_model_deployment_name = input(\"Azure OpenAI embedding model deployment name (enter 'None' if not applicable): \" )\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5879fadd",
   "metadata": {},
   "source": [
    "We'll also initialize our dataset manager for easy data access."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2baf659f",
   "metadata": {},
   "outputs": [],
   "source": [
    "datasets = SampleCsvDatasets()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e04781fb",
   "metadata": {},
   "source": [
    "Next, we'll configure the Elasticsearch client, which we will use to index some data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4050818b",
   "metadata": {},
   "outputs": [],
   "source": [
    "elastic_client = Elasticsearch(\n",
    "    f\"{elasticsearch_endpoint}:443\",\n",
    "    api_key=elasticsearch_api_key\n",
    ")\n",
    "\n",
    "print(elastic_client.info())"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6b3ea191",
   "metadata": {},
   "source": [
    "Next, we'll configure the OpenAI client to make requests to our specific Azure OpenAI resource endpoint.  We need to create an instance of `requests.adapters.HTTPAdapter` to ensure that the request session URL used by the OpenAI client points to the correct Azure OpenAI resource URL for each request."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "13a59211",
   "metadata": {},
   "outputs": [],
   "source": [
    "from requests import Session\n",
    "from requests.adapters import HTTPAdapter\n",
    "\n",
    "class OnYourDataAdapter(HTTPAdapter):\n",
    "    def send(self, request, **kwargs):\n",
    "        request.url = f\"{openai.api_base}/openai/deployments/{chat_model_deployment_name}/extensions/chat/completions?api-version={openai.api_version}\"\n",
    "        return super().send(request, **kwargs)\n",
    "    \n",
    "\n",
    "session = Session()\n",
    "session.mount(\n",
    "    prefix=f\"{openai.api_base}/openai/deployments/{chat_model_deployment_name}\",\n",
    "    adapter=OnYourDataAdapter()\n",
    ")\n",
    "\n",
    "openai.requestssession = session"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "315211dc",
   "metadata": {},
   "source": [
    "## Example 1: Grounding ChatGPT with data retrieved from a full-text search query \n",
    "\n",
    "\n",
    "### Create Elasticsearch index with required mappings\n",
    "\n",
    "We need to create an index which contains some text data for using full-text search for retrieving documents to ground the responses from Azure OpenAI.  First, we'll create the index mapping."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "902e3f19",
   "metadata": {},
   "outputs": [],
   "source": [
    "elasticsearch_index_name = \"msmarco-passagetest2019-unique\"\n",
    "mapping_properties = {\n",
    "    \"id\": {\"type\": \"keyword\"},\n",
    "    \"text\": {\"type\": \"text\"}\n",
    "}\n",
    "\n",
    "create_index(\n",
    "    elastic_client,\n",
    "    elasticsearch_index_name,\n",
    "    **mapping_properties\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "be0e040e",
   "metadata": {},
   "source": [
    "#### Download dataset\n",
    "\n",
    "For this example, we'll a subset of the MS MARCO Passage Ranking dataset.  We'll use the dataset manager to get a dataframe of our data to use for indexing."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ee9cab58",
   "metadata": {},
   "outputs": [],
   "source": [
    "dataframe = datasets.get_dataframe(\"msmarco\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "67981bbd",
   "metadata": {},
   "source": [
    "#### Index documents\n",
    "\n",
    "We'll call the helper function `index_data` to handle the indexing.  This function uses the `bulk` API to index data in batches."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7f8eaa4b",
   "metadata": {},
   "outputs": [],
   "source": [
    "index_data(\n",
    "    elastic_client,\n",
    "    dataframe,\n",
    "    elasticsearch_index_name\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8a072892",
   "metadata": {},
   "source": [
    "### Chat about your dataset\n",
    "\n",
    "Now that we have some data available in our Elasticsearch cluster, we can use Azure OpenAI On Your Data to ask questions about it.  The `chat_with_my_data` function call below will use full-text search by default, since we are not passing in any additional configuration about embeddings."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e34f9221",
   "metadata": {},
   "outputs": [],
   "source": [
    "chat_query = \"How's the weather in Jamaica?\"\n",
    "chat_with_my_data(\n",
    "    chat_query,\n",
    "    chat_model_deployment_name,\n",
    "    elasticsearch_endpoint,\n",
    "    elasticsearch_api_key,\n",
    "    elasticsearch_index_name\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cdf209c6",
   "metadata": {},
   "source": [
    "## Example 2: Grounding ChatGPT with data retrieved from a kNN search query using an Elasticsearch machine learning model for embeddings\n",
    "\n",
    "The next example will show how to chat with your data using a vector search query using embeddings produced by a model deployed to your Elasticsearch cluster.  This example is adapted from the Elastic Search Labs guide [\"How to deploy NLP: Text Embeddings and Vector Search\"](https://www.elastic.co/search-labs/how-to-deploy-nlp-text-embeddings-and-vector-search), and uses the same dataset that we already downloaded in the previous example.\n",
    "\n",
    "First, we will need to install the `eland` package, which we will use to deploy an embedding model."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "02fdf05d",
   "metadata": {},
   "outputs": [],
   "source": [
    "!pip install eland[pytorch]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8d6c7581",
   "metadata": {},
   "source": [
    "Next, we will deploy the model `msmarco-MiniLM-L-12-v3` model from Hugging Face, which is trained on a superset of the data we have already indexed in the previous example."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7b31d2e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "!eland_import_hub_model \\\n",
    "    --url {elasticsearch_endpoint}:443 \\\n",
    "    --es-api-key {elasticsearch_api_key} \\\n",
    "    --hub-model-id sentence-transformers/msmarco-MiniLM-L-12-v3 \\\n",
    "    --task-type text_embedding \\\n",
    "    --start"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "570de4ea",
   "metadata": {},
   "source": [
    "Next, we can reindex our data with the embeddings from the model to enable kNN search using those embeddings.  In the next cell, we'll create an ingest pipeline to calculate embeddings from the data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "49109c76",
   "metadata": {},
   "outputs": [],
   "source": [
    "from elasticsearch.client import IngestClient\n",
    "\n",
    "pipeline_id = \"msmarco-minilm-l-12-v3\"\n",
    "ingest_processors = [\n",
    "    {\n",
    "      \"inference\": {\n",
    "        \"model_id\": \"sentence-transformers__msmarco-minilm-l-12-v3\",\n",
    "        \"target_field\": \"text_embedding\",\n",
    "        \"field_map\": {\n",
    "          \"text\": \"text_field\"\n",
    "        }\n",
    "      }\n",
    "    }\n",
    "]\n",
    "\n",
    "on_failure = [\n",
    "    {\n",
    "      \"set\": {\n",
    "        \"description\": \"Index document to 'failed-<index>'\",\n",
    "        \"field\": \"_index\",\n",
    "        \"value\": \"failed-{{{_index}}}\"\n",
    "      }\n",
    "    },\n",
    "    {\n",
    "      \"set\": {\n",
    "        \"description\": \"Set error message\",\n",
    "        \"field\": \"ingest.failure\",\n",
    "        \"value\": \"{{_ingest.on_failure_message}}}\"\n",
    "      }\n",
    "    }\n",
    "]\n",
    "\n",
    "ingest_client = IngestClient(elastic_client)\n",
    "\n",
    "ingest_client.put_pipeline(\n",
    "    id=pipeline_id,\n",
    "    on_failure=on_failure,\n",
    "    processors=ingest_processors\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "63da95e8",
   "metadata": {},
   "source": [
    "Then, we'll reindex the `msmarco-passagetest2019-unique` index using the pipeline we just created."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "140fc17d",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create the new index\n",
    "elasticsearch_embeddings_index_name = f\"msmarco-passagetest2019-unique-{pipeline_id}\"\n",
    "mapping_properties = {\n",
    "    \"text_embedding.predicted_value\": {\n",
    "        \"type\": \"dense_vector\",\n",
    "        \"dims\": 384,\n",
    "        \"index\": True,\n",
    "        \"similarity\": \"cosine\"\n",
    "      },\n",
    "      \"text\": {\n",
    "        \"type\": \"text\"\n",
    "      }\n",
    "}\n",
    "\n",
    "create_index(\n",
    "    elastic_client,\n",
    "    elasticsearch_embeddings_index_name,\n",
    "    **mapping_properties)\n",
    "\n",
    "# Reindex source data into target index\n",
    "reindex_source = {\n",
    "    \"index\": elasticsearch_index_name\n",
    "}\n",
    "reindex_dest = {\n",
    "    \"index\": elasticsearch_embeddings_index_name,\n",
    "    \"pipeline\": pipeline_id\n",
    "}\n",
    "\n",
    "response = elastic_client.reindex(\n",
    "    source=reindex_source,\n",
    "    dest=reindex_dest,\n",
    "    wait_for_completion=False\n",
    ")\n",
    "print(response)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fe3900f7",
   "metadata": {},
   "source": [
    "The reindexing operation may take some time, so we can poll for the task status before moving to the next step."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1c5bf795",
   "metadata": {},
   "outputs": [],
   "source": [
    "from time import sleep\n",
    "\n",
    "is_completed = False\n",
    "while not is_completed:\n",
    "    sleep(1)\n",
    "    task = elastic_client.tasks.get(task_id=response.get(\"task\"))\n",
    "    is_completed = task.get(\"completed\")\n",
    "    \n",
    "print(\"Reindexing is complete!\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "648d6e4a",
   "metadata": {},
   "source": [
    "Now that we have our embeddings index ready to go, we can use this new index with embeddings with the Azure OpenAI On Your Data service.  Note that this call to `chat_with_my_data` passes in some configuration for our embeddings."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "818e393c",
   "metadata": {},
   "outputs": [],
   "source": [
    "chat_query = \"What's the weather like in Jamaica?\"\n",
    "\n",
    "chat_with_my_data(\n",
    "    chat_query,\n",
    "    chat_model_deployment_name,\n",
    "    elasticsearch_endpoint,\n",
    "    elasticsearch_api_key,\n",
    "    elasticsearch_embeddings_index_name,\n",
    "    elasticsearch_embedding_model=\"sentence-transformers__msmarco-minilm-l-12-v3\"\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2125fbee",
   "metadata": {},
   "source": [
    "## Example 3: Grounding ChatGPT with data retrieved from a kNN search query using Azure OpenAI embeddings\n",
    "\n",
    "We also have the option to create embeddings to use for kNN search using Azure OpenAI.  \n",
    "\n",
    "For this example, in addition to the chat model deployment used in the previous two examples for chatting with your data, you will also need an embedding model deployment added to your Azure OpenAI resource.  We will first use this embedding model to generate embeddings on your data, and then later refer to this deployment in our requests to the Azure OpenAI On Your Data service, which will call the model to generate the embeddings for your query as a part of the chat request.\n",
    "\n",
    "First, we will create a new index with the correct mappings for embeddings produced using the Azure OpenAI Ada embedding model."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5df5e380",
   "metadata": {},
   "outputs": [],
   "source": [
    "aoai_embeddings_index_name = f\"msmarco-passagetest2019-unique-{embedding_model_deployment_name}\"\n",
    "mapping_properties = {\n",
    "    \"id\": {\"type\": \"keyword\"},\n",
    "    \"text\": {\"type\": \"text\"},\n",
    "    \"text_embedding.aoai_predicted_value\": {\n",
    "        \"type\": \"dense_vector\",\n",
    "        \"dims\": 1536,\n",
    "        \"index\": True,\n",
    "        \"similarity\": \"cosine\"\n",
    "    }\n",
    "}\n",
    "\n",
    "create_index(\n",
    "    elastic_client,\n",
    "    aoai_embeddings_index_name,\n",
    "    **mapping_properties\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7882d2ac",
   "metadata": {},
   "source": [
    "Next, we will calculate embeddings for our dataset.  Note that this step may take some time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9091deb6",
   "metadata": {},
   "outputs": [],
   "source": [
    "dataframe = datasets.get_dataframe_with_aoai_embeddings(\"msmarco\", embedding_model_deployment_name)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "44b2b5e2",
   "metadata": {},
   "source": [
    "Then, we will index the data with embeddings we just calculated."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9767db99",
   "metadata": {},
   "outputs": [],
   "source": [
    "index_data(\n",
    "    elastic_client,\n",
    "    dataframe,\n",
    "    aoai_embeddings_index_name,\n",
    "    add_aoai_embeddings=True,\n",
    "    aoai_embedding_model_deployment=embedding_model_deployment_name\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c505efc9",
   "metadata": {},
   "source": [
    "Now that our index has been created with Azure Open AI embeddings, we can use the new index to chat with our data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eea9580a",
   "metadata": {},
   "outputs": [],
   "source": [
    "chat_query = \"What's the weather like in Jamaica?\"\n",
    "chat_with_my_data(\n",
    "    chat_query,\n",
    "    chat_model_deployment_name,\n",
    "    elasticsearch_endpoint,\n",
    "    elasticsearch_api_key,\n",
    "    aoai_embeddings_index_name,\n",
    "    aoai_embedding_model=embedding_model_deployment_name,\n",
    "    aoai_embedding_key=openai.api_key\n",
    ")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
</file>

<file path="README_azd.md">
# (Preview) Sample Chat App with AOAI

## Deploying with the Azure Developer CLI

> **IMPORTANT:** In order to deploy and run this example, you'll need an **Azure subscription with access enabled for the Azure OpenAI service**. You can request access [here](https://aka.ms/oaiapply). You can also visit [here](https://azure.microsoft.com/free/cognitive-search/) to get some free Azure credits to get you started. Your Azure Account must have `Microsoft.Authorization/roleAssignments/write` permissions, such as [User Access Administrator](https://learn.microsoft.com/azure/role-based-access-control/built-in-roles#user-access-administrator) or [Owner](https://learn.microsoft.com/azure/role-based-access-control/built-in-roles#owner).

> **AZURE RESOURCE COSTS** by default this sample will create Azure App Service and Azure Cognitive Search resources that have a monthly cost, as well as Form Recognizer resource that has cost per document page. You can switch them to free versions of each of them if you want to avoid this cost by changing the parameters file under the infra folder (though there are some limits to consider; for example, you can have up to 1 free Cognitive Search resource per subscription, and the free Form Recognizer resource only analyzes the first 2 pages of each document.)

## Opening the project

This project has [Dev Container support](https://code.visualstudio.com/docs/devcontainers/containers), so it will be be setup automatically if you open it in Github Codespaces or in local VS Code with the [Dev Containers extension](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers).

If you're not using one of those options for opening the project, then you'll need to:

1. Install prerequisites:

    - [Azure Developer CLI](https://aka.ms/azure-dev/install)
    - [Python 3+](https://www.python.org/downloads/)
        - **Important**: Python and the pip package manager must be in the path in Windows for the setup scripts to work.
    - [Node.js](https://nodejs.org/en/download/)
    - [Git](https://git-scm.com/downloads)
    - [Powershell 7+ (pwsh)](https://github.com/powershell/powershell) - For Windows users only.
    - **Important**: Ensure you can run `pwsh.exe` from a PowerShell command. If this fails, you likely need to upgrade PowerShell.


### Deploying from scratch:

If you don't have any pre-existing Azure services (i.e. OpenAI or Cognitive Search service), then you can provision
all resources from scratch by following these steps:

1. Run `azd auth login` to login to your Azure account.
1. Run `azd up` to provision Azure resources and deploy this sample to those resources. This also runs a script to build the search index based on files in the `./data` folder.
    * For the target location, the regions that currently support the models used in this sample are **East US** or **South Central US**. For an up-to-date list of regions and models, check [here](https://learn.microsoft.com/en-us/azure/cognitive-services/openai/concepts/models)
1. After the application has been successfully deployed you will see a URL printed to the console.  Click that URL to interact with the application in your browser.
    > NOTE: It may take a minute for the application to be fully deployed. If you see a "Python Developer" welcome screen, then wait a minute and refresh the page.

### Using existing resources:

If you have existing Azure resources that you want to reuse, then you must first set `azd` environment variables _before_ running `azd up`.

Run the following commands based on what you want to customize:

* `azd env set AZURE_OPENAI_RESOURCE {Name of existing OpenAI service}`
* `azd env set AZURE_OPENAI_RESOURCE_GROUP {Name of existing resource group that OpenAI service is provisioned to}`
* `azd env set AZURE_OPENAI_SKU_NAME {Name of OpenAI SKU}`. Defaults to 'S0'.
* `azd env set AZURE_SEARCH_SERVICE {Name of existing Cognitive Search service}`
* `azd env set AZURE_SEARCH_SERVICE_RESOURCE_GROUP {Name of existing resource group that Cognitive Search service is provisioned to}`
* `azd env set AZURE_SEARCH_SKU_NAME {Name of Cognitive Search SKY}`. Defaults to 'standard'.
* `azd env set AZURE_FORMRECOGNIZER_SERVICE {Name of existing Form Recognizer service}`. Used by prepdocs.py for text extraction from docs.
* `azd env set AZURE_FORMRECOGNIZER_SERVICE_RESOURCE_GROUP {Name of existing resource group that Form Recognizer service is provisioned to}`.
* `azd env set AZURE_FORMRECOGNIZER_SKU_NAME {Name of Form Recognizer SKU}`. Defaults to 'S0'.

1. Run `azd auth login` to login to your Azure account.
1. Run `azd up` to provision Azure resources and deploy this sample to those resources. This also runs a script to build the search index based on files in the `./data` folder.
1. After the application has been successfully deployed you will see a URL printed to the console.  Click that URL to interact with the application in your browser.
    > NOTE: It may take a minute for the application to be fully deployed. If you see a "Python Developer" welcome screen, then wait a minute and refresh the page.


### Re-deploying changes

If you make any changes to the app code (JS or Python), you can re-deploy the app code to App Service by running the `azd deploy` command.

If you change any of the Bicep files in the infra folder, then you should re-run `azd up` to both provision resources and deploy code.

### Running locally:

1. Run `azd auth login`
2. Run `./start.cmd` or `./start.sh` to start the project locally.
3. Navigate to `http://127.0.0.1:5000` in your browser. The deployed code requires authentication, but the local app should allow access as long as it's access from `127.0.0.1`.

### Note

>Note: The PDF documents used in this demo contain information generated using a language model (Azure OpenAI Service). The information contained in these documents is only for demonstration purposes and does not reflect the opinions or beliefs of Microsoft. Microsoft makes no representations or warranties of any kind, express or implied, about the completeness, accuracy, reliability, suitability or availability with respect to the information contained in this document. All rights reserved to Microsoft.
</file>

<file path="scripts/aml_config.json">
{
        "chunk_size": 1024,
        "token_overlap": 0,
        "keyvault_url": "https://<keyvault name>.vault.azure.net/",
        "document_intelligence_secret_name": "<secret name>",
        "document_intelligence_endpoint": "https://<resource name>.cognitiveservices.azure.com/",
        "embedding_key_secret_name": "<secret name>",
        "embedding_endpoint": "https://<resource name>.openai.azure.com/openai/deployments/<deployment name>/embeddings?api-version=2023-06-01-preview",
        "index_name": "<index name>",
        "search_service_name": "<resource name>",
        "search_key_secret_name": "<secret name>"
}
</file>

<file path="scripts/auth_init.ps1">
. ./scripts/loadenv.ps1

$venvPythonPath = "./.venv/scripts/python.exe"
if (Test-Path -Path "/usr") {
  # fallback to Linux venv path
  $venvPythonPath = "./.venv/bin/python"
}

Write-Host 'Running "auth_init.py"'
$appId = $env:AUTH_APP_ID ?? "no-id"
Start-Process -FilePath $venvPythonPath -ArgumentList "./scripts/auth_init.py --appid $appId" -Wait -NoNewWindow
</file>

<file path="scripts/auth_init.py">
import argparse
import subprocess

from azure.identity import AzureDeveloperCliCredential
import urllib3


def get_auth_headers(credential):
    return {
        "Authorization": "Bearer "
        + credential.get_token("https://graph.microsoft.com/.default").token
    }


def check_for_application(credential, app_id):
    resp = urllib3.request(
        "GET",
        f"https://graph.microsoft.com/v1.0/applications/{app_id}",
        headers=get_auth_headers(credential),
    )
    if resp.status != 200:
        print("Application not found")
        return False
    return True


def create_application(credential):
    resp = urllib3.request(
        "POST",
        "https://graph.microsoft.com/v1.0/applications",
        headers=get_auth_headers(credential),
        json={
            "displayName": "WebApp",
            "signInAudience": "AzureADandPersonalMicrosoftAccount",
            "web": {
                "redirectUris": ["http://localhost:5000/.auth/login/aad/callback"],
                "implicitGrantSettings": {"enableIdTokenIssuance": True},
            },
        },
        timeout=urllib3.Timeout(connect=10, read=10),
    )

    app_id = resp.json()["id"]
    client_id = resp.json()["appId"]

    return app_id, client_id


def add_client_secret(credential, app_id):
    resp = urllib3.request(
        "POST",
        f"https://graph.microsoft.com/v1.0/applications/{app_id}/addPassword",
        headers=get_auth_headers(credential),
        json={"passwordCredential": {"displayName": "WebAppSecret"}},
        timeout=urllib3.Timeout(connect=10, read=10),
    )
    client_secret = resp.json()["secretText"]
    return client_secret


def update_azd_env(name, val):
    subprocess.run(f"azd env set {name} {val}", shell=True)


if __name__ == "__main__":
    parser = argparse.ArgumentParser(
        description="Create an App Registration and client secret (if not already created)",
        epilog="Example: auth_update.py",
    )
    parser.add_argument(
        "--appid",
        required=False,
        help="Optional. ID of registered application. If provided, this script just makes sure it exists.",
    )
    args = parser.parse_args()

    credential = AzureDeveloperCliCredential()

    if args.appid and args.appid != "no-id":
        print(f"Checking if application {args.appid} exists")
        if check_for_application(credential, args.appid):
            print("Application already exists, not creating new one.")
            exit(0)

    print("Creating application registration")
    app_id, client_id = create_application(credential)

    print(f"Adding client secret to {app_id}")
    client_secret = add_client_secret(credential, app_id)

    print("Updating azd env with AUTH_APP_ID, AUTH_CLIENT_ID, AUTH_CLIENT_SECRET")
    update_azd_env("AUTH_APP_ID", app_id)
    update_azd_env("AUTH_CLIENT_ID", client_id)
    update_azd_env("AUTH_CLIENT_SECRET", client_secret)
</file>

<file path="scripts/auth_init.sh">
#!/bin/sh

. ./scripts/loadenv.sh

echo 'Running "auth_init.py"'
./.venv/bin/python ./scripts/auth_init.py --appid "$AUTH_APP_ID"
</file>

<file path="scripts/auth_update.ps1">
. ./scripts/loadenv.ps1

$venvPythonPath = "./.venv/scripts/python.exe"
if (Test-Path -Path "/usr") {
  # fallback to Linux venv path
  $venvPythonPath = "./.venv/bin/python"
}

Write-Host 'Running "auth_update.py"'
Start-Process -FilePath $venvPythonPath -ArgumentList "./scripts/auth_update.py --appid $env:AUTH_APP_ID --uri $env:BACKEND_URI" -Wait -NoNewWindow
</file>

<file path="scripts/auth_update.py">
import argparse

from azure.identity import AzureDeveloperCliCredential
import urllib3


def update_redirect_uris(credential, app_id, uri):
    urllib3.request(
        "PATCH",
        f"https://graph.microsoft.com/v1.0/applications/{app_id}",
        headers={
            "Authorization": "Bearer "
            + credential.get_token("https://graph.microsoft.com/.default").token,
        },
        json={
            "web": {
                "redirectUris": [
                    "http://localhost:5000/.auth/login/aad/callback",
                    f"{uri}/.auth/login/aad/callback",
                ]
            }
        },
    )


if __name__ == "__main__":
    parser = argparse.ArgumentParser(
        description="Add a redirect URI to a registered application",
        epilog="Example: auth_update.py --appid 123 --uri https://abc.azureservices.net",
    )
    parser.add_argument(
        "--appid",
        required=False,
        help="Required. ID of the application to update.",
    )
    parser.add_argument(
        "--uri",
        required=False,
        help="Required. URI of the deployed application.",
    )
    args = parser.parse_args()

    credential = AzureDeveloperCliCredential()

    print(
        f"Updating application registration {args.appid} with redirect URI for {args.uri}"
    )
    update_redirect_uris(credential, args.appid, args.uri)
</file>

<file path="scripts/auth_update.sh">
#!/bin/sh

. ./scripts/loadenv.sh

echo 'Running "auth_update.py"'
./.venv/bin/python ./scripts/auth_update.py --appid "$AUTH_APP_ID" --uri "$BACKEND_URI"
</file>

<file path="scripts/chunk_documents.py">
import argparse
import dataclasses
import json
import os

from azure.identity import DefaultAzureCredential
from azure.core.credentials import AzureKeyCredential
from azure.keyvault.secrets import SecretClient
from azure.ai.formrecognizer import DocumentAnalysisClient

from data_utils import chunk_directory

def get_document_intelligence_client(config, secret_client):
    print("Setting up Document Intelligence client...")
    secret_name = config.get("document_intelligence_secret_name")

    if not secret_client or not secret_name:
        print("No keyvault url or secret name provided in config file. Document Intelligence client will not be set up.")
        return None

    endpoint = config.get("document_intelligence_endpoint")
    if not endpoint:
        print("No endpoint provided in config file. Document Intelligence client will not be set up.")
        return None
    
    try:
        document_intelligence_secret = secret_client.get_secret(secret_name)
        os.environ["FORM_RECOGNIZER_ENDPOINT"] = endpoint
        os.environ["FORM_RECOGNIZER_KEY"] = document_intelligence_secret.value

        document_intelligence_credential = AzureKeyCredential(document_intelligence_secret.value)

        document_intelligence_client = DocumentAnalysisClient(endpoint, document_intelligence_credential)
        print("Document Intelligence client set up.")
        return document_intelligence_client
    except Exception as e:
        print("Error setting up Document Intelligence client: {}".format(e))
        return None


if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("--input_data_path", type=str, required=True)
    parser.add_argument("--output_file_path", type=str, required=True)
    parser.add_argument("--config_file", type=str, required=True)

    args = parser.parse_args()

    with open(args.config_file) as f:
        config = json.load(f)

    credential = DefaultAzureCredential()

    if type(config) is not list:
        config = [config]
    
    for index_config in config:
        # Keyvault Secret Client
        keyvault_url = index_config.get("keyvault_url")
        if not keyvault_url:
            print("No keyvault url provided in config file. Secret client will not be set up.")
            secret_client = None
        else:
            secret_client = SecretClient(keyvault_url, credential)

        # Optional client for cracking documents
        document_intelligence_client = get_document_intelligence_client(index_config, secret_client)

        # Crack and chunk documents
        print("Cracking and chunking documents...")

        chunking_result = chunk_directory(
                            directory_path=args.input_data_path, 
                            num_tokens=index_config.get("chunk_size", 1024),
                            token_overlap=index_config.get("token_overlap", 128),
                            form_recognizer_client=document_intelligence_client,
                            use_layout=index_config.get("use_layout", False),
                            njobs=1)
        
        print(f"Processed {chunking_result.total_files} files")
        print(f"Unsupported formats: {chunking_result.num_unsupported_format_files} files")
        print(f"Files with errors: {chunking_result.num_files_with_errors} files")
        print(f"Found {len(chunking_result.chunks)} chunks")

        print("Writing chunking result to {}...".format(args.output_file_path))
        with open(args.output_file_path, "w") as f:
            for chunk in chunking_result.chunks:
                id = 0
                d = dataclasses.asdict(chunk)
                # add id to documents
                d.update({"id": str(id)})
                f.write(json.dumps(d) + "\n")
                id += 1
        print("Chunking result written to {}.".format(args.output_file_path))
</file>

<file path="scripts/chunk_documents.yml">
$schema: https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json
type: command

name: chunk_documents
display_name: Crack and Chunk Documents
version: 1

inputs:
  input_data_path:
    type: uri_folder
  config_file:
    type: uri_file

outputs:
  document_chunks_file_path:
    type: uri_file

code: .

environment: 
  conda_file: conda.yml
  image: mcr.microsoft.com/azureml/curated/python-sdk-v2:latest

command: >-
  python chunk_documents.py --input_data_path ${{inputs.input_data_path}} --config_file ${{inputs.config_file}} --output_file_path ${{outputs.document_chunks_file_path}}
</file>

<file path="scripts/conda.yml">
name: conda_env
dependencies:
  - python=3.10.9
  - pip
  - pip:
    - azureml-core
    - azure-identity
    - azure-keyvault-secrets
    - azure-ai-formrecognizer
    - markdown
    - requests
    - tqdm
    - tiktoken
    - langchain
    - bs4
    - urllib3
    - openai
    - azure-search-documents
    - azure-storage-blob
    - chardet
</file>

<file path="scripts/config_multiple_url.json">
[
    {
        "data_paths": [
            {
                "path": "data/source1",
                "url_prefix": "https://<URL for source 1>.com/"
            },
            {
                "path": "data/source2",
                "url_prefix": "https://<URL for source 2>.com/"
            }
        ],
        "subscription_id": "<subscription id>",
        "resource_group": "<resource group name>",
        "search_service_name": "<search service name to use or create>",
        "index_name": "<index name to use or create>",
        "chunk_size": 1024,
        "token_overlap": 128,
        "semantic_config_name": "default",
        "language": "<Language to support for example use 'en' for English. Checked supported languages here under lucene - https://learn.microsoft.com/en-us/azure/search/index-add-language-analyzers"
    }
]
</file>

<file path="scripts/cosmos_config.json">
[
    {
        "data_path": "<path to data>",
        "location": "<azure region, e.g. 'westus2'>",
        "subscription_id": "<subscription id>",
        "resource_group": "<resource group name>",
        "connection_string": "<Cosmos Mongo vcore database connection string>",
        "account_name": "<Cosmos Mongo vcore database connection string>",
        "database_name": "<Cosmos Mongo vcore database name>",
        "collection_name": "<Cosmos Mongo vcore database collection name>",
        "index_name": "<Cosmos Mongo vcore vector index>",
        "vector_field": "<Cosmos Mongo vcore vector field>",
        "chunk_size": 1024,
        "token_overlap": 128
    }
]
</file>

<file path="scripts/cosmos_mongo_vcore_data_preparation.py">
"""Data Preparation Script for an Azure Cognitive Search Index."""
import argparse
import json
import os
import uuid

import requests
from data_utils import Document
from azure.ai.formrecognizer import DocumentAnalysisClient
from azure.core.credentials import AzureKeyCredential
from azure.identity import AzureCliCredential
from pymongo.mongo_client import MongoClient
from typing import List

from data_utils import chunk_directory

SUPPORTED_LANGUAGE_CODES = {
    "ar": "Arabic",
    "hy": "Armenian",
    "eu": "Basque",
    "bg": "Bulgarian",
    "ca": "Catalan",
    "zh-Hans": "Chinese Simplified",
    "zh-Hant": "Chinese Traditional",
    "cs": "Czech",
    "da": "Danish",
    "nl": "Dutch",
    "en": "English",
    "fi": "Finnish",
    "fr": "French",
    "gl": "Galician",
    "de": "German",
    "el": "Greek",
    "hi": "Hindi",
    "hu": "Hungarian",
    "id": "Indonesian (Bahasa)",
    "ga": "Irish",
    "it": "Italian",
    "ja": "Japanese",
    "ko": "Korean",
    "lv": "Latvian",
    "no": "Norwegian",
    "fa": "Persian",
    "pl": "Polish",
    "pt-Br": "Portuguese (Brazil)",
    "pt-Pt": "Portuguese (Portugal)",
    "ro": "Romanian",
    "ru": "Russian",
    "es": "Spanish",
    "sv": "Swedish",
    "th": "Thai",
    "tr": "Turkish"
}

def check_if_cosmos_mongo_db_exists(
    account_name: str,
    subscription_id: str,
    resource_group: str,
    credential = None):
    """_summary_

    Args:
        account_name (str): _description_
        database_name (str): _description_
        subscription_id (str): _description_
        resource_group (str): _description_
        credential: Azure credential to use for getting acs instance
    """
    if credential is None:
        raise ValueError("credential cannot be None")
    url = (
        f"https://management.azure.com/subscriptions/{subscription_id}"
        f"/resourceGroups/{resource_group}/providers/Microsoft.DocumentDB"
        f"/mongoClusters/{account_name}?api-version=2023-03-01-preview"
    )   

    headers = {
        "Content-Type": "application/json",
        "Authorization": f"Bearer {credential.get_token('https://management.azure.com/.default').token}",
    }

    response = requests.get(url, headers=headers)
    return response.status_code == 200

def create_or_update_vector_search_index(
        mongo_client: MongoClient,
        database_name: str,
        collection_name: str,
        index_name,
        vector_field, 
        credential, 
        language):
    if credential is None:
        raise ValueError("credential cannot be None")

    try:
        dbs=mongo_client.list_database_names()
        if (database_name in dbs):
            print(f"database {database_name} exist")
            collections=mongo_client[database_name].list_collection_names()
            if (collection_name in collections):
                print(f"collection {collection_name} exist")

        mongo_collection = mongo_client[database_name][collection_name]  
        indexes = mongo_collection.index_information()
        if (indexes.get(index_name) == None):
            # Ensure the vector index exists.
            indexDefs:List[any] = [
                { "name": index_name, "key": { vector_field: "cosmosSearch" }, "cosmosSearchOptions": { "kind": "vector-ivf", "similarity": "COS", "dimensions": 1536 } }
            ]
            mongo_client[database_name].command("createIndexes", collection_name, indexes = indexDefs)
    except Exception as e:
        raise Exception(
            f"Failed to create vector index {index_name} for collection {collection_name} under database {database_name}. Error: {str(e)}")
    return True

def initialize_mongo_client(
        connection_string: str) -> MongoClient:
    return MongoClient(connection_string)
     
def upsert_documents_to_index(
        mongo_client: MongoClient,
        database_name: str,
        collection_name: str,
        docs: List[Document]
        ):
    for document in docs:
        finalDocChunk:dict = {}
        finalDocChunk["_id"] = f"doc:{uuid.uuid4()}"
        finalDocChunk['title'] = document.title
        finalDocChunk["filepath"] = document.filepath
        finalDocChunk["url"] = document.url
        finalDocChunk["content"] = document.content
        finalDocChunk["contentvector"] = document.contentVector
        finalDocChunk["metadata"] = document.metadata

        mongo_collection = mongo_client[database_name][collection_name]

        try:
            mongo_collection.insert_one(finalDocChunk)
            print(f"Upsert doc chunk {document.id} successfully")
        
        except Exception as e:
            print(f"Failed to upsert doc chunk {document.id}")
            continue

def validate_index(
        mongo_client: MongoClient,
        database_name: str,
        collection_name: str,
        index_name):
    try:
        mongo_collection = mongo_client[database_name][collection_name]  
        indexes = mongo_collection.index_information()
        if (indexes.get(index_name) == None):
            raise Exception(
                f"Failed to create vector index {index_name} for collection {collection_name} under database {database_name}. Error: {str(e)}")

    except Exception as e:
        raise Exception(
            f"Failed to validate vector index {index_name} for collection {collection_name} under database {database_name}. Error: {str(e)}")  

def create_index(config, credential, form_recognizer_client=None, embedding_model_endpoint=None, use_layout=False, njobs=4):
    account_name = config["account_name"]
    database_name = config["database_name"]
    collection_name = config["collection_name"]
    subscription_id = config["subscription_id"]
    resource_group = config["resource_group"]
    index_name = config["index_name"]
    vector_field = config["vector_field"]
    language = config.get("language", None)

    if language and language not in SUPPORTED_LANGUAGE_CODES:
        raise Exception(f"ERROR: Ingestion does not support {language} documents. "
                        f"Please use one of {SUPPORTED_LANGUAGE_CODES}."
                        f"Language is set as two letter code for e.g. 'en' for English."
                        f"If you do not want to set a language just remove this prompt config or set as None")


    # check if cosmos mongo vcore database account exists
    if check_if_cosmos_mongo_db_exists(account_name, subscription_id, resource_group, credential):
        print(f"Using existing cosmos vcore database account {account_name}")
    else:
        # Won't create the database account automatically for user since it needs set admin password
        raise Exception(f"Database account {account_name} doesn't exist. Please follow this page https://learn.microsoft.com/en-us/azure/cosmos-db/mongodb/vcore/quickstart-portal to create the resource")

    # Initialize Cosmos Mongo Client
    mongo_client = initialize_mongo_client(config.get("connection_string"))

    # create or update vector search index with compatible schema
    if not create_or_update_vector_search_index(mongo_client, database_name, collection_name, index_name, vector_field, credential, language):
        raise Exception(f"Failed to create or update index {index_name}")
    
    # chunk directory
    print("Chunking directory...")
    add_embeddings = True

    result = chunk_directory(config["data_path"], num_tokens=config["chunk_size"], token_overlap=config.get("token_overlap",0),
                             azure_credential=credential, form_recognizer_client=form_recognizer_client, use_layout=use_layout, njobs=njobs,
                             add_embeddings=add_embeddings, embedding_endpoint=embedding_model_endpoint)

    if len(result.chunks) == 0:
        raise Exception("No chunks found. Please check the data path and chunk size.")

    print(f"Processed {result.total_files} files")
    print(f"Unsupported formats: {result.num_unsupported_format_files} files")
    print(f"Files with errors: {result.num_files_with_errors} files")
    print(f"Found {len(result.chunks)} chunks")

    # upsert documents to index
    print("Upserting documents to index...")
    upsert_documents_to_index(mongo_client, database_name, collection_name, result.chunks)

    # check if index is ready/validate index
    print("Validating index...")
    validate_index(mongo_client, database_name, collection_name, index_name)
    print("Index validation completed")

def valid_range(n):
    n = int(n)
    if n < 1 or n > 32:
        raise argparse.ArgumentTypeError("njobs must be an Integer between 1 and 32.")
    return n

if __name__ == "__main__": 
    parser = argparse.ArgumentParser()
    parser.add_argument("--cosmos-config", type=str, help="Path to config file containing settings for data preparation")
    parser.add_argument("--form-rec-resource", type=str, help="Name of your Form Recognizer resource to use for PDF cracking.")
    parser.add_argument("--form-rec-key", type=str, help="Key for your Form Recognizer resource to use for PDF cracking.")
    parser.add_argument("--form-rec-use-layout", default=False, action='store_true', help="Whether to use Layout model for PDF cracking, if False will use Read model.")
    parser.add_argument("--njobs", type=valid_range, default=4, help="Number of jobs to run (between 1 and 32). Default=4")
    parser.add_argument("--embedding-model-endpoint", type=str, help="Endpoint for the embedding model to use for vector search. Format: 'https://<AOAI resource name>.openai.azure.com/openai/deployments/<Ada deployment name>/embeddings?api-version=2023-03-15-preview'")
    parser.add_argument("--embedding-model-key", type=str, help="Key for the embedding model to use for vector search.")
    args = parser.parse_args()

    with open(args.cosmos_config) as f:
        config = json.load(f)

    credential = AzureCliCredential()
    form_recognizer_client = None

    print("Data preparation script started")
    if args.form_rec_resource and args.form_rec_key:
        os.environ["FORM_RECOGNIZER_ENDPOINT"] = f"https://{args.form_rec_resource}.cognitiveservices.azure.com/"
        os.environ["FORM_RECOGNIZER_KEY"] = args.form_rec_key
        if args.njobs==1:
            form_recognizer_client = DocumentAnalysisClient(endpoint=f"https://{args.form_rec_resource}.cognitiveservices.azure.com/", credential=AzureKeyCredential(args.form_rec_key))
        print(f"Using Form Recognizer resource {args.form_rec_resource} for PDF cracking, with the {'Layout' if args.form_rec_use_layout else 'Read'} model.")

    for index_config in config:        
        if index_config.get("index_name") and not args.embedding_model_endpoint:
            raise Exception("ERROR: Vector search is enabled in the config, but no embedding model endpoint and key were provided. Please provide these values or disable vector search.")
        print("Preparing data for index:", index_config["index_name"])
        os.environ["EMBEDDING_MODEL_KEY"] = args.embedding_model_key
        create_index(index_config, credential, form_recognizer_client, embedding_model_endpoint=args.embedding_model_endpoint, use_layout=args.form_rec_use_layout, njobs=args.njobs)
        print("Data preparation for index", index_config["index_name"], "completed")

    print(f"Data preparation script completed. {len(config)} indexes updated.")
</file>

<file path="scripts/datastore.yml">
$schema: https://azuremlschemas.azureedge.net/latest/azureBlob.schema.json
name: my_ds # your datstore name here
type: azure_blob
description: Data store for index preparation # your description here
account_name: mystorageaccount # your storage account name here
container_name: mystoragecontainer # your container name here
credentials: 
  account_key: # account key here
</file>

<file path="scripts/embed_documents.py">
import argparse
from asyncio import sleep
import json

from azure.identity import DefaultAzureCredential
from azure.keyvault.secrets import SecretClient

from data_utils import get_embedding

RETRY_COUNT = 5

if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("--input_data_path", type=str, required=True)
    parser.add_argument("--output_file_path", type=str, required=True)
    parser.add_argument("--config_file", type=str, required=True)

    args = parser.parse_args()

    with open(args.config_file) as f:
        config = json.load(f)

    credential = DefaultAzureCredential()

    if type(config) is not list:
        config = [config]
    
    for index_config in config:
        # Keyvault Secret Client
        keyvault_url = index_config.get("keyvault_url")
        if not keyvault_url:
            print("No keyvault url provided in config file. Secret client will not be set up.")
            secret_client = None
        else:
            secret_client = SecretClient(keyvault_url, credential)

        # Get Embedding key
        embedding_key_secret_name = index_config.get("embedding_key_secret_name")
        if not embedding_key_secret_name:
            raise ValueError("No embedding key secret name provided in config file. Embeddings will not be generated.")
        else:
            embedding_key_secret = secret_client.get_secret(embedding_key_secret_name)
            embedding_key = embedding_key_secret.value

        embedding_endpoint = index_config.get("embedding_endpoint")
        if not embedding_endpoint:
            raise ValueError("No embedding endpoint provided in config file. Embeddings will not be generated.")

        # Embed documents
        print("Generating embeddings...")
        with open(args.input_data_path) as input_file, open(args.output_file_path, "w") as output_file:
            for line in input_file:
                document = json.loads(line)
                # Sleep/Retry in case embedding model is rate limited.
                for _ in range(RETRY_COUNT):
                    try:
                        embedding = get_embedding(document["content"], embedding_endpoint,  embedding_key)
                        document["contentVector"] = embedding
                        break
                    except:
                        print("Error generating embedding. Retrying...")
                        sleep(30)
                
                output_file.write(json.dumps(document) + "\n")

        print("Embeddings generated and saved to {}.".format(args.output_file_path))
</file>

<file path="scripts/embed_documents.yml">
$schema: https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json
type: command

name: embed_documents
display_name: Calculate Embeddings for Document Chunks
version: 1

inputs:
  document_chunks_file_path:
    type: uri_file
  config_file:
    type: uri_file

outputs:
  chunks_with_embeddings_file_path:
    type: uri_file

code: .

environment: 
  conda_file: conda.yml
  image: mcr.microsoft.com/azureml/curated/python-sdk-v2:latest

command: >-
  python embed_documents.py --input_data_path ${{inputs.document_chunks_file_path}} --config_file ${{inputs.config_file}} --output_file_path ${{outputs.chunks_with_embeddings_file_path}}
</file>

<file path="scripts/loadenv.ps1">
# Only load env from azd if azd command and azd environment exist
if (-not (Get-Command azd -ErrorAction SilentlyContinue)) {
  Write-Host "azd command not found, skipping .env file load"
} else {
  $output = azd env list
  if (!($output -like "*true*")) {
    Write-Output "No azd environments found, skipping .env file load"
  } else {
    Write-Host "Loading azd .env file from current environment"
    $output = azd env get-values
    foreach ($line in $output) {
      if (!$line.Contains('=')) {
        continue
      }

      $name, $value = $line.Split("=")
      $value = $value -replace '^\"|\"$'
      [Environment]::SetEnvironmentVariable($name, $value)
    }
  }
}

$pythonCmd = Get-Command python -ErrorAction SilentlyContinue
if (-not $pythonCmd) {
  # fallback to python3 if python not found
  $pythonCmd = Get-Command python3 -ErrorAction SilentlyContinue
}

Write-Host 'Creating Python virtual environment ".venv" in root'
Start-Process -FilePath ($pythonCmd).Source -ArgumentList "-m venv ./.venv" -Wait -NoNewWindow

$venvPythonPath = "./.venv/scripts/python.exe"
if (Test-Path -Path "/usr") {
  # fallback to Linux venv path
  $venvPythonPath = "./.venv/bin/python"
}

Write-Host 'Installing dependencies from "requirements.txt" into virtual environment'
Start-Process -FilePath $venvPythonPath -ArgumentList "-m pip install -r ./requirements-dev.txt" -Wait -NoNewWindow
</file>

<file path="scripts/loadenv.sh">
# Only load env from azd if azd command and azd environment exist
if not command -v azd &> /dev/null; then
    echo "azd command not found, skipping .env file load"
else
    if [ -z "$(azd env list | grep -w true | awk '{print $1}')" ]; then
        echo "No azd environments found, skipping .env file load"
    else
        echo "Loading azd .env file from current environment"
        while IFS='=' read -r key value; do
        value=$(echo "$value" | sed 's/^"//' | sed 's/"$//')
        export "$key=$value"
        done <<EOF
$(azd env get-values --no-prompt)
EOF
    fi
fi


echo 'Creating Python virtual environment ".venv" in root'
python3 -m venv .venv

echo 'Installing dependencies from "requirements.txt" into virtual environment'
./.venv/bin/python -m pip install -r requirements-dev.txt
</file>

<file path="scripts/pipeline.yml">
$schema: https://azuremlschemas.azureedge.net/latest/pipelineJob.schema.json
type: pipeline

display_name: data_preparation_pipeline
experiment_name: data_prep
description: Pipeline to crack, chunk, and embed data for RAG.

settings:
  default_compute: azureml:serverless

identity:
  type: user_identity

inputs:
  config_file: 
    type: uri_file
    path: aml_config.json # your config file name here
  input_data_path:
    type: uri_folder
    # path: ../data # uncomment this to use local data
    path: azureml://datastores/<datastore name>/paths/<path> # substitute your datastore name and path here
    mode: ro_mount

jobs:
  chunk_documents:
    type: command
    component: ./chunk_documents.yml
    inputs:
      config_file: ${{parent.inputs.config_file}}
      input_data_path: ${{parent.inputs.input_data_path}}
    outputs:
      document_chunks_file_path:
        type: uri_file
        mode: upload

  embed_documents:
    type: command
    component: ./embed_documents.yml
    inputs:
      config_file: ${{parent.inputs.config_file}}
      document_chunks_file_path: ${{parent.jobs.chunk_documents.outputs.document_chunks_file_path}}
    outputs:
      chunks_with_embeddings_file_path: 
        type: uri_file
        mode: upload

  push_documents_acs:
    type: command
    component: ./push_documents_acs.yml
    inputs:
      config_file: ${{parent.inputs.config_file}}
      chunks_with_embeddings_file_path: ${{parent.jobs.embed_documents.outputs.chunks_with_embeddings_file_path}}
</file>

<file path="scripts/prepdocs.ps1">
. ./scripts/loadenv.ps1

$venvPythonPath = "./.venv/scripts/python.exe"
if (Test-Path -Path "/usr") {
  # fallback to Linux venv path
  $venvPythonPath = "./.venv/bin/python"
}

Write-Host 'Running "prepdocs.py"'
$cwd = (Get-Location)
Start-Process -FilePath $venvPythonPath -ArgumentList "./scripts/prepdocs.py --searchservice $env:AZURE_SEARCH_SERVICE --index $env:AZURE_SEARCH_INDEX --formrecognizerservice $env:AZURE_FORMRECOGNIZER_SERVICE --tenantid $env:AZURE_TENANT_ID" -Wait -NoNewWindow
</file>

<file path="scripts/prepdocs.py">
import argparse
import dataclasses
import time

from tqdm import tqdm
from azure.identity import AzureDeveloperCliCredential
from azure.core.credentials import AzureKeyCredential
from azure.search.documents.indexes import SearchIndexClient
from azure.search.documents.indexes.models import (
    SearchableField,
    SearchField,
    SearchFieldDataType,
    SemanticField,
    SemanticSettings,
    SemanticConfiguration,
    SearchIndex,
    PrioritizedFields,
    VectorSearch,
    VectorSearchAlgorithmConfiguration,
    HnswParameters
)
from azure.search.documents import SearchClient
from azure.ai.formrecognizer import DocumentAnalysisClient


from data_utils import chunk_directory


def create_search_index(index_name, index_client):
    print(f"Ensuring search index {index_name} exists")
    if index_name not in index_client.list_index_names():
        index = SearchIndex(
            name=index_name,
            fields=[
                SearchableField(name="id", type="Edm.String", key=True),
                SearchableField(
                    name="content", type="Edm.String", analyzer_name="en.lucene"
                ),
                SearchableField(
                    name="title", type="Edm.String", analyzer_name="en.lucene"
                ),
                SearchableField(name="filepath", type="Edm.String"),
                SearchableField(name="url", type="Edm.String"),
                SearchableField(name="metadata", type="Edm.String"),
                SearchField(name="contentVector", type=SearchFieldDataType.Collection(SearchFieldDataType.Single),
                            hidden=False, searchable=True, filterable=False, sortable=False, facetable=False,
                            vector_search_dimensions=1536, vector_search_configuration="default"),
            ],
            semantic_settings=SemanticSettings(
                configurations=[
                    SemanticConfiguration(
                        name="default",
                        prioritized_fields=PrioritizedFields(
                            title_field=SemanticField(field_name="title"),
                            prioritized_content_fields=[
                                SemanticField(field_name="content")
                            ],
                        ),
                    )
                ]
            ),
            vector_search=VectorSearch(
                algorithm_configurations=[
                    VectorSearchAlgorithmConfiguration(
                        name="default",
                        kind="hnsw",
                        hnsw_parameters=HnswParameters(metric="cosine")
                    )
                ]
            )
        )
        print(f"Creating {index_name} search index")
        index_client.create_index(index)
    else:
        print(f"Search index {index_name} already exists")


def upload_documents_to_index(docs, search_client, upload_batch_size=50):
    to_upload_dicts = []

    id = 0
    for document in docs:
        d = dataclasses.asdict(document)
        # add id to documents
        d.update({"@search.action": "upload", "id": str(id)})
        if "contentVector" in d and d["contentVector"] is None:
            del d["contentVector"]
        to_upload_dicts.append(d)
        id += 1

    # Upload the documents in batches of upload_batch_size
    for i in tqdm(
        range(0, len(to_upload_dicts), upload_batch_size), desc="Indexing Chunks..."
    ):
        batch = to_upload_dicts[i : i + upload_batch_size]
        results = search_client.upload_documents(documents=batch)
        num_failures = 0
        errors = set()
        for result in results:
            if not result.succeeded:
                print(
                    f"Indexing Failed for {result.key} with ERROR: {result.error_message}"
                )
                num_failures += 1
                errors.add(result.error_message)
        if num_failures > 0:
            raise Exception(
                f"INDEXING FAILED for {num_failures} documents. Please recreate the index."
                f"To Debug: PLEASE CHECK chunk_size and upload_batch_size. \n Error Messages: {list(errors)}"
            )


def validate_index(index_name, index_client):
    for retry_count in range(5):
        stats = index_client.get_index_statistics(index_name)
        num_chunks = stats["document_count"]
        if num_chunks == 0 and retry_count < 4:
            print("Index is empty. Waiting 60 seconds to check again...")
            time.sleep(60)
        elif num_chunks == 0 and retry_count == 4:
            print("Index is empty. Please investigate and re-index.")
        else:
            print(f"The index contains {num_chunks} chunks.")
            average_chunk_size = stats["storage_size"] / num_chunks
            print(f"The average chunk size of the index is {average_chunk_size} bytes.")
            break


def create_and_populate_index(
    index_name, index_client, search_client, form_recognizer_client, azure_credential, embedding_endpoint
):
    # create or update search index with compatible schema
    create_search_index(index_name, index_client)

    # chunk directory
    print("Chunking directory...")
    result = chunk_directory(
        "./data",
        form_recognizer_client=form_recognizer_client,
        use_layout=True,
        ignore_errors=False,
        njobs=1,
        add_embeddings=True,
        azure_credential=azd_credential,
        embedding_endpoint=embedding_endpoint
    )

    if len(result.chunks) == 0:
        raise Exception("No chunks found. Please check the data path and chunk size.")

    print(f"Processed {result.total_files} files")
    print(f"Unsupported formats: {result.num_unsupported_format_files} files")
    print(f"Files with errors: {result.num_files_with_errors} files")
    print(f"Found {len(result.chunks)} chunks")

    # upload documents to index
    print("Uploading documents to index...")
    upload_documents_to_index(result.chunks, search_client)

    # check if index is ready/validate index
    print("Validating index...")
    validate_index(index_name, index_client)
    print("Index validation completed")


if __name__ == "__main__":
    parser = argparse.ArgumentParser(
        description="Prepare documents by extracting content from PDFs, splitting content into sections and indexing in a search index.",
        epilog="Example: prepdocs.py --searchservice mysearch --index myindex",
    )
    parser.add_argument(
        "--tenantid",
        required=False,
        help="Optional. Use this to define the Azure directory where to authenticate)",
    )
    parser.add_argument(
        "--searchservice",
        help="Name of the Azure Cognitive Search service where content should be indexed (must exist already)",
    )
    parser.add_argument(
        "--index",
        help="Name of the Azure Cognitive Search index where content should be indexed (will be created if it doesn't exist)",
    )
    parser.add_argument(
        "--searchkey",
        required=False,
        help="Optional. Use this Azure Cognitive Search account key instead of the current user identity to login (use az login to set current user for Azure)",
    )
    parser.add_argument(
        "--formrecognizerservice",
        required=False,
        help="Optional. Name of the Azure Form Recognizer service which will be used to extract text, tables and layout from the documents (must exist already)",
    )
    parser.add_argument(
        "--formrecognizerkey",
        required=False,
        help="Optional. Use this Azure Form Recognizer account key instead of the current user identity to login (use az login to set current user for Azure)",
    )
    parser.add_argument(
        "--embeddingendpoint",
        required=False,
        help="Optional. Use this OpenAI endpoint to generate embeddings for the documents",
    )
    args = parser.parse_args()

    # Use the current user identity to connect to Azure services unless a key is explicitly set for any of them
    azd_credential = (
        AzureDeveloperCliCredential()
        if args.tenantid == None
        else AzureDeveloperCliCredential(tenant_id=args.tenantid, process_timeout=60)
    )
    default_creds = azd_credential if args.searchkey == None else None
    search_creds = (
        default_creds if args.searchkey == None else AzureKeyCredential(args.searchkey)
    )
    formrecognizer_creds = (
        default_creds
        if args.formrecognizerkey == None
        else AzureKeyCredential(args.formrecognizerkey)
    )

    print("Data preparation script started")
    print("Preparing data for index:", args.index)
    search_endpoint = f"https://{args.searchservice}.search.windows.net/"
    index_client = SearchIndexClient(endpoint=search_endpoint, credential=search_creds)
    search_client = SearchClient(
        endpoint=search_endpoint, credential=search_creds, index_name=args.index
    )
    form_recognizer_client = DocumentAnalysisClient(
        endpoint=f"https://{args.formrecognizerservice}.cognitiveservices.azure.com/",
        credential=formrecognizer_creds,
    )
    create_and_populate_index(
        args.index, index_client, search_client, form_recognizer_client, azd_credential, args.embeddingendpoint
    )
    print("Data preparation for index", args.index, "completed")
</file>

<file path="scripts/prepdocs.sh">
#!/bin/sh

. ./scripts/loadenv.sh

echo 'Running "prepdocs.py"'
./.venv/bin/python ./scripts/prepdocs.py --searchservice "$AZURE_SEARCH_SERVICE" --index "$AZURE_SEARCH_INDEX" --formrecognizerservice "$AZURE_FORMRECOGNIZER_SERVICE" --tenantid "$AZURE_TENANT_ID" --embeddingendpoint "$AZURE_OPENAI_EMBEDDING_ENDPOINT"
</file>

<file path="scripts/push_documents_acs.yml">
$schema: https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json
type: command

name: push_documents_acs
display_name: Push documents to Azure Cognitive Search Index
version: 1

inputs:
  chunks_with_embeddings_file_path:
    type: uri_file
  config_file:
    type: uri_file

code: .

environment: 
  conda_file: conda.yml
  image: mcr.microsoft.com/azureml/curated/python-sdk-v2:latest

command: >-
  python push_to_acs.py --input_data_path ${{inputs.chunks_with_embeddings_file_path}} --config_file ${{inputs.config_file}}
</file>

<file path="scripts/push_only_pipeline.yml">
$schema: https://azuremlschemas.azureedge.net/latest/pipelineJob.schema.json
type: pipeline

display_name: push_only_pipeline
description: Pipeline to push data to ACS.

settings:
  default_compute: azureml:serverless

inputs:
  config_file: 
    type: uri_file
    path: aml_config.json # your config file name here
  chunked_file:
    type: uri_file
    path: <data asset name>
    mode: ro_mount

jobs:
  push_documents_acs:
    type: command
    component: ./push_documents_acs.yml
    inputs:
      config_file: ${{parent.inputs.config_file}}
      chunks_with_embeddings_file_path: ${{parent.inputs.chunked_file}}
</file>

<file path="scripts/push_to_acs.py">
import argparse
from asyncio import sleep
import dataclasses
import json
import os

from azure.identity import DefaultAzureCredential
from azure.keyvault.secrets import SecretClient

from data_preparation import create_or_update_search_index, upload_documents_to_index

RETRY_COUNT = 5

if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("--input_data_path", type=str, required=True)
    parser.add_argument("--config_file", type=str, required=True)

    args = parser.parse_args()

    with open(args.config_file) as f:
        config = json.load(f)

    credential = DefaultAzureCredential()

    if type(config) is not list:
        config = [config]
    
    for index_config in config:
        # Keyvault Secret Client
        print("Connecting to keyvault...")
        keyvault_url = index_config.get("keyvault_url")
        if not keyvault_url:
            print("No keyvault url provided in config file. Secret client will not be set up.")
            secret_client = None
        else:
            secret_client = SecretClient(keyvault_url, credential)

        # Get Search Key
        search_key_secret_name = index_config.get("search_key_secret_name")
        if not search_key_secret_name:
            raise ValueError("No search key secret name provided in config file. Index will not be created.")
        else:
            search_key_secret = secret_client.get_secret(search_key_secret_name)
            search_key = search_key_secret.value

        search_service_name = index_config.get("search_service_name")
        if not search_service_name:
            raise ValueError("No search service name provided in config file. Index will not be created.")

        # Create Index
        print("Creating index...")
        index_name = index_config.get("index_name", "default-index")
        create_or_update_search_index(
            service_name=search_service_name,
            index_name=index_name,
            vector_config_name="default" if "embedding_endpoint" in index_config else None,
            admin_key=search_key
        )
        print(f"Index {index_name} created.")

        # Upload Documents
        print("Uploading documents...")
        with open(args.input_data_path) as input_file:
            documents = [json.loads(line) for line in input_file]
        
        upload_documents_to_index(search_service_name, "", "", index_name, documents, admin_key=search_key)
        print("Done.")
</file>

<file path="scripts/role_assignment.sh">
while getopts ":s:o:a:" opt; do
  case $opt in
    s) search_service_resource_id="$OPTARG"
    ;;
    o) azure_openai_resource_id="$OPTARG"
    ;;
    a) storage_account_resource_id="$OPTARG"
    ;;
    \?) echo "Invalid option -$OPTARG" >&2
    ;;
  esac
done

echo "search_service_resource_id=$search_service_resource_id"
echo "azure_openai_resource_id=$azure_openai_resource_id"
echo "storage_account_resource_id=$storage_account_resource_id"

if [[ -z "$search_service_resource_id" ]]; then
  echo "Must provide search_service_resource_id (-s) argument" 1>&2
  exit 1
fi

if [[ -z "$azure_openai_resource_id" ]]; then
  echo "Must provide azure_openai_resource_id (-o) argument" 1>&2
  exit 1
fi

if [[ -z "$storage_account_resource_id" ]]; then
  echo "Must provide storage_account_resource_id (-a) argument" 1>&2
  exit 1
fi

function get_subscription_id(){
  echo "$1" | cut -d'/' -f3
}

function get_resource_group(){
  echo "$1" | cut -d'/' -f5
}

function get_resource_name(){
  echo "$1" | cut -d'/' -f9
}

function get_azure_openai_resource_system_assigned_identity_principal_id(){
  resource_id="$1"
  az cognitiveservices account identity show -n $(get_resource_name $resource_id) -g $(get_resource_group $resource_id) --subscription $(get_subscription_id $resource_id) --query "principalId" -o tsv
}

function get_azure_search_resource_system_assigned_identity_principal_id(){
  resource_id="$1"
  az search service show -n $(get_resource_name $resource_id) -g $(get_resource_group $resource_id) --subscription $(get_subscription_id $resource_id) --query "identity.principalId" -o tsv
}

function get_system_assigned_identity_principal_id(){
  resource_id="$1"
  resource_type=$(echo "$resource_id" | cut -d'/' -f7)
  if [[ "$resource_type" == "Microsoft.CognitiveServices" ]]; then
    get_azure_openai_resource_system_assigned_identity_principal_id $resource_id
  elif [[ "$resource_type" == "Microsoft.Search" ]]; then
    get_azure_search_resource_system_assigned_identity_principal_id $resource_id
  else
    echo "Unknown resource type $resource_type" 1>&2
    exit 1
  fi
}

function ensure_role_assignment() {
  assignee="$1"
  resource_id="$2"
  role="$3"
  echo "ensure role assignment $role for $assignee on $resource_id"
  principal_id=$(get_system_assigned_identity_principal_id $assignee)
  echo "resolved principal_id=$principal_id"
  az role assignment create \
    --assignee-object-id $principal_id \
    --assignee-principal-type ServicePrincipal \
    --role "$role" \
    --scope "$resource_id" \
    --subscription $(get_subscription_id $resource_id)
}

function get_signed_in_user_id(){
  az ad signed-in-user show --query "id" -o tsv
}

function ensure_role_assignment_for_me() {
  assignee=$(get_signed_in_user_id)
  resource_id="$1"
  role="$2"
  echo "ensure role assignment $role for $assignee on $resource_id"
  az role assignment create \
    --assignee-object-id $assignee \
    --assignee-principal-type User \
    --role "$role" \
    --scope "$resource_id" \
    --subscription $(get_subscription_id $resource_id)
}

ensure_role_assignment $azure_openai_resource_id $search_service_resource_id "Search Service Contributor"
ensure_role_assignment $azure_openai_resource_id $search_service_resource_id "Search Index Data Reader"
ensure_role_assignment $azure_openai_resource_id $storage_account_resource_id "Storage Blob Data Contributor"
ensure_role_assignment $search_service_resource_id $storage_account_resource_id "Storage Blob Data Contributor"
ensure_role_assignment $search_service_resource_id $azure_openai_resource_id "Cognitive Services OpenAI Contributor"
ensure_role_assignment_for_me $azure_openai_resource_id "Cognitive Services OpenAI Contributor"
</file>

<file path="SECURITY.md">
<!-- BEGIN MICROSOFT SECURITY.MD V0.0.8 BLOCK -->

## Security

Microsoft takes the security of our software products and services seriously, which includes all source code repositories managed through our GitHub organizations, which include [Microsoft](https://github.com/microsoft), [Azure](https://github.com/Azure), [DotNet](https://github.com/dotnet), [AspNet](https://github.com/aspnet), [Xamarin](https://github.com/xamarin), and [our GitHub organizations](https://opensource.microsoft.com/).

If you believe you have found a security vulnerability in any Microsoft-owned repository that meets [Microsoft's definition of a security vulnerability](https://aka.ms/opensource/security/definition), please report it to us as described below.

## Reporting Security Issues

**Please do not report security vulnerabilities through public GitHub issues.**

Instead, please report them to the Microsoft Security Response Center (MSRC) at [https://msrc.microsoft.com/create-report](https://aka.ms/opensource/security/create-report).

If you prefer to submit without logging in, send email to [secure@microsoft.com](mailto:secure@microsoft.com).  If possible, encrypt your message with our PGP key; please download it from the [Microsoft Security Response Center PGP Key page](https://aka.ms/opensource/security/pgpkey).

You should receive a response within 24 hours. If for some reason you do not, please follow up via email to ensure we received your original message. Additional information can be found at [microsoft.com/msrc](https://aka.ms/opensource/security/msrc). 

Please include the requested information listed below (as much as you can provide) to help us better understand the nature and scope of the possible issue:

  * Type of issue (e.g. buffer overflow, SQL injection, cross-site scripting, etc.)
  * Full paths of source file(s) related to the manifestation of the issue
  * The location of the affected source code (tag/branch/commit or direct URL)
  * Any special configuration required to reproduce the issue
  * Step-by-step instructions to reproduce the issue
  * Proof-of-concept or exploit code (if possible)
  * Impact of the issue, including how an attacker might exploit the issue

This information will help us triage your report more quickly.

If you are reporting for a bug bounty, more complete reports can contribute to a higher bounty award. Please visit our [Microsoft Bug Bounty Program](https://aka.ms/opensource/security/bounty) page for more details about our active programs.

## Preferred Languages

We prefer all communications to be in English.

## Policy

Microsoft follows the principle of [Coordinated Vulnerability Disclosure](https://aka.ms/opensource/security/cvd).

<!-- END MICROSOFT SECURITY.MD BLOCK -->
</file>

<file path="TEST_CASE_FLOWS.md">
# Introduction
Below are some flows to follow to make sure code changes are tested effectivly and efficiently. 
The goal is to make sure that this is repeatable and can be done by anyone to avoid regressions.

## Test Case Flows
- with data, streaming
- with data, non streaming
- without data, streaming
- without data, non streaming
- All of the above with and without chat history

### With Data, Streaming
The following environment variables are required to run this test case:

`AZURE_SEARCH_SERVICE`\
`AZURE_SEARCH_INDEX`\
`AZURE_SEARCH_KEY`

`AZURE_OPENAI_STREAM` should be set to `true`

### With Data, Streaming, Chat History
Keep the same environment variables as above, but add the following:

`AZURE_COSMOSDB_DATABASE`\
`AZURE_COSMOSDB_ACCOUNT`\
`AZURE_COSMOSDB_CONVERSATIONS_CONTAINER`\
`AZURE_COSMOSDB_ACCOUNT_KEY`

### With Data, Nonstreaming
The following environment variables are required to run this test case:
`AZURE_SEARCH_SERVICE`\
`AZURE_SEARCH_INDEX`\
`AZURE_SEARCH_KEY`

`AZURE_OPENAI_STREAM` should be set to `false`

### With Data, Nonstreaming, Chat History
Keep the same environment variables as above, but add the following:

`AZURE_COSMOSDB_DATABASE`\
`AZURE_COSMOSDB_ACCOUNT`\
`AZURE_COSMOSDB_CONVERSATIONS_CONTAINER`\
`AZURE_COSMOSDB_ACCOUNT_KEY`

### Without Data, Streaming
The following environment variables should **not** be set:

`AZURE_SEARCH_SERVICE`\
`AZURE_SEARCH_INDEX`\
`AZURE_SEARCH_KEY`

`AZURE_OPENAI_STREAM` should be set to `true`

### Without Data, Streaming, Chat History
Keep the same environment variables as above, but add the following:

`AZURE_COSMOSDB_DATABASE`\
`AZURE_COSMOSDB_ACCOUNT`\
`AZURE_COSMOSDB_CONVERSATIONS_CONTAINER`\
`AZURE_COSMOSDB_ACCOUNT_KEY`

### Without Data, Nonstreaming
The following environment variables should **not** be set:

`AZURE_SEARCH_SERVICE`\
`AZURE_SEARCH_INDEX`\
`AZURE_SEARCH_KEY`

`AZURE_OPENAI_STREAM` should be set to `false`

### Without Data, Nonstreaming, Chat History
Keep the same environment variables as above, but add the following:

`AZURE_COSMOSDB_DATABASE`\
`AZURE_COSMOSDB_ACCOUNT`\
`AZURE_COSMOSDB_CONVERSATIONS_CONTAINER`\
`AZURE_COSMOSDB_ACCOUNT_KEY`
</file>

<file path="WebApp.dockerignore">
.venv
.env
WebApp.Dockerfile
WebApp.dockerignore
frontend/node_modules
</file>

<file path=".github/ISSUE_TEMPLATE/bug_report.md">
---
name: Bug report
about: Create a report to help us improve
title: ''
labels: bug
assignees: ''

---

**Describe the bug**
A clear and concise description of what the bug is.

**To Reproduce**
Steps to reproduce the behavior:
1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.

**Configuration: Please provide the following**
 - Azure OpenAI model name and version (e.g. 'gpt-35-turbo-16k, version 0613')
 - Is chat history enabled?
 - Are you using data? If so, what data source? (e.g. Azure AI Search, Azure CosmosDB Mongo vCore, etc)
- Verify the startup command and runtime configuration by showing the output of the following az CLI command:
```
az webapp show --name <app name> --resource-group <resource group name> --query "{startupCommand: siteConfig.appCommandLine, runtime: siteConfig.linuxFxVersion}"
```

**Logs**

1. If the application deployment is failing, please share the deployment logs using the following az CLI command:
```
az webapp log deployment show --name <app name> --resource-group <rg name>
```

2. If the application is crashing after deployment, please share the application logs using the following az CLI command:
```
az webapp log tail --name <app name> --resource-group <resource group name>
```

**Additional context**
Add any other context about the problem here.
</file>

<file path=".github/workflows/check-test-updates.yml">

</file>

<file path=".github/workflows/stale-issues.yml">
name: Close inactive issues
on:
  schedule:
    - cron: "30 1 * * *"

jobs:
  close-issues:
    runs-on: ubuntu-latest
    permissions:
      issues: write
      pull-requests: write
    steps:
      - uses: actions/stale@v5
        with:
          days-before-issue-stale: 60
          days-before-issue-close: 14
          stale-issue-label: "stale"
          stale-issue-message: "This issue is stale because it has been open for 30 days with no activity."
          close-issue-message: "This issue was closed because it has been inactive for 14 days since being marked as stale."
          days-before-pr-stale: 60
          days-before-pr-close: 14
          repo-token: ${{ secrets.GITHUB_TOKEN }}
</file>

<file path=".repomix/bundles.json">
{
  "bundles": {}
}
</file>

<file path="backend/history/cosmosdbservice.py">
import uuid
from datetime import datetime
from azure.cosmos.aio import CosmosClient
from azure.cosmos import exceptions
  
class CosmosConversationClient():
    
    def __init__(self, cosmosdb_endpoint: str, credential: any, database_name: str, container_name: str, enable_message_feedback: bool = False):
        self.cosmosdb_endpoint = cosmosdb_endpoint
        self.credential = credential
        self.database_name = database_name
        self.container_name = container_name
        self.enable_message_feedback = enable_message_feedback
        try:
            self.cosmosdb_client = CosmosClient(self.cosmosdb_endpoint, credential=credential)
        except exceptions.CosmosHttpResponseError as e:
            if e.status_code == 401:
                raise ValueError("Invalid credentials") from e
            else:
                raise ValueError("Invalid CosmosDB endpoint") from e

        try:
            self.database_client = self.cosmosdb_client.get_database_client(database_name)
        except exceptions.CosmosResourceNotFoundError:
            raise ValueError("Invalid CosmosDB database name") 
        
        try:
            self.container_client = self.database_client.get_container_client(container_name)
        except exceptions.CosmosResourceNotFoundError:
            raise ValueError("Invalid CosmosDB container name") 
        

    async def ensure(self):
        if not self.cosmosdb_client or not self.database_client or not self.container_client:
            return False, "CosmosDB client not initialized correctly"
        try:
            database_info = await self.database_client.read()
        except:
            return False, f"CosmosDB database {self.database_name} on account {self.cosmosdb_endpoint} not found"
        
        try:
            container_info = await self.container_client.read()
        except:
            return False, f"CosmosDB container {self.container_name} not found"
            
        return True, "CosmosDB client initialized successfully"

    async def create_conversation(self, user_id, title = ''):
        conversation = {
            'id': str(uuid.uuid4()),  
            'type': 'conversation',
            'createdAt': datetime.utcnow().isoformat(),  
            'updatedAt': datetime.utcnow().isoformat(),  
            'userId': user_id,
            'title': title
        }
        ## TODO: add some error handling based on the output of the upsert_item call
        resp = await self.container_client.upsert_item(conversation)  
        if resp:
            return resp
        else:
            return False
    
    async def upsert_conversation(self, conversation):
        resp = await self.container_client.upsert_item(conversation)
        if resp:
            return resp
        else:
            return False

    async def delete_conversation(self, user_id, conversation_id):
        conversation = await self.container_client.read_item(item=conversation_id, partition_key=user_id)        
        if conversation:
            resp = await self.container_client.delete_item(item=conversation_id, partition_key=user_id)
            return resp
        else:
            return True

        
    async def delete_messages(self, conversation_id, user_id):
        ## get a list of all the messages in the conversation
        messages = await self.get_messages(user_id, conversation_id)
        response_list = []
        if messages:
            for message in messages:
                resp = await self.container_client.delete_item(item=message['id'], partition_key=user_id)
                response_list.append(resp)
            return response_list


    async def get_conversations(self, user_id, limit, sort_order = 'DESC', offset = 0):
        parameters = [
            {
                'name': '@userId',
                'value': user_id
            }
        ]
        query = f"SELECT * FROM c where c.userId = @userId and c.type='conversation' order by c.updatedAt {sort_order}"
        if limit is not None:
            query += f" offset {offset} limit {limit}" 
        
        conversations = []
        async for item in self.container_client.query_items(query=query, parameters=parameters):
            conversations.append(item)
        
        return conversations

    async def get_conversation(self, user_id, conversation_id):
        parameters = [
            {
                'name': '@conversationId',
                'value': conversation_id
            },
            {
                'name': '@userId',
                'value': user_id
            }
        ]
        query = f"SELECT * FROM c where c.id = @conversationId and c.type='conversation' and c.userId = @userId"
        conversations = []
        async for item in self.container_client.query_items(query=query, parameters=parameters):
            conversations.append(item)

        ## if no conversations are found, return None
        if len(conversations) == 0:
            return None
        else:
            return conversations[0]
 
    async def create_message(self, uuid, conversation_id, user_id, input_message: dict):
        message = {
            'id': uuid,
            'type': 'message',
            'userId' : user_id,
            'createdAt': datetime.utcnow().isoformat(),
            'updatedAt': datetime.utcnow().isoformat(),
            'conversationId' : conversation_id,
            'role': input_message['role'],
            'content': input_message['content']
        }

        if self.enable_message_feedback:
            message['feedback'] = ''
        
        resp = await self.container_client.upsert_item(message)  
        if resp:
            ## update the parent conversations's updatedAt field with the current message's createdAt datetime value
            conversation = await self.get_conversation(user_id, conversation_id)
            if not conversation:
                return "Conversation not found"
            conversation['updatedAt'] = message['createdAt']
            await self.upsert_conversation(conversation)
            return resp
        else:
            return False
    
    async def update_message_feedback(self, user_id, message_id, feedback):
        message = await self.container_client.read_item(item=message_id, partition_key=user_id)
        if message:
            message['feedback'] = feedback
            resp = await self.container_client.upsert_item(message)
            return resp
        else:
            return False

    async def get_messages(self, user_id, conversation_id):
        parameters = [
            {
                'name': '@conversationId',
                'value': conversation_id
            },
            {
                'name': '@userId',
                'value': user_id
            }
        ]
        query = f"SELECT * FROM c WHERE c.conversationId = @conversationId AND c.type='message' AND c.userId = @userId ORDER BY c.timestamp ASC"
        messages = []
        async for item in self.container_client.query_items(query=query, parameters=parameters):
            messages.append(item)

        return messages
</file>

<file path="backend/security/__init__.py">

</file>

<file path="frontend/.eslintignore">
node_modules
public
build
dist
</file>

<file path="frontend/.eslintrc.json">
{
  "root": true,
  "parser": "@typescript-eslint/parser",
  "extends": [
    "eslint:recommended",
    "plugin:@typescript-eslint/eslint-recommended",
    "plugin:@typescript-eslint/recommended",
    "plugin:react/jsx-runtime",
    "plugin:react-hooks/recommended",
    "plugin:jsx-a11y/recommended",
    "prettier"
  ],
  "plugins": ["@typescript-eslint", "import", "simple-import-sort", "prettier"],
  "env": {
    "browser": true,
    "jest": true
  },
  "rules": {
    // "prettier/prettier": "error",
    "prettier/prettier": [
      "error",
      {},
      {
        "usePrettierrc": false
      }
    ],
    "quote-props": [2, "as-needed"],
    "comma-dangle": "error",
    "no-console": ["warn", { "allow": ["warn", "error"] }],
    "no-debugger": "error",
    "react/prop-types": 0,
    "import/no-extraneous-dependencies": ["error", { "devDependencies": true }],
    "object-curly-newline": [
      "error",
      {
        "ObjectExpression": "always",
        "ObjectPattern": { "multiline": "as-needed" },
        "ImportDeclaration": "never",
        "ExportDeclaration": { "multiline": true, "minProperties": 3 }
      }
    ],
    "object-curly-spacing": ["error", "as-needed", { "objectsInObjects": true }],
    "no-underscore-dangle": 0,
    "jsx-a11y/click-events-have-key-events": 0,
    "jsx-a11y/anchor-is-valid": 0,
    "no-await-in-loop": 0,
    "no-unused-expressions": ["error", { "allowShortCircuit": true, "allowTernary": true }],
    "arrow-parens": ["error", "as-needed"],
    "no-unused-vars": "off", // Turn off the base rule and use @typescript-eslint/no-unused-vars
    "@typescript-eslint/no-unused-vars": [
      "error",
      {
        "argsIgnorePattern": "^_",
        "varsIgnorePattern": "^_",
        "ignoreRestSiblings": true,
        "args": "after-used"
      }
    ],
    "import/prefer-default-export": 0,
    "react/no-find-dom-node": 0,
    "no-shadow": 0,
    "max-len": 0,
    "consistent-return": 0,
    "no-plusplus": 0,
    "spaced-comment": 0,
    "react/react-in-jsx-scope": 0,
    "react/jsx-filename-extension": 0,
    "indent": ["error", 2],
    "react/jsx-indent": ["error", 2],
    "react/jsx-indent-props": ["error", 2],
    "@typescript-eslint/no-explicit-any": "warn",
    "simple-import-sort/exports": "error",
    "simple-import-sort/imports": [
      "error",
      {
        "groups": [
          // Packages `react` related packages come first.
          ["^react", "^@?\\w"],
          // Internal packages.
          ["^(@|components)(/.*|$)"],
          // Side effect imports.
          ["^\\u0000"],
          // Parent imports. Put `..` last.
          ["^\\.\\.(?!/?$)", "^\\.\\./?$"],
          // Other relative imports. Put same-folder imports and `.` last.
          ["^\\./(?=.*/)(?!/?$)", "^\\.(?!/?$)", "^\\./?$"],
          // Style imports.
          ["^.+\\.?(css)$"]
        ]
      }
    ]
  },
  "ignorePatterns": ["node_modules/", "build/", "dist/", "public/", "*.config.ts"]
}
</file>

<file path="frontend/.prettierignore">
node_modules
public
build
dist
</file>

<file path="frontend/.prettierrc.json">
{
    "semi": false,
    "singleQuote": true,
    "arrowParens": "avoid",
    "trailingComma": "none",
    "endOfLine": "auto",
    "tabWidth": 2,
    "printWidth": 120,
    "bracketSpacing": true,
    "bracketSameLine": true,
    "jsxSingleQuote": false,
    "quoteProps": "as-needed"
}
</file>

<file path="frontend/authConfig.js">
// MSAL configuration for Azure AD authentication
const baseUri = "http://localhost:50505";

export const msalConfig = {
    auth: {
        clientId: "022fb5e8-f6fb-4827-abe5-18f8a1cff62f", // Application (client) ID
        authority: "https://login.microsoftonline.com/8525bbee-114f-4aa9-a0e4-6110954ed79b", // Tenant ID
        redirectUri:  "http://localhost:50505", // Redirect URI after login

        postLogoutRedirectUri: baseUri,
    },
    cache: {
        cacheLocation: "sessionStorage",
        storeAuthStateInCookie: false,
    },
};

export const loginRequest = {
    scopes: ["User.Read"] // Add other scopes as needed
};
</file>

<file path="frontend/AuthRedirect.tsx">
import { useIsAuthenticated } from "@azure/msal-react";
import { useEffect } from "react";
import { useNavigate } from "react-router-dom";

const AuthRedirect = () => {
    const isAuthenticated = useIsAuthenticated();
    const navigate = useNavigate();

    useEffect(() => {
        if (isAuthenticated) {
            navigate("/chat");
        }
    }, [isAuthenticated, navigate]);

    return null;
};

export default AuthRedirect;
</file>

<file path="frontend/eslint.config.ts">
import globals from 'globals'
import pluginReactConfig from 'eslint-plugin-react/configs/recommended.js'
import eslintConfigPrettier from 'eslint-config-prettier'

import path from 'path'
import { fileURLToPath } from 'url'
import { FlatCompat } from '@eslint/eslintrc'
import pluginJs from '@eslint/js'

// mimic CommonJS variables -- not needed if using CommonJS
const __filename = fileURLToPath(import.meta.url)
const __dirname = path.dirname(__filename)
const compat = new FlatCompat({ baseDirectory: __dirname, recommendedConfig: pluginJs.configs.recommended })

export default [
  { languageOptions: { globals: globals.browser } },
  ...compat.extends('standard-with-typescript'),
  pluginReactConfig,
  eslintConfigPrettier
]
</file>

<file path="frontend/LogOffButton.tsx">
import React from 'react';
import { useNavigate } from 'react-router-dom';
import { AppStateContext } from '../state/AppProvider';
import { LogOffManager } from '../utils/LogOffManager';

/**
 * LogOffButton component renders a button for logging off the user.
 * It uses the LogOffManager class to handle log-off functionality.
 * Created on: June 11, 2025
 */
const LogOffButton: React.FC = () => {
  const navigate = useNavigate();
  const appStateContext = React.useContext(AppStateContext);

  // Initialize LogOffManager
  const logOffManager = new LogOffManager(navigate, appStateContext);

  const handleLogOff = () => {
    logOffManager.logOffUser();
  };

  return (
    <button onClick={handleLogOff} style={{ padding: '10px 20px', backgroundColor: '#f44336', color: '#fff', border: 'none', borderRadius: '5px', cursor: 'pointer' }}>
      Log Off
    </button>
  );
};

export default LogOffButton;
</file>

<file path="frontend/src/api/api.ts">
import { chatHistorySampleData } from '../constants/chatHistory'

import { ChatMessage, Conversation, ConversationRequest, CosmosDBHealth, CosmosDBStatus, UserInfo } from './models'

export async function conversationApi(options: ConversationRequest, abortSignal: AbortSignal): Promise<Response> {
  const response = await fetch('/conversation', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      messages: options.messages
    }),
    signal: abortSignal
  })

  return response
}

export async function getUserInfo(): Promise<UserInfo[]> {
  const response = await fetch('/.auth/me')
  if (!response.ok) {
    console.log('No identity provider found. Access to chat will be blocked.')
    return []
  }

  const payload = await response.json()
  return payload
}

// export const fetchChatHistoryInit = async (): Promise<Conversation[] | null> => {
export const fetchChatHistoryInit = (): Conversation[] | null => {
  // Make initial API call here

  return chatHistorySampleData
}

export const historyList = async (offset = 0): Promise<Conversation[] | null> => {
  const response = await fetch(`/history/list?offset=${offset}`, {
    method: 'GET'
  })
    .then(async res => {
      const payload = await res.json()
      if (!Array.isArray(payload)) {
        console.error('There was an issue fetching your data.')
        return null
      }
      const conversations: Conversation[] = await Promise.all(
        payload.map(async (conv: any) => {
          let convMessages: ChatMessage[] = []
          convMessages = await historyRead(conv.id)
            .then(res => {
              return res
            })
            .catch(err => {
              console.error('error fetching messages: ', err)
              return []
            })
          const conversation: Conversation = {
            id: conv.id,
            title: conv.title,
            date: conv.createdAt,
            messages: convMessages
          }
          return conversation
        })
      )
      return conversations
    })
    .catch(_err => {
      console.error('There was an issue fetching your data.')
      return null
    })

  return response
}

export const historyRead = async (convId: string): Promise<ChatMessage[]> => {
  const response = await fetch('/history/read', {
    method: 'POST',
    body: JSON.stringify({
      conversation_id: convId
    }),
    headers: {
      'Content-Type': 'application/json'
    }
  })
    .then(async res => {
      if (!res) {
        return []
      }
      const payload = await res.json()
      const messages: ChatMessage[] = []
      if (payload?.messages) {
        payload.messages.forEach((msg: any) => {
          const message: ChatMessage = {
            id: msg.id,
            role: msg.role,
            date: msg.createdAt,
            content: msg.content,
            feedback: msg.feedback ?? undefined
          }
          messages.push(message)
        })
      }
      return messages
    })
    .catch(_err => {
      console.error('There was an issue fetching your data.')
      return []
    })
  return response
}

export const historyGenerate = async (
  options: ConversationRequest,
  abortSignal: AbortSignal,
  convId?: string
): Promise<Response> => {
  let body
  if (convId) {
    body = JSON.stringify({
      conversation_id: convId,
      messages: options.messages
    })
  } else {
    body = JSON.stringify({
      messages: options.messages
    })
  }
  const response = await fetch('/history/generate', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: body,
    signal: abortSignal
  })
    .then(res => {
      return res
    })
    .catch(_err => {
      console.error('There was an issue fetching your data.')
      return new Response()
    })
  return response
}

export const historyUpdate = async (messages: ChatMessage[], convId: string): Promise<Response> => {
  const response = await fetch('/history/update', {
    method: 'POST',
    body: JSON.stringify({
      conversation_id: convId,
      messages: messages
    }),
    headers: {
      'Content-Type': 'application/json'
    }
  })
    .then(async res => {
      return res
    })
    .catch(_err => {
      console.error('There was an issue fetching your data.')
      const errRes: Response = {
        ...new Response(),
        ok: false,
        status: 500
      }
      return errRes
    })
  return response
}

export const historyDelete = async (convId: string): Promise<Response> => {
  const response = await fetch('/history/delete', {
    method: 'DELETE',
    body: JSON.stringify({
      conversation_id: convId
    }),
    headers: {
      'Content-Type': 'application/json'
    }
  })
    .then(res => {
      return res
    })
    .catch(_err => {
      console.error('There was an issue fetching your data.')
      const errRes: Response = {
        ...new Response(),
        ok: false,
        status: 500
      }
      return errRes
    })
  return response
}

export const historyDeleteAll = async (): Promise<Response> => {
  const response = await fetch('/history/delete_all', {
    method: 'DELETE',
    body: JSON.stringify({}),
    headers: {
      'Content-Type': 'application/json'
    }
  })
    .then(res => {
      return res
    })
    .catch(_err => {
      console.error('There was an issue fetching your data.')
      const errRes: Response = {
        ...new Response(),
        ok: false,
        status: 500
      }
      return errRes
    })
  return response
}

export const historyClear = async (convId: string): Promise<Response> => {
  const response = await fetch('/history/clear', {
    method: 'POST',
    body: JSON.stringify({
      conversation_id: convId
    }),
    headers: {
      'Content-Type': 'application/json'
    }
  })
    .then(res => {
      return res
    })
    .catch(_err => {
      console.error('There was an issue fetching your data.')
      const errRes: Response = {
        ...new Response(),
        ok: false,
        status: 500
      }
      return errRes
    })
  return response
}

export const historyRename = async (convId: string, title: string): Promise<Response> => {
  const response = await fetch('/history/rename', {
    method: 'POST',
    body: JSON.stringify({
      conversation_id: convId,
      title: title
    }),
    headers: {
      'Content-Type': 'application/json'
    }
  })
    .then(res => {
      return res
    })
    .catch(_err => {
      console.error('There was an issue fetching your data.')
      const errRes: Response = {
        ...new Response(),
        ok: false,
        status: 500
      }
      return errRes
    })
  return response
}

export const historyEnsure = async (): Promise<CosmosDBHealth> => {
  const response = await fetch('/history/ensure', {
    method: 'GET'
  })
    .then(async res => {
      const respJson = await res.json()
      let formattedResponse
      if (respJson.message) {
        formattedResponse = CosmosDBStatus.Working
      } else {
        if (res.status === 500) {
          formattedResponse = CosmosDBStatus.NotWorking
        } else if (res.status === 401) {
          formattedResponse = CosmosDBStatus.InvalidCredentials
        } else if (res.status === 422) {
          formattedResponse = respJson.error
        } else {
          formattedResponse = CosmosDBStatus.NotConfigured
        }
      }
      if (!res.ok) {
        return {
          cosmosDB: false,
          status: formattedResponse
        }
      } else {
        return {
          cosmosDB: true,
          status: formattedResponse
        }
      }
    })
    .catch(err => {
      console.error('There was an issue fetching your data.')
      return {
        cosmosDB: false,
        status: err
      }
    })
  return response
}

export const frontendSettings = async (): Promise<Response | null> => {
  const response = await fetch('/frontend_settings', {
    method: 'GET'
  })
    .then(res => {
      return res.json()
    })
    .catch(_err => {
      console.error('There was an issue fetching your data.')
      return null
    })

  return response
}
export const historyMessageFeedback = async (messageId: string, feedback: string): Promise<Response> => {
  const response = await fetch('/history/message_feedback', {
    method: 'POST',
    body: JSON.stringify({
      message_id: messageId,
      message_feedback: feedback
    }),
    headers: {
      'Content-Type': 'application/json'
    }
  })
    .then(res => {
      return res
    })
    .catch(_err => {
      console.error('There was an issue logging feedback.')
      const errRes: Response = {
        ...new Response(),
        ok: false,
        status: 500
      }
      return errRes
    })
  return response
}
</file>

<file path="frontend/src/api/index.ts">
export * from './api'
export * from './models'
</file>

<file path="frontend/src/assets/csudh_brand_kit.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="511.977" height="287.846" viewBox="0 0 1366 768">
  <g id="Artboard_1" data-name="Artboard 1">
    <image id="CSUDH-Mark-4C-RGB" y="313" width="803" height="166" xlink:href="data:img/png;base64,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"/>
    <image id="Artboard_1-2" data-name="Artboard 1" x="848" y="124" width="496" height="638" xlink:href="data:img/png;base64,iVBORw0KGgoAAAANSUhEUgAAALoAAADwCAYAAAC3zX77AAAgAElEQVR4nGJkGCZgQmE545cn7xlYmP8y/GX8x1C9fP7/4eK3UUAhYGBgAAAAAP//GvIJ/f2rFxwnDx9xunHktMOXJ+/lWJj/Mv9l/Pdewcr4hIOv1zZpBaUXg8CZo2AgAQMDAwAAAP//GrIJ/cP7lyynDp903dDQ38Rw540RJzMn4+9/fxj+MzEysPxnYGBiYvr/muXbW8OEwCmRuck9ErKK3waBs0fBQAAGBgYAAAAA//9iHqoBb6qlm7Apo2ER5/v/skwMLEz/GP4zMv5nYGRiYGBkYGBk/P//PyPHXxbuP+fvORx7cJXj6OWLuwaBs0fBQAAGBgYAAAAA//9iGooB/+j2LfmttRObeP5xsjOAEjioXvoPSt6QCur////Q5M7A8PX/X8YvW85lr5wzJ2zAHT4KBgYwMDAAAAAA//8akgl9eefESqHPzFJ/QUn5PyMkkSMrAKVwuDgTAxsjK/u+5pntb188Fx44V4+CAQMMDAwAAAAA//8acgn96/u3THf2nvD8/fc/AzMjEwMjAyO8BAfRICbCU4ygtM7wn5GJkfHdF8U9GzZ7D6jjR8HAAAYGBgAAAAD//xpyCf3Vy7cSv19+kmJk/M/4798/hv8M/xmQmy6MkIIcnOBBcmAGw38GHhYehoObN1oNAi+MAnoDBgYGAAAAAP//GnIJ/d3Tp1KsjKzMoBTNBG+vQNvmSGxocx0iBmnC/P/17iPvQLh5FAwwYGBgAAAAAP//GnIJXURB7uEfhj//oG0SSInOwACnGWCdUQYGRNudEYwZ/7My/xpAp4+CgQIMDAwAAAAA//8acgldgJ/3HaukwGNwX5PpPwMTtB3OiNQdZYS03JFK9f8M3359Z7B09zo3cC4fBcSAt8+uKLy9scbl3ct7IlQLMAYGBgAAAAD//xpyCZ1fROyvQajnMrZ/jP+ZoIkY3BFl/A9hgwAjUvkOGpj5z/j/tyDbg4CU2GUD6vhRgBe8vTwh/f+FtHN/n8za8fd80qm3t1ZHv3vzgoXiUGNgYAAAAAD//xqSw4t+qXGzXzF+ecfwDyoAGmn5zwhto/xHbbOD8sF/JgbztKBJIuJSbwfS3aMAN3h9b7Pdv2ebehjY+AWYGJmZGVk5Ff7fnTKL4cM5d4qDjYGBAQAAAP//GpIJXUZJ+YFXZ0HxW4Zvn5jB86EMDH8Z/8PKdzAA0aB8wMbM+P+fqeQav6SYmQPs7FGAA7x7tNOW4c7EeYzM7Nz/wW1QcCwy/mPh4vx3r3/y+2dnNCgKOwYGBgAAAAD//xrSi7rOnzhutKK2t/XD8VtuHKysTODh9P+M4HF0ZmbwWpc3BmkhkyLTEnol5BS+DwInjwI08PbGwiSGh7Mn/GPm4wHP/iGNpIGHikFl17/fd5k06uOFZG2OkRV+DAwMAAAAAP//GvKrF798fMM5O6Xw8IN9N41+/f3NCBpLZ//H/P+XNt+FkoUzohRVVW8MAmeOAizg3ZMjVv8ulm7/zybICyqhYIMHSK1PCACNsX1/8YbReIa/sLT5cZLDkoGBAQAAAP//GpJNF2TAwy/yXYiZ77beH24G7X/cDJogmoH3v39s0OzRRD54wbvnZy3/XW9Z8J9DkJeR8R84kUMan0iJHEyDp7oZ/3NLify73rjg3avbKiR7ioGBAQAAAP//GvIJHQSYmRgZ/kHHzCHtF8Z/f////zoInDYKsIB3t9dH/buYv+U/E5MKpLkCneRDGiaGzG4jFe3//zEyMjGp/r1Usvbtqzu6JIUrAwMDAAAA//8aFgmdEbrWBdSgA4fZPwZG5j//h4Xfhht4++KG3v87vRMZWHgE4W1y6EoN2LIN2JACWBJc0oPGG0BifxgZGH/rMpyNXff+1V1NooOGgYEBAAAA//8aFonhPyO0HICudQGFzb+/owl9sIH3r+9p/rteNecvG68wqEgCF9jgqhgWbyhtFggAl2HQNdf/wDHL+I9dUPnPtfLZ714/EiXKiwwMDAAAAAD//xoeieH/f0b4fOh/BgYWFibGf7//cg8Cl40CKHj/5JDn39Nxuxn//TBh+g8qmqDJGbxgCTEoDGuWQypoiDiMhM+Ag5oxf79Z/btWMfP9u8f8BMOYgYEBAAAA//8aHgn973+mf/CA+c/w999/Jobff/kGgctGAWjb49tHKr+v1M5gYBWQAi9QAhVLoJQHLqURC5Igs9uIBXmgHiokrSMWecBY////Y/z/573/7xNRy9+9e4E/rhkYGAAAAAD//xomTZf/jEyw0gDaSP/3+y/bwLtsFLx/91jmz+XyWYws3LKMzH9hSRg6aw1ptoDb6KCOFXjlHWo7HVLKQ9Wj7q5hYGT4x8jIyuf253rD1PfvXnLgDGwGBgYAAAAA//8aLp1RRsTZFpD23t9ff9gH1FGjADSEqPHnTPxWhr8fHcD7B6A9TvAGGVhJDu2Ewtvn8EYogg9SD2+9g9s8MFkmxv8M/5iZvt+P/Hu7d8q79++wN1cZGBgAAAAA//8aHk0XRljpwABdzcjI8Pfnb9ZB4LIRC969e8H7/0rVEkZmDl1Qmxrc7v4HbXpAEzOilAYX41AAWXqNNKoOH3mBcSGjjhBVzODdlEzMfz9eiP9/tXz2+7evMRM7AwMDAAAA///kW7sNwjAQvXNaECgg0lCRji5rMABbsAMjQMMA7JAlqKhpEpEi/BIUUZAi8SH/Q09HZ1nWybLv5+f3fsIMq4obq/L7tMiyOREXBQplUTJUcTGS0J98aDO1T6HTV59hXEVsLWmGQiKBCPjNMFeGLLkcdKEjEAqM43Yfcn0QLbXQAIN3fokOcbwABg0SQjfju4eNMY4SoiSyiFZnvaKySwyHG8USul5SfXUIxjAgQ0kz6w8HyXgWnv1J0Pyjoz/LR4+f1jtiGJlbs8IA7dgKPjDZuiucEWfsYEXbmxsI2YaCntdOxjzP43WyhHTzKovryh8FTnsAAB8AAAD//yJ7CcCXD29Yrxw+7nBz6abkV4cu2/7//EuC9S8jIzMDMyjhgmoqeBuMiRFUU/2Hpt7/4D2c4KoElACZ/v0HL7j9D3E8E7y19h/uQdBZLZAJMrBeaGKDttKY/jGyMrH9h+yjY4B3Xpj+////8+9vBiZ4p4YRXArAVjzCMhgDYmTyP6zJyPCfCWUPKjMzE7zahcTVf4gayPDAf/CeVKhaBub///8w/mb4yfz/k6Cxyhn1CI9FBn4em4QkZD6QG9ZDCbx7cUfx//WSJf///rAApT9wOcLEBIsyVAAOT5AcYu8AekEEb8tDm6SweIe34aHxCjf//5+/jIKW05gUc0qFhMV+gsUYGBgAAAAA//8iK6E/uXVLfUFqTj/3+Q/O3IwcrL/+/4EkXeS2FqKkBjuJiYmB4d+//9AjKRjhpfQ/2IwYdM/nP+SyFGlmDNJnQWQeRCj8g5f8sELj/z+kwgNt8S4sNSMCEVsn5z983ym8mv2PqEYRAQxlMiD5E+qz////MYCT/////x8J/rgdNrM5y8jTa9/QS7qkgbeH41b8+/0mlOnfP/BIGCiRI1Ihcg0NiWto2QcpjBB1JVQVKL2AEg4s7KFhDh+pQbR6IAUUVN3f779Z5GNKBTRSJ4L5DAwMAAAAAP//IrmNfm73Lq+lrik7JK/89mD9x8L25/9fRiZIxoXY+x/aZ4blUuhYP0qHA6kVxgTzFCO0hEXaBvcflloZkXM2TPI/PJUir0SHl8pIAKbrH6xR+B9LIofnL0R/H7YAA5RoMUoERkwmLLshTWWDjGBS+sintj+qYd2OvqmJpIb3UALv3zxm+f/lvgvDv3/gCh1SySIXEIgE/w8cppCaFpyY4dKoO8VQmu8o8Y4IdEh8I+2bZOVj/vNgfiZcDQMDAwAAAP//IrpE//j+FdvB+UtLbrUsr+T6w8qNSE+wQ4OgBqIUn0gWQZsCoKL9/79/SInoP+j4OGjTBVMfA3J7DHmoCSVIkEQYEdYjl8T/kd2G4kRoqQFXB9qexwQZ00XKNPACA2bIf0QGZGJkRGQcWFsSlrvhx3H8Z/jN9PcHi7f2lPCOunpRWflheUTe2+OF/f8+XkhgZGBgBzVCwcPmTAyM/8AtUqb/jP//gvuP/xk5GJmYGNlB/TT0wgm5/EGqXxkY/v/9///3J0i39h+oJ8gEGr6B0KDVj//BB7QxMjByPWFUiG4R0UqeAzaEgYEBAAAA//8iOqEfX7s+/Gxy52KmP8ys/6E9Q0ZGpISCkvwQ7Wt4/xo6+I/cwQC33+GND0SCgPVf4DkUNVvDxRmR22bIpTmsPY7S44SuiUFu0yB1LCF9UkZoe/4/wjBY7oMlfORQ+4/UXIGPHkC7SkyMCDdDq+a///4xsLOw/eOMNW6JmdxTT2zYDzfw/sNnVoaf16P/nsudx8AmAO7pw9MSSuMFFtigDPOfgYlD6CmDTq8bw1+GJ+DFe///gTaWgWSg4zmgcGZiYGDm+C4oIIQYCGBgYAAAAAD//yJq1OX9y+e8s50iarj/MLIwMiHKcViCZ4AlUHgbGmW0iOHff8gwDAMDrDpDNEX+IddY6E0O6NANAzyXIxWj0LYduNeN3F6GVBoYnR9YIocVtJCmFdLY7X/oLBxKiYxUlCNnqH+QmT14Swguh+hKwzq9TLAlGv//g1dZ/vr/h+nz4oN5N0+cWK1uYXFl2KdqLEBQgPf3uxenb4CKY9B4CayYhDVtUZMBLOb/M/z/+++jsIDUNZItZGBgAAAAAP//3FyxDYAwDHPoAgscwlucwgt8wMIbLByCxBdtECIhKSyIkW5th0iR49Ru1Vdn9GWcunqNLYpArO+GFSOEG80hRzmsLbHf1klh0kOQ62wkZ6VKDHYkK3aqMbLiMvEjDhPZGuWFpZ4iuWLxX2bACU7o9bUK1ZuYvfxJqLi2VCQpuIrLZu6H/k3u/zoYYQMoHvk4yS5nJuv+lldG+nY3AmAHAAD//9xcuQ2AMAz0MQnDMAYjsgIdO1CBaGmAgtpGKPJHg2hxHUWJdbHvbCuvQD+PrZq6vi3kR4zzFxCCUiC+UahDOpF3iQM6XeepoBUgkoGYGFsY+NEumTrCjmHlR4/aMeEIiwugELHtc9KwnxOykEwBb2DYI0daTdCqE1yemmBn7MPYrMtcv/n/vwYG3/z6ObnoWq0QWw0yrN2M70ZEFwAAAP//IpzQn7/W+nrtsTZ4/Bqpx/Af2m79Bxs/hheviOE/lKYAYoYAbgJK3Q+vJhBDe4gRGMQwCSNy75oB0W7+h5Q5GOEr4pASJDzAIO1n0EgKciXyHz6MiOp/lA4vLA8jN3v+Q0ppeJcJyY8w3/z//58BecoKJMH5h4Xr8ILFgSM1mTMxs4JnWyBzFbAEhFyCw0onpNqZ8R95CZ2BgQEAAAD//yKo8cSadR48/zjZUDqESG0C5DUJMIAYAUIv1hkQqxiQu9mMiA4hbEgRZUQHyff/GWGn5CI6rZDBkP9oYYWUtKBnvjAit3mgZjPBmh/Ik0FItiLOikHvQCA1dRgR8wGoQwZo40LwphEjAxszG+P19btCCYX/cAX//rP8QTQ3kYcRETUf+nAjw3/Gv2QFBwMDAwAAAP//IpjQP5+9asTOxI5IoPCBC1giQzuz+T9k5AJW6iLazwjx/9B2NCOSXpTWC7wFALGFCe7K/4jCHeYGeGsJKbP8R02sDHC7oafrgvrpjLCOMqQjDS/NYVPPjEzwSEDMwiGaTf/h7X5YuEA0M8H9jRjaRCn9GRENmT+3n+u8f/GUKsswhhxgZPvNyMAIPkMTmmxQ0xRy/EFKMsjwHDmAgYEBAAAA///knUEKgDAMBNPixQ/5/z/4Bv9gD24EzXZjL4JXj4VCU5rCZjO0r4m+resCgpOeEtWp18caGQqwxO0My82zLpAxwWFijyVZEC4HZ0mWSwrBc7Eo8q177q41ct1cehKKwTA+hOS44xs6o+zisRNHoPTy0gG5Q53Oe+6Zh3gYbLIy7639MtGr1WwZhOoVZiEeI33w8FW6mNkJAAD//+RdQQ7AIAhTbvv/dx0uCqWNlyW7zqtoTEQppcbXgX2MCzg3eOtZmuEwoG3sqdH5p2SuCQ8Aa2hD/6I8gBVRkyhAaB7rQXXNquPgNZUyF59Dubk0WsKyIMnFJQKIYvg0xnjw5KlqxKwc6Ei+9yQWUQPryNPj7n19SXOvgscPmwhvof+oiL+JggMq5iX4zdFbaw8AAAD//+RdQQ7AIAhD+P+XdREpdOywZNd5NSYaC7TYxNeFGn7Ikncjs1whKLdz+sZrFjJJCAJ5xUzSGBUcjXnMAe7MR6dBgGH/Glc05tWrJ9MzNwjQuvJzDIkAUKMuDlXOGR5qx7CSTgAF2tkcMdoEKQIbmX+j3auC2bPh/5fhDj0ftwPDJ9QlUdz0N6CLyAUAAP//5FzLDsAgCAP//5enC0ILuMOSXefNg/GxIqU2ex144fedD20wFIUiAUJ2A69dhQkwWnFTqntISC1YCCYQYbg3SiAEaN/6PppYXNaA+ahUvTNdAXSEe62QissqQU2sT8Reed2ll8Pp2VA95op0Gx8NWdHPLIJpjnVUOP9plsjUbJ8VVp229ktg978BXURuAAAA///kXUkOhDAMi/P/N7doaLzMCXGmRyRQhdLajl14vPGn26ISVQVrPstsx96Me8tOH7qyzOtz720KxEQxCryGzag+BdbwNcZ4gQz26jFBe/D38ngOsSU+ISGr+WazCOPxU0QGIuwpZAORoEG/l9nFBWLHlemA5KhfGzearUxKp+dwOlNnQ4iu16S7X4+qugAAAP//5FwxEsAgCAPb//9Y7V0hibjYvU4OeAoqBsh5HHi795gcwDQ2/0rmGdrqEW3Dw/LkpV5OJ6u03xIUmpXgtTwoKR+QYkRhwXHFhLvB7hQkarTZKBzoyoemWlOpXIk6sydcGRVRMACYtb5yMMzMQlvSeH950Pts7/+BlYeOXnhQngvEQ3v59GszswcAAP//1J3BDoAgDENXjP//xU5j2NrixcSbnAiQcGA8ujHC+w7p+eg0VDMdPeViN0BJ89bCofrQfyzVeJ8Nx5QxkNoG1pS2NmCDsEVNTONDpPSgR9OXfYKv/kGihq9RSIVEYY51HxmnIilLyrVJNS5evWKaJXUhNj5D6tdlYM/ENunJdwsGtgf0yta+pQBExAUAAP//5F0xDgMxCANy/f977yRwBcRJurVzI2WNGCxkjCFfSFurpdmZCHt4op2XtrinyIF4NH83s089uW7gwshf5SLSoI9c7zwQl+j93EXdyu5DuLLwEwJ6RkQks4lEAM5+f9OdPb+BQ3jcSs/0pNCLBug1XjAZMId4hq9u7q4EcL+HI1PvT8JIj844ddYjG/ntvIyQ8Z8EnYxVtWoka2VqMZWiijMxZtVaCSqxxy0CPx4ReQMAAP//IpjQ//4HjU0gbzxAPaoAMpWOaJ4grwGBdSTBzRom0HVZDP+//v72h0mB766Uqe4ZMSONE5zCAq///v8H2rXP+fridb0Pt54YvT9xw5TvDzfXX6a/kMNqkBfmMyG2Jf2HVm3wQRqoov/wNSaIsX8GBrQFWEgFBiN4tIj5/1eWb5941CQviRiq3xRRU7rEJizw6vuHTzwfbj0w+HT5rt6raw91+L6zCYL6/sz/GRn/IVWzCPOZkGZZUWOWAeFESBAxMf79jzyZMILAf0bQ0tp/TOCCElzCg4dhYKUbfJABVKtC+kfgJip5M6MMDAwAAAAA///Cm9C/ffnE1a9tAc5V4OkTtIQCayszInWuGKF7AFE6Woz////6/+M3n6P2LqfKzFZJTbXTvPxCfxkWYLf32e1bcuc3bI24NW9zCufT3yr/oL3F/4yoiRVpwS8i4zEgZQh444oBqdmANIQJyn//GRm+8P95rJ7iO980IXyWhJziM4bjm7G66+2LJwJnV2yMuLFgSyrD/Q96jIzMzP//wg7JhIymwM+BRKps4BzkDj24v/UPvOyGYCwNQwDab4G04B8+/AwfaYPVxkjFBXJPiiTAwMAAAAAA//9C0fj53Rvmm4eOuV9btzX+4bFTJpycnGzsL/5Isf5ghbRWoUUn4v5OiHYm+AQMrOfGiCh4//9j+ML884PFhPxCA1/PpXzCor+JdeT7Z89kF/jEreG++9v077+/jP9hTaL/kIVZsJGW//BtWf8YmJiYUatBBkSbGaYOdJAXaNkEFwPL/w9mfDuTVs5LFhAWfUasu759/sS1rryh+fPSk/kM/xmZUUbxkZp2kMz5D36hGGw3FaQZw/T/45+3DLFXN3LKKKr+xG/j8AMfPn5k/XPM6wcDGy98oTY6gEw5IC3CY2R5JeK0VZzkwGBgYAAAAAD//4KX6HeuXtJbFlfQ/O3gDU8uRk5WcQZ+8Kjl/39MjP+wNAuQOsQMf5H2hzLBpsuhRdUf1r+fXBe3JBt6ea4j1XGCUlKPX92/F7Ixr2b63/33PRkZmCF9WfgYNWzanwmawJhQLthFjN5Ad0zDNuAy/Qc1Pf7/spZcEzurK1VAWPQjKe7i4uX79vHNy8p9/NP/PZuyo4CRiZX5P/Q8QZRF7dCJtX/wczRgSwkgPYx//xHNnqEIPnx8Cx4+EOIXIdkT/xiY/0JCBzb0CplKhiyhhvUJIeEJ7j8hNUFJBgwMDAAAAAD//wIn9Et797qssIlfKfyPR5CVkR16tMMfeI8Ntt8TNuwG8RWiLYrYM/kfOg8Aaf3++f/rp/nkoixyEjkMiCkqPf70/m3optyqOV+2XI/8/+8fI/pe0P9Ipw0wIJ0TAgHIqyVh47X//383E94WN6s7RVhW9hM57uIXEf/14dXzqlMiwi+uNS1qZWdkZ/+PvHEEaSQV1ndhRPQcIK5mBh3KMXRS+ru3L5gZvz/W+fvmYCDjh9M2/87EKDL8Z2R5dzjhyh8erWMs4m5rhKQMbhJjlhA/z7/X220hx58gzYLAZ5WRmnxII2vk9WgYGBgAAAAA//9i+fjuJeOisIwqob+8gqBkyvQfUVrDpvuRR03QJzlgIxAMyJscQMS/fwwcEQZLNNwdV5LrOBjgExT+/vr+/bq5mwO8eBl4BCDdQCZoeMBPSULK8Ug5EqlJ/h+6lPc7/587qWsWxfMK8JOVyGFAQEzy9/u3LyY8P3LW9sf++37/Gf5CTjCCLTJjgq3fZYT3J/6BNxBAAvf//////lNQStETvH//muXv3elVDG+2lDCwS3D///cL3JQExcX/Xy9kmT6+9/j3fF3Bu9srioVUIxYR5zSmPwygahr5OntwBxQWbbA5CKgc5OpB0gEDAwMAAAD//2L5+uaj/NdTDyz5GHgQqRR5FhY8IgHbT4lo58JSEWJdB2INzD/Gfww/hBkfJrc0VAsIYz+t6uObV5zX9h10eHLligErA9M/biHBp/KWpmcklBRv8YlKYORcUUXFuyvzKxd/WXA859f/30hLlqE7VOBNApSpJQaYn2ArI0FrdzSzQ6byCvDjvIrx3qWLCnf27rf9+eEDNye/4Gc1F4fDcnr6j7CpFRSW+Hv94MHunXtKvNgZ2Vlh9oHLqH9Ip1DB1rfAN5KDL+35j+HWQQjev33F+u/h9Pb/7w/lMbKKsDCAh/lgM8rQTep/fjL+YxMU/n9vxpT3Z+uU/8tntQuJSPzA5ZsP379K/DnoCWpropzABikUkNMTLA5BM4BkrnVhYGAAAAAA//9ieXTytAk3Mxc7OCJgjXHo0AZyroIPJcI3NzMiRjOQ9mNCDu5h/q8U6TxfQFzqFbqFH9+8ZLx36rzDQo+kLuYbr41YWDiYGKFjklf/L/rF6aq7/M3jh1kisvIYt8hZJITNXDJvY7rAfyE2+AI3+PwOot3OwIhovCBPGoGy6GeOb+9No0MXMZSXYATG83t3pLY29DSvt00J4fnPwQvqEPz594/hQsOSj3MT0lZ41pc1SimqvEDXJ6WjeZxTR+rC76tvTJigiwRQJrNQJrbgWZQRvvR5EIP3718z/7vdV/P/05k8RiYWVuiaE6hXIJkXMkUAmZ9mZOHk+fvhWA3jr9cOb8/W3GX485P7/7/vLAz/fjIy/v/FAq3E2P6eTFT7z8zBDJ8tR541h437wu+OhQUZmeHEwMAAAAAA//9i+ff7Jw/TP2h6hXkAfggkyuEUSOerIE+LIxwKcRYTw88/nxmUbc0PYLPw7aNn+rsDS9cJcArw/2FhZfz3HzQrCukIsDFysLPuuRe/f9oCUDuvA12voLzsjX8KfFeYHjEb/fv3FzzLinwmH2zyAXm25h90pAO8VOA/A4Owgfp5ERn599jctrWhq4V5890Etn/soF27DH/+/gNXzVz/2QT+r7+dvv5LI6hPk4quj19Y7N/6gtpDb68cMfnN+BuxUvM/6uwuMvgPSeeI1uAgBf+/3DH4/+ZQMRM7HwtspwGilIV141BO3mFk/MfC+P/rQ1uGb49swVM+4DD4B1n9CZ4oAxWGkIkEhIGwNASJU9i8IzRmoWujyFzUxcDAAAAAAP//YvoP3akOm7WErciDLVxB7dbB7WVAjJQjt9chHvnN8v+/lJ7OZWwWHp0yN0eATUjgD6hT+Q/W72CEZ5wf/34z3pu7MfvF3Xti6Hr5hET+GgX57Pj/7w94iOPfP4TdiCHFf/B0Dp5/gM7MMoIbgyz/BTVlz2Fz172LF9Tebzgd+v3vD0YWxC4gkC5wmPz5/5Px546rEbePHVPHpl/UQP3ib+bf8BEW2IgB0uAPPOxgDEaGwd8T/f96ZygjmxAndBEydO0/BCAmopGmn0F6wCeu/mP8//8vIyO4mfkbzAZt+geffQtqP8KXuSCWTyBGYGBpAjxojVpbkwMYGBgAAAAA//9igkUKzGD4rCcDYiob7mnYLiFGJE+CnYvIaKCSloWP6xMLOxvGoZqf371her3rrM9fxt+Ig2qQN9NDmyB837ilj86eFY7NT/Jmpod//P0JDRjEmhdtbQcAACAASURBVFpGJqRqDumYsv//UFOZiLY61nNBbuzY5cr7n4cbUTLBdMA6sswMvEzcPBfXbw3Apl9QTPTBlz8/4G1u2P5sxv+I1ZconWN4gUL+JAg9wL8Pl5xAx6bCQxCp94Tc90ekG/gqI8Raf2iBiRy24ENZkQpXiHbUs3bQjhoFaWImy8sMDAwAZq5dB2EYBjqPIpFOSIC6ITH3/3+HDYTEQJUBKGqMmtpOgjIxkT2SlcE+X+5OM9rm73QimuPSVDhjSJAl3TdTTCIlKSmyzjWt898Wu/lM42hxeG6BwkSVEkFhIR1ojFH+cj7UCl53+1sMZoJ8dFKYE3HsIQTpCmKgUAAWLKxaV42CC/7RWcPxCokS1HG5pgpR4+t07Wv33W4zzF1M+BVMXlPkUZ2HOvB2/O/qxff9yOap5bCungw2tCSJJ5fpXcLXkq2ZgI38KUSonGSuJU4vXoutij8KJgDgAwAA///MncsOgyAQRQdLa2xN+v9fiYldqEVuQ2EeJKy6qjsXblSGeZx7KW5qDpUW5OItCYRkyTxAKT62i9ARLtUcjOh8x7FXY128j5ivS1ZEcZGYoF4xrNQ/cMLfpm5XZA/hCesnY6bqjhdktdEq79oomAZQ3I4uAQc/hOjQIrr8Q+ZdIZU9aJwfa+/5bXndZQJaF78iymXowWf0SFdL/AP++MoJt9iAKMFZYopNmdsWM3+cNirbM4k0MH3vWUFqaNQ2VmaNwo+oJxF9AAAA//9igk75QGcPGeCdANiwHcy58K4n7KgsxLpW+JmF4Gl5JiaGX28+CTH8+YNxgRKviNg/cUvtg6xgU5DawdAaHFYqfPr37otNVuZqbA5+ePaSITsTJK2ib61jgK0TRxsihYP/DAyvb93CWlMo2Noc/vLz819Y/wO2hxV+KizTf4bf///8F7bS3otN/6cXrxTZ/7NCO14McBrmDiZGNMdA+hOMuDqrgwawCNwGbz+HHn6DUv/A9gDDa06kUgJjmBdtBxasTQ4/4gR5NwrSuUDwmRIKAAMDAwAAAP//YoLtkQMfTAqrYP6hzuYxIK8vZ0AevkOdnWSAjrkz/vzP8uTqdawXnmqnBM34+v/rr/+MsHYafFE9aFU66HzC/yIuRtsUDA3uYNP/8PgZR3YmNviOI4b/sCWwyN10pGYDPE7+M/xm+Mfw8/lHrJ1JRUO989zakqdAQ6NM8EyPmMkEdXw/8/56oufjhTWhP71yWYeDmQNuH/JRdLA0jtiBxADvrDJQIRJpCRh5tU6ALylBTsOw0w9gJTLykTqIJQ5oiR/SJIaNrsDa46gjd6h2wCcgoQdj/WdgJO8GEQYGBgAAAAD//2KCHe3L8B8zUcMHhP8jqlxYpxVemsI3cSP2YHKz8Px/cv6iFTYLlUxN9mt3ZxZ95/zzioWZ+T9sgRozE9N/5n9//3+SZr3oXF9UjU3vq4cPJF4fOWf5599f5L3LiINL//+HJ3yUWVqomn9/fjM+O3HB8PO7VxidGh4h4T92E6pKPkswXmdgAq3wAU9cQg4H/c/I8Jnzx0uL5pxSYSnMmys+vH3B+P7cHeuf/34j3IPUm/2HlJ5hNQ8kk1Iw1UcnwChku4Xx79ffsHUW8NE5pOYibCQBsVkG2t2E3Abyn4GRGUoz/WdkYoGsXAGnddBB6v/+M/779Z/h3x9wYKMeRwirAaAjgwz/yTsahIGBAQAAAP//YoGMGSG2dyG1XeA9X9jeUOhyMpTJJNQhE0Z4dX9j4fboj+/fTOMXFEGZHRMQlQTlymkPr17acWrm0pRPVx+aMvz8y8UsyXdLxsl8l6G/5xZhKVms7eDTazZGSv4VEfjF+BdjiBq5qYUxZAKlmBmYGFhe/NK6ffSkIwMDwx5087WtbY5/ev3K4tSqDaGP1u8L+vn6gwwzH/drURu93b5JYculVDUfY3PXm4dPdD6euGPBycDJ+B9p6BVmMeQOpX9IHTEGyNwB/GyTwQsYBYz3/hO2XsHw4XQsw39mcCDDC1/o3l34QAZ4PB28s/8fAwv/NUYW7geMjKy//zFy/mZi5/zNyMTx4z8jw3cGRrbPjAycXxiZOd78ZxP4wszE+/M/K9uvfw/m9/77+VqVkQGULGEdK5T0RV6HhoGBAQAAAP//YmGEDsExQQ8igRyfjDRRhFQVIZIMbN35P3DbGnl9DHRDKyPjg4/6hxYsjWNgYJiFzWJ5bb17DAwMVSiCq+cyMGRiU83A8PnNa645VqGp7H9+M0B2rMILDpSFZ/Cd+UjnrjMwwLZ6MjKwMrAzXZi7NhtbQgcBPlExUCabB8UQcHgtA0M77uPMT81dkcrDxM327x9kWS4DUseaAb55mwEtHBG1/aAG4IoNlEygfTCk5ivcn9BDtMCrjxiZ/jH+YdzCbD49ToBXiKS1RG8OxqQxMjKpIo/EIMpc1BEZkgADAwMAAAD//wLfVg07nAeyoOY/PEqQmzOw+4PgbV/YQi+kkRjo0AtYDwcjO9PV+rmt144eNqRGPB5dvDKH9cUPdXhow8dukTufyDUR6mZsiLfAR08wftp3zX3/rDnJ1HDXme3bPF+uPhL9B3RHPex+Qdg5LsjDbQxIzcP/sAVyfwf/tosv1+wY3xwIZGRkBhflsEQHHUAC3aT2n+E/838GRrZ//39//8ggYN7NZLowhtREDgLgta+wqhq2VBfSFkWM+JADGBgYAAAAAP//YvqHdLIsosGFGAGBt78YYDkM0RFFbU7BhieZoG34f4yCjHzCe2JqVj28fEmNXAd+eP2SfevEiWU3m5bUMTGxMMH66gzIfU/UGSd4Wx0CELUSrLbi+MvOeb5k1uTNnb1p5AcdA8OptetC9obVLWf/wSqIuk4D0XdBFYNeRgbve/1nHMyDLu/fveL+d2dy138WPh6kNheoBfGPgY3/FgML52UGVsEjDPzai5jEfPOZDGYaChs1VAoKiX0hxz7Q2gGYHbA+IaJJCi2JyQEMDAwAAAAA//9iYWBk+QXb9PwfaScxrBkAvwmOAXZ74X+kK/MYITfNMSBKVcRkKtgMRrb3/5RXBeWueH7vXpikkhLWkRRc4N2bl2y7G3vbXy04mMfKyMrMAO/lM8J75bC2L+RGCSb4uDyis4o+uwbp/HP8Y+G807J8wr4FC345JSTg2NSHG1zZu9dtR1DJLJ7/3PzQm1MRM3tIlQysSQVbioC4BAdU3rMM6kH0/6+2BTD8/2bAwMLEyPAXso7oL2iw5ff3pwwmU21E+IXfUNU+8IIkpNNdIFcTIY7EIjedMzAwAAAAAP//YpLR07749f/PP/9hY/FI50DAjmSAD3Ey/oc3B5jgPW2Urjf8CDnwkBx4suUfI/8rBoP5ZqFHNta3Vr558liAkKM+vH3JcvXIYaONBfXzXy46lMvIyAIZJYEe4v8PWpv8g+0agqaov/+gY+kwv8BmcxkRLRtwZmWEHDPBwcjJeT5/6tQFkanLrx45YvX5/WuCExKPrl5WWF3a0LI7qnop938eAejGGLDv4fMZ0Ikw5FEh1FoGaXh4kDZd3n94Jvbv0coKUIeICdwXAzct/jP+//eXSTayh9qJHAJACRt5mBFRZUPn78krGBgYGAAAAAD//2L89O4ly6LQ3H1sp1/Y/GH4xwg5SBR5XBN5aAN1AzJSlcLAiNZaYEAuR5kgM1+gIyQ+8P18KutgekTSWu+ojJ72IX4ZqTsgb/z+9p33xcWrmq/vPba4u/Fg+J+rT7U5mLhYGRADPVBDGZFOqkUEAiNydYIkBy9eoS5C2TqCaA/+//335x9WC8Xj8rYGe8S0VU5KaWmdY+Ph+Pzn7z+mt7fvab++/8jk4Z4TTm/2XvTg/8vF+xu2TxXp/Bi0OSJokMGaWajdUVAof/j3+V/MpdVc8krqKLccDzR4/+4Fz9/zmWv//f/pwgweA4XNXv79959dcj2rdlesgLA4xjJqSsHrAyHbGf98dYfvm0NeAv7/LygTfBBx3S1Isj0MDAwAAAAA//8Cm3J6+zbv/aF1q3kYOTggSxBgzYL/8EEXJlhHFTrCAlsiC+lsQVZhI5qkyGeKI3rQMMAMWkvDxPD/y5+v/7/8/wQym5H1P9t/XhZeBlYmVsZff0GHODHD1z4gr2qDNw/gF2nAjpCD3m/3H5GYYesp/iMlsn//EUc8MzLDVjYiJg2YGNgY/v7/+f/T388Mf//+YPzPxPyfh4XvPzcDB2hQE9KBhM8VQ83+B0vI8E1yKOHAxIi8bxTW9vzP8OHvp38x19ZyyiuoDaqE/u76nPQ/T1dPBcUS+BQeMAGqTH89YjVbbiUoIE70RnJSwOuDYdsYf33wYGBmhtylD19ECz109P/fzyIuezBm3AkCBgYGAAAAAP//zJ07DsIwDIbzO1XFgFpRqgqJmQMwwFG4ATMzh+AQXICd6yAYYWBDbRJEUifuyICET5A4TuJ8fsTftYvV8rw+7rfPGhcCOSLtrDBQxIRSRHeFK42o9wdSoyHBkdlJlYUQ/kA2qjMGOUZU04ymusFYlx8CRK2xwchFP3XZjJSQ0oSYukToxbEAYPg5l5CEx2RInhv3K9WZlwdHJRWY5I2qdIXMZWidCammERQizRk8RrnVGcMOffdEyOBIPlj/RB73W2Gvp13/eWcswXG2s3q+OfzKyMNiBf2yTjgNO0YHmd1+K0qpNwAAAP//As80CYiAJ3GWvnx4b++pVRti3xw5b/H7429JRqb/7L/OPNJn+MfMDD8ZE56AEB1CpGlTxDHPyJNI8OhHdFQZoKPh8M0daNPhGKsfkWcWGZDdgUizyCMYiGYewqR/KBunkdaKI7W7kEtmmKHM0AhHTZOwHi/qVDjMafBaET7ig+Rs6IjL//9Mg64z+v/J4koGpv/q8Dt0IJHzj5FD9AijZPAsBoYMGlr+nxnlBDRYkQ4LtP9kLgFgYGAAAAAA//9CmVIVl1cCbRPrhvG/ff7INkXX8j7fOyEp+GVYUABPDmhNE/Dowj+kxfT/YUvn0da3I90UjWjrMsKXcoJyMxMTfGATJ4DJMsHulkdOYIxMiDb5f0QihrTFEGPwkESMtBcW3taHLttF7iQgh8F/1NWOiNlB5I3kjEiNd6S1fJCuARMFI2ZUB+/e3jX6czI6jYlVALotAnTC0z+Gf7++/GFVyu4VEhKl8fkzfyD7I0BMtNV40LVC5NV/DAwMAAAAAP//wjvKwMXL/+sPbOAXOT7gI3Xwwwvhmf8/bC04IyJhMTIijmtGjXzorBq0Mw2/GOUfVPwfxMP/YEdEw69VQSRvWIn9H3q0M+xyIlCGY0JaUwTpQ/yFpGPoaBJ8gwnyabcoy0z/wxM++vZFWEmOWMTJCI8QlOXHsM2+0JVysAPEYKuxKZkEoSZ4//aJwJ9zOZMY2YQEkNoKoJV2f1n49ZYw8JvtpLUb/oN7ArCARhQUiFqbzK10DAwMAAAAAP//zF2xDQIxDLx7hEQDxe/BAIxFT8UYbMQUrIEEeaPYsePQIAok0kWRojSJz77c+eMnGbd0SXL2KOkxsjvXaSaRa7CSSRzBbtrvuweuBqK0FHYHwdJSihTc5QE+i+J0TZDE3nGVO1jPeYMnymlIuziLRUTYOet/lw3X6LCZA7ZGigBTFoS/leM73u4LA+fmlhcDceUXaYlmXv/CGJXb5UTKoTbU9+gkE4Wr3ZX783Hezj9PmCla+PVJIx+rkW17/Dw9+3YAeAEAAP//InY1GNLt5EjHH8MOF4Xf7obUAUXoROQBlCsRYVKwJgNibA7eBQLvLGdieMjw5p1Tc063iqnJYVCNAe6yMEGPUPkHmTZmAp3GC74U/h9kjRp4/BfUBgKdZvkHvNjk3+9/LL++fhU4s2174LNFB4LFmQU4fzP8RQyFwPcqMsBPy2WA7GwBjzL9Q54Q+4/I97DbLhCDjQi/og+V/4OtrAT1vGGbu+kM3r1/zc74+6XA/78/2RhYBL4y/P9r8O9sXBojKz+kSoQdKfj7218Glcx2ITKm88kBoBk0+NXz4MLxL3zeBrzy4/8/8rbSMTAwAAAAAP//IpjQmf8jN6wRKR7W2fwP6YEi9v3B1yEjTToxwvp7yL1oRKP/PyInMMCKdFiH7hvn3/cZu1YEyOvrHaFWgH54/XzT88jQDTsCCxex/WLjRozB/4d3HlFKZeQaDK3UZmBAlPr/4FfMIA1nwsIMNsSJ2LxAwbH2ZPj57Vv2f292Bf57tSPj74kAYwaGf1wMjCz/GEFLi5m5/v1jEWQFdxjAUfGX4S9oOS2H9GEmAbNd9HIjaNkuSjjDTiaGTqag7dUnHjAwMAAAAAD//yKY0P8wQI4r/498PsN/pKlZjLY7IjXAmwX/0Uo65AkdeP8P0c5HFhM0kLlGzUTOAFkqDDp+eN1kY7dWxtvfNJD72f/+I+0GQhlJYYSXxoiFWrDJJ+hsMWgJwt//SM0ZmB+RzGFCrvX+/Wegw0Ldd0+Oa/w5nzz7/79vFoyMTMwMLHzQEuYf03/IQm3w3VkQ14K3Iv7/9/PdByaN+kphYXG6jfGDExg4AuBDV8g3PkB23pMDGBgYAAAAAP//Ity4Z/yPuPMCKdKR5hdRhv4gVQ9E/N8/xAgEA/wQUOROJdJljfAqHNoEgK6F//Hms9CX92+o3pD98vED66+vP7nQL98Fn2IKC1hYxgSX9LD15AwomRl6JA30IB/ktj4irOD9DdgsL6zm+M9I861079+94v17uX4pI9MfK0ZmZhZw2QQdwIecnABxL2SnHHxPwn9Gaf8pwtJmJ2nqODTw/z/Tb/DVCMgFDfTKT8ip5WQOLzIwMAAAAAD//yJ8zygD+DgOlKYGojRGaoHCqH+wxAEbnYNKMCGXgIjRCQZYGocthoKvsYEIfb39QunF/Uem5HoQF3hy8arz/8efJBkh4+RwP8GTHVKaZUQaJ8c46QaxrAY2WADXDh/+ZWCAXyqM0MrIgHrBAm3A/0dzShhZmQ0Y/v2BHP8GjyTEXkz42D40Qv79/fKPWSqc5qMs6ICR8T/r/z+wTfdI5Sh82QmZpQIDAwMAAAD//yKY0EHnIf9jgkUM6kkAqKUb0sA5rLb+9w9tAQjycl8GaPsW6f4g9Bvh/jMwcDFysa2Nzpv/4t5tRXI9iQ6e3b2ttDqxYCoPMy+46QZbHIY8iQRf/oA0ggQp7f6hbPWEDnshTUPBT8tFjMrAlwRA1SBmjSgaSSAE3r26rfbv5c5s0EgK4oY3aJMTeR4Gfuw3dBabhYfp77WqyvfvXtH1giUmJkZOeNhCa3TExB14QIC8sGJgYAAAAAD//yJ8/SIjIjKhImAScQQCDMDGt5GuUkE+nQCpk8eIXJIwIlqH8IFG8C4zWEf3H6PwU2bNlTkVsz69e8VFrkdh4OOr5+zb6zq7Jd5yKP5lhJ3YAsvBSB1QpHXQjAgpeOZE3gsAL/ChJ5UxInkD3nNlRG/2Q7qqNEznDP+eroljZGYTgkUWfAsIzF3Qg58g8YvoR4Abjp+uuv7/80mWZo5DAx8+vmX79/+/GGgoHT6xCC9AoHHASOaeUQYGBgAAAAD//yKo8Tf4QiVEW/MfvE3NAC8hwAB5tIIBJoTUeWVCmlGGTxQhTSzBO2uM8DYZWJCJkeEXwz9GliNPnVamV86/e+l8s4i09DXQeYekePT96+eMXz99Ut5S21X5ZdNlf1ZGVsRxqWgFBXxU6D9sABTNjbCLB+BdC9jQI+oyAHjPmhHJXKidkMms/8grFKgO/r/c78HAxg5ap4J0uD5ifQ7Yb9DzKuHLYyF9DkYGVl5Wxq/3VUAHL+Bz17t7Ow3+f79rADkaEdwcA034QspgRoY/0E4MuFIBjcMygs7ahAr+B91iAt4o/Z/1953JJoy/v8kzMLMwwvt2KEO9FKwLYmBgAAAAAP//IpjQOfm57/17/0+KET5/+B+5nwCNTSZ4kmdCTvOwVYbQs1/+wQ71YYCMYMAnZKClJyRt/0cUgrDbDsBrvpmZ/u+8Hbpqa6yPUJDJ0me3b7dIqapiPcoZHbx//kxsT/eU4gsz1qTJM4nxszGxMsKGBRlhN1IgL76CepDxP2KTCSyDwnuU0BWJKM2af4yINfsMSKXmf/j1pNCMxQA5jJXhzz8m8k9ZIwj+//kqx8jGinLVDGQZNsRx4P2+iMkP6OwxpKn1j4WHgeHHOyGCdtzsXMXAwavIyMDwC7w3AxRqTKAsDG15gOYLGBlYoJfVgo9TZ2Bk/PUPdK8wIv2ANqUygxI5OGSgcQEb5YO4FpyGyEvqDAwMAAAAAP//IpjQpczMzr59eNGWEelCXfROFiMjbEUjUqcUXBgjlsiilO6wRAxvryLVDUg3csGazuCtmIxMDKAVhHzMfFz/Nt9NWbIpLLpP1+GegKTkfR5lmZfMjP/+MDIy/2OCFFNgF/189Unk6cO7yrN0fZR5fnHwSTOIgk7IBU/OMsE6Of8RbmBElPHQCQs4DyHOgDT0hTRiDlsRiXEMMiN85gHhS2gNxybA+4CDh5Nmw3eMDIy/4OP8KDUxIh4gF4xBR8qg5ymBMyt4vp2R4H1T/5hYRJn+/mL5C7p7GRZG4BYh7EZt8DWTkOFocEUILi5ZQasxYB19xAwzpKkLK3hg7oXMzYE38ZAXEAwMDAAAAAD//yKY0DUCvXbvX34yn5OFnfEfIjkieurI7T0G5DFwBsTVh7A4Rh5nZ0Ac3o/omP5Dassi1rDCOoZM0PMgQWP6PAzcXAyP/uj8ePBI5+fJp/+ZoAtbYDUO+HLev/8ZuUFH5DFwIQ6Lgy47Btco0Dss0deJMyJ1SlHHxJH8Ap09REyIIc0PMCJlCCj4Dy3aYcOV//7+YRBzNd7AL4J56QHVALfGPoa/T6IhRTdsoRu2Vaew2gvSqACVyn9/fPjHyCsPOqmBAGD6A7/jCtqxhfR00U5OA6d96PAz0opE2JnCkL0W0MIQvCgQMXAB31RO7vF9DAwMAAAAAP//ItgZVbIwPfpLgPH1P9hVJYyIkhc29Q0/2Rf1NDjY/UtIAigNeEgiZ4JdrQ6+6xNR0qC5A5ZAGJGuVYTtLgQtA/gLxr8ZQevc/4KuWAHt+oItl4WXqbDaA7pCEjI5gno3EyPyYc4QeRT3IC11gA8pwvoeyP11pM4tI5J7YQnr679vf81CQjeQHmUkALmANQy/PyENEyFfOw5beYm01Bg6XPoPNB/OxHj/P7cSwfuIwPd/wmpxaNsVJZ9DO+7wS97gfRnoeh/4SBV0Dhl+8i7MaYhVraglDgmAgYEBAAAA//8imND5RUQ/yrib7WZjZPnP+B+RVBiQ2nqwwvc/UmeTAXlsmQFRpTOiSSAf5A/akAEPDPggO8wl0FSDuCQIcYEYtLSAJVTkXAJrhiAbBXMDIzwCkMThMQZ1E/LoN2yDCTwMkPsjiA4eomqD+Qt2Ezj0Nu1///6zyQtdU7E1PU1uxBEDmAQM7/1j4vkObiRCd4LBmwGwg1ph64qQM+mfH78YFTM7hQQJL8uFDOYg2qvw5hFi2Sj8AFt4JoBOHkIKe8hpaJDzP6GZAikCIdEJC3XQKV9kAAYGBgAAAAD//yJqnNQyP6n3E+O374hTXVAzFmzyB32UEz4uzoDYJfQftv0MvbpDAogEh0TDAg8+04ipA3UAA3WjCANSAse6yASlg41Wo8D9gGw3YiEXA1ImhwUIbCsiA3StPMQBEDf9Y2L4r5weMIGHj3YrAt+9vKr2/2zCYiZmJh7YUg14SwVtdAylYwXKl/x6ixjFPBcSZRF0oR8iruDroBE1G6w2hQcSclsWueBA3iGG3OeDlGZkX0rHwMAAAAAA//8iKqELS0teEPIw2MbyjwnauYLlMKRmBjzg4AND8PYZrNOJOKPxP1wp8vlD6MN8/xFdd6T0ijSJgFCJRMEOSf0PLc8RJS/CDrSZGqj2fyibQRDteZh18BbAP6T2Pnzty3941MEMhecHaH8EPBP6////r0L/b1hFBVN8Wx8u8OH9a55/V8oXMjCz6MNDFdp/QRk0gE9kQUY0GBnZ//3/8/ssq1pJiZCwGHHT7UjbJ2GTTqjr82DtQqRRDPAcCUoHBynMoSkINrMOHxaFZSAyAAMDAwAAAP//IiqhC4hK/revzm58K/z7PjN4kg22ZJkRUWjCA+0/AwNaGxu+I4oZqWPxH+EA6Mpj1JIdGmiwfamIpe2IBghKCc6IVC0idXj+watR5K1+/+FtVORMilrSMSJ1rlCbRIgbGhAdZ1iTDab9339YpCP2izIzMP///u/nF8v6rFpBUSmsFxJQCt6+e83152bbRIb/f83+/YedyA6+U///P9Cwxd9ffxmZQefJgMbwQZj5P2jdOcOf7+8ZuRUXsehPjBAQlsZ69iU2wMgEPtQGUmtBD5lFObobqVCDRyJsTRDSzBrqAABUDuxKxPJpRoZ/WM+2JwgYGBgAAAAA//8ieqZJSdfgyssH9z1WROUv5rj0wewPC2S4B9HBYoBHPrzaRmrPwE8JQCoFYf5igiVA6OYJRNH4H9rdQVr6Ct/+9h9eHYKDABaYyE2W/wzw7g4s4GBnRiKcjTTLCc2R8KoeZTkCrNpEjF4gDyghZ16Y9bAGFTQu/3/h/vfYdGJ5uk1o6A4K0zNW8O71A/G/l/IXMP595woZZ4FtGAFdI/TpM7NKQSkj6Lzz9+dtGf68UwHdt8DEzPCFgVPhIoOY20YhMeUnDAwTSLMUOiSGWIYC78VBePC0AA0rKIFo2kEzBigtwc6jR+rZw0+jAM2Y/iNzjy0DAwMAAAD//yJpSlVcQfHWy4cPomY5R2+Resum/uPfL+gJdIhqEdEbgU4SwUdRkNaowzyFZDbsIgEGpH2Y8KYOajcSWgcgLZsFHx3zHzGcyYDorcMCigl2ksF/6NKEf4iQZ2KCpWOkUSXoqBEDdCwffMATorcNHwlAmdZnYkCszWdkhM8jg9z2mfHHO6vpdyiJNgAAIABJREFU9dHW/n5UXXKMDP7d7a9m+PfFjfE/+F5k2OjGf4bfX74wKZemC6sErIAq308tO/9DDu2Brm1C7Zug1OsY8yywZhR0XTRyqQFr+MGaM9ARvn/gVeNkAAYGBoBIXrQjLq9wN37rbG+eeMsZX9h/vmNlYoasTIeuWfmHNAEAToBINsA6paiJHBEs//4hzkWBzUYib0xmRGqnwWfN4P0eRJXy/z+s3QmrPRnhpxPAq1D44fKwZgbUVKSIgHgAVrlASxgmhLtRO8UwPnTSA1zbMf3/9f/nz5/6wrsdVrf60TKRv70+J+n/p8spjH9/wytZcNj9+/OHUSa0XFgVnsipCmCb3mHRBG+pgAsA2O3eaAMFSG0USE0IOZUZHpzwfbawUh3WLSKzjc7AwAAAAAD//yJ7XBIEnt66KX9s/rLUlzuO+36+80Kd+z87GxsjJ3gmF1zKgzod/8CDWtCjJv6DJ4T/Q/cBghLD/3+wlXWIRgCiN4NwJnIGQaQt5KMyYG18RnizAXzHKNIuJwYGeNqFb4SFdS7B7kFpDv37z8TEBhsngexKhU6o/GdEjKSAtTOCt/WCTfv19xfDZ4avf5h4OJ9LOpru00kOmKZkqHuGT5g2E0Pv3rzkYHgyo/rviwNFDCzsnPAF7uAg+/WXUdhhErNcapmgiATZmxbwgdc73V4ysjCJoUYMzAFIJTxSpYzUpUOZLYfU+tAcA2t6QmthcG3859dXUff9PCQ7koGBAQAAAP//oiihw8Dn928Yv7x6q3z3xFnbp0eOqr3+9ZUTNiUOO1gTdj0XeC8+bC3T6y/yDIeeBTAzs8FLUyYmxATYP3h7jRFxtAR8WSmiHc0Ar1EQOZ4R3paGCiAFNGIhJqTdAd4P+g+2L5GBgZGNiYHdWuHnT1HWCwz//534/ecPaB0H2D4mpOkNJkQPBbwrB+QraQWVR5puDsdkdXSucfHy0fh4CAaGt+d7qhleb2/4y8jGDD4TAT4B9/MPA6/eImbV6hwhYVGqHx8HA693ub5mZGYRgQ8kIM+XQAn4bDPKkmyk9IxSriH6b4hMAKoZ/jAw/v31XcT9AOkrWBkYGAAAAAD//yJ72SMy4BUUAbnsDhQTDe7s2e+87lC6P/d/EUbYBALKPZawUuL/P8gWBdhYN3wwD9YxhU1rIxIxbN7tP1LHhxGpZIGdFMzICDvYCFFDMPz6y/D50HUWTkUJUQEbzd8m6TGzpFSU77KzcxFXd+K+M4Cq4O39HYH/b3aX/WdlYYbdMvQPsh7kHyO/2XwmleICISHaJXIQAB3ChDxsibgyH9ZnQhpIQPTskZonyOcwICIQNvkGSeyw5iszebUSAwMDAAAA//+iSolOLPj87hXj+2cvFB+evWz1+Nx5k48nb3j/u/pOhQm2+hFpUgO5Y4JSJaJXkYimNPR4CwaUUR30jc3w5g5SSYNS6iMNIoGyFwsz6/8vvz//5tKTOS8f5z3bJiJoCR8RM4a0Bm/vrPL6f2/GAgZGdhEG6MYKyKGZ////51JbwqxamyYkIkZzd77e6fGSkZlBDDGZjBpxkKYHUlijDEGgNmFgEQAn4WPX0Fr836/vIm77SC/RGRgYAAAAAP//okqJTgh8+viW/cn5q+bz4rOyvu+/6c/zj4eDnY0NtGcLeQAckdAQK2ERAHnBFayZwcAIPy4DeVIK0TlFWnaLctgobPwfSv9HD34YYGL4++8vIyczJxvDlXdm98rnmlzfssf11ZOHZWIy8kQtEaYFeHdvg/2/m91LGdj4+EG9HvghSaBO0Z+f25nUq3OEhGifyMEA3O2C9dihQqh9dHhHHbmtjlgPgyhl4CtbkSZEYRkFeoUCef0cBgYGAAAAAP//olmJ/uH1c8ZfP35Knd+03e/WvM2Zv2481eRlFWD+8+83ZL0m0uo22Lg0clsNPvTEABlbh9desFER5AM6sUy+IZ+5BFuX8x95Oh42cgMbrEQfN2dAijFoBgKtymBlYmR4x/bjuU5ZdJdNYuR0ASrvkn/75Lghw8t9Af+/3XRg+PrQGHQ1OxObwMP/vNq7GEXstjCyCX7/e6ViCQMThwIjA+zqclDnhuUfIxPPOkbdnmQhYVm6nMMCAm92ej5jYP4viRw58HkGpGEpRGWJKNnhBTZs2BF55SoSgLft//z8LuK+n/QSnYGBAQAAAP//oklCf3b3ttTetqmND9YdCBX7x8f37+9fRtARzeAF/SgTSgwo467IR0IzIDVlEAsGoasNkZcQYAzQQMbpwWdAwjrEsLFwtAkk5O2BiKl+5JNvIWqZkM6EhIydg8eN/zI7Kq/16a2tlFZRI2I5K37w/v0rnr/3ptb/e7knk4ldkPP/v1+MjNCdBpDdOSz/Gf58BN0hwsjIyAbdMQE7l57lPwMz1x5Gne4AYVF5msy44gKvd3o8Y2RhlEQsAYaGJ3zaBH2RHax7ijZOgDRngpBDmj0Er5L9TV7ThYGBAQAAAP//onrT5eqJ47Zz3OKmSb5h1xFm4Gb4C+ocwabkweA/0uQR8vnmyFvtIG07+A4exv8o4zaIm+iQmjwwAG/zIDZpo5cnEGcgDvJnQtr4jRgVQEr88IwIPZ4O4hZm5oOPQ3scfI0f3LwWqKCudZncMHv3/i33n7MpCxgZf/gzsfEyM4BKatgBp5AMxvj/P2hfCTc8DBhhY/ygNSofn99mtFmdI0TnRA4BsGYTUnMD1lhBGvdGTr7gcEY+xRCqD9F/QirqYZIUjKEzMDAwAAAAAP//otou7w+vX7CvrKpv2eyetUXsFbPOn39/GZgQhyiC1cDvKoV5ALqWnfE/bEYR1lKAnXUOSWpMUI8i/Aq5RQ88woC0EAsCGJGaPf+hZ60ghqkQ+wAYEevQERUEnIG8Ux9ZAmnvAsOv/78Ytb9IKm2KLFj89P5tOXLD7v/DWZWMjN/9QRdn/4feRAuzkgmaIpAXtcEOT/3/D6Sc4zKj1aogIVGlW+TaTwkAzcHC7xZCGklAankjxKCL3+BHmoANgGyxhFSe0MIINnkHLaxgi/vIvsSIgYEBAAAA//+iSon+/uUzvtWp5dP+7r0byfefi+kfEwNSOYg6QQCrouBDegzICQlJLSPsRmuEPLyjAt8ahjqB9B+lCYJ8rTtiBg65zciA7AbksQLkoR/khj90JxHsNK//DMwMv///YWS7+19vZXjOuhf3boVJKJHWjHn37LLqv0uZuQysoJIccUsdcnMN0exiRApTULJhec6o1REkJK58lxQ7wfa+fsLG+P8naAID1iSD9GZBrSRoiwheyEImbuB1IzTncTF9u+X963oPPwMr6AYe2K0nyEOIML9A+1lI+xkQo16IGVR4ExJpwAVlxxf6OnBiAQMDAwAAAP//ojihf37/lnuCd9QCias/A8CX2zEgbbj9D9sqhdTpgE+wMMADBXlyB7GAC/laFMQSWdCFXLDjPf7/Q67akJo/sKEUBqTjNdBXRqKcow7brQjZEQ8+jwa5wwRva0K3fcE2VMNGckB7WW/+MJobmjbn47vXvvxCol+JDb//b/YEMLIL8/z/9xOaTJhQOunw5Qz//0MrMliuZ2JgZJO8JyyhTnIif/PiturfY34bGJn+qvz/z/gX1DT6Bz6U+C8Tw1+Gf3+ZmJj+Mf1nYvz37w/05HlGxn/Mf0FXdICuSARvLWD+z8bIJszAyMwBWb4IbyrCmnlIo16wcgK+WQfW30It8eGJGdxEhPSxEFvsYAfakwEYGBgAAAAA//+iKKF/ePWcaXvnxEbhq5/9f/9ngjetkDuaDP8R9x5BIgj1YKP/8JL4P3xjBTwhIh8KD03ETAyIzg188RTyZBFy0wR+/C1qSc74D5HIYW78B1sA9u8fPJMxgm/FRqzlgkUm7MpHWFUNon7+/8MgdPuf3cFJs3IYGBg6iQ3D/9+eGPz/95sRsTYEqaqHqYE1XVBqmj8MDN/uqJMTb8yvtvn85RRXh+wlZ2AFn1mMsoj8PwMoYfwHbWIGCyHFJyIa4ceywUfAofph+2ORXI80CAARRxSGiDiDqYcW//D+GWJpAMP/d+/fMApBJiiJBwwMDAAAAAD//6KojX7j5Fnv5zN35jL8h41qI3ZuI2YpkScJIB5jYkJ08hjhKpCaIf9RF+wjH2iDah6iTfQfJg+1E9bmg9UZiOiBDmWinOeCbCZSoQHf1oU6tIOcBGHamMCNLSam2xPWVd44flSP2DBk/P1OiQl2lDS8eQaLFqS2OaJzAeUzMf7/90Po3csH7MTaBQP/mFh5/4OHJkF1I/jUCVgVCi0jwA0V8BkOSKPZ4AVMSEPdkCOmoYUY0uAi5HgTtDAHrxFCbprA+lywzIVc48PbbUjpBpzfoKUpqYCBgQEAAAD//5xdMQ7CMAy0I7ULgqqfZe0j4AP8pQufYehYFRkR4/O1LNCxqlQ1iePzJbnL7kCfpsfhPlyHdmla+arIWbAgATu+5EekihXivCaicOu1deAJk1uuBi2/h5LJ32zNajEAzERDSURwu3U/g4UbE2mOvIo2RTs7nsbL7fxrP9r7lgKSGfqPhzMBd866IfXcTdGn2vy/MYw2c3UUiokcTYGPZO4ee4IHnkG55WfEP+gW4ggKgeBRWYeTNtcFXom+dCcrkiQes8A1KUu/I5uLiLwAAAD//yIroX9484Jx56z5BUy3PxgwIl21Au8dMzIgXPsf4WnwvURol83CjjZggN1DBF9ViNiuh2it/EeJcHgJwoho08NHeBiRS3SYBqRxcybs4gzQlZL//yNFOPLqSHhTCbEBhAFpvc2vf78ZPmw743fj0CFrYsKSkU3o0T/QLXywIUNGBvihSbDRIqR2AUrCB7WvGVh5SZ6wAt+XgDQBAU/ssA4h0uYH+NWHsESOPM8Bn1tAMge+KAu56wwrlpDKfVjagPd/EE6A9UtgGR1iGvT0WnIAAwMDAAAA//8iK6G/vvPQ5G7TwkoWBmZmcML8h9qagPoMMVKBVDqitD6hB/nA22uw03SZ4F19eMAhmiBIh/UjBfx/uDzMaNQdTv+RNnTAcw68mfMPrYkCHdYED0dCMii8dIUmOlhEwfsMiAkSRt7/PDwrEvJmvn36mJ9QWDLyqByFH98MX60Ar8NhLQlEykCE4n9GDumzgsKSJG9GYGQCNcERG0mQm/8Ia2BDqZAkAumLI59ahogPhAGIQgZWI8J3XsEvWUB2B+JcS1h3C1ZIQibmEEfTQda7knmHEQMDAwAAAP//Ikvj2TWbo0WZRLgYmBlQL9JlRGRJSNygXl2CWDaLKJ0gV56jFar/GRFNC6SmDgP05C+Udit88dZ/JPWwZbywC3Oh5wuiZwR4S5MZ7h54uQM7Ex15mQLMApT4+gd3I6yw+/P/L6PsWz7N63sPehAKSyYxj43/f7z7hrzdDJ7hEY6FrJdHCkvwHJKg6UZC5mMH4M2dEHPAk06IBAarCWHr/xHtGoT3EcuHYNeoISbyYKkBtPsLkhQgY7GIhAytrRBFN6Lmh8UBUgaE95PAfDK30jEwMAAAAAD//yI5oX9+/4b15fYTXr9A2+j+ws5jZIB6lgElYJigw2Gw+GFCWdiAqPYRkwiwRIs4xQsxQ8kIH1dHLLtlQGojI7W5kTo8TPDSCil1oh1syoDUfoQHLNKoEHKnkBHpvGU4CW+iMcBHi37//8d4Z9O+YELh+Y+R4z6TqOMCRkamv9BxNPg4PiPUbbBwYIJvqGX5//f314tMkv5LSY0/iPfh5wJCT3mDDSIg15TQsW1oqoYtn0CMaSMCDLXriXbgKtJSCohyyNk9SAU9yo1/yEcVwco8mPuQpwxJAgwMDAAAAAD//yI5oT+5esP43/0PygxIaQvej4O1zRnhtSJcHtJt+Y/sI/ieTkSAMcD3YUKOUINO08OaFtBMAWvDwUo4RgakU3iRzEfQcJORm4nwZhDy6BCiYkZe4QUbdkQ6Mx3pvEWEIxBt6b+M/xheH7jk8vr5UwF84SkkKvWfUSm3goFbbQHD398/ka7NgBrLhMQGj7P/Z2RgPcVivCBISEz5OYnRBzGHkQWpnQ0NCTRbIRkaNpyKlE6RDymCTdrB+lzwvhZScwRpCReoEoH0v5DjHVGDwsxHuBNxVSa0diCvjc7AwAAAAAD//yI5od87etyRm4mDCeYF6LlvDCgG/UckZGSrmGBXjqHJQRI8E/RgSaQhSgZYMwjR7GBE7q4jtRH/I00kMSJFCPJoEPJGa0g8wdq/0BqREdVNiBgFNR2YkcyAWQs9kgE5NcBqr/+MjNzfWfnvHTthSChMhYSlvjCr1WYySrg0//vz4xcD6DgK8Frk/+ASENK4A+3NBa16+HOOUX9ihKCI4gNS4w4ePVAHw5ZHQLyO6FzD+79Iu4JQhlSR4xVpRAbStoZue4PHBCI8YWexgws9+LU/sK4UYqIMrB42xAyPBtRZbJIAAwMDAAAA//8iecLow+UH2owsoBGxv0iFIyNKrccAZyINxaEttPqP3MSAJxSkXjws4SBOYEUZNkRp58NKWEbYSAniSA34ikVsqxVhy3mhO/xhF5AxwEciEJ1P2HEA/xkQndz/0BhBRA5qh5eFlZ3xw637psTsuhcUEvn9/s2LTgZenbP/X+6KYfx235bxzwdp8NwWE8un/1zyJ/8JmW5lEnNbJSQi94qCOAfdSPkT1hyDryuBJjLEBnRE8xCxUwgpvBH5Hd5hhBUKSONliJoa6UxNcEcf+epJpCFM5C4caBILfoY+OH6Z/r1/95pRUEiUtCYMAwMDAAAA//+UXcsNwjAMtcsIRWIHdmENhuoA7MAiLIC48Tv02NTIws95OSCRSL1FPrS247xnv3Y5+vx+6elw3C8uLC9DE2XGDm2WfQ0WODpkL2plUeHACkRp6/BANghuQ1mk1uYLBJTyHla8BZVOCEOyynBcDtbchACli9nAPTg1i/Pbd1tlXeRxuf5NHsUA8zkeed5v/nctLbop23FnIlPP5/q5nAfNso8h1KypcW8h7RWC279tDzT/macoseEABfjU5RzvKgkx34rhgrQNHU3K+GEv2g06l4h8AAAA//+0XTEOgzAMvJalM6JT/v8sxNap6gxSISip73J0K1IzENY4tmOfL85Pir4u8+39eCYEJ/uwUiUubdZlZrRnCwUduddnTKiT0Ly0MFnTvTCMa7ML6xPixR0cHsG95KzGvzUHkDCNTecSVujyhbSQY7OxyOJHOWTgZW2vabyf3Bv0Q/rLzf2ANuLPGoyKTlJbdbTwMWKMQp1gbYJJougJ5Pxbfx+CE4zfJWdzdlT4Okz2DlB8tqF8u9yf8OYAsAMAAP//tF1BCoAwDMt+IP7/lxNBESZuS5p5c6AXL4JrkJm0WfuJoyek5cx55UqVZTDTlr4PPaCQhj4sLAiIKJSkg8wualNHUZssogatXHm8IdAqQZNAA5ZzfHMHkoI42nVdxmFF0cAJe2YYY5QSpIwJOLZ9qj3Dn1er67VzuiE0ydlloNJQNk/he35bwPQ/gFhPxW7U6cSOAjN2/pdJSfSn9fkJ7J/7NTceBMANAAD//7ydMQ6AMAhFoXoJ739J49AaW/k83eqgmzEOUGrhfQNzgV78mhix1Ns7RQUL0WLkW0k5IieXsmj48hmPzBzLGNU2DaXD8gECsRFhmoJtvOY5iVhoaxSwTm6PqQsyCQJOMdz7UyeoLSmFtvBetxkf/3KV9ej/4gK5MH1RzxuZCfSbOzn7tkSc9pZy7JOZa4QS7SW+QVGP9QyJ4z6ylQJ/5ehmdgIAAP//tF1bDoAwCAP0/ifWYRZKQf2aiX4v0fGysA7WDH3ERVzDDWRvBlP1jhKOJfnV5Z21Z8KRG+c4D9B1tQREKKy9ktrBT4v3Xg0+0xkFUxQ0qyteTjM8pmMwZiOKzWTJLF0R37FZOVlTTLyqaAFE85P+esgy6ervR3U/89CGf7p7CAF06KeZGd0h60deElSOlpgS9kBH6NlD3I/F0TWXPSIbvqfhhD4wvf2TaETkAgAA///MXcsOgDAI6/7/n+cSpA+86UmPalwk3cqAlVdAL0xUu3TM+Hd3j0Ck5x2iCt5DrIb9wa1nN0J2u492afxuqWGtCbCwhX8qWONCagIGTbsyI47lmXmUipeoKUTtc0TG1p9TXTLheesfV4ljsAI/ank4/UWKdgcz8Sc3ZFiCJbXMYHsR5Bhkfdb0jM2/drM0a9q4G719hTmAAwAA///MnUEOgCAMBIH//7lGYKdbPOlJDyZEorJWmVYo7+LolqgdlejMSpPnweHpk519RWFicLHZZuliGnYNR3CdTImI+LIaxpCRdaSaKV0n7CiNg3LnBXanqsYN4thnmVr3xNLjF8MftpgLPOVqgHXsENb/MER8MZv8nHyTjV9yee9gg9N2XYUooUbsxJ6F6b3u86Nv3lq7AAAA//+0ncEOgDAIQyH+/z8bs/W1JF5cIme9lAi2dOxjEmaFE2fMNtbcCdRWOHAkSk6a8iGjZrPM6vC6vO1nhYxGiLxc6fSrYs92uiaTT0hLxoCU7/J4AE4vyG6UnnlPhs9tSD/G848e3yxo7ZwgFQsmzg8sjOVjcoFwMA3dQz4XDZ8xGNseZHQiB4ZzZGpJkGc1vapuAAAA//+0XUEKgDAMSwX//+SJtk1SbxPcZSIKsnZtks111wzuKZSguUTwOFNtFjL2jAWRuAhhsbo30VehReJxr5gviDEq5DVRin7+BZUq8rO4GOZ2gXHtRLZ6sG/sqcw1JlxwJii7fLfNb23hOFmljgHoXq3MkbYAS9Wqc2Br364kSyjzbCcYw+BMJUwHHuX7/c9o2dhIfftHfoGfzbzRAFwAAAD//8RdMQ6EMAxLxMAv+Nn9hy/eI1AXRk5B19SOYWOic8XQisRxYvcRj549BJksM+FT+Tp0VoM6jGPyvEsFQWe0wBATilaiDkacKEE1mBMpaGtjmSDR9MZ9yH+k4+oFp7Slb4pXIxsX3YC0T/LBn6FSWKCQYs6uMHTvFL+1Wts84ufxf4a115f7cnzXj01zMgvjsKGJJdzDyV9NcQYDApiT90uh+wVEizEsKEtKKPMHYNYmFCrIiLvCnH9+OWX3j5eZnQAAAP//nF27FcMgDBT2S58dskK2yGreIMOkyxCpsoDbVAHlSTp9KB23+AEGLHSIOx1a6IyMBOFjTSyd6PO066e1L759tRJp2C2Ig6DEKCAomyg7ATkXNX3vCmCdda7LcxS/MboAgVHI24UFx7sLyIFKFonrvhnBnY7mJnBOU/+OQtH9/bj213Zv/LkgkbgMykrsrM6+qCIrjwaFsd6ssLlep7Q6EPr8Pm/C6sC4yI/LTKezpHQBDU5AXqUHlR1OF2YeydpFOp8ZK1LJkTAO+R3h2AFj2bELjAuuWrgL5JbT8VnFOFaFzKPoA0lKmj8eIvoBAAD//5Rd2xGAIAyjnDqOuzi227gBnto8wC/480euCk1SuGYuo7+3+CQ9mdxq2NqVemHGNE6GQBFC6zibMB899zzUxooLugNYk9CmagwW2cDU+1YMmbWFMkIf1v3NdkYdxYKbiV+F80tYk+/O5vTrPCLqHnX9qrgJ659Jx/OfN7vg9k61NNjMcCPjjAMD1C7TZneeAaTSCyke0zqRWoqdcWHH8kdEPowUzv6jGwu7fO8QFwGmJhh45NwopdwAAAD//5xdyxaFIAgE+v9PLu85yjxo1922sFJ0gGHkMxRkLuEyFCBGoTvw0acdTb20wRfaKVbZqWgjwKWJznWbcYk182geBpCK4PF8MJ9JMfZ4GU77bVjVsr80IJIwARjCbFJWvHfW8V0/l5ZepzFL8R82wu2Ne/Ee+CX7mHI2gsgy5rjn4j5+sxe0UW1sMcVZK+81JfsazDdjtFlOoWm2Ndjf32wsUrfM5DQeY+CWV+I6E4H48x8zGhE/AAAA//+cnVEShDAIQ+n972wct30h7Je7XkClECCE6Y8SAFnElszDHMU3sZ0NKaDnaRfbLJeChdEwOIX6godyIV0h6e1y6HKtrwjCnV6lFboUnWtz9vf5NuXsm57NJ3f/c1Gg4uibj26Nx7JdRhp5+ehkzehDcntK7W0CoNHKn3imUV/hlWQ+1tIACJwU5yNgBwL7UMhSG5iskAjBHll8MDe22JdBYuYCIWEg+bA28d/7/f/V6FV1AwAA//+UXUkSgCAMC/z/px74AToDDUm84dEZirbQNl3gauAkM5nUccDZdRSzqVJZnJMS1uJfA7sW617bXmtOSAR5+16EhMQG7aVoaF7NLSrGq4FXwhe40lyoC75SKJpLr3XDXUZYrMP45ul97kwt/dmixrBmY8LFuoIM5B9Uw5ILi0mvz6xj/Ej0RcWmD7vTwTsbOH5cSiR7DlKOYUgdRVFR/Uoo0vIvx9GobspjPLcWEgDwAQAA//+cXUkOwCAIBH/g/x9LY8Ms1pO9NKYHo0aGTYY7CamQZ27hP21F/5BKp1oi2sPGP9PII4Wc3GF77kvCRxo1AiI0VTZH2XsrYxTAN5No25Qkzf1ocd1U+KsSdqnMFoQweYAbu6+0guzRO/9pdZBAHgAN0OCE0xnmJce4BDqWiiegYO61/rd2trXvltRB/zJ12vM9aX1NygrhNhYG1qH6GX3Aw9SH7gWtnS59hHnrBRxdmDPnj9eLEfEAAAD//5SdSxLAIAhDY+9/5tJpx0dCd3bjRh2rfAIIHkIXdVJthZoxvWd0cs0fS3DObN/BjN4M7hbc7rIPDLd2UTCJoiJGZitV2Vhb4atdV2BeWRKSjDEBmLyOrQFuarB4C5oxNtGcSqAibuCrx/NJSgXGTZsDzSoRQf95fULrmK/TZAXysF92g3OuL2M7hRE7xQSPMM4EFDNeO48nzIGeRl+vjQsbuxTp+SfpAQAA//+UXc0agCAIQ9//mbOvYGOzS3LOg/xDOM5mXQwhrnrnInR6470Sl1XjbQwTc1U3AAAgAElEQVSZHV62ThGfuzDqWBrVaANTpwPmc8ZCCsKYm7Q3DEBre1rghgpFPxKILJ5x2ckC1dPpPLxi9KbZXzSiVxm619Z5fijFYAeLpra6E6JcRzvvJdxFeGQp3hOLahIRuIfunzpKk0f8ly8R9DOHVJ5ZBAUdUmwX+MOG/ag6gBBLhxQRN2fnkgQgDMJQWu9/ZesCEh7LunZ0bAnfQnr14tYtzrtdqxNGCNsg2bCo0c8J3gexfa5nFcHbGXF2nCyvWbDApkbnxhH+4YZBQGYScDA4Te7W/aSqn7MEeWq076X0oj+vGksne3GH88hccbguAH5SSC9rFrhuOKJm1PSskMq42Z6MCEMzmzXarD9IZ5wkRuVbbcfNr2tj16caWjoNiftMswqBUBD7CCXK5jwq8s8Do4j4AAAA//+UXUkOxDAIg8z/X9wWRgUcu8fkWlUoGzhg4OjHJ+uoXXEPMd4eQ7AUCxYmRKkqOTOvfSQrixoOG/cdTFZCmyd2vHt6rqlrvoYasHEcaLwjfDjWlce86HXQS9F5F2ypXtpqyYIHNm7NXIQeDBzsxOvufDBunouT2hs/v4525DVylaVP2ITIoKdojC3Oyb5Mwj2NL9SnoinD0jY9meMbiGOtFshqC9YNwZSJRZi0I+Fazg5enUl0xr1spdDJ5nAxQzYEK6DCuQHQPR5m9gcAAP//nF2xEcIwDJTsQAtUlGxAyxJskAXpKBmBhg04NqCg5xxx8kuK3QFl7pLzRZHkt155/caMDvm5PR5Or/NtLJKyx6lip+TbEFUJYjjRJOGQFLgXSKLoMzwj8BhQO8GYYkq2ugo+chvdbbuAK9tq87cdMksNDgBktl6ZynxM0TDeaUD6ety05wLwzsbPPniDuwNx+IFdd04uROv97kL3723Mi9WDpLyFByA7NQhlsRHvVpAwBgn0/FycZcmRs4UK18K7FzkHf2elR5U6TSKCScFIu5ifAYik1oR7wgk1FRQV+QTEDJpWb3W9LQxKbsgyaGga5KxqBnb4T9pX48nQIR52pdCedwgVfz4x8XJz/cvLiegDAAD//5xdO04EMQy1nQzSIlEhlg5W4gQcgxNQcAVuQk/NPWg4BByACiS0BdKy7Cr+oOfMwJZAOTNSRsqLncT2e/7rRYne3172n+4fLtpqfcyFDfXpKRwPUkYWpQIS68sXTA2o1llmPNDirUDFij3ETEv3zM6sUVX1Q5sOeG/aKuYa5/fUu5GU7c4ruXSR8EATqwQ5vE/MaAhOHqoqsdUaTYtrE3cXW3/uOYW0zbaWpjXMJZrmHsDfRooWf+hJG9Bhn5KzQ6guJGhQUwnVChp9hElgXIesuA3hyU3jgrWZ3TCKz07mj5e3N9fz08WvWfvL5essnu+uTFdnCbNID3DsZph35dEI4cjk8GZSP3g0ickRTBeiKVU/WuHP6UiIQdyJApI9EAvOVSiBUGT3YF3kn6FkB9Q8EZ98+BQYIyqpMj0aTk2LSBgFJ9Shu778KsaCIotiJKUF1U3+MHdhPMuWorbuZ8SJUQIR6zg4fzg8+ocCAhF9AQAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8iefXiKBhe4P2r58xfHr6S/vrutRwDK+sPbkGBh7xykm8EhMXI3rY26AADAwMAAAD//2K8vG+PyrWFq+NZGf8z/f73H3wCG2TVPOTCcuZ/zIxfGH+zMHFwf1XxcDquoK97WlxJ+T0uz1zYuUf/6vJVIRwMDMx//zMy/WD8/9Kno36SkAT+a0oWJGfl8/77J8gAWZv+l9fCeIdLeuoZZDX7Zs61+HjsrOc/RvC2WaafDP8eOVUWLZJUV/8BU/P4+lWuPR29qVwMzEJMTKwsf/7//ano57nIIiiApFvcjm7ZIv1w9fp4BgYGTiZGxNVSkLWn/xiYmJj/c4lLvxezMTmnoKF+UUJF5R2lEXxq3Xqpl5sPZfz9/4ftDyMTI9P/vz+ZtRR2+5eVHMan79Obtyx7GjuSmL7+UgKt5v7L8Jfh699fD33bqqcLSstiJNhP718zPz5/zXpre0/ux+O3XfiZuPgZ/4FuWmcGLWL//4/93zN+V73NDhmpc6W01M4JikriTfQH5y5wfHX4qDPo6j5mBqb/3xkZLrs2VawSk5HHG+ebiqvc/rx7Z8/EwApay/1L3M91oXVQ4F2UMNm2Te7x6k1JjP//s4MWxINPMQBv5GFkBC/JZvjLyMrG91PJ3em4ipXZSQEpqQ8YFjEwMAAAAAD//2L58OSZydvN1ypBtyf/BXkT6cp12C4rZtBum///GI4vPfJ/HwfDu7VljbPsC5I6RKRkP6Mb+PrpU8t3ay5Vs7Kyg5eIf/jz9idTK8M00AYlfJ5+tuVsi/BvTm5wYmJi+v+ZEXyAPkpCf3HheuTP7bezf/75yfjn31+Gj0w/f/7J/baKgYEBntC/f/rM/WrdiWYBFlEuyCYIZoYvGpqgRE5SQv9876Hbn23Pmr7//Qbd2PMfvlEbvHmWkYHh7b9rDPcmb2Y8yPrn6yyXyCNKQXaL9Py9t4pJy30ixS4YkNLV/Ls3sy2D/ye7COQEc0aGDxsOZt44etRdw9r6HC59J9ZuiHmy9MhkNkY2VkboyTtsbhqzsSXyUzt22C8Myqj5eua+jQgLHzsfmyjDv7//GBiZuWEbDxmZ/rBIs+58lrF1c2GioKfBplsnT3aKKsldEBSVxLrD5+25S0Gftt7P+vX3F8Pf//8ZPvx+9+NnddF6QnH+/MDloj/3PriCXMzOzPqfSVXxPgMDA0pC/3DnvvX7jbdrf//7DT85Dxz80C1LkFN9/zE8Xn6EYQfL/48zg5L3WxfGt+vY2p2GG8LAwAAAAAD//5Sdv0tDMRDHk3vv9YevaqW6ibgI/Sc6iTgUwUWdHEQnB6cKSgdBELqUDi6iCA4KLi4WB6WdpC4WF1EXEaUFf7QgKi59yZ1caAfbQjUQsoRLQi6XDPl8DwzLoMgipS1QJhywVwPDEcBMg+Z/+Mp86ffbLvR5bqS6nVvZjE3nSne3Q82TN/AcK0JpBKZYAKVfQmdtE9DIc2AJLo4pHFtaMD/GEMhDEJoANIsfo6/FEK9boY/YniYLtccgk9Np/BYzUrjoKUCtQSBCHRwxlYELbhlVCNhB2UvdIbosjT8mDw/2Y7PFi+Ns/L/jcRkcib5G5+I7DjmcxISDjhwQ/ZFCZnf1vfLc9plZvrkeLiY3Uz50HFIoqabgs/b1HUsspJv7HqXS84WZtRP7qjoaBjfgoZbE126DzjSQL2d6QFlTnuyx3ADkH6ayY4vnp5mtjY/KS1sizUawNO8dY2ece4ss/1+0D0ihz+wlMy582AzZ8btISQaSYf+TjURXyIQT1n2FpSdJdlmujGAoLPL3k2cTy7m9pcT6W/kpaKwJIX4AAAD//5Sdr0sEQRSA37zZmZ07sYhoMqlZEC3+AcIlq6BGQbPRZLJ6YlLbBrlmcoNyIHJV8W84i+ByxaCLM0/mze7qLQenGyYtb978ZMr3PSz1GZUXJBIU69hqZVysGk5qQ0rGzDOF8hrkaSKcG5jV+/blfj0xW0rRinguJDZ22JWiolCRiZEzVXNyM8AC9UNUQavMj4phC+FfP7/cfIP/+H0IQZIUimSkSaOmAI8F3TKDRs4Kk9nF3s5R0ktvNv7dKQCs7W6fv0A/w0AYgt9w2e1j6/1tMD/q/4fO9dasnZoJBUEESIxoen0pXVheGQL4rk7bm/3jzokReqKgYAPWSBEoqegz/3B5npMW2uNxxBwj3xlffhM1X8/Sg+e7bmtk0oLIg0el7gLRvy3HP/ERC8fxbwlDPXRoQtFotpABKYyoKRvOSG0VshU4CA4lY53CODVJydNh9yLZ4yAA8A0AAP//YoHsbYYdyvn//29OhndqVQGt/xkY3oCaogwMDBzfHr5Su7PuYBjvm3/S/0CmMv5n+PPnD8PzLcfCPrx8XiMgLgmvopjhdwLBrrtAnIKBD0BOV4DeeY96AjMiYBgYEDvH4RkDPXz+w/fTgnfGMSDuJyIFgM81AhnODNk//+ffPwZxd80d7Nw8TxmYGf/9+/WH9evnrxIvzlzRYf30V4qDiZ0JstONkYGXgUvgcGTt/NObN8eY+vpuI8VeNl7uR+b1uS2365f1sDOwsYA8zc/Az3Vs9pIUBgaGCmS1714+5VloFxPHAapxIbdrMHz9//GnXVrEVIY18+DqLu7aY7M3vHwaFwM3N+xiLFBb+ivLj2+Cdpp7ZVzMd0hrq1/+/fsv6+sbt7RurtwTy3jphQkTMxu4YgHtxeVg4mA51Ty35e3TJ8eFpWXeoCRGUGkD3ggM3vMJLtiIO3ESdroD0gEy6AB6OhNs//Rf9p8/5WvDuxgZGO+B9qv++fRD+s3FWwYv9p5z4/vDwfOf8S8jqEv1/e9Pxtdzt+W9fvxwnqis/EcAAAAA//9igZyWAzsA5x8DAyfrHafsnH50+14+vj99nkvEbuGXHPJ/wUcWMzAyffyr8O7pM1nk9i9sBzh8nyPTf5R7JvB5Gn7dBwPyxZ/IShiZ/sJPkWD8z4g4TBEVQHa9MzIww5txJKd0RvhN1JBM+OPf5/+mRSnJilZmKPfvf37/hu3WyTM2R2sm9XHd+aEHaUv+Z+T7yyV4IL9rwpsnj46IyBDfZhcUk/z/5f3bqY82H/ViPP8C3H4Fbbp9tHRPytObNxdIq6vfgKk9sXRtDOeLP6qwvA3awSqS4DZF0Uj3CEzNp3dvmBf4pbRy/+UR+McE3gsNjpJv/IwPXRd2xug6Oh5l2LAQ2Qn7P755Oef8nn1ep4on9fN+YZaDbf7ke/pHd05idu/HN6+S+EXE4IUbKJ7hpz+AD6WBnw2BF4CzHCiDQo4JBzWbsMYDbCc6KKJ/sDJ+tkmIaeDiFUAx//aJEwZrw4pW839kVgY3c5iYGPg/M8qfXL8xkIGBYQEAAAD//2KC3SvLCL1l498/7BfFiMsq3tGLDV79++8v+HklLIxMjD9fvhZGdRjiqBRQyQ7e1U/MRQX/wUfFws4qAY28YAYUKAuDT9aCbPJlwn4M1n9w/5kRtnsX8+RyosF/2BVkjNC72hn+oGvlFRT5ZezhsS9s5cTwpyLvb0GOwoWcfSPwjlnl7MYtJLfXeQSF/2glBcz68/sHNKiZGAR/cgmtKatt+PjuJTgwv376wH5/4fY0+Nkf//8xfBFhfOBfX9EuKILoNL6+d1/t98VHlv9AJR04Lf77/5Ph13/j1rRScCLHAvhFxH86RESuN+nMKgFdXwcLQdAIB/OJx2HP7txRQ9YGPcUddmIR6HQH5AO3cANoIQs7LgdbExd2SgfsPJh/jP8Y0RM5CKhaWFyw6S4o//3nO/z4DkYmZobvFx+YMDAwMAAAAAD//2L6BzlYBX7cMBMTA9ae9Ye3Lxk/v3olyvgfdvAjaKf8v3/s4iJPUFUyIo7T+Qc9suYfEQUq0mb1f5BWB7bcwQg5DAByKtE/Bqx1BeM/BvilSQyQ7EF60wV6aB3khAHQbnjkc3SwAAll1Zup25aHfhX8+wTSoPoHHqm6v/lQKMmWMzAw6Hu67vgjz3sV1jz9/f83w/c9t/yeXL5mCpI/NH9pwu+7b3T/QSo38FnT2kkBk3kFBVGGOW8eOOzBx8jLAj/nhYGZ4Zeh6D59T+ethNxg4um+9bcC142//0BHMUAGnIVZBdlu7znkjqwOfNgT/GRe6PkbRIQ59AxWcPzgaupAeqDQlg34gFTctbOamfnBrwyghA490ubff4YvT5+JMzAwMAAAAAD//wKfDAS7gxN8fgYTEze6AaDe9vVDR2MeLzoQBrprE3ru4X9mVZHzgrLSr1E8DTmEFnrOISP8jBpC4D8D41/YYTtIJ36gepqZEXoBIqQR/4+JEeWYc5gPmRkY/kIOngJf0AU6hoTkQh1+nSTcWCYG9GN/0IGUmsZllXjPeZDyCVydM346fdvxzdMnJN8ezS8i+lW/JKbj37/f/8Ang/1jYhRh4ec41j2v5uH1a1pn62e2cDBzMEPOyGH4/1Hk3x2LxIi56Oa8PHDeAnQ6BSxIP/759CdkQlMJv4gEJEXgAXzCYt/Vw91Wsv1ngbTsQTdh//nJ+ProZVtkbbDbT8ANEHCiJa61CmoAg0ZcIOkFcjIMuhrEKWXQA6vwnEr39e1bBSbwwA3i/ql/oNEyBgYGAAAAAP//YmGEdqDg9z18/q0xPT52NQMjw6O//xiZmBn/s8wMijNgu/jRgoeBiwVyYBHD/z+MP37pFqW2oo+tMjJCD0FlhB8OSfT9JpB7iuBnH2Fogl1iATm+7h94wB3D4/8hAYhyTSz2IRwCAHqeCdL54cRkWSlL44P3utczsLJygPWy/Gbmf37thh4DA8MxUl1g4Ou1YXfX9IvKz9kMfzD+YvzN9J/x0/6Lbrua+hXE/wuJ/IG2pDgZ2RjEopwXCEvKYMxrfH36Xp0FfHgQpNpmEeN/JayodJlYN4irqh6/zfiTgQ2agEAV7acnz1BGgMCDk+C7NuHnRBPXYIR3niCzFEhXKSCUQKsJSLcNVFdDrlpGBx/evmZbnFFcKcDCB2+SgJzCKS3xgoGBgQEAAAD//2L5D60a/kHPGmT9xsDBsuFJMPg4InAD4j+D0D9Ght8MrODEBa6QNUXOa+WEt5p4Yan+kK9ogzasiOuMIh0viOuaCPhZxUyQE7rADS/0lhb0Im1IEcQIuYuInFNYGcGnpsFu1vjH+IeoqklCXv7GL2aG/+yQRg8DGxM7w6MTZwzJSegCouJfLx48VLjbt2ALNwM3z/8//xkFmAXZfmy5rM3KzAbuVDEzMf1/yP3uUVpC6CKG5hoMM/68/CDPDD0TDRRmzELs73j5BYg+2k1CS+XGt99fGFjZBCFFCqip++aHFLIacBMS3ExFlAVE1eKQq7mhB7Vib2FCjrqGtN9BvR8WJgamn18+87Dz8H4ByX96/5rxy8vXspvqu0v/7bju+5eJDX7g0l+Gfwxi5lrHGeYzMAAAAAD//wIndAbwcWxMECczMoKnkOGzgf+QbkKA9Br+ayT7HzRzc9nBJyyO9VxB2AGyTNCTZ4k5Ch9WRYGHmphgo6bY1CGulIEMf6KaDj4fDHb9DPRaCybyCnRGiBGgDhAo8zATM5DAwCEg8IqJBXzmGtgJzAyMDL9//uAj3QEQoG9vd2ihf+Kun/vvBP2D3mPEwsQKOXKXkYHh++/vf2zr8yqllNWfYNP/98dvNgZGVnC4gsKBhZX1LSn2M3Fzvv7P8As0gAVtjP5j+PvjD8+XVy8ZecTE4YUa/MRGyDl1sAOR8QJwAQu9iByncpRTuhkZOD8xC/ToWl9qVNAF9/169V1YWd79FhFnEWZn/c8GbtuCWtcg8Jn1+wtDP8/tDBkMDAAAAAD//2KCnOSJOI0VVPx+//31/88/X/7/AOHf3/7/+/vrPzMj839QYDH/Y2G6VTI3b4qp79n9sxeGY7iLEdoRQVxPTtR9Vf9gF69A5ukY/2HN3gywA9eg7bV//9EHXiCdJugxvpDjjhn/kjGODmllM0FOzkW99RUv+P31szBsyJYBeu0KIxMTaQeNogGd9NCpX///+INUV0KvGWD6z6QredQ0LGAtLr3MrCx/4KdB///P8PvvH4w+GD7w9+8fTtC5jX+hxyiCJoUZuFg/IxI59ChU+Dn5sDs0iAhzUOSAj2uENp1xzaBDe6OgGonpPyuT6FshBfEPQgqSH4UVJD/zSwszCbP/AZXF4C43pM3849/v71qVcY3CUnJvGRgYGAAAAAD//2JhhHZroTNU/38LM7/zmNuf+o/x/1NG8F3aDIx/vn/jvX/otOftWVuT+P5w8oGO/hT6wKZ+pWjmvONrVr+zDAndDXPTP+hQ039oQ5sJcuYw4Qkj+J0BoK4VGyO2bvt/JoZ/sEQLqepARyCiHiUMv38VPqtE3mX8/6EnmcIOu4cPVxIAz2/e1WH78x8ymQ0aLfn3h0FaXYPoNjE2oGRqePCslfJuhhPPPP9Br10E+ez7n29/LcuLWvkEhH/h0sstK3Lz3623JuDpQ5DOz7+Fv318z8jFL0hU7n919boBFyMvdHUPJFKZhbkeMDxFqAHflge7SRpcA4JHsgmaDZlMRTq3HUvugBxMCr3tA9qoALU4QGXPX/BtatCDpqHnZ/759+cvs7H0HufqjEZZQ52TDMUFDAwMDAwAAAAA//9igY85wgbtmRgfaTjYrcfirt3XDh85ttU9ZwkvKy87w18GRlamf5znZqxNBcnBFDEzwPoC4N43aPiD6e+/v6Box1mqfXr7hnWGmhd0FQIT9HYDbMOLiCtO/qHcEYMWNkyI21rImf6HAcht17Ajlf9jswsDPD17xoydhZsRdKQ2yObvjF++yVmbnyakDx8AdfjPrl8/++jxNg8WBnbI5eOg4SRlwRvajrYH8OllFeZ98IPxvSk4WBiZGH48fCH55eMnUBsbKaniBi+u3zfnYmdn/Ae+0Q4SliKy0g8ZLiH0IC47hhwhzM7AzPgfEud4wZ8fP0RBU/MwxMSMeSw0bC0H/MoZBob/Xxl//fvL8JuB/R87EzsTG3TIB+Q61v/SKbar3WqK4viExBDpjYGBAQAAAP//YoLMBzBCb54AzeEy4Bx2ktPVWs9nonQRvLQGfIAwC8Pnq/esPr5+Bb8Wj5mB8Q9sxAPUtuVkYGN89+wFxuIvZPD5xSu5Pz++QhZegdqS//4zsDEyYUzOMEE7q+Dg/gcZu2VEGzmETaIxwc+gB/fWSZ8ZhV5W8Q9yzvV/xv+MONbfIMDn928F7248Hv6fATKmBYocbjX5S2IK8hQv4RWSlbn57e978EghyGusTCwMIvpal3kEhDHCCRnwGaldBU33w/o//EyCHPtnzsn+8Ab7IjFk8OH9C+ZHO455/kHMgTIwM7EzcOspXUdW9wN02jXiPpj/fIzcDC9v3dfBa/brV0Lf3nyQBY8ZQI+FZuZkxfQLfEwe3FRj+Mr161PKzU3icRdW8+p0Jqb9/v/rDyilg1ZN/v3/m+HhjtO6P799hy/mAgMGBgYAAAAA//9igo2PMv6HXxmIMwB4BIT+snKyfWWArZhiYGD8+fmrxL+fvzlgaiSkpW/8Y4bMpoFmRTlZeBiu7dgfgc/TVw8d8hJhFmKEXaL1/e8PBmlDk4uYfoZddY60SAC9r84IaT7BigaUi6dIA4zwQ/ShNSe2IU8YePngruzsgMS1bHc+6P+HLJFgYGFi/q8Q5LiULNvR/f4fdEsobPHbf+gx0rhrSRjQ8HXe9PnvV/D96LDweTBxa/6985fsCem9uudI6K/zj61AZ7TDrP3w/8NPbW8XlBpfWE35GmgAAWoBIzszG+ODvcejcJn78c1Lpt0Tpxbz/Wblhc+6/v/zn5uPD6NAQB0x+8/wl+nfLwFxibeSiirfTUP85/NFWU4Br/eAXtrE/eyn1p7u6ajDTwwMDAAAAAD//4LeJfEfPgnDwIJ7KO7J3dt2b87fMwQv1YPYy8DJz/uGjYsTvh5c1sLg9He2v+/BU5zMoImOv4xXZ67OeHzzhglWT799I3phwsqsPwz/oB2a/wzfGL/+kLM1xZieBuVKaJEGHbn8/58BrUQHdyLBPUDoVCboDnEy7qf8ywRdQYJ8wxuOZP7myUOxBVFZS4QvfnUALbCBXej7lvHjG5Mw/zWk2o0NMDIwfAZffcoEcQh4QImZcN9HRkv9EouG+AXIfDJYKyM/Mxfnzty2/jfPHovi0nfvymWnXYXt/WwMrKBRZnA/kY2ZmeGHodguSR1VlD6HoJzk2R+/fsPmQBh+/vvHeHvplqind25rYTP7yfVbVjcmrs5nYmKFX378/veH/6LaWvB1PDAArpohbUhwCwG5RcsvKvE3rLOx/ps06xXw6lJG0ApuRoa7i7an3jp7xhyukIGBAQAAAP//YvkPX5YAXfD3l0Hi9qmTcqCO63/IeAPH/19/JR6cPOU01zk+V/I3B/9fxr+QdhkT438BNdlT3EJC8MqNR0Dk27yQ5EN/dt8JAK9jZ2RkEPrMJb7AOXbjtklT+3Wd7VcJiIo8+/Thg/j1Iyd8ZtiF5wk8+6sOW9wCaiTwqcqfFlSQfoHu6f///8LvvID1ELGu6ALnl3+QWyEY/jN8f/3W+Orefdf+Q4eD/sEveGH4Bx3E+cfAxHxPx8HhNZIp/6F5Dzx0DDrL/umNGwHnNm+9+/vbD9Z/P39wfH73TuLFxZtGC61j3ITeM8l9Z/wLvSGUgYH1H/M/lTSfWZKqai9xJSZSwH9Gxl+wG40Z4AvOCLfI+ARE/u6eMWfqnfL5cxj+g+6MAQEmRsEXf/WXeSTs2jll6lQlc7P9IjKSD/79+8/y+skT9Qurt8evdoxPlP3DI/AbPOAMuWLyPef3xwlTJpfyCSAWdIGAgoXZ5a18H++LfxVSgtz68JdB5DuP0OrwnOV7li9t0TYx3c/Dx//h3avXMrfPnHXeEV9TI8EsxgVaAgwZtf7PwK4gcV1GWRFjcwxkKhwyI4q42gYBuPj4Ph9dsrzpfPbE5Uz/2VhBVxSIMwjwL4nJm/bi/h0vCUWVlwwMDAwAAAAA//9iYfwHm3aHdFfYXv1R3OiQcg/croX095gYGZkZ+VgFGMRBd1n8h+x9+QOux///1s0KncqwfzWK5ebZ0T2791R6sDKycTJCZioZRT6yST6uWz6fZ5sAACAASURBVNV1qXJGJwM72x+GX79ZBJn5GPnhwxmQxvef///+6JfEdvIKYLlPEuQUUOL9A5v1/Ic55MfIAE2fsKukGRkfzdydfnf69nTYdbyIZb7/GWCDNH9UBEDVcTDcHPC1MkwM/39DxtJ5WHgYLubPmAFbAcfCxAxa+w0efuRi+M/4B3oJBKij+IvxxxfOGPN+17KcNoaeFkrTONQ90LkF2J0/JHQ7TEN9lj178EDm0/Q91Sz/2TlB036gqXe2h7/0H9aumXX1x8z/P9mY/4CmL5j+/GcWZBVg5GXgYvwNHpSG3Ijzh+nvN4vuggI5Hd1b6OYLS0l/Prd1e+GB6IalnP/ZeEFr6n4z/GPkuP1d907mzJWnfrf/Y2Xn+P3n5zc2fiYBRk4mJoY/4GqJGdwU/cvy55d+cVQjr5AoRhsdNtYFvjYGvAIRs2zT8XTccNlx22bmA08C/zL8Yfzz7x+jzAsWw+11vW0fXr9IFRCV+Adg7exVGgiiKDx3/vYnu9ndrEqKFBY2IiIKUYuAEEWQgHZCRDRPYGklVhEtTGFh4QNYK9qJ2IrvIFiJoG3UEHd2ZGazi4aAjfcFFuYuzJ1zz+HDKVlM4gw0Cw7zicMK1GU+dbmPc9QBIYW2DiU/kkQOM2S3WrqaWFq47f9waXL83lifPc9hLoVe2ypfN1YTBXjUx15s8TzO4zRfIXsmLZMw2S0P300tV28GdgwSVTuVDhVHpt8CoI1YOmgF2TaQYQo2s8CkNjKpCQY1gFMDDG6DySwwGEd+YajvASMz/m/C1pFACQVGCDBMtCgm4iiLfqhpiSIi2/Ljc+ywsds4be17I8UO+qeC1MnX47r8ZKz+VX5Y/No+ah64W5VjRtWxp7hKxZuKwOYeDpDLPXCYy/I40pqdXoggGQvJMIpy9blWZbM+SI3TNVNbuQ7r8yeUkASxpAXJWCN/AhoQV1hmQEKMVRa2R1HTEyaJo/fV0bPyWu1yYMvVHakwO9qTlXb4d3lhUSzu7TRfOs9tPd5IQEJIeLt42Hh9fJpGCKFvAAAA//+sXb1KA0EQ3t2Zu8sVJkqCQQn4AGpjqU2wEgRNEEErQZBA0mlUENEg+cFCJIWohZ2V7+BDWPoEokHUw0SNxcjMeoKJIIIL11yxzOwss3wz3/AZS9o2xMjcaLDKlRpIxK40WiVNZr0qILQCWPTsv914y+O1xXqtEO1LdtF6Y4kBmt8pbkYK6b2m377zeRqHkbH6rIKHHBJByqQQPAp0KzDZ0bOFk/2VWLz/x0oC2wE8wWoMIbhEfKidjtu2v8xPG7EZlTEo/oB8QFqjNMCYmS3/wVUU+V7lYeUdaT5pJASUs5EGjUa2Q1IdGJcc7RDPFwX+6607M3I+eVGempjLnP7XBf9yiyPAYkAaxHZ+Tf4KsrPba9VoLl1+gmbDQ45JiOdDbrjlX0gXlRQ5GqiV9K5TB0u5TKlY+W3/6a3VqpsZPn5UQdMxjn2BQkIZJ1KevLcQnyKIFMDL/eD6bDF/WN/oiXdnc7s48XN1QzaiUFW7cyWGUldjlXypTe13AxxTpF6MepeVo93goeF9AAAA//9i4ZaVOC/irrMUUo+A176CawuQm/6BJ+OhezJYmX9wyYk/4NOUO69pb3dYVE7hA0N3M05Pi8iAh9Qant2/O+vM8g1hHy/ctvp4+bbet4/fJUCTSKDinZmD9ZuwnsY1Hl2Fo65hPksV9AzuMcyZiNtMHeV9LG++C/wFdxX/M3Aw/L7Pws2BMhzKwcP7TczXfCIXA5c0E7RFCyv9/oAutPoPX3j0HzJ2Abkpj01b+hDDDoQ5gkpyx7+6aczn/P+PHXwwAQNsChBck4Obiyz8HG94VGUf8CnKXFSzND8tLC37mWHxFELpgSzAzsP9Q9zHejLPfy5pyPVxjP95dVR3k2IWv7gkqIapf/ng/uSzG7b4P95wKObj1Uf6DF+/8IEb4kyMoCbFXxZ+3hfiZvpnxFwMNgYGeK0RkpIDryshBERk5b9/ePUs53PZu54Lazd7vzt5x+ftpasaDL8YecAXBYK6dewsX8TMtY/zmmkccvFy2yKrofmYoaoEt5sV5S8IuKov+s/wlw2UHHl5mD4zzD2JoQ401/Dx1YuJvz99/fP3+gtz8K1r4Gbk789HNm6VAAAAAP//In82ZRQMC/D53VvWd3ceKHz68kGa8T8jM5+Q8AMRVcX7XDx8ZN/pOegAAwMDAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//+i6/Di83t3pC5v3eXz4cpdo7fX78p8/fSJh/0/4/9foNOoJKQ+cqtK3FawMz+kYWe9T1BM8iu59pzZtEXt3cPHJoz//rNCtjyBF8D8YZQQOO8cHnGVFLMu7Nwt9frqbSfQVgrIMDoTdGM2aE8taEAOvBcMdAjjL1Yeji9CMlIPpTQ0bghISOHcDIEO9k6fbfH31y8V0PoGJuheW9gREExIO3fgJxLAlshDt1l9+/PrqXWw30EReQWUybsLG7fKv34AWn0InshHWU0PWzMEXukEXTQFOz0KNlP9n4Hht6yl4U5Nc0uUVYUv7t9hPrd+uz87MysPyuoTJuhhKOCj/P4zsvJx/2RhYfworqF8S0RB/hGfKOJEN7oCBgYGAAAAAP//onlCf/fyKePTq7dsT0yel/PqwFVX0T+8/H8hm7Igewuh26fA60TAayR+//8mynRHIcZjsU1c+FxJJZXnhG1BgDePHgpPNnQ7p/BbWvYvZA8seJcTEwMj00OGt29ST600klbXxLq/EhtYX1jd9GnB6Zrf/3//h04hwjZgwJcOMkLXy4DOP/nx/yfDTx6G16KmGocUwtwWGHs47+QXlcS7ZnyqnO0N1vdMauADNWCzXNADBcHz/kwMSDt4EGvuoXmA8eu/7z+913eaq7o4oCxtXp5Q0P5p7flyxC4ehGb4ol3I+RSwnZ6wY0rAAmysbP8lG/yj3HKyVyKb+/DUKcH1DskvuFmF2KCuhZ14CVlADN0PD3I6KD7//P/5/zsf40MxS92DGkGuK3TdHPfwiUjQL9EzMDAAAAAA//8iuAuEUnDt8PHYQ0ktU/n+8vMIMHIw/AOvfGSC71ZhAm/Ogp0EBVlsxPPin+rnCXubZi7fHvzszq0gKRW1+8Q649apM9bCPwVkfzD8ZASfEws6t4CRkRk0zSvLICxy7cARF9ARZcSa95+Bge8XaPHC/79MsNW/0CQBXvPDiHRMB0iSg4GDgfXbf7EfB+4E3zpwJ+Bq6JGuz29fNfEKi/3EZcdfpv98//7/ZgRN8SMW3sLPRIaW8NCFmTA20lztfwYmts/v3kqAjllENpeRmZn5H3j5FPh4d/hpbIiDA6FrC8CLxMBHqkHOvoT6kekPw//fv//D9xogwgR0ZNk/ll///kDyBHyDC2RhG9gb4M3bkAUl7AwcjBwf/yv+2nNb4dyuq1HnQg9N+/r5fQ03ryDZtTZJgIGBAQAAAP//InmdNrHg4+uXbGt7esuPp3dPFmHg5WZi/ssAPk4OcvQVdIUS+LQvyDEa0GPVoEfgMv7495tR4hmz/vLYwlUPbl3Du1sFGdw/cMKLh5kbbA94eQQDZI0yeP8m8z+GR7uOYD8RFgeAJOT/8MVEkAIdsqccchIJ+ERj8KpFsNeYICu/QSs+/4MOxl97qXR2Ut7SF08eiOC05B94ehyxW4qREX7sHwNsCQN0UfJ/KM0I3SwDUsEOWif++ycXhrmQJWfQ87MgS7FBVoDWbYPtgy5bBfsPfFoDZJkc/IBbUP749hPzyG2oM8FHiUBrC5AZMBqyrx+iCLRKCpzPIIcoMLIwsLIxrbqYO8Enfv3T2zdkSE9ZZAAGBgYAAAAA//+iWULfOWV2zcuWda3cv9j4/sDCFNq4BC2s+v3/1/+PDD/+f2L49v/rvx////37/Z+FkQlxKgwonJj/MnJf/2K80jlxx6ndu3UJ2fnu5TOex+sPBfz895ORCbqKDb7xG7xa7i/jq72X3F4+eiBMyCxkAF/VC99Nz8Dw+8/3/z9/f/3/4++X/z//fPv/7z9olR/zf9j+W+jRv4xMf5lYBQ6+DNpU3tH1/uUzrE1FRnj7GPXkDtBS6X+wE/7AZSSkdACtq//PBD7mCrzKmJOB/T8DqCRBN5eZ6T9yWxzaWQFvVgIdwwI9+xZ6CixofSakBIIeh/3/37+/jD+ev1bFcDB8BwoiQ0JW7f37/xMULn+////15wdo4zpoMwRkQyfSSktGRiZmsbPvXDbl1k75+OYFfBsmzQADAwMAAAD//6JJ0+XZzRvKi0yj83j/czIzQs91hu1FY2D89+8+7+eHNllRM0xjoxaz8nC8+v7mg9LJpauSz0xbES//TVD8D/hMC1ClywjeO/GF+ddbfkEBjFOo0MHji1cM2T/+EfvPBN1+yvAfvp4ZWkQxCPzj4b926IgTAwPDakLmMcBPBUMkQFDt8+v/n/+Kxf5TeRRkzoKUsDAwMb64cVP12rZdHkKPmbTZGFhZ/oOP2oScj/f7/1/GN+uPRnysfAtaBYfRDIM0hP7Dq39QOP0TYv8iYq606u9fhm+gpMfMwPCfmQF63iQjZP3d3/9/wKn9z/9fn5nZ2M6gmwvOJtDqAXZbx/f/vxgknfU3/2b88wCysBB6JivoqhTomm9YjQW60oFfWuQgFvdC6hTYtgDQHlZmlv+MtpIXtILdZ0A2aDEyfLr3RPbeoQOOP86/MOFlEuRkAB3aD22egeL495FHnnfPXTJgYGAAhSPtAAMDAwAAAP//oklCPzR9YZbgP06+f0zwMw3ATZS/jH9+KBT6NkXmpMwUEJV4x1BZDtMCOrS+4s2zx3072/vq3y08lc7CyMT8h+nXN8kku8mRZbndguKSBA/eubXviCcPCy/DH9ARbNAbh0D7vRnABwqB1u3+Ay91fbDlkC+xCR0M/iOO6AGXq6zMDPKmxiv0fb1Qtvt9efO6/uL+/UEns3pmcvxg44Pv0P7/n0GMVYjj2p79rgwMDLOwmA85vhB2tg7TfwY2JaEzEatmpxDtxg1LMIQQa/dh/Yh/DD8Zfv53n9YaKygpRtxR1lhCCXLwKfIB/pDMwSuncNohKQHFfx/fv2l6ev26xfa42kXcr/8rwdaOggpADmYu1tvb9ofQPKEzMDAAAAAA//+ietPlxd07Ko+X7kn8xwTt5ECvuWJhZPorXxLQ4NdY0w5O5FiAiJTsK+/a0gKBWPOJv+TZT9gtbQgJ722rICaRf/zwlv3RhiMhv/7+ZvwP3Xj06++v/4pZvqd+/PsBudIAdDDMfwbGZ3tPu7x9/ATnfklkwIhcTUMPWALvJvjP8ApdLY+I6C/r0LAVqtmB01hZmOHNMFCrHXQGybujV61xWQM1HJbqQW1rijtqTJAkCRlnAXWkQQefgvpEf38TPfSJDcBOzoIPg0J3bf9lZsQYXeIXFPmnZWV7zH16TdrXf98hx6hDC40/DL8ZXh45BxocoC1gYGAAAAAA//+iekI/MndpEvd3ZgFGaDoHeYyZkeX/Y/Fv5x1ykgku1hYQk/odO7WvOP/SHksjL8/txNr78Oxlyz+P3yqDj8CDdqh+sf3+4FSbE/ZfihfcXICec8Ag8oNH/OCipTh3qSMDRugJSLCD06ANWlDxiHMHvoKF0e4P318zwMcDwae6/mH49/4njr4B7OBMeFuAAbLRgDIAXpL9H7aHDDY2Dz+3i2wAG2lCHA4FPSgKz+GU0kY6Rz7x/nkG2sAC6bWCRncYGX8/+Sz/+d17mvUVwYCBgQEAAAD//6KqBZ/evmS5vHJjECsLOySFQA95/vj/y9+Arro2fiExmgwnfX73mnHnhEmZwqxCjLDjk0BRzG+udYKNj+ehlIP+HtCuHNg9DKCdcJdmr0p+9+IpxtAZOvgHOx2BETGWzQgZg8OZENmYmT+DzpmH3eAB1vOPieHbl0+Yl4uBAfSepf/wbi+WK2tIB/8ge9Cg4QEZIYEenEZhJkL0bBF37eA/3UlQWOIXlxj/R9iAEvhY7X//GX59+Sj45xv0TB9aAQYGBgAAAAD//6JqQn//7KUC66ufqn/+Q/bCw7YGMsvwXtd0st9MK388v/dA99f+O/6//v0Cz1WAJ5+YmP+rhzgvA8mr+bis//73O/yMwN9//zIKv2fVunHspC1h0xmZkKZXYIOMjPjO6X56/4ERBzM/5DBu2NQh6MhCfl7sh0PBtrczwjIGIwMTCwNJZyRiBRAnwhtQIMzCyMTAxsZJ0qgThnNhQzWIU8zA4vgOc31x547st7svFUF7iGGqQBUvMwfnN2ZWNrwTahQDBgYGAAAAAP//ompn9PX1Wyp8LDzgawMZYGPO/xkYRTVVbnLzC9DMM7f2HvYQYxVm/fP3N/wAjE9/3v9VMjM7DmIrWhqe2M389xPrPwZ+yCgQ6AQxDqZH244EIh+nhx3AB5URZwD+BXemsKb0Tx/fcc1zj03hYmYD3VIHPk8DPHbNxMTAKsGH/a5T+AWasBLyP8OXy49Nmhwc5jL9h28JhtcpTOAjOv6Dbsb8rR4R0h+alXMbu7nQ2gFqB6hjwcbIydAX4L+xxc7uMsv//6CRX4a/sJMTIJOx4It1PjD+v1O9dEm3kIwslp1G8BMpEesRYJc/4ABHFq1Ml2cS4/oJngSDHJEK6j+wSAk85hNHPT6D6oCBgQEAAAD//6JqQv/z9w8X2y9WBshdfNCTmxkY/7OJ8+K8aZoa4PmBc66gMV/Y7R3gUwoUpW/xS4uBE5agiNSnOb7xx/4dfOAB2jcKGg359f8Xw9N9Z9w/vnzJxi8ujrtz9h+6SAF2YgvkPDwGJhY2BeShwvcvnvI+uXRVf2N2VRbr1bdGf0FHOyONu4PcJWJjcIRhIVZbYPM5sAvLGDm/sfByX/yXAD+VF3pOMRNsIzPo7BhGFgbm5x/OQketMA39h7h4BHYTLQcjGwP3VWZjRkYGY3hRD058sGFU0BoE0N7yT98Y//zrg0+mIgFQ9gWbDx5ogB48BfIrCyNKU/Dj65csn569VDy7cWvog0kb8tj/scLTBaiNCRoBEzPRPsJwCeMgCeoCBgYGAAAAAP//ompCB8+vMTEz/AGPgEOOS4BU8X9plmMfX7smv9wixhp0DgkDdHaRk5n9v4C3xXp+YcQJBYr+dqtvHLjlAdrF/x+6n5zt9Q+FW6dPW4BGRHGZD54KYWJEmSThYORg2B1ftaVfxvI76JD9P7//sM1W9+Ng/fuPiZOFG7xXH6YWdoHVe3Gmq0Zeblg71+Au7j8G6PQoNGOADmj9B925jVDI+I8JmvTA52WCTl75j7N9ywhJv7BWP8QI0DHajJDTaKFLAiBz+LCuCPTq8X8Mf0E3d2Nvi0D9BD5YFKoEdJP3s5X7YyfKWvn/+fuPmenPf5ZZKu6gRXUsPIzcjOz/2RhAO9NhqxpAZnxi+vbFIT1yBsM83BviqQIYGBgAAAAA//+iahv9378/TP+Y/8IvzPkPL3vYaTb7dfnAIT9uRi4OBtj1NP/+M3z89e6fnJXhDmR1mrZWBz4wfPn1H3pCBmicg5OJh+nR/lMeeC0AFej/oOPx0HYuaNiA9QcLF/tHRmGmj/+F2L8z83D/42BhZ+Zh+v8PekLSf+hxdqBLcZn//zErj28SlpbFupueCTbsAp/6/w8/6BF6WikD9KIPsP/+MyOWlP1nwN6EgjodQkNOAQE3iiHLWqBmg0c+EEdRgM0DOQZkPtN/SKbC5l7w7dKw5VywlY7/GNm+s7CwfmQU4vzCxM/+g5Wb+z8PGw8jN2idBOhkEcjNjNAQBJ2CKxBgMlPN3OIC3vCnBmBgYAAAAAD//7SdsW7CMBCGz0YoFQxdYIShD9AOPEWlDOVtGFpV3XkZZjqylLdgYaKVUBTI2Ul+dGdHwBAmasvrSbYc6Y//0/ff9aI/JP2cRULoEClmtaOvztzjf21g+/3zatGJYQbhXu6SfDd+frlqcOoPB5veZLTqoKtCwCojkGm7XE+z/V/SVj+05DbUvvNzd7AJhNYVlml+T82FfrUGea/+HX1M3ydv6aJ1E5GJisvwX/EBjIerPNh6sGE4mbaCA8NTCTZqjbXKLmmhQYyQVP0lpr8ki5NHQQ5clyjAUk0nS03ycFRSUbnsFlpe0BVN+nQ8KP1w1GdQsPUZGBjUXuSkSf4V+cMxfZqnX7PP1jO55yCiEwAAAP//omrTRUJb49KHvx//iTELM8NKIVDuf3L2nOGXD29ZeQSEKbr5AR28unNHdZ5JuB0fAyd0Bha8eoNBP8T38q/PnzmfXrzMApkyYRT+8vg5h01y/PmjGZ1O7MxckPF9JiaGH/deq13Ysgt0nfkqXPYwQpevQi8CZABf2wJawwFtWIMPwoeON8JWOIIWp3JaK+8LaCnOUTY0usFQiPvsEvBpsOBJfjiXgUFT6I5ra378vx+/mJkh51ZDrt2A3vgGagP8Z2Fh5JESu8nQjD29/GP8A7t0GL768dv/z/89l3eEMTL+By8ygZ42D7kYFXJxG1jpn39/vzOyMuPIRNDb/hAL4yHhBDmWHrxoDHTsHewiOOj53aDVH/9/K/A+Nm8vzTT38duWtWQO6ZFODmBgYAAAAAD//6JqQucVFX7+T4j9CdNHJrm/4LNPIQ2XP48+KL569MwYdNkxNe07uGBZMvcfFi7wNeawEYZ/jIxPFu10mbto/at/4EsSIDcwMYJnZ1kYhJhFGGGLp0E6eFn4GQ9Nmpn1+d2r1bzgK/XRwX/YvV/wddyszMz/P3K+e/CD9e8XFgYWJvbPnKrsf1jZ/jPCB9j+g0pN05zYyeBETggwwo7ChjuNgYmb446mqzPJF3yhAsQYN2xy5wfj7/+yRvrb+KUkvlFiMOTgbkRXBOTyL6xf//zk+v3mN8N/Bs6vTPz8f0DrW6DLf0GdTyZWBnkviz2gRE6Zv0gEDAwMAAAAAP//omrThU9E7I9qkPMm0IHs8DYnAwODKBMf85qy+vIPb17gbCKggxdPHuLNhO9eveC9uHRdBDsz5MhERmjTAtTW5GQVYBBjlWKQZJZgFGOWZBJjlWQUZZVkFGQWA7ef/0NX84Hwv3+/GFmuvjd/ef8h5io96GwiojECSYhf/n3757VgYkTNo+t6FY8u6+g0J5YzMoIOp4ReEAY6I5yRm3FX3YSS96+eEZ6U+g+5wRA2hgheuMXERHkHHj4GAF2FDqsxyLgYARnAR0HB81yw8XkWBoVoj5XVjy5LNTy6IhWwbYb7N4av3yCdD/AgK8Nvhj+MN+dvD7hz8Zw6xX4jBTAwMAAAAAD//6L61KtHaX7fVx6Gt4hbtEB3mjEwch5/4Xdo1pI8Qvo/vH7OsqKmvn2BcdidZRV1bW9ePsN6o9vNvQc9Jd5yyf35/wexgBo6bAU/wB+aqBmhxw5D0ioTvNcPnjtkZGAQYhZgv7x2K/YbnhmhDUv4IibwhNS/vz9/wtffmEUETGMwkjzAADmbEqrvPyPvzc+Wh+cszSXkZ0h7AXHuOxOkN0pIG0HAyMKEaLOALQKdGAk++J0yc6FhiigEoGXAX8T6HHVzqyPSqR5T2MHD95DVfaCQ5/vFLrijsrv307vXNJ8NhQMGBgYAAAAA//+iekIXkZF9IO5ptIWFiQV+IQd4URcDI9Pl9iV1p3fudMWn/8r+w0nP+3cW83xlk/8yfX/FzPD0DU/u3lFGV3d/1zE/ZtBx37CRCvh4MTP02kUmyCg+E7SNitiw8J8B6foHUDfwD8Nfhid7zgR9fv8WW+frP3wBEzSJQLa7/YfvGOIXkfxlWZ7W/evP9z/II3J//zMyX56woujdi+cKBIINtl8IYh0jrDNAGQAnLeRDOcEdxr+guXeKzIau9oHfXQS7Ve4v7IxKKHDOS+u7wfTiEaRlBsvI/xh/HbrjfnDNhjBK/Uc0YGBgAAAAAP//oskyXbPkiOmbV+eFcjFycTOBd61ATuYUYeLlPhTXvHJxet5yDS+XTcqmJseZmBm//mdiYn1y9qL5hc3bE0/mTgjiZmVjAY0WgDbdiZ7/6LDYJvrItolTkrzyc8Dj0B/fvOKcYxFsxwWfnWMAn8rLKsT6gU1FDNQP+M0Eb7ZDZzMZ//8HlWb/GP6xfLvzyoTp7T8xcNcO2nz9dvWxzuuHD0EZ6g6yX6ArChCbiUHmgM90R00riiYG+85HWcz/uuJMMjMj+PhXcHtE+AeH+JyolO73L57FCkpIYT1GGr6uBT6Tyfif4f1XycNLlkb++/0HdK7vP0b4yDf4ClMW6NnL/8DZ4vd/Bm5hgVsmgf7nkc39/+cPeE06ZCQEUh5wMrAz3Nx3MP/w4iV3wNvlQNcr/IXcWccMLpxAGy4gxT6of/qXifGzQ2wMapsatk0DWqLDrj9Bvy5aRE7u1elt2wuPRjcsYvvLygMb5uRm5mS+UD+968HFC2cV9A0I92EoBQwMDAAAAAD//6JJQtewtjm1KCVv5e/VlxN//vsN3tv+H1zC/Wfk+vpf8OfKC5lHlhzJ3ML8g/H33x8MjMzs/4X/cTLwswgxsP1hYvzH9A9+OQH4VPbPfwRE5KThGy8eX79hyPjih/Q/0JVekD1hoCl9BsEYmxlBzQ2VhNy3e/Kk7HvVGyf/Y/wBvTuEgYGPmYf1xr6DrugJ/T/Df/idLtCcw/gPvPUNNaHzi4r//vL+fdmsIyHWnE9+aoETERO4mczIe+p94Jlt2wIYGBhWYHMPaIs4+NINRiboMPp/xv93PxhcyZy29D90ASLYmaChQiYmBqY/kBKVCbZ6h5nhv7C3AWgfbBKKwfB9VojagYuJm+Fs7tRWyF0f0IlQyDI1yPAgeJIJbBl4+ugj748PfGHpKQAAIABJREFUoLvCUM2FTqSC2dB6DpT4sfjN1Mtz/ey4jLUMG2/E/WH8A+7AgsasxL9zS+6bOKeCgYEhgVB8UQwYGBgAotnySNfKnIZneuwHGJgZwbtCIbfJgVZ4MTH8/vePkY2Zi1GCUfi/Aqvcf1kmUQZOJk6Gn6COIRMjA+z+N1AU/GL59UWnK7lC3dbyOMzsOzsO+fKycoLuFoB0QP/9Y/j8//M/ZWsrohaOqdjYHnj178VvBth9v+BEw8LwZO8ZzMkj2J5KRni/6z+upXo8goIfDSviu//+/wW5/RJ0JAYzM/jqjIs9y2rfvXiCtb/x/z/sGI3/8IVnkItNwcU2aGoAzGJmBJ3WDkqHjGAMPm0f2gxn4uXA0nlF7N2ElL6QnX6g4UpQLmRiAZ01zwq+95CZmZmRGUSDlnaCb1QHXesBumITNI2KzdFIV8tAKdDYOjalbiUZ7R9Zvr4HX3QKBaALcN+uPRZ0/cRxglskKQYMDAwAAAAA//+iWUKXVFZ7XLBpiY9otlP7T8bf35ggTUb4TnTYpB1ojcp/yA50RkakDh/oEP/P7D+f2SyqjfbKyprIDz0e4eObN+z3V+8N/v33H2S5NWhrKRPr/4+Sfy4qmhoQdZ+noKz0dX5H7T0sjGzg5gV4axfDX8YPh646379wTh9Z7X+k0Qp4+4WB8f9f7HHKYOTjuYzdTnUHKxPsnnfwjUmMPM9+a+6eMLsau4v+/YENL8I2HjIgH1EBW0sO24rEiLThAVwoMzP8Y/qDkSChx1dAB8BgS4Ehp1sgtghCzASP9ECXAUDmW6Gzu+xsWE8vAO8Dh/Z/IMU72Eys/Vx5PYObGqXhrYilPBA7eBl5eHaVd094/+Yl5sZuagIGBgYAAAAA//+i6YJ3XkGRb6FtjTUmM0tTHrG8fcgGCcH/4NsF/kFGSP4zMSHtlwQfd/H/L9Pff/eFP1733TQxwNjLB6WUvnfurP2fJx+VQAkNtD2P6R8Dw+/f3xhMUmIX8wmLETUhJSAi9s8xP3P6+38f/4N23ICWjoIXgjHzcG3rm5qJrJYRtgbkHyP0onTQddq//zIxYx804BcS/W1fkdn89s/b76C5dhAAXUYLmlS6MW198pPrtzCH1hj/g7ItqFfyH6LyH+TSevBEEnSSCHKLDwNY3X9YC/k/lP2H4T8LC+b9P+AL+SCbqkF37kMu2YG2xsBiIL0QDLmdAlLDQcat/v//8//ffy4hfoxL0yDZF2QzaJM15N4S0D4UUGziCnO75Ni5L0Q/XWFlBsc+WNe/f/8Ymc+/st01cx7BkSmKAAMDAwAAAP//ovm5LiBgGx6y/N3TJzvP7d7r8mzT8fAXp86b/fv4TZzx5z8WcPud8T/Dr38Mf1kFOF5KmBsd1wpyXB7r6rSHX0wcY1/jpa37JSTs9Lb+//uf6T9kIo7hB8PvlyahfksYygqIdpOcodY+QXfD6Syff8uDWgnM0AV8zz9+ffbu2XNGISlJcOnErahw/JvFc6m///4xMYLvP/z//wfjv4fs3Jw4N2uLa6me1qpKzH2z77IPI/M/RqZ/kFOUeEFbO3t6tUGjo8jqeU001zB/+SsPXpoATdWMkNtHmKHr+iE3L/6Htg1g56hACmlmJkbGvwKqyhg3SHPLiO36Z66swggaaITe7wWZPYNshWYEDYdCLoYA7wIFNzGhjTLwKAroolwZwZ0MZ1D7oizsnD94LbQW8LHwQFbNMTH8Z2FkZOBTkME5wcUnKv7xxrET8YfrJhTyMLIJgtbRgNwBuuznwZ6T3E9u3mCRUdegzVJuBgYGAAAAAP//ongIixzw+d0rxh8fv/J/ePta5v/fv6B90P8EBAUfiaqofhgI94yCYQ4YGBgAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//8axaNg+AMGBgYAAAAA//+cXV1PglAYPgeyzSwqk4/QBVqtXHKr/v9fUMHmmoJYgAQ0c6ArRtnO4RBuIRc91+fd+14/X6eUdTFGKpuEkQh+/fNZaTIyaWUuOOqrelALqmz97ZQT/h2sCNyXynxmKzSSKkjXPs44ACq66w+eds05+qS+DHw5s9FlKU0SICCV3VkSBuYKJyTVaiDPMCJyLYZgpfSHeN+771K2PlVofFFKvSH5p8HzI1ZqF1dXbME2xmzoBxIkmuomnYecKGiNloRDDWNN7SVRWIMQJuR4XKzNN88fWPJmFzzred+3rBv07zhxVWJ/1ZHAT1sXnWXZ7CJwaEef3dIbsIeKElMtD8usq+5g+Oe//21MHu+v4o9PBvUh5LITAMccZzbly8K9hqZy8Xot4q40rJx8Q8QQn7Bnpti5Lr01w6upMwvPk1OnQqpSoYsrzKHb7vYK+H4CAMAPAAAA///COY7+7uVT5tWZZdO+7zgf/IPhF3hbHCNsmxj0lFoQB7Ty7+e//wx/eLg/9br77zeJCppn4OO5j1+YtMOKLmzb63Uyt3MF679/7LC5M9B56V/+/Xj5+MoVa1kdnXvY9B1YuCj7Sc/qBibQlAhsZh6ekBnh67vhADxTBb0kG3pEA3gVHviIYyaGpwK/rnx+/UKfV1Ti/8fPn3mX24Xt5mHm4mUEn3HFxPD97/e/zpNqQKd84d4aBwWHZy/NfDZhRfnvf3+ZGJmYQfNHzF/+f/8duXq6PehiDpCq3d2T47+vPJQN2137Dzypz/RXtzUtloGBYR0+828fPW6/P756MwsDIxsj9BwdLkb2/0LpHqAtRy349D49f1lnnV/OcQ4GZg7YHC8oO/6SZAWdJ4nzvJsvb99ydanb7eT5+lsRdkY8aKYJdJ26SKp3BwMDA9bZ31Nbt9s/a1yw7Nf/v8zQew1AK0f/C/lZz2VgYEgjFJYgsL15Yvv7pbszfoFWYEIW2DGwsrL9E8oJAE3yzcapkYGBAQAAAP//wj1hxMjAwMfKzsHCLsXI/he66A5RRkL3IEDLQ9Cm91//+VhOfvK/cHya3+mGWXe3T57ZaxsVsIhHWJxgyQcCrw6cDRVlEmf/y/KHEXmLpuD//2K7Jk/PYmBgwLoXjeM/Cx8vqxhozzwjI/LiK9h54rATYzHI//CJF6jnwMdZ/1Ni/gNK5ODAAS32YhUU4WXig9d8bAxff3GwshF1QCcXEysrH7sE52/4Ptr//1n/fvrFxsoGP3tSx8Xu3JV1NzkYGP4wwqbpWZiY/n+4eN+LUEJ/dfqKoxiHDNtfhPngGuH7hcfuhBL6ozNXnKU4ZDh+/v/JyPSfBbY04L+Qrd4NhvuXceo7vWOHN983TgVuFkHYGgUwAAX3532XAj6/f1vPKyiMMfHjHBO5e8qsVVdk3vDo/wFVBNDVju/3Xw29f/XyVEVtXZQ9vujgxf17KgutwsL42EWY2KH1MBMT0/9nPB+fRCUl7GBoxeNdBgYGAAAAAP//wr0EAHKUHngdzn9YqoOuQoSt/2BEUgxS//v/b0Z2RlYmrneMKg9rlk6b4BK379a5s2p4XQA6+OjZE+FHW496g3agQJYGMMLXfYCWMj1ddTjp0bWr8tj0fn/wUhK2vglxBBRsvwRsbxCERt28DDtJjBG++Am8tIqNEX54KOzuFLh5kOMoQIeePCXkJ0QowgyDBRhocQ9ig4KWlfWBD0zvf8IvAWBgYPj17w/js0NnnT++f4339ISXRy65/AVvbIKu9Qat8WJmZHh1/rrxq4f3BPHqPXzR6/ffP4zM/0BH9UOcCqr7FL0ccS6M+/jmJef+lqnVAuzcjJBTAyAbXOCbrx6/V390/rIJNr2i0rIfYpZPS/vI+PUTeBMedNEb/x8O/qVROTPevnqO82Syj29esCzOLGkX/MYDPmEMcmPKf9BOr59+c7vyJZVVHuPzKwMDAwMAAAD//yK41gW8ux2ybBMSV/AtiKA4ZIasE/n3H1YVMUBOcgFNMP9nkrj7zXxtesWsz+9e4d1NcvPsWUveX2z8YDOhZ5v8+wc94uH/P9AqR4Hr+w+7YdP76fUbyT+gdRbQZazgjcp/Ie779/8vbOMR2gnn/xkg9xv9Q1qxBRL/yyAiIA4/lOgfuFXNwIi80JURciIEkVPV/xkRi9kRvQfk89ZFlBWfC+upX//3G7GjnhmUqV59l3v/8DHODRvvnj2V/Xj1kRZscxV0vSNorToDzx929hfXbuO8JeTjh7ecby/c00ecNwqqzVj+v2F8+17FxuwILn13L1wy4nn4RffXX3DTHBpqiBWMHAxcTLf2HQTVJliBqpnZaRF/k03MTCzQdZr/GX7/+cso+PCP2c0Dh3BuyLl79oIR6+FHvn/AZQRknSfLf6b/vI6aR1RMDQivWGVgYAAAAAD//8Kb0P/DT3uAb14A74BnN5I4zmoivYPFWGo7m7bUhe+8v999//vjH6gqYUA0kRl+/f/LyH3zs/W5PQfwHg38aMdRXzZmLvCxbbDqAnZaK/jItL//GB/tOIb1Spa/LMz//wgyv/8rwPTmrxDr63/CLK/+iLC8+ifE/PovD+N32EES8FoWdGoyD9OXf/zM7/7yM7/7I8j09q8Qy5vfAsxvfvD+fydpYHIKZjbEz9CjP//jP3ING/j3H3oA0X/kYyFgZ3chgJCl1k5uTq7/sA0MoPBmZ2RjfHTuojEus89t2O7P+Y+VC7KpAmmnPajJxMrF+PDkOStcem8dPmnP8uWXELzpCW3uiTgZbReWkcV6pDcIPNp/1FMIdJAr1B5ILEO9CN6i+ofh6Y5THp/w1ESmyZHTP//5+huWU0C1Mds/FsaL8zelf3z9HGt6PL9wbS43Gy8bKCNDlwAyfGH48VcvPnASv5AY4T2HDAwMAAAAAP//wruoiwW09IcRURiB8BemH/+zNs525OEXhC/ffP/mOdurOw9Ndld3t7OcfWULWXQHaRawMrAw35y5NhvUl8Bmx6d3bwVm6vn6cf9nYoSd6Qfa4ALeNwk6Gg0UGKBDiY5cdXpx946ohLLKa2T9OVuWuXx88Qw8LMQnLomSgI4sW5VyLXP6LEZQk4gB0mwB3Rrnt7gnRExPbRfsHHU+MSR99Uhn+0M3EqEsoQUthSLySGdGWEJHHL8FFoCnEyhQd7NZv2vqxlIuRm7QgnBoO52N4cnh8y7YjuEAnR48wSkgToKVG3TrBTyBQ73D8OPfL4bXhy6B2vid2Nx1as7CdG4mTkbw/VHQ816+/vv8x684ZwLDuqVY/fLpw2uWuVZRQezgje+I7Ymg1aOQ81wgIz7frj8zeXDuMqh0RjlACgakNVRPCHjqbfm7427gX0ZIf+wP4z/G74dvON+/fNUG/dS0mydPaG5yzQ7hZeSC3LMB7voy/ecwV96vYW9F3GkCDAwMAAAAAP//wt90AZfk/1D2S4Jy8J+/v1GGEQVFJH+pW1gcC1/Ym/iA5fULFvAZ2JDyApR235y7afH2+TNObFZc3nPAg+XjT3HokBNYjEWM488fdvBhipAIZGRg4P3LzXft0BGs1Ru/hNR/9EQOAv+Y/31m/o9ogUIupQIfhv8F1OEE6UFJ5OgA1AD7z4hoq0NGWCGbUYkDTP9ht7VBmwn/YKdmIQEFPd2L3/mYnjIzw2pEUNPqN8Obk9etP79/gzEE/PndB/H/d97q/QXdOIe0uRR2EgKoAf3m4k2DT69fYxwc9e7pE55Xh644gjrIsL4X+PAvKf67Ejqq53D56tmVW5p/Hr9Vg1zzBbYNfI8Tiyj7L1CQwEJZgJWfefvEaaDBA6xAQEzyv2FK2NQvfz/+gZ9FwMgAWiLNcn7+OozRl5PLNsQLM/HBR+JAB6aB7kjSTw2YJoB05CBewMDAAAAAAP//wn2cGQN0/TX8fgJYe50B6RxCVCAqo3DPqiRp9vc/36CnQ0FSGNtvJqHXt+9po6v/9O4Vy6GJMzN5mfjAKQBUjoM2UQh7mW1mcJY9CDvIG+wSxv8Mj7YeDiDWYyDA/I+B7c+/f4zQM/wRBwQxEBc+kKFzRCUNbcCBVmETt+qTmeE3EwOivwsx5/9fJrRbufjEJH7Kh9hvhG+kANvDwvjj0Svl94+eaqAb++j0BStxFlGW/9DTfcF9JFjeg+4kYvzJwHN59z4HDL0XLukJ/mbnYwbtv4PelwRqM4vY6h7i4RfB2Qy4deSYGx8zL3wTN+hetc8sH1/LZHgtAGVP0Lp+2MzErwM3HZ7duY3zxjklE4PDLJ46y0AH24EjBrRB/f9fxpdbj3vfu3gRdKcRGLy6f0/8xZqDkaAmMKx5xM7M9P+HJv9RbWe7XUTFAQgwMDAAAAAA///CmdD/Q0alwSuhYYfI/4e3NXEXgnq+7mt/MP1FVPWMjKBz9hg+XL9niq720cVrxqznX1v//P8LPsr34+8XBgUP0ykeRYUtH39//A3bvQaqZF/uP+/y5tEjKWI99//ffzZwu4cBqRMNjg8imx6wgUjoKV3Q9g94oJtIJ/yD7RaC7CL7D3UG5k4c15zMaV/+fwM3B2FzWzwMPGxHFyyLQ1d7b/9xP0bQnkRGyAVboITKbiT699e/H/DZMAFWfsbjcxcnout9cOyMuwCbCOLAJNDI8L8fDEouljibAV8+vGV+uHp/KMO/v4g7Ef4xMOjkR000iAhq/Pj/8zfY8BLoABEpFmGei2s3BeMyj19I7Hfs9J7i72Kst8GbVqGFqMg/Qf4liflT3796zv3p7Uu2+ekFE/m/sctCylbI3r23rN/fRi2ZkiEgIkn8AUwMDAwAAAAA///CXaJDboj9Dx/2+g/pOCANI2AFP959FWNmgI9WQe62+c/I8JP9P8Z4+u0Dh90E2YSYmECbzqEjfT9Yfr9XNTE/K62heJhPU/o65KZaSLuV6ze7wNH5SyOJ9h1iNpcBdhkW/IZaIoMHfLQa7G5ocF/lHwvjH2aHz0+ecXx59oLpy7NnTJ+fvWD+8uQZ8+enz5m/PnnB/OXxc+aPj59xsv5nEoaUC//AtRX4vgnQjYyMmFUir7jwTWYVweuQsgTStGdhZmW4s3mH16e3r1Hi6e2pK+agq2Jg8fCT6R+DSqjHjp//f/9hBt3syQjpGP4698j59bNHKIf+f7n8yPrH/+/IQ+AMP5h+/1C3tka5eAwZvHjw2OjHrRdG/5jAR+OBQ+/T/0/frVITl0jIyT9j15a6Dr1tDBxSP//+Z3iy9zSoj4ATCIiKvVVO8p7Pxgy6BAS04YSB4fe/X4xCt35YXNp/wOXuqbO27EeeBf37B+1fgUpzNnYGmTCHNVLq6teIjEAIYGBgAAAAAP//wlOiM0LTCCO8V/3vL/REPRwF4oe3L5mPrVgWzQm6bBjaXoDsVPnxT97YCOV6wE9vXjE+33fe4/e/3/DhStDGMFEz7SP84hIfufhF/ora6u1iYWL+D6u3WBlYGS7NWZn47uVzgqdfgQGkvYqY+oe1IYg+HOg/4kxFaPONg4WH8UjVlMmzDP1fztT3fTtd1//dLH3ftzP1/N7N1vN9O8PQ99UMQ9/Xcw39nt+ZvjXl198/4Bus/4E3ssGcgVlQ8AgI/1e0N9/NDO7f/AWHHaijyfb8v/qrBw8VYepePrwv8eXua4X/0JtvQR2zT7/f/VD3cs7nVZe58ef/P2gN+I+R/ScL1+Mzl+AjNx9ePON+fPy8IWiwALwpHLrdk09L5qKQnNwbXKGwZ+rMDD5GLhbI6cAQzG+geJ6Dmwc8fq3gaLEXNNkG28sKCt935+6Zvnr0EPX0ADRgEuq/5A3r5zfgI6ihQxFszGyMd1ftLri6bEspNysvaBwS3j989/P9V7OkiElERh4CMDAwAAAAAP//ItAZhW3KhXAYwbXlfwYGLMNsn968ZD6zanPKh8XHI0HjErBDbkDjJn9FOB8KSUminN/x6tFjnS9n75v+A4+sQFqYrExsDFJ+1mtgarT83NZ9+fMV3rIGjWsLfeDWunHokD2R/oNsPoMPpsNnQYkeJ4ReRQvPJKCTYFj+sLBx/WLn4/rJLsD7h4Of8xcHP+cfTj6O3xz8XD85hLh+cQpy/uTgZ/3NCL6zCNGwhY5047BeydN2859/PyH3DEFtFWIXZntw6AT8dIJbh47b8zNxs8PMACV3LguFI+IKinclnIw2c7Kw/YdNkfGzCTDePXAEHlZ3L1404fvBIgAZ9oHUbSyMrAzizqY427sPb1yVf7XqSBgos8J6KaCN6zIeluv5hETAjtDydVn54d9nUEUFPRPtP6PQb06Bc5u3gm4UwQmkVFSfaBeEdLIwgQ5YhfgH1Dj6uvuK/fv1F91AE5CwqoeVieW/dJTjYhUjo+vExh0cMDAwAAAAAP//wp3QwaXxP9goIRSAOg4sDIzMrNKfvrxj/vjlPfPHD69ZL+/dZ7ewtGbBzfLZkzj/c0HOVwSVYoygDY1M/5WcLHfxCYugTLJc23fAQ4CNjxV2qP0fhv//n/969FvFygy+91FaX+v8b37ml7CjAkGRys7CwfBgxzG8AQh3LWTYHzrqAbuMFtZSJipw4CfXI64ZhE6kgu9JYoTe6vEfdrM7xOuw0Q/Iqg7oiA90CQLoymccDpAx1L/0leXXBxYGZsgYJBMDw++fPxmen7lmCVPz/NQlC9b/0FHh/4wMP/58YzAJD1kO4kqYah/5+vvLfyZopP35/4fhw8X7cL0vL1634GDmQuzVBw0X/3rLIG9ljHFpLgzc2HPITea/IBd4+AnsdyaGL/8//1exs4ZnDjF1tStfJRhvgxMs1O+gm0We7zvrRyiMzaNCFz38//IJ01/IMeogwMLAxsgMGsQFzcRDw/31z5c/jJLDQJf1kg4YGBgAAAAA///CO+oCv4wJOvYB4nMysjFMl3N6OEPK8c90aZffMxQ8f+4IKDrAuu56NDMDK+t/pHk/0IkuX/79+K6RFLAA2ewv798wPt91xvPfP9gJsqBDKpkZ2LRkz4soyMKn1/mFxX+KOhoeZWFmhXeBf/z5wfh09xmP9y+eET6wFLKCAO4XRtiMLpEpHXFCD9JaGehpBeDmwb//0Bk1Rvi8EJwBPj7xH9LgH7R/8P8/zh6OkJjkJwFj5fN//0Huq4W0sJgZX5y8bPrlHeS4vA/nb5r9ZvgLL+l+sDF+1HR32gpiKxgZXnjP+PnXX2g1DMrWH87dNXz74hloXzbDm+PXLUCL8MCzYKB+AyPj//e8TM/kjPQxbp2GgUe7jgf8gl1oB7byz/+/IhwPJTTV4DU0n7Dwb70o/2Xf/0DWREELlv+vjly0ev/8Gd77XEXlFV4795Q2/GT+/RtxKRr0pg7wZSOQO5tEopzmSSjJXyEm3jAAAwMDAAAA///C3UYHH5nNAF8SBV3WCpogYOT7x83Iw8DLwPePk5HvHwcjDyMvZF0M9GwocOn2H3Q44e8fihWhTTrWtieRzX5+76H15+M3rcAtSajY97/f/ttXFXTyC6LOdKm6W2/5+ecHAyzPgZYjcH74K3vz1BmcM38IAFoDwwSf5mZkgE3kEddy+QefrockKibIIXD//3D8+/aP/e+7f1z/X/3j/P/6N/uft3/Yf7/9w/Hr5R/232/+cvx795vj35t/LODzGWEDBpBTbBlhlzhiB9LOZptZmVkQq9qYGBhYnn9TfnHnttLze/flP116ZAibCQV5RdRE+ZiInOxLkGGSKmrPBKy0DrNCr4iHDO0y8t87fsrq45uXXM+PnbP58xfSVAQfh874/79+auAMYQkprIvUnj+4K/Xh8FV7BpAeWG3GyMyg4GqxQ0AE9WgRp4zkWb84/ryHdd5Bc4aC3zmF902ekUEonA0DfRZy2CntgkcNFEPPsvn/RZ7zekRHXTW/iAR5J68yMDAAAAAA///C03RhgM/hQQoqxKlPoMVdsEVO8ItVoes5wBEAKimYf7yTbopMd06L70U3ete0WZm8jNyQ9iu0afSHl/mTtr3dYXS12o52h96zfAFd7QBf1MHKyM74YM8xvL16uBegocbIiBjNwJixwakffhYV/JKa73+//LXtym+NubRBOvriesnYC+slYi5vEIu7tkks7upmycQrm8ViLm0Qi76wTkI+w2sxK3hdBwPSAjJG2LwRVqBqY7n3/d8P/2AWgsKHm4WX6dH5a7Z7Vi7z5/rPyQEucMB5gJmBz1zjOLI5esEeC3/8Q4yqcDPzMTw9e8n87ulzZsxf/gmDFn2BMiyosnn7++Nf85CglbjccnP/UWf+P7ywtQkQJzEyMMg5W2AcayEsJfNKwErzAmjyCNKFBzfrGC/MW5f8/s1LcI2CC4AmfvRTw6aCbuCA3oUMH6Bg/s/MoJ7gOYdXRIyoNetYAQMDAwAAAP//wrMEALJYG+VoYOhd+MwMTOAjf2AlCzMTG3hF199///5/Yfz8jcdC/ZBPVXaNjp3deYaCQhRTXzy6LzndwMdDigEy6gW7XpuXhZN7W079uhXReeAF9OB08e8/w76KXnZRDiFmhu8MsNU3DP/+/2F4vuuU/+c3r2t5RUSxHtwJce5/2GU90Ej6Bx0FZyKqZICe/vYfcjUd/Ojjf4z//xznlxTHbS9kWRnD5uo2pGlNeI+Y+S9oKgkHEFNXuflZhOkB/3tmpb+g88CgR2G/P3sl/MnFi+LCTCwMf6HNj68MX/4ZmxujJHQdL8/dp8qnfWUBHerJ+B98Ucu3649tLnz+IMfPyg++VAs2gsSnJnuHV1b8Li633Nl+yBdchcNXq4LWHf1kuLNyd8mKqDw/yDUg0NUeDAzs76/fNwTnIOgtIKCz9ES+csvePn4SVPvuxBfWGjaW+09rCl3/f/OTFrTxAC5QP3F//xQEyoxFqOmIJMDAwAAAAAD//yJwgBGidw5re/5l/MMgGmW36T/j/9cM0MG7f4y///JLS94X0tE8q2iif0FEWu4tww7sBcX59VuCZP8KC/5mgGyUgBRyTAz/P/5lfbflgi3GjlnkAAAJpklEQVRsPB3cPoOcR/gf5gh4gIOO+HzySfn0+s1BDAwMy3A6H3Y+ILS2YYJVicQeEf4fdio6I2LLEyP4LEKCy0Kh4A+iLoadmsvEzMSAu48gICb+a2dz96xbXes6QIfrM4Knvf8xvt50zonv9z8maPMd4iJOlvdKlhYot4gIS0u/muMacfb3qad2/6CLcz4fvOkEWmMKvn0L2idiZWb9L+Vuup5PSBRrpn/98LHMXEN/V/7/3CgLMJkY2Bg/7bmhz8DwXx85bKELu6F3EUL7eAz/GXmZuRhurd8H2qiCN6HzC4v9WJtUdvb1tWPaoP0NkEmpfwwsInyvReTknxEZ3tgBAwMDQDgTOixxMyFf9AragcL4h8G5tShKSJi8q0Ge7j3t9ZcRdrUl7LA/2Hpq2N2V/+FnbzNCr7L6z4h0NuB/JgZ+Vn7GI5NmZ31692YVn5AIzmWz4KW4sFlA6OpIEm7Zh7sOnuEhhxkStUwXcaYmI3x0k+n/v9//Ib1UnMAiPmLl5e5l9cxM3FzgnV0gf3/7x8YCW7jFBOqiMv/n15c9JyAiirGTS8BY7cT7M6/sQKMu4Iz9i4H5PyMzM3gdNfQU3q9/v/43tTXZyQDaE4QFHJq/JIHvDxd4rQzk6gT4GgZ4hxpWo0PveIKuYYOuBIKq+fH/N+OrbUdcPr59zc4vLIr1HEd4eP2FLMOF33YHyafExhVuwMDAAAAAAP//wjthBLIQvqIbesglaMU3ExMTvmobJ3jz/KnwmxNXLaD3WUGaIbBkBJqWh4yQgMyHHNjNBFlq8w80ygS5tBQ+cvH9z09GzrvfzZ5fv22Iyz5QgoYtv/wPv4j2PyTBEwFgbXz4wlrELD5xgfuf4T38mk9IqIJyyV9ch3HCAL+c7EMeDblLyKfPQibXkWonBkYGIWNVrHdCyVuYHPz99xf8kg7IEAyouQOZrQY1K74x//4sY2iA9erD96+e8VyauzoJtFQLdrAptFMOyXaQwzLBA46QehK6KggUzJATBsEAMqrOyMD+9b/Eg/OINSw4AThhwLZpQgYR/jMx4Fw2TDRgYGAAAAAA///C3XQBN7/+I5oLsPP+GGFTKKSDy1t3+PH/4BKEZPm/kAml/3//C9iqn2Hh47nPBB64/w8/bfcf9N43UMXy9/svmdd7LlmwMLNCTlZmYmQQZBJkObt6fQRohxdWLzCCB/LBy31hS9MYSVhXDrvCBGoa9KoY8JGcxN2bysj4/T9suAc+RItnyAUJiHqY7nl7c685eBku1DUMsCYL6Jjsv5/+mzrY7GJox9SrZGF85CDHj0/cPzgEYAfNI686AO3VlHI23i8sJYN1tOXagaMuQp9Z5P+B1iyBlhSAb7P4+5/XTP40p4jAXfBCavBoFmRBCGhzDMx9f378En+774o9E+g0RmjLlJeFj/H65n2gGy5QRt8wAHiVF3STN3RQg+E/IyWXikEAAwMDAAAA///Cs2cUskQNXHbAusJg/I9AeYQbPN51whc8QgfuTIHGDBj/v2d59SJqboensITEW3x6P757yTfTIPAG1/u/kqDhM1Cp9IvpN+O3/ZfdP394W8IrIIy5TBfS7GKENYUYYYfVE+sD+Jq5/4gJH0ZGBibi0ioD+IIJBrhGBug+QYb/RNTHSlYme572bKhiY+MGD5Eg1tIxgSeqPjF+fyhnoncWm15hCenPM+yCrzOce235H7mdBllsw8DFzsUgaqu9j2E9drvv7Dzkyfefi/E7eGYStNbzP8OX/9+/hS/s8BWRkoVvNcQGPr55xdVv5HZO5qOg2m/wWnnQQr0/jJ+2Hvb6/OlDBS+fAO6TIkCH+oLGpeE3O4J2LZKZ2JABAwMDAAAA///Cv8MIuc6GhjRkdybp7aYPL16IPjt20fo/rAECbnP/ZZAOdV5HKJEzgFe8iX+ScjHbzcXI8f8vNABBOf/PnVeqL2/fxXqjHPSAYnh1+B857RIBoF1IpNIUJkhklfCPgQu14cKI1BbCD+QM9M795mZ9B6rx/jMi1tGBwo2ZkfGfbKDdZkFh3CM/kua6h1mYEakcftMz43+GFz+e/FU2Mca6Ze7DqxccL/dccP/KCGphQReX/Wf+L2ClcYJQIgcBfhGxb4apofO//0Os4QPtnf//7JvK9UOH8e40g1xrjdRTB820Er0ADw9gYGAAAAAA///Ck9Bhi1xgyQOxYfQ/GTem7Z46p5DvM6soZDcKxPjPDN+/uuZlTyPWDFV/x5Xv/32Et9NBTuJl5mG9sH5bCFYfgHeKI0IKMhrGBL2LjjAAn2ADayvCzGSEXUtBBGBheAO9wgLqAMiieyyLFzGAsITUZxE77UOsjCwoW/FA1Ps/7/9YpSctxKdfxt5k0/df3//DL9YCXX0Oag4wMf3/J89/UVJHA+tW/1tnz1qyv/slywxedgFtrv3/y6DgbY2j/McEdinJc79z/n0LuSoG4mg+Nm7mPbVddZ/evMS5fxg81QRp+8PLE9Q+DpmAgYEBAAAA///Ck9Dhl9TAZxLBh7czEjnbggQ+vHwucGHWsnimf4ipclAVym2gdF5OW4foJZfq5qbHPnF8fw13AeN/hp8Mfxhe77+E9T7//4yMPyFdpv+I/PoP2mQnAjBCVqX8h/QWoIOVYMuJu6fzP/Qagf+MfyC3AUCaTkQP+ohbaR+HbDhH7IAGXRXALMDzXFpXHe/xEArGxhfesH76wAS9FRAWh3///mXQiQmazyckinXk6OHu425cTFzQniVkiO/N/0+/VW2s9xDpbAZBSYk3Ug6mhyGn50BGn0AnG7Dd+mz68NJVnFe5MIISBaxfBhaATYRQCBgYGAAAAAD//8Izjv7/P7u0+MXfqq8V/v5nYwR3OEDjr0ycj4lu40LB7fMXZPgl+N/8ZmL7DBuqYvzP9E/Gx2oZw6HVRJsjICH1YUN9a8uzTfvS/0IO3wAvjf70/c2tG2dPcWgYm6FU5WzcnLdYdAWPszKxgq5Kf//n/9+/f//9+cbCzoZzSSoyYGZk+cWlLbOAm5WDHzJ5xPCf5c/vD8yCgl+I0c8pLHSOW09yNee/vyx/wRueGFlY/nx7wMjNTtRZN4oW5lvPKa4P5WFmZwdvbILWp1K2pqt5eYXwbpMSlpT8Ojc5a/rX87f8QFfkgZbngVqLXxn+PjSPDlvFUIX9yvYHN2+KsisyXmNiZAVXe78ZmBj51VX2iyjIoFxiRggo+NhMP3/7lgZoahEy6MD4k4uR+/W1y1dwL90V5T7HpMZp8Acy8QsqUd4zyfBvYcCbpYkADAwMAAAAAP//AwCxgvGSIikseQAAAABJRU5ErkJggg=="/>
  </g>
</svg>
</file>

<file path="frontend/src/assets/csudhsvg.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1366" height="768" viewBox="0 0 1366 768">
  <g id="Artboard_1" data-name="Artboard 1">
    <image id="CSUDH-Mark-4C-RGB" y="242" width="1366" height="284" xlink:href="data:img/png;base64,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"/>
  </g>
</svg>
</file>

<file path="frontend/src/components/Answer/index.ts">
export * from './Answer'
</file>

<file path="frontend/src/components/AuthButtonsBar.module.css">
.authButtonsBar {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  justify-content: center;
  gap: 16px;
  padding: 16px 0;
  background: rgba(255,255,255,0.95);
  z-index: 1000;
  box-shadow: 0 -2px 8px rgba(0,0,0,0.08);
}
</file>

<file path="frontend/src/components/AuthButtonsBar.tsx">
import React from "react";
import { SignInButton } from "../../SignInButton";
import { SignOutButton } from "../../SignOutButton";
import styles from "./AuthButtonsBar.module.css";

const AuthButtonsBar = () => {
    return (
        <div className={styles.authButtonsBar}>
            <SignInButton />
            <SignOutButton />
        </div>
    );
};

export default AuthButtonsBar;
</file>

<file path="frontend/src/components/ChatHistory/ChatHistoryListItem.tsx">
import * as React from 'react'
import { useContext, useEffect, useRef, useState } from 'react'
import {
  DefaultButton,
  Dialog,
  DialogFooter,
  DialogType,
  IconButton,
  ITextField,
  List,
  PrimaryButton,
  Separator,
  Spinner,
  SpinnerSize,
  Stack,
  Text,
  TextField
} from '@fluentui/react'
import { useBoolean } from '@fluentui/react-hooks'

import { historyDelete, historyList, historyRename } from '../../api'
import { Conversation } from '../../api/models'
import { AppStateContext } from '../../state/AppProvider'

import { GroupedChatHistory } from './ChatHistoryList'

import styles from './ChatHistoryPanel.module.css'

interface ChatHistoryListItemCellProps {
  item?: Conversation
  onSelect: (item: Conversation | null) => void
}

interface ChatHistoryListItemGroupsProps {
  groupedChatHistory: GroupedChatHistory[]
}

const formatMonth = (month: string) => {
  const currentDate = new Date()
  const currentYear = currentDate.getFullYear()

  const [monthName, yearString] = month.split(' ')
  const year = parseInt(yearString)

  if (year === currentYear) {
    return monthName
  } else {
    return month
  }
}

export const ChatHistoryListItemCell: React.FC<ChatHistoryListItemCellProps> = ({ item, onSelect }) => {
  const [isHovered, setIsHovered] = React.useState(false)
  const [edit, setEdit] = useState(false)
  const [editTitle, setEditTitle] = useState('')
  const [hideDeleteDialog, { toggle: toggleDeleteDialog }] = useBoolean(true)
  const [errorDelete, setErrorDelete] = useState(false)
  const [renameLoading, setRenameLoading] = useState(false)
  const [errorRename, setErrorRename] = useState<string | undefined>(undefined)
  const [textFieldFocused, setTextFieldFocused] = useState(false)
  const textFieldRef = useRef<ITextField | null>(null)

  const appStateContext = React.useContext(AppStateContext)
  const isSelected = item?.id === appStateContext?.state.currentChat?.id
  const dialogContentProps = {
    type: DialogType.close,
    title: 'Are you sure you want to delete this item?',
    closeButtonAriaLabel: 'Close',
    subText: 'The history of this chat session will permanently removed.'
  }

  const modalProps = {
    titleAriaId: 'labelId',
    subtitleAriaId: 'subTextId',
    isBlocking: true,
    styles: { main: { maxWidth: 450 } }
  }

  if (!item) {
    return null
  }

  useEffect(() => {
    if (textFieldFocused && textFieldRef.current) {
      textFieldRef.current.focus()
      setTextFieldFocused(false)
    }
  }, [textFieldFocused])

  useEffect(() => {
    if (appStateContext?.state.currentChat?.id !== item?.id) {
      setEdit(false)
      setEditTitle('')
    }
  }, [appStateContext?.state.currentChat?.id, item?.id])

  const onDelete = async () => {
    const response = await historyDelete(item.id)
    if (!response.ok) {
      setErrorDelete(true)
      setTimeout(() => {
        setErrorDelete(false)
      }, 5000)
    } else {
      appStateContext?.dispatch({ type: 'DELETE_CHAT_ENTRY', payload: item.id })
    }
    toggleDeleteDialog()
  }

  const onEdit = () => {
    setEdit(true)
    setTextFieldFocused(true)
    setEditTitle(item?.title)
  }

  const handleSelectItem = () => {
    onSelect(item)
    appStateContext?.dispatch({ type: 'UPDATE_CURRENT_CHAT', payload: item })
  }

  const truncatedTitle = item?.title?.length > 28 ? `${item.title.substring(0, 28)} ...` : item.title

  const handleSaveEdit = async (e: any) => {
    e.preventDefault()
    if (errorRename || renameLoading) {
      return
    }
    if (editTitle == item.title) {
      setErrorRename('Error: Enter a new title to proceed.')
      setTimeout(() => {
        setErrorRename(undefined)
        setTextFieldFocused(true)
        if (textFieldRef.current) {
          textFieldRef.current.focus()
        }
      }, 5000)
      return
    }
    setRenameLoading(true)
    const response = await historyRename(item.id, editTitle)
    if (!response.ok) {
      setErrorRename('Error: could not rename item')
      setTimeout(() => {
        setTextFieldFocused(true)
        setErrorRename(undefined)
        if (textFieldRef.current) {
          textFieldRef.current.focus()
        }
      }, 5000)
    } else {
      setRenameLoading(false)
      setEdit(false)
      appStateContext?.dispatch({ type: 'UPDATE_CHAT_TITLE', payload: { ...item, title: editTitle } as Conversation })
      setEditTitle('')
    }
  }

  const chatHistoryTitleOnChange = (e: any) => {
    setEditTitle(e.target.value)
  }

  const cancelEditTitle = () => {
    setEdit(false)
    setEditTitle('')
  }

  const handleKeyPressEdit = (e: any) => {
    if (e.key === 'Enter') {
      return handleSaveEdit(e)
    }
    if (e.key === 'Escape') {
      cancelEditTitle()
      return
    }
  }

  return (
    <Stack
      key={item.id}
      tabIndex={0}
      aria-label="chat history item"
      className={styles.itemCell}
      onClick={() => handleSelectItem()}
      onKeyDown={e => (e.key === 'Enter' || e.key === ' ' ? handleSelectItem() : null)}
      verticalAlign="center"
      // horizontal
      onMouseEnter={() => setIsHovered(true)}
      onMouseLeave={() => setIsHovered(false)}
      styles={{
        root: {
          backgroundColor: isSelected ? '#e6e6e6' : 'transparent'
        }
      }}>
      {edit ? (
        <>
          <Stack.Item style={{ width: '100%' }}>
            <form aria-label="edit title form" onSubmit={e => handleSaveEdit(e)} style={{ padding: '5px 0px' }}>
              <Stack horizontal verticalAlign={'start'}>
                <Stack.Item>
                  <TextField
                    componentRef={textFieldRef}
                    autoFocus={textFieldFocused}
                    value={editTitle}
                    placeholder={item.title}
                    onChange={chatHistoryTitleOnChange}
                    onKeyDown={handleKeyPressEdit}
                    // errorMessage={errorRename}
                    disabled={errorRename ? true : false}
                  />
                </Stack.Item>
                {editTitle && (
                  <Stack.Item>
                    <Stack aria-label="action button group" horizontal verticalAlign={'center'}>
                      <IconButton
                        role="button"
                        disabled={errorRename !== undefined}
                        onKeyDown={e => (e.key === ' ' || e.key === 'Enter' ? handleSaveEdit(e) : null)}
                        onClick={e => handleSaveEdit(e)}
                        aria-label="confirm new title"
                        iconProps={{ iconName: 'CheckMark' }}
                        styles={{ root: { color: 'green', marginLeft: '5px' } }}
                      />
                      <IconButton
                        role="button"
                        disabled={errorRename !== undefined}
                        onKeyDown={e => (e.key === ' ' || e.key === 'Enter' ? cancelEditTitle() : null)}
                        onClick={() => cancelEditTitle()}
                        aria-label="cancel edit title"
                        iconProps={{ iconName: 'Cancel' }}
                        styles={{ root: { color: 'red', marginLeft: '5px' } }}
                      />
                    </Stack>
                  </Stack.Item>
                )}
              </Stack>
              {errorRename && (
                <Text
                  role="alert"
                  aria-label={errorRename}
                  style={{ fontSize: 12, fontWeight: 400, color: 'rgb(164,38,44)' }}>
                  {errorRename}
                </Text>
              )}
            </form>
          </Stack.Item>
        </>
      ) : (
        <>
          <Stack horizontal verticalAlign={'center'} style={{ width: '100%' }}>
            <div className={styles.chatTitle}>{truncatedTitle}</div>
            {(isSelected || isHovered) && (
              <Stack horizontal horizontalAlign="end">
                <IconButton
                  className={styles.itemButton}
                  iconProps={{ iconName: 'Delete' }}
                  title="Delete"
                  onClick={toggleDeleteDialog}
                  onKeyDown={e => (e.key === ' ' ? toggleDeleteDialog() : null)}
                />
                <IconButton
                  className={styles.itemButton}
                  iconProps={{ iconName: 'Edit' }}
                  title="Edit"
                  onClick={onEdit}
                  onKeyDown={e => (e.key === ' ' ? onEdit() : null)}
                />
              </Stack>
            )}
          </Stack>
        </>
      )}
      {errorDelete && (
        <Text
          styles={{
            root: { color: 'red', marginTop: 5, fontSize: 14 }
          }}>
          Error: could not delete item
        </Text>
      )}
      <Dialog
        hidden={hideDeleteDialog}
        onDismiss={toggleDeleteDialog}
        dialogContentProps={dialogContentProps}
        modalProps={modalProps}>
        <DialogFooter>
          <PrimaryButton onClick={onDelete} text="Delete" />
          <DefaultButton onClick={toggleDeleteDialog} text="Cancel" />
        </DialogFooter>
      </Dialog>
    </Stack>
  )
}

export const ChatHistoryListItemGroups: React.FC<ChatHistoryListItemGroupsProps> = ({ groupedChatHistory }) => {
  const appStateContext = useContext(AppStateContext)
  const observerTarget = useRef(null)
  const [, setSelectedItem] = React.useState<Conversation | null>(null)
  const [offset, setOffset] = useState<number>(25)
  const [observerCounter, setObserverCounter] = useState(0)
  const [showSpinner, setShowSpinner] = useState(false)
  const firstRender = useRef(true)

  const handleSelectHistory = (item?: Conversation) => {
    if (item) {
      setSelectedItem(item)
    }
  }

  const onRenderCell = (item?: Conversation) => {
    return <ChatHistoryListItemCell item={item} onSelect={() => handleSelectHistory(item)} />
  }

  useEffect(() => {
    if (firstRender.current) {
      firstRender.current = false
      return
    }
    handleFetchHistory()
    setOffset(offset => (offset += 25))
  }, [observerCounter])

  const handleFetchHistory = async () => {
    const currentChatHistory = appStateContext?.state.chatHistory
    setShowSpinner(true)

    await historyList(offset).then(response => {
      const concatenatedChatHistory = currentChatHistory && response && currentChatHistory.concat(...response)
      if (response) {
        appStateContext?.dispatch({ type: 'FETCH_CHAT_HISTORY', payload: concatenatedChatHistory || response })
      } else {
        appStateContext?.dispatch({ type: 'FETCH_CHAT_HISTORY', payload: null })
      }
      setShowSpinner(false)
      return response
    })
  }

  useEffect(() => {
    const observer = new IntersectionObserver(
      entries => {
        if (entries[0].isIntersecting) setObserverCounter(observerCounter => (observerCounter += 1))
      },
      { threshold: 1 }
    )

    if (observerTarget.current) observer.observe(observerTarget.current)

    return () => {
      if (observerTarget.current) observer.unobserve(observerTarget.current)
    }
  }, [observerTarget])

  return (
    <div className={styles.listContainer} data-is-scrollable>
      {groupedChatHistory.map(
        group =>
          group.entries.length > 0 && (
            <Stack
              horizontalAlign="start"
              verticalAlign="center"
              key={group.month}
              className={styles.chatGroup}
              aria-label={`chat history group: ${group.month}`}>
              <Stack aria-label={group.month} className={styles.chatMonth}>
                {formatMonth(group.month)}
              </Stack>
              <List
                aria-label={`chat history list`}
                items={group.entries}
                onRenderCell={onRenderCell}
                className={styles.chatList}
              />
              <div ref={observerTarget} />
              <Separator
                styles={{
                  root: {
                    width: '100%',
                    position: 'relative',
                    '::before': {
                      backgroundColor: '#d6d6d6'
                    }
                  }
                }}
              />
            </Stack>
          )
      )}
      {showSpinner && (
        <div className={styles.spinnerContainer}>
          <Spinner size={SpinnerSize.small} aria-label="loading more chat history" className={styles.spinner} />
        </div>
      )}
    </div>
  )
}
</file>

<file path="frontend/src/components/ChatHistory/ChatHistoryPanel.module.css">
.container {
  max-height: calc(100vh - 100px);
  width: 300px;
}

.listContainer {
  overflow: hidden auto;
  max-height: calc(90vh - 105px);
}

.itemCell {
  max-width: 270px;
  min-height: 32px;
  cursor: pointer;
  padding-left: 15px;
  padding-right: 5px;
  padding-top: 5px;
  padding-bottom: 5px;
  box-sizing: border-box;
  border-radius: 5px;
  display: flex;
}

.itemCell:hover {
  background: #e6e6e6;
}

.itemButton {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 28px;
  height: 28px;
  border: 1px solid #d1d1d1;
  border-radius: 5px;
  background-color: white;
  margin: auto 2.5px;
  cursor: pointer;
}

.itemButton:hover {
  background-color: #e6e6e6;
}

.chatGroup {
  margin: auto 5px;
  width: 100%;
}

.spinnerContainer {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 50px;
}

.chatList {
  width: 100%;
}

.chatMonth {
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 5px;
  padding-left: 15px;
}

.chatTitle {
  width: 80%;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

@media (max-width: 480px) {
  .container {
    width: 100%;
  }
}
</file>

<file path="frontend/src/components/ChatHistory/ChatHistoryPanel.tsx">
import { useContext } from 'react'
import React from 'react'
import {
  CommandBarButton,
  ContextualMenu,
  DefaultButton,
  Dialog,
  DialogFooter,
  DialogType,
  ICommandBarStyles,
  IContextualMenuItem,
  IStackStyles,
  PrimaryButton,
  Spinner,
  SpinnerSize,
  Stack,
  StackItem,
  Text
} from '@fluentui/react'
import { useBoolean } from '@fluentui/react-hooks'

import { ChatHistoryLoadingState, historyDeleteAll } from '../../api'
import { AppStateContext } from '../../state/AppProvider'

import ChatHistoryList from './ChatHistoryList'

import styles from './ChatHistoryPanel.module.css'

interface ChatHistoryPanelProps {}

export enum ChatHistoryPanelTabs {
  History = 'History'
}

const commandBarStyle: ICommandBarStyles = {
  root: {
    padding: '0',
    display: 'flex',
    justifyContent: 'center',
    backgroundColor: 'transparent'
  }
}

const commandBarButtonStyle: Partial<IStackStyles> = { root: { height: '50px' } }

export function ChatHistoryPanel(_props: ChatHistoryPanelProps) {
  const appStateContext = useContext(AppStateContext)
  const [showContextualMenu, setShowContextualMenu] = React.useState(false)
  const [hideClearAllDialog, { toggle: toggleClearAllDialog }] = useBoolean(true)
  const [clearing, setClearing] = React.useState(false)
  const [clearingError, setClearingError] = React.useState(false)

  const clearAllDialogContentProps = {
    type: DialogType.close,
    title: !clearingError ? 'Are you sure you want to clear all chat history?' : 'Error deleting all of chat history',
    closeButtonAriaLabel: 'Close',
    subText: !clearingError
      ? 'All chat history will be permanently removed.'
      : 'Please try again. If the problem persists, please contact the site administrator.'
  }

  const modalProps = {
    titleAriaId: 'labelId',
    subtitleAriaId: 'subTextId',
    isBlocking: true,
    styles: { main: { maxWidth: 450 } }
  }

  const menuItems: IContextualMenuItem[] = [
    { key: 'clearAll', text: 'Clear all chat history', iconProps: { iconName: 'Delete' } }
  ]

  const handleHistoryClick = () => {
    appStateContext?.dispatch({ type: 'TOGGLE_CHAT_HISTORY' })
  }

  const onShowContextualMenu = React.useCallback((ev: React.MouseEvent<HTMLElement>) => {
    ev.preventDefault() // don't navigate
    setShowContextualMenu(true)
  }, [])

  const onHideContextualMenu = React.useCallback(() => setShowContextualMenu(false), [])

  const onClearAllChatHistory = async () => {
    setClearing(true)
    const response = await historyDeleteAll()
    if (!response.ok) {
      setClearingError(true)
    } else {
      appStateContext?.dispatch({ type: 'DELETE_CHAT_HISTORY' })
      toggleClearAllDialog()
    }
    setClearing(false)
  }

  const onHideClearAllDialog = () => {
    toggleClearAllDialog()
    setTimeout(() => {
      setClearingError(false)
    }, 2000)
  }

  React.useEffect(() => {}, [appStateContext?.state.chatHistory, clearingError])

  return (
    <section className={styles.container} data-is-scrollable aria-label={'chat history panel'}>
      <Stack horizontal horizontalAlign="space-between" verticalAlign="center" wrap aria-label="chat history header">
        <StackItem>
          <Text
            role="heading"
            aria-level={2}
            style={{
              alignSelf: 'center',
              fontWeight: '600',
              fontSize: '18px',
              marginRight: 'auto',
              paddingLeft: '20px'
            }}>
            Chat history
          </Text>
        </StackItem>
        <Stack verticalAlign="start">
          <Stack horizontal styles={commandBarButtonStyle}>
            <CommandBarButton
              iconProps={{ iconName: 'More' }}
              title={'Clear all chat history'}
              onClick={onShowContextualMenu}
              aria-label={'clear all chat history'}
              styles={commandBarStyle}
              role="button"
              id="moreButton"
            />
            <ContextualMenu
              items={menuItems}
              hidden={!showContextualMenu}
              target={'#moreButton'}
              onItemClick={toggleClearAllDialog}
              onDismiss={onHideContextualMenu}
            />
            <CommandBarButton
              iconProps={{ iconName: 'Cancel' }}
              title={'Hide'}
              onClick={handleHistoryClick}
              aria-label={'hide button'}
              styles={commandBarStyle}
              role="button"
            />
          </Stack>
        </Stack>
      </Stack>
      <Stack
        aria-label="chat history panel content"
        styles={{
          root: {
            display: 'flex',
            flexGrow: 1,
            flexDirection: 'column',
            paddingTop: '2.5px',
            maxWidth: '100%'
          }
        }}
        style={{
          display: 'flex',
          flexGrow: 1,
          flexDirection: 'column',
          flexWrap: 'wrap',
          padding: '1px'
        }}>
        <Stack className={styles.chatHistoryListContainer}>
          {appStateContext?.state.chatHistoryLoadingState === ChatHistoryLoadingState.Success &&
            appStateContext?.state.isCosmosDBAvailable.cosmosDB && <ChatHistoryList />}
          {appStateContext?.state.chatHistoryLoadingState === ChatHistoryLoadingState.Fail &&
            appStateContext?.state.isCosmosDBAvailable && (
              <>
                <Stack>
                  <Stack horizontalAlign="center" verticalAlign="center" style={{ width: '100%', marginTop: 10 }}>
                    <StackItem>
                      <Text style={{ alignSelf: 'center', fontWeight: '400', fontSize: 16 }}>
                        {appStateContext?.state.isCosmosDBAvailable?.status && (
                          <span>{appStateContext?.state.isCosmosDBAvailable?.status}</span>
                        )}
                        {!appStateContext?.state.isCosmosDBAvailable?.status && <span>Error loading chat history</span>}
                      </Text>
                    </StackItem>
                    <StackItem>
                      <Text style={{ alignSelf: 'center', fontWeight: '400', fontSize: 14 }}>
                        <span>Chat history can't be saved at this time</span>
                      </Text>
                    </StackItem>
                  </Stack>
                </Stack>
              </>
            )}
          {appStateContext?.state.chatHistoryLoadingState === ChatHistoryLoadingState.Loading && (
            <>
              <Stack>
                <Stack
                  horizontal
                  horizontalAlign="center"
                  verticalAlign="center"
                  style={{ width: '100%', marginTop: 10 }}>
                  <StackItem style={{ justifyContent: 'center', alignItems: 'center' }}>
                    <Spinner
                      style={{ alignSelf: 'flex-start', height: '100%', marginRight: '5px' }}
                      size={SpinnerSize.medium}
                    />
                  </StackItem>
                  <StackItem>
                    <Text style={{ alignSelf: 'center', fontWeight: '400', fontSize: 14 }}>
                      <span style={{ whiteSpace: 'pre-wrap' }}>Loading chat history</span>
                    </Text>
                  </StackItem>
                </Stack>
              </Stack>
            </>
          )}
        </Stack>
      </Stack>
      <Dialog
        hidden={hideClearAllDialog}
        onDismiss={clearing ? () => {} : onHideClearAllDialog}
        dialogContentProps={clearAllDialogContentProps}
        modalProps={modalProps}>
        <DialogFooter>
          {!clearingError && <PrimaryButton onClick={onClearAllChatHistory} disabled={clearing} text="Clear All" />}
          <DefaultButton
            onClick={onHideClearAllDialog}
            disabled={clearing}
            text={!clearingError ? 'Cancel' : 'Close'}
          />
        </DialogFooter>
      </Dialog>
    </section>
  )
}
</file>

<file path="frontend/src/components/common/Button.tsx">
import { CommandBarButton, DefaultButton, IButtonProps } from '@fluentui/react'

import styles from './Button.module.css'

interface ButtonProps extends IButtonProps {
  onClick: () => void
  text: string | undefined
}

export const ShareButton: React.FC<ButtonProps> = ({ onClick, text }) => {
  return (
    <CommandBarButton
      className={styles.shareButtonRoot}
      iconProps={{ iconName: 'Share' }}
      onClick={onClick}
      text={text}
    />
  )
}

export const HistoryButton: React.FC<ButtonProps> = ({ onClick, text }) => {
  return (
    <DefaultButton
      className={styles.historyButtonRoot}
      text={text}
      iconProps={{ iconName: 'History' }}
      onClick={onClick}
    />
  )
}
</file>

<file path="frontend/src/components/QuestionInput/index.ts">
export * from './QuestionInput'
</file>

<file path="frontend/src/constants/chatHistory.tsx">
import { Conversation } from '../api/models'

export const chatHistorySampleData: Conversation[] = [
  {
    id: '1',
    title: 'Customer Support Issue And Resolution and Customer Support',
    messages: [
      {
        id: '1',
        role: 'user',
        content: 'How can I reset my password?',
        date: '2023-08-10T08:00:00Z'
      },
      {
        id: '2',
        role: 'assistant',
        content: "To reset your password, please visit the 'Forgot Password' page and follow the instructions.",
        date: '2023-08-10T08:05:00Z'
      }
    ],
    date: '2023-08-10T07:55:00Z'
  },
  {
    id: '2',
    title: 'Order Inquiry',
    messages: [
      {
        id: '3',
        role: 'user',
        content: 'Can you provide an update on my order?',
        date: '2023-07-09T15:30:00Z'
      },
      {
        id: '4',
        role: 'assistant',
        content: 'Sure! Let me check the status of your order. Please provide me with your order number.',
        date: '2023-07-09T15:32:00Z'
      },
      {
        id: '5',
        role: 'user',
        content: 'My order number is 12345.',
        date: '2023-07-09T15:35:00Z'
      },
      {
        id: '6',
        role: 'assistant',
        content: "Thank you. I'm looking up the details for order #12345. Please wait a moment.",
        date: '2023-07-09T15:40:00Z'
      }
    ],
    date: '2023-07-09T15:25:00Z'
  },
  {
    id: '3',
    title: 'August Entry 1',
    messages: [
      {
        id: '7',
        role: 'user',
        content: 'I have a question about my subscription.',
        date: '2022-08-20T12:30:00Z'
      },
      {
        id: '8',
        role: 'assistant',
        content: "Of course! Feel free to ask your question, and I'll be happy to help.",
        date: '2022-08-20T12:35:00Z'
      }
    ],
    date: '2022-08-20T12:25:00Z'
  },
  {
    id: '4',
    title: 'August Entry 2',
    messages: [
      {
        id: '9',
        role: 'user',
        content: 'When will my order be delivered?',
        date: '2023-08-15T09:45:00Z'
      },
      {
        id: '10',
        role: 'assistant',
        content: 'I can check the delivery status for you. Please provide your order number.',
        date: '2023-08-15T09:50:00Z'
      }
    ],
    date: '2023-08-15T09:40:00Z'
  },
  {
    id: '5',
    title: 'June Entry 1',
    messages: [
      {
        id: '11',
        role: 'user',
        content: 'Is the product available in different colors?',
        date: '2023-06-05T16:20:00Z'
      },
      {
        id: '12',
        role: 'assistant',
        content: 'Yes, the product is available in blue, red, and green.',
        date: '2023-06-05T16:25:00Z'
      }
    ],
    date: '2023-06-05T16:15:00Z'
  },
  {
    id: '133',
    title: 'Order Inquiry',
    messages: [
      {
        id: '1',
        role: 'user',
        content: 'How can I reset my password?',
        date: '2023-08-10T08:00:00Z'
      },
      {
        id: '2',
        role: 'assistant',
        content: "To reset your password, please visit the 'Forgot Password' page and follow the instructions.",
        date: '2023-08-10T08:05:00Z'
      }
    ],
    date: '2023-08-10T07:55:00Z'
  },
  {
    id: '233',
    title: 'Phone Plan System Reset',
    messages: [
      {
        id: '3',
        role: 'user',
        content: 'Can you provide an update on my order?',
        date: '2023-07-09T15:30:00Z'
      },
      {
        id: '4',
        role: 'assistant',
        content: 'Sure! Let me check the status of your order. Please provide me with your order number.',
        date: '2023-07-09T15:32:00Z'
      },
      {
        id: '5',
        role: 'user',
        content: 'My order number is 12345.',
        date: '2023-07-09T15:35:00Z'
      },
      {
        id: '6',
        role: 'assistant',
        content: "Thank you. I'm looking up the details for order #12345. Please wait a moment.",
        date: '2023-07-09T15:40:00Z'
      }
    ],
    date: '2023-07-09T15:25:00Z'
  },
  {
    id: '333',
    title: 'System Failure Error',
    messages: [
      {
        id: '7',
        role: 'user',
        content: 'I have a question about my subscription.',
        date: '2022-08-20T12:30:00Z'
      },
      {
        id: '8',
        role: 'assistant',
        content: "Of course! Feel free to ask your question, and I'll be happy to help.",
        date: '2022-08-20T12:35:00Z'
      }
    ],
    date: '2022-08-20T12:25:00Z'
  },
  {
    id: '433',
    title: 'Keyboard Coverage',
    messages: [
      {
        id: '9',
        role: 'user',
        content: 'Can you help me fix my keyboard?',
        date: '2023-08-15T09:45:00Z'
      },
      {
        id: '10',
        role: 'assistant',
        content: 'Sure. What seems to be the issue?',
        date: '2023-08-15T09:50:00Z'
      }
    ],
    date: '2023-08-15T09:40:00Z'
  },
  {
    id: '533',
    title: 'Color Difference',
    messages: [
      {
        id: '11',
        role: 'user',
        content: 'Is the product available in different colors?',
        date: '2023-06-05T16:20:00Z'
      },
      {
        id: '12',
        role: 'assistant',
        content: 'Yes, the product is available in blue, red, and green.',
        date: '2023-06-05T16:25:00Z'
      }
    ],
    date: '2023-06-05T16:15:00Z'
  },

  {
    id: '1111',
    title: 'Customer Support Issue And Resolution and Customer Support',
    messages: [
      {
        id: '1',
        role: 'user',
        content: 'How can I reset my password?',
        date: '2023-08-10T08:00:00Z'
      },
      {
        id: '2',
        role: 'assistant',
        content: "To reset your password, please visit the 'Forgot Password' page and follow the instructions.",
        date: '2023-08-10T08:05:00Z'
      }
    ],
    date: '2023-08-10T07:55:00Z'
  },
  {
    id: '21122',
    title: 'Order Inquiry',
    messages: [
      {
        id: '3',
        role: 'user',
        content: 'Can you provide an update on my order?',
        date: '2023-07-09T15:30:00Z'
      },
      {
        id: '4',
        role: 'assistant',
        content: 'Sure! Let me check the status of your order. Please provide me with your order number.',
        date: '2023-07-09T15:32:00Z'
      },
      {
        id: '5',
        role: 'user',
        content: 'My order number is 12345.',
        date: '2023-07-09T15:35:00Z'
      },
      {
        id: '6',
        role: 'assistant',
        content: "Thank you. I'm looking up the details for order #12345. Please wait a moment.",
        date: '2023-07-09T15:40:00Z'
      }
    ],
    date: '2023-07-09T15:25:00Z'
  },
  {
    id: '3111122',
    title: 'August Entry 1',
    messages: [
      {
        id: '7',
        role: 'user',
        content: 'I have a question about my subscription.',
        date: '2022-08-20T12:30:00Z'
      },
      {
        id: '8',
        role: 'assistant',
        content: "Of course! Feel free to ask your question, and I'll be happy to help.",
        date: '2022-08-20T12:35:00Z'
      }
    ],
    date: '2022-08-20T12:25:00Z'
  },
  {
    id: '4123344',
    title: 'August Entry 3',
    messages: [
      {
        id: '9',
        role: 'user',
        content: 'When will my order be delivered?',
        date: '2023-08-15T09:45:00Z'
      },
      {
        id: '10',
        role: 'assistant',
        content: 'I can check the delivery status for you. Please provide your order number.',
        date: '2023-08-15T09:50:00Z'
      }
    ],
    date: '2023-08-15T09:40:00Z'
  },
  {
    id: '51121213',
    title: 'June Entry 1',
    messages: [
      {
        id: '11',
        role: 'user',
        content: 'Is the product available in different colors?',
        date: '2023-06-05T16:20:00Z'
      },
      {
        id: '12',
        role: 'assistant',
        content: 'Yes, the product is available in blue, red, and green.',
        date: '2023-06-05T16:25:00Z'
      }
    ],
    date: '2023-06-05T16:15:00Z'
  },
  {
    id: '131443',
    title: 'Order Inquiry',
    messages: [
      {
        id: '1',
        role: 'user',
        content: 'How can I reset my password?',
        date: '2023-08-10T08:00:00Z'
      },
      {
        id: '2',
        role: 'assistant',
        content: "To reset your password, please visit the 'Forgot Password' page and follow the instructions.",
        date: '2023-08-10T08:05:00Z'
      }
    ],
    date: '2023-08-10T07:55:00Z'
  },
  {
    id: '2455633',
    title: 'Phone Plan System Reset',
    messages: [
      {
        id: '3',
        role: 'user',
        content: 'Can you provide an update on my order?',
        date: '2023-07-09T15:30:00Z'
      },
      {
        id: '4',
        role: 'assistant',
        content: 'Sure! Let me check the status of your order. Please provide me with your order number.',
        date: '2023-07-09T15:32:00Z'
      },
      {
        id: '5',
        role: 'user',
        content: 'My order number is 12345.',
        date: '2023-07-09T15:35:00Z'
      },
      {
        id: '6',
        role: 'assistant',
        content: "Thank you. I'm looking up the details for order #12345. Please wait a moment.",
        date: '2023-07-09T15:40:00Z'
      }
    ],
    date: '2023-07-09T15:25:00Z'
  },
  {
    id: '33567565673',
    title: 'System Failure Error',
    messages: [
      {
        id: '7',
        role: 'user',
        content: 'I have a question about my subscription.',
        date: '2022-08-20T12:30:00Z'
      },
      {
        id: '8',
        role: 'assistant',
        content: "Of course! Feel free to ask your question, and I'll be happy to help.",
        date: '2022-08-20T12:35:00Z'
      }
    ],
    date: '2022-08-20T12:25:00Z'
  },
  {
    id: '677433',
    title: 'International Coverage',
    messages: [
      {
        id: '9',
        role: 'user',
        content: 'When will my order be delivered?',
        date: '2023-08-15T09:45:00Z'
      },
      {
        id: '10',
        role: 'assistant',
        content: 'I can check the delivery status for you. Please provide your order number.',
        date: '2023-08-15T09:50:00Z'
      }
    ],
    date: '2023-08-15T09:40:00Z'
  },
  {
    id: '578833',
    title: 'Color Difference',
    messages: [
      {
        id: '11',
        role: 'user',
        content: 'Is the product available in different colors?',
        date: '2023-06-05T16:20:00Z'
      },
      {
        id: '12',
        role: 'assistant',
        content: 'Yes, the product is available in blue, red, and green.',
        date: '2023-06-05T16:25:00Z'
      }
    ],
    date: '2023-06-05T16:15:00Z'
  },

  {
    id: '34573',
    title: 'System Failure Error',
    messages: [
      {
        id: '7',
        role: 'user',
        content: 'I have a question about my subscription.',
        date: '2022-08-20T12:30:00Z'
      },
      {
        id: '8',
        role: 'assistant',
        content: "Of course! Feel free to ask your question, and I'll be happy to help.",
        date: '2022-08-20T12:35:00Z'
      }
    ],
    date: '2022-08-20T12:25:00Z'
  },
  {
    id: '402042',
    title: 'Details',
    messages: [
      {
        id: '9',
        role: 'user',
        content: 'When will my order be delivered?',
        date: '2023-08-15T09:45:00Z'
      },
      {
        id: '10',
        role: 'assistant',
        content: 'I can check the delivery status for you. Please provide your order number.',
        date: '2023-08-15T09:50:00Z'
      }
    ],
    date: '2023-08-15T09:40:00Z'
  },
  {
    id: '03491200',
    title: 'Color Difference',
    messages: [
      {
        id: '11',
        role: 'user',
        content: 'Is the product available in different colors?',
        date: '2023-06-05T16:20:00Z'
      },
      {
        id: '12',
        role: 'assistant',
        content: 'Yes, the product is available in blue, red, and green.',
        date: '2023-06-05T16:25:00Z'
      }
    ],
    date: '2023-06-05T16:15:00Z'
  }
  // ... (additional entries)
]
</file>

<file path="frontend/src/constants/sanatizeAllowables.ts">
export const XSSAllowTags = [
  'iframe',
  'a',
  'img',
  'svg',
  'h1',
  'h2',
  'h3',
  'h4',
  'h5',
  'h6',
  'div',
  'p',
  'span',
  'small',
  'del',
  'img',
  'pictrue',
  'embed',
  'video',
  'audio',
  'i',
  'u',
  'sup',
  'sub',
  'strong',
  'strike',
  'code',
  'pre',
  'body',
  'section',
  'article',
  'footer',
  'table',
  'tr',
  'td',
  'th',
  'thead',
  'tbody',
  'tfooter',
  'ul',
  'ol',
  'li'
]

export const XSSAllowAttributes = ['href']
</file>

<file path="frontend/src/pages/NoPage.tsx">
const NoPage = () => {
  return <h1>404</h1>
}

export default NoPage
</file>

<file path="frontend/src/styles/custom.css">
.auth-buttons-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.auth-buttons-bar {
    display: flex;
    gap: 16px;
    justify-content: center;
    align-items: center;
}
</file>

<file path="infrastructure/deployment.json">
{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "HostingPlanName": {
            "type": "string",
            "defaultValue": "[guid(resourceGroup().id)]",
            "metadata": {
                "description": "Name of App Service plan"
            }
        },
        "HostingPlanSku": {
            "type": "string",
            "defaultValue": "B3",
            "allowedValues": [
                "F1",
                "D1",
                "B1",
                "B2",
                "B3",
                "S1",
                "S2",
                "S3",
                "P1",
                "P2",
                "P3",
                "P4"
            ],
            "metadata": {
                "description": "The pricing tier for the App Service plan"
            }
        },
        "WebsiteName": {
            "type": "string",
            "defaultValue": "[guid(resourceGroup().id)]",
            "metadata": {
                "description": "Name of Web App"
            }
        },
        "ApplicationInsightsName": {
            "type": "string",
            "defaultValue": "[guid(resourceGroup().id)]",
            "metadata": {
                "description": "Name of Application Insights"
            }
        },
        "AzureSearchService": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Name of Azure Search Service"
            }
        },
        "AzureSearchIndex": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Name of Azure Search Index"
            }
        },
        "AzureSearchKey": {
            "type": "securestring",
            "defaultValue": "",
            "metadata": {
                "description": "Azure Search Admin Key"
            }
        },
        "AzureSearchUseSemanticSearch": {
            "type": "bool",
            "defaultValue": false,
            "metadata": {
                "description": "Use semantic search"
            }
        },
        "AzureSearchSemanticSearchConfig": {
            "type": "string",
            "defaultValue": "default",
            "metadata": {
                "description": "Semantic search config"
            }
        },
        "AzureSearchIndexIsPrechunked": {
            "type": "bool",
            "defaultValue": false,
            "metadata": {
                "description": "Is the index prechunked"
            }
        },
        "AzureSearchTopK": {
            "type": "int",
            "defaultValue": 5,
            "metadata": {
                "description": "Top K results"
            }
        },
        "AzureSearchEnableInDomain": {
            "type": "bool",
            "defaultValue": false,
            "metadata": {
                "description": "Enable in domain"
            }
        },
        "AzureSearchContentColumns": {
            "type": "string",
            "defaultValue": "content",
            "metadata": {
                "description": "Content columns"
            }
        },
        "AzureSearchFilenameColumn": {
            "type": "string",
            "defaultValue": "filename",
            "metadata": {
                "description": "Filename column"
            }
        },
        "AzureSearchTitleColumn": {
            "type": "string",
            "defaultValue": "title",
            "metadata": {
                "description": "Title column"
            }
        },
        "AzureSearchUrlColumn": {
            "type": "string",
            "defaultValue": "url",
            "metadata": {
                "description": "Url column"
            }
        },
        "AzureOpenAIResource": {
            "type": "string",
            "metadata": {
                "description": "Name of Azure OpenAI Resource"
            }
        },
        "AzureOpenAIModel": {
            "type": "string",
            "metadata": {
                "description": "Azure OpenAI Model Deployment Name"
            }
        },
        "AzureOpenAIModelName": {
            "type": "string",
            "defaultValue": "gpt-35-turbo",
            "metadata": {
                "description": "Azure OpenAI Model Name"
            }
        },
        "AzureOpenAIKey": {
            "type": "securestring",
            "metadata": {
                "description": "Azure OpenAI Key"
            }
        },
        "AzureOpenAITemperature": {
            "type": "int",
            "defaultValue": 0,
            "metadata": {
                "description": "Azure OpenAI Temperature"
            }
        },
        "AzureOpenAITopP": {
            "type": "int",
            "defaultValue": 1,
            "metadata": {
                "description": "Azure OpenAI Top P"
            }
        },
        "AzureOpenAIMaxTokens": {
            "type": "int",
            "defaultValue": 1000,
            "metadata": {
                "description": "Azure OpenAI Max Tokens"
            }
        },
        "AzureOpenAIStopSequence": {
            "type": "string",
            "defaultValue": "\n",
            "metadata": {
                "description": "Azure OpenAI Stop Sequence"
            }
        },
        "AzureOpenAISystemMessage": {
            "type": "string",
            "defaultValue": "You are an AI assistant that helps people find information.",
            "metadata": {
                "description": "Azure OpenAI System Message"
            }
        },
        "AzureOpenAIStream": {
            "type": "bool",
            "defaultValue": true,
            "metadata": {
                "description": "Whether or not to stream responses from Azure OpenAI"
            }
        },
        "AzureSearchQueryType": {
            "type": "string",
            "defaultValue": "simple",
            "allowedValues": [
                "simple",
                "semantic",
                "vector",
                "vectorSimpleHybrid",
                "vectorSemanticHybrid"
            ],
            "metadata": {
                "description": "Azure Search Query Type"
            }
        },
        "AzureSearchVectorFields": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Azure Search Vector Fields"
            }
        },
        "AzureSearchPermittedGroupsField": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Azure Search Permitted Groups Field"
            }
        },
        "AzureSearchStrictness": {
            "type": "int",
            "defaultValue": 3,
            "allowedValues": [
                1,
                2,
                3,
                4,
                5
            ],
            "metadata": {
                "description": "Azure Search Strictness"
            }
        },
        "AzureOpenAIEmbeddingName": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Azure OpenAI Embedding Deployment Name"
            }
        },
        "WebAppEnableChatHistory": {
            "type": "bool",
            "defaultValue": false,
            "metadata": {
                "description": "Enable chat history by deploying a Cosmos DB instance"
            }
        },
        "ElasticsearchEndpoint": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Endpoint to use to connect to an Elasticsearch cluster"
            }
        },
        "ElasticsearchEncodedApiKey": {
            "type": "securestring",
            "defaultValue": "",
            "metadata": {
                "description": "Encoded API key credentials to use to connect to an Elasticsearch cluster"
            }
        },
        "ElasticsearchIndex": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Elasticsearch index to use for retrieving grounding data"
            }
        },
        "ElasticsearchQueryType": {
            "type": "string",
            "defaultValue": "simple",
            "metadata": {
                "description": "Type of query to use for Elasticsearch data"
            }
        },
        "ElasticsearchContentColumns": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Elasticsearch index content columns"
            }
        },
        "ElasticsearchFilenameColumn": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Elasticsearch index filename column"
            }
        },
        "ElasticsearchTitleColumn": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Elasticsearch index title column"
            }
        },
        "ElasticsearchUrlColumn": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Elasticsearch index url column"
            }
        },
        "ElasticsearchVectorColumns": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "Elasticsearch index vector columns"
            }
        },
        "ElasticsearchTopK": {
            "type": "int",
            "defaultValue": 5,
            "metadata": {
                "description": "Top K results"
            }
        },
        "ElasticsearchEnableInDomain": {
            "type": "bool",
            "defaultValue": false,
            "metadata": {
                "description": "Enable in domain"
            }
        },
        "ElasticsearchStrictness": {
            "type": "int",
            "defaultValue": 3,
            "allowedValues": [
                1,
                2,
                3,
                4,
                5
            ],
            "metadata": {
                "description": "Elasticsearch strictness"
            }
        },
        "ElasticsearchEmbeddingModelId": {
            "type": "string",
            "defaultValue": "",
            "metadata": {
                "description": "The model ID for a model deployed on Elasticsearch to use for generating embeddings for queries."
            }
        }
    },
    "variables": {
        "WebAppImageName": "DOCKER|sampleappaoaichatgpt.azurecr.io/sample-app-aoai-chatgpt:latest",
        "cosmosdb_account_name": "[format('db-{0}', parameters('WebsiteName'))]",
        "cosmosdb_database_name": "db_conversation_history",
        "cosmosdb_container_name": "conversations",
        "roleDefinitionId": "00000000-0000-0000-0000-000000000002", // Cosmos DB Built-in Data Contributor Role
        "roleAssignmentId": "[guid(variables('roleDefinitionId'), parameters('WebsiteName'), resourceId('Microsoft.DocumentDB/databaseAccounts', variables('cosmosdb_account_name')))]"
    },
    "resources": [
        {
            "apiVersion": "2020-06-01",
            "name": "[parameters('HostingPlanName')]",
            "type": "Microsoft.Web/serverfarms",
            "location": "[resourceGroup().location]",
            "sku": {
                "name": "[parameters('HostingPlanSku')]"
            },
            "properties": {
                "name": "[parameters('HostingPlanName')]",
                "reserved": true
            },
            "kind": "linux"
        },
        {
            "apiVersion": "2020-06-01",
            "name": "[parameters('WebsiteName')]",
            "type": "Microsoft.Web/sites",
            "location": "[resourceGroup().location]",
            "dependsOn": [
                "[resourceId('Microsoft.Web/serverfarms', parameters('HostingPlanName'))]"
            ],
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "serverFarmId": "[parameters('HostingPlanName')]",
                "siteConfig": {
                    "appSettings": [
                        {
                            "name": "APPINSIGHTS_INSTRUMENTATIONKEY",
                            "value": "[reference(resourceId('Microsoft.Insights/components', parameters('ApplicationInsightsName')), '2015-05-01').InstrumentationKey]"
                        },
                        {
                            "name": "AZURE_SEARCH_SERVICE",
                            "value": "[parameters('AzureSearchService')]"
                        },
                        {
                            "name": "AZURE_SEARCH_INDEX",
                            "value": "[parameters('AzureSearchIndex')]"
                        },
                        {
                            "name": "AZURE_SEARCH_KEY",
                            "value": "[parameters('AzureSearchKey')]"
                        },
                        {
                            "name": "AZURE_SEARCH_USE_SEMANTIC_SEARCH",
                            "value": "[parameters('AzureSearchUseSemanticSearch')]"
                        },
                        {
                            "name": "AZURE_SEARCH_SEMANTIC_SEARCH_CONFIG",
                            "value": "[parameters('AzureSearchSemanticSearchConfig')]"
                        },
                        {
                            "name": "AZURE_SEARCH_INDEX_IS_PRECHUNKED",
                            "value": "[parameters('AzureSearchIndexIsPrechunked')]"
                        },
                        {
                            "name": "AZURE_SEARCH_TOP_K",
                            "value": "[parameters('AzureSearchTopK')]"
                        },
                        {
                            "name": "AZURE_SEARCH_ENABLE_IN_DOMAIN",
                            "value": "[parameters('AzureSearchEnableInDomain')]"
                        },
                        {
                            "name": "AZURE_SEARCH_CONTENT_COLUMNS",
                            "value": "[parameters('AzureSearchContentColumns')]"
                        },
                        {
                            "name": "AZURE_SEARCH_FILENAME_COLUMN",
                            "value": "[parameters('AzureSearchFilenameColumn')]"
                        },
                        {
                            "name": "AZURE_SEARCH_TITLE_COLUMN",
                            "value": "[parameters('AzureSearchTitleColumn')]"
                        },
                        {
                            "name": "AZURE_SEARCH_URL_COLUMN",
                            "value": "[parameters('AzureSearchUrlColumn')]"
                        },
                        {
                            "name": "AZURE_OPENAI_RESOURCE",
                            "value": "[parameters('AzureOpenAIResource')]"
                        },
                        {
                            "name": "AZURE_OPENAI_MODEL",
                            "value": "[parameters('AzureOpenAIModel')]"
                        },
                        {
                            "name": "AZURE_OPENAI_KEY",
                            "value": "[parameters('AzureOpenAIKey')]"
                        },
                        {
                            "name": "AZURE_OPENAI_MODEL_NAME",
                            "value": "[parameters('AzureOpenAIModelName')]"
                        },
                        {
                            "name": "AZURE_OPENAI_TEMPERATURE",
                            "value": "[parameters('AzureOpenAITemperature')]"
                        },
                        {
                            "name": "AZURE_OPENAI_TOP_P",
                            "value": "[parameters('AzureOpenAITopP')]"
                        },
                        {
                            "name": "AZURE_OPENAI_MAX_TOKENS",
                            "value": "[parameters('AzureOpenAIMaxTokens')]"
                        },
                        {
                            "name": "AZURE_OPENAI_STOP_SEQUENCE",
                            "value": "[parameters('AzureOpenAIStopSequence')]"
                        },
                        {
                            "name": "AZURE_OPENAI_SYSTEM_MESSAGE",
                            "value": "[parameters('AzureOpenAISystemMessage')]"
                        },
                        {
                            "name": "AZURE_OPENAI_STREAM",
                            "value": "[parameters('AzureOpenAIStream')]"
                        },
                        {
                            "name": "AZURE_SEARCH_QUERY_TYPE",
                            "value": "[parameters('AzureSearchQueryType')]"
                        },
                        {
                            "name": "AZURE_SEARCH_VECTOR_COLUMNS",
                            "value": "[parameters('AzureSearchVectorFields')]"
                        },
                        {
                            "name": "AZURE_SEARCH_PERMITTED_GROUPS_COLUMN",
                            "value": "[parameters('AzureSearchPermittedGroupsField')]"
                        },
                        {
                            "name": "AZURE_SEARCH_STRICTNESS",
                            "value": "[parameters('AzureSearchStrictness')]"
                        },
                        {
                            "name": "AZURE_OPENAI_EMBEDDING_NAME",
                            "value": "[parameters('AzureOpenAIEmbeddingName')]"
                        },
                        {
                            "name": "SCM_DO_BUILD_DURING_DEPLOYMENT",
                            "value": "true"
                        },
                        {
                            "name": "AZURE_COSMOSDB_ACCOUNT",
                            "value": "[if(parameters('WebAppEnableChatHistory'), variables('cosmosdb_account_name'), '')]"
                        },
                        {
                            "name": "AZURE_COSMOSDB_DATABASE",
                            "value": "[variables('cosmosdb_database_name')]"
                        },
                        {
                            "name": "AZURE_COSMOSDB_CONVERSATIONS_CONTAINER",
                            "value": "[variables('cosmosdb_container_name')]"
                        },
                        {
                            "name": "ELASTICSEARCH_ENDPOINT",
                            "value": "[parameters('ElasticsearchEndpoint')]"
                        },
                        {
                            "name": "ELASTICSEARCH_ENCODED_API_KEY",
                            "value": "[parameters('ElasticsearchEncodedApiKey')]"
                        },
                        {
                            "name": "ELASTICSEARCH_INDEX",
                            "value": "[parameters('ElasticsearchIndex')]"
                        },
                        {
                            "name": "ELASTICSEARCH_QUERY_TYPE",
                            "value": "[parameters('ElasticsearchQueryType')]"
                        },
                        {
                            "name": "ELASTICSEARCH_TOP_K",
                            "value": "[parameters('ElasticsearchTopK')]"
                        },
                        {
                            "name": "ELASTICSEARCH_ENABLE_IN_DOMAIN",
                            "value": "[parameters('ElasticsearchEnableInDomain')]"
                        },
                        {
                            "name": "ELASTICSEARCH_CONTENT_COLUMNS",
                            "value": "[parameters('ElasticsearchContentColumns')]"
                        },
                        {
                            "name": "ELASTICSEARCH_FILENAME_COLUMN",
                            "value": "[parameters('ElasticsearchFilenameColumn')]"
                        },
                        {
                            "name": "ELASTICSEARCH_TITLE_COLUMN",
                            "value": "[parameters('ElasticsearchTitleColumn')]"
                        },
                        {
                            "name": "ELASTICSEARCH_URL_COLUMN",
                            "value": "[parameters('ElasticsearchUrlColumn')]"
                        },
                        {
                            "name": "ELASTICSEARCH_VECTOR_COLUMNS",
                            "value": "[parameters('ElasticsearchVectorColumns')]"
                        },
                        {
                            "name": "ELASTICSEARCH_STRICTNESS",
                            "value": "[parameters('ElasticsearchStrictness')]"
                        },
                        {
                            "name": "ELASTICSEARCH_EMBEDDING_MODEL_ID",
                            "value": "[parameters('ElasticsearchEmbeddingModelId')]"
                        },
                        {
                            "name": "UWSGI_PROCESSES",
                            "value": "2"
                        },
                        {
                            "name": "UWSGI_THREADS",
                            "value": "2"
                        }                        
                    ],
                    "linuxFxVersion": "[variables('WebAppImageName')]"
                }
            }
        },
        {
            "type": "Microsoft.Insights/components",
            "apiVersion": "2020-02-02",
            "name": "[parameters('ApplicationInsightsName')]",
            "location": "[resourceGroup().location]",
            "tags": {
                "[concat('hidden-link:', resourceId('Microsoft.Web/sites', parameters('ApplicationInsightsName')))]": "Resource"
            },
            "properties": {
                "Application_Type": "web"
            },
            "kind": "web"
        },
        {
            "condition": "[parameters('WebAppEnableChatHistory')]",
            "type": "Microsoft.DocumentDB/databaseAccounts",
            "apiVersion": "2023-04-15",
            "name": "[variables('cosmosdb_account_name')]",
            "location": "[resourceGroup().location]",
            "kind": "GlobalDocumentDB",
            "properties": {
                "consistencyPolicy": {
                    "defaultConsistencyLevel": "Session"
                },
                "locations": [
                    {
                        "locationName": "[resourceGroup().location]",
                        "failoverPriority": 0,
                        "isZoneRedundant": false
                    }
                ],
                "databaseAccountOfferType": "Standard",
                "capabilities": [
                    {
                        "name": "EnableServerless"
                    }
                ]
            }
        },
        {
            "condition": "[parameters('WebAppEnableChatHistory')]",
            "type": "Microsoft.DocumentDB/databaseAccounts/sqlDatabases",
            "apiVersion": "2023-04-15",
            "name": "[concat(variables('cosmosdb_account_name'), '/', variables('cosmosdb_database_name'))]",
            "dependsOn": [
                "[resourceId('Microsoft.DocumentDB/databaseAccounts', variables('cosmosdb_account_name'))]"
            ],
            "properties": {
                "resource": {
                    "id": "[variables('cosmosdb_database_name')]"
                }
            }
        },
        {
            "condition": "[parameters('WebAppEnableChatHistory')]",
            "type": "Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers",
            "apiVersion": "2023-04-15",
            "name": "[concat(variables('cosmosdb_account_name'), '/', variables('cosmosdb_database_name'), '/conversations')]",
            "dependsOn": [
                "[resourceId('Microsoft.DocumentDB/databaseAccounts/sqlDatabases', variables('cosmosdb_account_name'), variables('cosmosdb_database_name'))]",
                "[resourceId('Microsoft.DocumentDB/databaseAccounts', variables('cosmosdb_account_name'))]"
            ],
            "properties": {
                "resource": {
                    "id": "conversations",
                    "indexingPolicy": {
                        "indexingMode": "consistent",
                        "automatic": true,
                        "includedPaths": [
                            {
                                "path": "/*"
                            }
                        ],
                        "excludedPaths": [
                            {
                                "path": "/\"_etag\"/?"
                            }
                        ]
                    },
                    "partitionKey": {
                        "paths": [
                            "/userId"
                        ],
                        "kind": "Hash"
                    }
                }
            }
        },
        {
            "condition": "[parameters('WebAppEnableChatHistory')]",
            "type": "Microsoft.DocumentDB/databaseAccounts/sqlRoleAssignments",
            "apiVersion": "2021-04-15",
            "name": "[format('{0}/{1}', variables('cosmosdb_account_name'), variables('roleAssignmentId'))]",
            "properties": {
                "roleDefinitionId": "[resourceId('Microsoft.DocumentDB/databaseAccounts/sqlRoleDefinitions', split(format('{0}/{1}', variables('cosmosdb_account_name'), variables('roleDefinitionId')), '/')[0], split(format('{0}/{1}', variables('cosmosdb_account_name'), variables('roleDefinitionId')), '/')[1])]",
                "principalId": "[reference(resourceId('Microsoft.Web/sites', parameters('WebsiteName')), '2021-02-01', 'Full').identity.principalId]",
                "scope": "[resourceId('Microsoft.DocumentDB/databaseAccounts', variables('cosmosdb_account_name'))]"
            },
            "dependsOn": [
                "[resourceId('Microsoft.DocumentDB/databaseAccounts', variables('cosmosdb_account_name'))]"
            ]
        }
    ]
}
</file>

<file path="package.json">
{
  "dependencies": {
    "@azure/msal-browser": "^4.14.0",
    "@azure/msal-react": "^3.0.14"
  }
}
</file>

<file path="scripts/config.json">
[
    {
        "data_path": "<path to data>",
        "location": "<azure region, e.g. 'westus2'>",
        "subscription_id": "<subscription id>",
        "resource_group": "<resource group name>",
        "search_service_name": "<search service name to use or create>",
        "index_name": "<index name to use or create>",
        "chunk_size": 1024,
        "token_overlap": 128,
        "semantic_config_name": "default",
        "language": "<Language to support for example use 'en' for English. Checked supported languages here under lucene - https://learn.microsoft.com/en-us/azure/search/index-add-language-analyzers"
    }
]
</file>

<file path="scripts/pinecone_config.json">
[
    {
        "data_path": "<path to data>",
        "environment": "<Pinecone environment name>",
        "api_key": "<Pinecone API key>",
        "index_name": "<Pinecone vector index>",
        "chunk_size": 1024,
        "token_overlap": 128
    }
]
</file>

<file path="scripts/pinecone_data_preparation.py">
"""Data Preparation Script for an Azure Cognitive Search Index."""
import argparse
import json
import os
import time
import uuid
import pinecone

import requests
from data_utils import Document
from azure.ai.formrecognizer import DocumentAnalysisClient
from azure.core.credentials import AzureKeyCredential
from azure.identity import AzureCliCredential

from typing import List

from data_utils import chunk_directory

SUPPORTED_LANGUAGE_CODES = {
    "ar": "Arabic",
    "hy": "Armenian",
    "eu": "Basque",
    "bg": "Bulgarian",
    "ca": "Catalan",
    "zh-Hans": "Chinese Simplified",
    "zh-Hant": "Chinese Traditional",
    "cs": "Czech",
    "da": "Danish",
    "nl": "Dutch",
    "en": "English",
    "fi": "Finnish",
    "fr": "French",
    "gl": "Galician",
    "de": "German",
    "el": "Greek",
    "hi": "Hindi",
    "hu": "Hungarian",
    "id": "Indonesian (Bahasa)",
    "ga": "Irish",
    "it": "Italian",
    "ja": "Japanese",
    "ko": "Korean",
    "lv": "Latvian",
    "no": "Norwegian",
    "fa": "Persian",
    "pl": "Polish",
    "pt-Br": "Portuguese (Brazil)",
    "pt-Pt": "Portuguese (Portugal)",
    "ro": "Romanian",
    "ru": "Russian",
    "es": "Spanish",
    "sv": "Swedish",
    "th": "Thai",
    "tr": "Turkish"
}

def check_if_pinecone_environment_exists(
    environment: str,
    api_key: str,
    credential = None):
    """_summary_

    Args:
        account_name (str): _description_
        database_name (str): _description_
        subscription_id (str): _description_
        resource_group (str): _description_
        credential: Azure credential to use for getting acs instance
    """
    if credential is None:
        raise ValueError("credential cannot be None")
    try:
        pinecone.init(api_key=api_key, environment=environment)
    except:
        raise BaseException("Invalid env or key")

def create_or_update_vector_search_index(
        index_name,
        credential):
    if credential is None:
        raise ValueError("credential cannot be None")

    try:
        # check if index already exists (it shouldn't if this is first time)
        if index_name not in pinecone.list_indexes():
            # if does not exist, create index
            pinecone.create_index(
                index_name,
                dimension=1536,
                metric='cosine'
            )

            # wait for index to be initialized
            while not pinecone.describe_index(index_name).status['ready']:
                time.sleep(1)

    except Exception as e:
        raise Exception(
            f"Failed to create vector index {index_name}. Error: {str(e)}")
    return True
     
def upsert_documents_to_index(
        index_name: str,
        docs: List[Document]
        ):
    
    index = pinecone.Index(index_name)
    for document in docs:
        finalDocChunk:dict = {}
        finalDocChunk["id"] = f"{uuid.uuid4()}"
        finalDocChunk['title'] = document.title
        finalDocChunk["filepath"] = document.filepath
        finalDocChunk["url"] = ""
        finalDocChunk["content"] = document.content
        finalDocChunk["contentvector"] = document.contentVector

        try:
            index.upsert([(finalDocChunk["id"],finalDocChunk["contentvector"], {"title":finalDocChunk['title'], "filepath":finalDocChunk['filepath'],"url":finalDocChunk['url'],"content":finalDocChunk['content']})])

            print(f"Upsert doc chunk {document.id} successfully")
        
        except Exception as e:
            print(f"Failed to upsert doc chunk {document.id}")
            continue

def validate_index(
        index_name):
    try:
        if not pinecone.describe_index(index_name).status['ready']:
            raise Exception(
                f"Failed to create vector index {index_name}. Error: {str(e)}")

    except Exception as e:
        raise Exception(
            f"Failed to create vector index {index_name}. Error: {str(e)}")  

def create_index(config, credential, form_recognizer_client=None, embedding_model_endpoint=None, use_layout=False, njobs=4):
    environment = config["environment"]
    api_key = config["api_key"]
    index_name = config["index_name"]
    language = config.get("language", None)

    if language and language not in SUPPORTED_LANGUAGE_CODES:
        raise Exception(f"ERROR: Ingestion does not support {language} documents. "
                        f"Please use one of {SUPPORTED_LANGUAGE_CODES}."
                        f"Language is set as two letter code for e.g. 'en' for English."
                        f"If you do not want to set a language just remove this prompt config or set as None")

    # check if pinecone database account exists
    try:
        check_if_pinecone_environment_exists(environment, api_key, credential)
        print(f"Using existing pinecone environment {environment}")
    except: 
        raise Exception(f"Pinecone environment {environment} doesn't exist.")

    # create or update vector search index with compatible schema
    try:
        create_or_update_vector_search_index(index_name, credential)
    except:
        raise Exception(f"Failed to create or update index {index_name}")
    
    # chunk directory
    print("Chunking directory...")
    add_embeddings = True

    result = chunk_directory(config["data_path"], num_tokens=config["chunk_size"], token_overlap=config.get("token_overlap",0),
                             azure_credential=credential, form_recognizer_client=form_recognizer_client, use_layout=use_layout, njobs=njobs,
                             add_embeddings=add_embeddings, embedding_endpoint=embedding_model_endpoint)

    if len(result.chunks) == 0:
        raise Exception("No chunks found. Please check the data path and chunk size.")

    print(f"Processed {result.total_files} files")
    print(f"Unsupported formats: {result.num_unsupported_format_files} files")
    print(f"Files with errors: {result.num_files_with_errors} files")
    print(f"Found {len(result.chunks)} chunks")

    # upsert documents to index
    print("Upserting documents to index...")
    upsert_documents_to_index(index_name, result.chunks)

    # check if index is ready/validate index
    print("Validating index...")
    validate_index(index_name)
    print("Index validation completed")

def valid_range(n):
    n = int(n)
    if n < 1 or n > 32:
        raise argparse.ArgumentTypeError("njobs must be an Integer between 1 and 32.")
    return n

if __name__ == "__main__": 
    parser = argparse.ArgumentParser()
    parser.add_argument("--pinecone-config", type=str, help="Path to config file containing settings for data preparation")
    parser.add_argument("--form-rec-resource", type=str, help="Name of your Form Recognizer resource to use for PDF cracking.")
    parser.add_argument("--form-rec-key", type=str, help="Key for your Form Recognizer resource to use for PDF cracking.")
    parser.add_argument("--form-rec-use-layout", default=False, action='store_true', help="Whether to use Layout model for PDF cracking, if False will use Read model.")
    parser.add_argument("--njobs", type=valid_range, default=4, help="Number of jobs to run (between 1 and 32). Default=4")
    parser.add_argument("--embedding-model-endpoint", type=str, help="Endpoint for the embedding model to use for vector search. Format: 'https://<AOAI resource name>.openai.azure.com/openai/deployments/<Ada deployment name>/embeddings?api-version=2023-03-15-preview'")
    parser.add_argument("--embedding-model-key", type=str, help="Key for the embedding model to use for vector search.")
    args = parser.parse_args()

    with open(args.pinecone_config) as f:
        config = json.load(f)

    credential = AzureCliCredential()
    form_recognizer_client = None

    print("Data preparation script started")
    if args.form_rec_resource and args.form_rec_key:
        os.environ["FORM_RECOGNIZER_ENDPOINT"] = f"https://{args.form_rec_resource}.cognitiveservices.azure.com/"
        os.environ["FORM_RECOGNIZER_KEY"] = args.form_rec_key
        if args.njobs==1:
            form_recognizer_client = DocumentAnalysisClient(endpoint=f"https://{args.form_rec_resource}.cognitiveservices.azure.com/", credential=AzureKeyCredential(args.form_rec_key))
        print(f"Using Form Recognizer resource {args.form_rec_resource} for PDF cracking, with the {'Layout' if args.form_rec_use_layout else 'Read'} model.")

    for index_config in config:        
        if index_config.get("index_name") and not args.embedding_model_endpoint:
            raise Exception("ERROR: Vector search is enabled in the config, but no embedding model endpoint and key were provided. Please provide these values or disable vector search.")
        print("Preparing data for index:", index_config["index_name"])

        create_index(index_config, credential, form_recognizer_client, embedding_model_endpoint=args.embedding_model_endpoint, use_layout=args.form_rec_use_layout, njobs=args.njobs)
        print("Data preparation for index", index_config["index_name"], "completed")

    print(f"Data preparation script completed. {len(config)} indexes updated.")
</file>

<file path="startDEV.cmd">
@echo off

echo.
echo Restoring backend python packages
echo.
call python -m pip install -r requirements.txt
if "%errorlevel%" neq "0" (
    echo Failed to restore backend python packages
    exit /B %errorlevel%
)

echo.
echo Restoring frontend npm packages
echo.
cd frontend
call npm install
if "%errorlevel%" neq "0" (
    echo Failed to restore frontend npm packages
    exit /B %errorlevel%
)

echo.    
echo Starting backend    
echo.    
cd ..  
start http://127.0.0.1:50505
call python -m uvicorn app:app  --port 50505 --reload
if "%errorlevel%" neq "0" (    
    echo Failed to start backend    
    exit /B %errorlevel%    
) 


echo.
echo Building frontend
echo.
call npm run dev
if "%errorlevel%" neq "0" (
    echo Failed to build frontend
    exit /B %errorlevel%
)
</file>

<file path="static/Hsi-Chatbot-Logo.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="511.977" height="287.846" viewBox="0 0 1366 768">
  <g id="Artboard_1" data-name="Artboard 1">
    <image id="CSUDH-Mark-4C-RGB" y="313" width="803" height="166" xlink:href="data:img/png;base64,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"/>
    <image id="Artboard_1-2" data-name="Artboard 1" x="848" y="124" width="496" height="638" xlink:href="data:img/png;base64,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"/>
  </g>
</svg>
</file>

<file path="SUPPORT.md">
# Support

## How to file issues and get help  

This project uses GitHub Issues to track bugs and feature requests. Please search the existing 
issues before filing new issues to avoid duplicates.  For new issues, file your bug or 
feature request as a new Issue.

For help and questions about using this project, please use the GitHub Issues and Discussions on this project. Please note that this sample app is provided **as is** and the maintainers of this sample are not able to provide direct support on modifying the project to suit custom requirements.

## Microsoft Support Policy  

Support for this project is limited to the resources listed above.
</file>

<file path="tests/unit_tests/dotenv_data/dotenv_no_datasource_1">
AZURE_OPENAI_MODEL=my_model
AZURE_OPENAI_KEY=dummy
AZURE_OPENAI_TEMPERATURE=0
AZURE_OPENAI_TOP_P=1.0
AZURE_OPENAI_MAX_TOKENS=1000
AZURE_OPENAI_STOP_SEQUENCE=
AZURE_OPENAI_SYSTEM_MESSAGE=You are an AI assistant that helps people find information.
AZURE_OPENAI_PREVIEW_API_VERSION=2024-05-01-preview
AZURE_OPENAI_STREAM=False
AZURE_OPENAI_ENDPOINT=https://dummy.openai.azure.com/
AZURE_OPENAI_EMBEDDING_NAME=
AZURE_OPENAI_EMBEDDING_ENDPOINT=
AZURE_OPENAI_EMBEDDING_KEY=
</file>

<file path="tests/unit_tests/dotenv_data/dotenv_no_datasource_2">
AZURE_OPENAI_MODEL=my_model
AZURE_OPENAI_KEY=dummy
AZURE_OPENAI_TEMPERATURE=0
AZURE_OPENAI_TOP_P=1.0
AZURE_OPENAI_MAX_TOKENS=1000
AZURE_OPENAI_STOP_SEQUENCE=
AZURE_OPENAI_SYSTEM_MESSAGE=You are an AI assistant that helps people find information.
AZURE_OPENAI_PREVIEW_API_VERSION=2024-05-01-preview
AZURE_OPENAI_STREAM=False
AZURE_OPENAI_ENDPOINT=https://dummy.openai.azure.com/
AZURE_OPENAI_EMBEDDING_NAME=
AZURE_OPENAI_EMBEDDING_ENDPOINT=
AZURE_OPENAI_EMBEDDING_KEY=
DATASOURCE_TYPE=AzureCognitiveSearch
</file>

<file path="tests/unit_tests/dotenv_data/dotenv_with_azure_search_success">
# Chat
DEBUG=True
DATASOURCE_TYPE="AzureCognitiveSearch"
AZURE_OPENAI_RESOURCE=
AZURE_OPENAI_MODEL=my_model
AZURE_OPENAI_KEY=dummy
AZURE_OPENAI_MODEL_NAME=model_name
AZURE_OPENAI_TEMPERATURE=0
AZURE_OPENAI_TOP_P=1.0
AZURE_OPENAI_MAX_TOKENS=1000
AZURE_OPENAI_STOP_SEQUENCE=
AZURE_OPENAI_SYSTEM_MESSAGE=You are an AI assistant that helps people find information.
AZURE_OPENAI_PREVIEW_API_VERSION=2024-05-01-preview
AZURE_OPENAI_STREAM=False
AZURE_OPENAI_ENDPOINT=https://dummy.openai.azure.com/
AZURE_OPENAI_EMBEDDING_NAME=embedding_model
AZURE_OPENAI_EMBEDDING_ENDPOINT=
AZURE_OPENAI_EMBEDDING_KEY=
# Chat with data: common settings
SEARCH_TOP_K=5
SEARCH_STRICTNESS=3
SEARCH_ENABLE_IN_DOMAIN=True
# Chat with data: Azure AI Search
AZURE_SEARCH_SERVICE=search_service
AZURE_SEARCH_INDEX=search_index
AZURE_SEARCH_KEY=dummy
AZURE_SEARCH_SEMANTIC_SEARCH_CONFIG=
AZURE_SEARCH_TOP_K=5
AZURE_SEARCH_ENABLE_IN_DOMAIN=true
AZURE_SEARCH_CONTENT_COLUMNS=content1,content2
AZURE_SEARCH_FILENAME_COLUMN=filepath
AZURE_SEARCH_TITLE_COLUMN=title
AZURE_SEARCH_URL_COLUMN=url
AZURE_SEARCH_VECTOR_COLUMNS=vector1
AZURE_SEARCH_QUERY_TYPE=simple
AZURE_SEARCH_PERMITTED_GROUPS_COLUMN=
AZURE_SEARCH_STRICTNESS=3
</file>

<file path="tests/unit_tests/dotenv_data/dotenv_with_elasticsearch_success">
# Chat
DEBUG=True
DATASOURCE_TYPE="Elasticsearch"
AZURE_OPENAI_RESOURCE=
AZURE_OPENAI_MODEL=my_model
AZURE_OPENAI_KEY=dummy
AZURE_OPENAI_MODEL_NAME=model_name
AZURE_OPENAI_TEMPERATURE=0
AZURE_OPENAI_TOP_P=1.0
AZURE_OPENAI_MAX_TOKENS=1000
AZURE_OPENAI_STOP_SEQUENCE=
AZURE_OPENAI_SYSTEM_MESSAGE=You are an AI assistant that helps people find information.
AZURE_OPENAI_PREVIEW_API_VERSION=2024-05-01-preview
AZURE_OPENAI_STREAM=False
AZURE_OPENAI_ENDPOINT=https://dummy.openai.azure.com/
AZURE_OPENAI_EMBEDDING_NAME=
AZURE_OPENAI_EMBEDDING_ENDPOINT=
AZURE_OPENAI_EMBEDDING_KEY=
# Chat with data: common settings
SEARCH_TOP_K=5
SEARCH_STRICTNESS=3
SEARCH_ENABLE_IN_DOMAIN=True
# Chat with data: Elasticsearch
ELASTICSEARCH_ENDPOINT=dummy
ELASTICSEARCH_ENCODED_API_KEY=dummy
ELASTICSEARCH_INDEX=dummy
ELASTICSEARCH_QUERY_TYPE='simple'
ELASTICSEARCH_CONTENT_COLUMNS=content1,content2
ELASTICSEARCH_FILENAME_COLUMN=filename
ELASTICSEARCH_TITLE_COLUMN=title
ELASTICSEARCH_URL_COLUMN=
ELASTICSEARCH_VECTOR_COLUMNS=
ELASTICSEARCH_EMBEDDING_MODEL_ID=
</file>

<file path="tests/unit_tests/test_utils.py">
import pytest
from backend.utils import format_as_ndjson, parse_multi_columns


@pytest.mark.asyncio
async def test_format_as_ndjson():
    async def dummy_generator():
        yield {"message": "test message\n"}

    async for event in format_as_ndjson(dummy_generator()):
        assert event == '{"message": "test message\\n"}\n'


@pytest.mark.asyncio
async def test_format_as_ndjson_exception():
    async def dummy_generator():
        raise Exception("test exception")
        yield {"message": "test message\n"}
    
    async for event in format_as_ndjson(dummy_generator()):
        assert event == '{"error": "test exception"}'

def test_parse_multi_columns():
    test_pipes = "col1|col2|col3"
    test_commas = "col1,col2,col3"
    test_single = "col1"
    assert parse_multi_columns(test_pipes) == ["col1", "col2", "col3"]
    assert parse_multi_columns(test_commas) == ["col1", "col2", "col3"]
    assert parse_multi_columns(test_single) == ["col1"]
</file>

<file path="tools/data_collection.py">
import os
import sys
import asyncio
import json

from dotenv import load_dotenv

#import the app.py module to gain access to the methods to construct payloads and
#call the API through the sdk

# Add parent directory to sys.path
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), '..')))

import app

#function to enable loading of the .env file into the global variables of the app.py module

def load_env_into_module(module_name, prefix=''):
    load_dotenv()
    module = __import__(module_name)
    for key, value in os.environ.items():
        if key.startswith(prefix):
            setattr(module, key[len(prefix):], value)

load_env_into_module("app")

#some settings required in app.py

app.SHOULD_STREAM = False
app.SHOULD_USE_DATA = app.should_use_data()

#format:
"""
[
  {
    "qa_pairs":[{"question":"...", "answer":"..."}]
  }
]
"""

generated_data_path = r"path/to/qa_input_file.json"

with open(generated_data_path, 'r') as file:
    data = json.load(file)


"""
Process a list of q(and a) pairs outputting to a file as we go.
"""
async def process(data: list, file):
  for qa_pairs_obj in data:
      qa_pairs = qa_pairs_obj["qa_pairs"]
      for qa_pair in qa_pairs:
          question = qa_pair["question"]
          messages = [{"role":"user", "content":question}]

          print("processing question "+question)

          request = {"messages":messages, "id":"1"}

          response = await app.complete_chat_request(request)

          #print(json.dumps(response))

          messages = response["choices"][0]["messages"]

          tool_message = None
          assistant_message = None

          for message in messages:
            if message["role"] == "tool":
              tool_message = message["content"]
            elif message["role"] == "assistant":
              assistant_message = message["content"]
            else:
              raise ValueError("unknown message role")

          #construct data for ai studio evaluation

          user_message = {"role":"user", "content":question}
          assistant_message = {"role":"assistant", "content":assistant_message}

          #prepare citations
          citations = json.loads(tool_message)
          assistant_message["context"] = citations

          #create output
          messages = []
          messages.append(user_message)
          messages.append(assistant_message)

          evaluation_data = {"messages":messages}

          #incrementally write out to the jsonl file
          file.write(json.dumps(evaluation_data)+"\n")
          file.flush()


evaluation_data_file_path = r"path/to/output_file.jsonl"  

with open(evaluation_data_file_path, "w") as file:
  asyncio.run(process(data, file))
</file>

<file path="WebApp.Dockerfile">
FROM node:20-alpine AS frontend  
RUN mkdir -p /home/node/app/node_modules && chown -R node:node /home/node/app

WORKDIR /home/node/app 
COPY ./frontend/package*.json ./  
USER node
RUN npm ci  
COPY --chown=node:node ./frontend/ ./frontend  
COPY --chown=node:node ./static/ ./static  
WORKDIR /home/node/app/frontend
RUN NODE_OPTIONS=--max_old_space_size=8192 npm run build
  
FROM python:3.11-alpine 
RUN apk add --no-cache --virtual .build-deps \  
    build-base \  
    libffi-dev \  
    openssl-dev \  
    curl \  
    && apk add --no-cache \  
    libpq 
  
COPY requirements.txt /usr/src/app/  
RUN pip install --no-cache-dir -r /usr/src/app/requirements.txt \  
    && rm -rf /root/.cache  
  
COPY . /usr/src/app/  
COPY --from=frontend /home/node/app/static  /usr/src/app/static/
WORKDIR /usr/src/app  
EXPOSE 80  

CMD ["gunicorn"  , "-b", "0.0.0.0:80", "app:app"]
</file>

<file path=".github/workflows/check-static-files.yml">
name: Check changes to static files

on:
  pull_request:
    branches:
      - main

jobs:
  changed_files:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: List changed frontend source files
        uses: tj-actions/changed-files@v46
        id: changed-frontend-src-files
        with:
          files: |
             frontend/src/**/*.tsx
             frontend/src/**/*.css

      - name: List changed frontend static files
        id: changed-frontend-static-files
        if: steps.changed-frontend-src-files.outputs.files_changed == 'true'
        uses: tj-actions/changed-files@v46
        with:
          files: |
            static

      - name: Check changed static files
        if: steps.changed-frontend-src-files.outputs.files_changed == 'true' && steps.changed-frontend-static-files.outputs.files_changed == 'false'
        run: echo "There were changes to the frontend code, but no corresponding changes to static files.  Please build the project locally, commit the static file changes and push the changes to try again." && exit 1

      - name: List logo customizations
        uses: tj-actions/changed-files@v46
        id: changed-logo-files
        with:
          files: |
             frontend/public/favicon.ico
             frontend/src/assets

      - name: Comment on logo customizations
        if: steps.changed-logo-files.outputs.any_changed == 'true'
        uses: mshick/add-pr-comment@v2
        with:
          message: |
            "Hello contributor, it appears that your pull request contains some customizations to branding. We are unable to approve your PR at this time. If you believe this message to be in error, please correct these unsupported changes and try again, or reach out to one of the maintainers of the repo to discuss the changes."
        
      - name: Fail on logo customizations
        if: steps.changed-logo-files.outputs.any_changed == 'true'
        run: echo "Logos are customized, which is not a supported change." && exit 1
</file>

<file path=".github/workflows/docker-image-publish.yml">
name: Docker Image Publish

on:
  push:
    branches:
    - main

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - name: Azure Container Registry Login
      uses: Azure/docker-login@v2
      with:
        # Container registry username
        username: ${{ secrets.SAMPLEAPP_ACR_USERNAME }}
        # Container registry password
        password: ${{ secrets.SAMPLEAPP_ACR_PASSWORD }}
        # Container registry server url
        login-server: sampleappaoaichatgpt.azurecr.io
        
    - uses: actions/checkout@v3
    - name: Build the Docker image
      run:         
        docker build . --file WebApp.Dockerfile --tag sampleappaoaichatgpt.azurecr.io/sample-app-aoai-chatgpt:$(date +'%Y-%m-%d')_$GITHUB_RUN_NUMBER;
        docker tag sampleappaoaichatgpt.azurecr.io/sample-app-aoai-chatgpt:$(date +'%Y-%m-%d')_$GITHUB_RUN_NUMBER sampleappaoaichatgpt.azurecr.io/sample-app-aoai-chatgpt:latest;
        docker push sampleappaoaichatgpt.azurecr.io/sample-app-aoai-chatgpt:$(date +'%Y-%m-%d')_$GITHUB_RUN_NUMBER;
        docker push sampleappaoaichatgpt.azurecr.io/sample-app-aoai-chatgpt:latest;
</file>

<file path=".github/workflows/sample-app-github-cd.yml">
# Docs for the Azure Web Apps Deploy action: https://github.com/Azure/webapps-deploy
# More GitHub Actions for Azure: https://github.com/Azure/actions
# More info on Python, GitHub Actions, and Azure App Service: https://aka.ms/python-webapps-actions

name: Build and deploy Python app to Azure Web App - sample-app-github-cd

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Set up Python version
        uses: actions/setup-python@v1
        with:
          python-version: '3.11'

      - name: Create and start virtual environment
        run: |
          python -m venv venv
          source venv/bin/activate
      
      - name: Install dependencies
        run: pip install -r requirements.txt
        
      # Optional: Add step to run tests here (PyTest, Django test suites, etc.)

      - name: Zip artifact for deployment
        run: zip release.zip ./* -r

      - name: Upload artifact for deployment jobs
        uses: actions/upload-artifact@v4
        with:
          name: python-app
          path: |
            release.zip
            !venv/

  deploy:
    runs-on: ubuntu-latest
    needs: build
    environment:
      name: 'Production'
      url: ${{ steps.deploy-to-webapp.outputs.webapp-url }}
    permissions:
      id-token: write #This is required for requesting the JWT

    steps:
      - name: Download artifact from build job
        uses: actions/download-artifact@v4
        with:
          name: python-app

      - name: Unzip artifact for deployment
        run: unzip release.zip

      
      - name: Login to Azure
        uses: azure/login@v1
        with:
          client-id: ${{ secrets.AZUREAPPSERVICE_CLIENTID_70EAEB01E7344A70ADC936904D8668C0 }}
          tenant-id: ${{ secrets.AZUREAPPSERVICE_TENANTID_DE1C873329344453B852433BF700723B }}
          subscription-id: ${{ secrets.AZUREAPPSERVICE_SUBSCRIPTIONID_07FF4A7ACD624D90ADE700FA7786CF46 }}

      - name: 'Deploy to Azure Web App'
        uses: azure/webapps-deploy@v2
        id: deploy-to-webapp
        with:
          app-name: 'sample-app-github-cd'
          slot-name: 'Production'
</file>

<file path=".gitignore">
.venv
frontend/node_modules
.env
# static
.azure/
__pycache__/
.ipynb_checkpoints/
repomix-output.txt
env.json
static/assets/
/static/assets
live-env.json
</file>

<file path="backend/auth/auth_utils.py">
def get_authenticated_user_details(request_headers):
    user_object = {}

    ## check the headers for the Principal-Id (the guid of the signed in user)
    if "X-Ms-Client-Principal-Id" not in request_headers.keys():
        ## if it's not, assume we're in development mode and return a default user
        from . import sample_user
        raw_user_object = sample_user.sample_user
    else:
        ## if it is, get the user details from the EasyAuth headers
        raw_user_object = {k:v for k,v in request_headers.items()}

    user_object['user_principal_id'] = raw_user_object.get('X-Ms-Client-Principal-Id')
    user_object['user_name'] = raw_user_object.get('X-Ms-Client-Principal-Name')
    user_object['auth_provider'] = raw_user_object.get('X-Ms-Client-Principal-Idp')
    user_object['auth_token'] = raw_user_object.get('X-Ms-Token-Aad-Id-Token')
    user_object['client_principal_b64'] = raw_user_object.get('X-Ms-Client-Principal')
    user_object['aad_id_token'] = raw_user_object.get('X-Ms-Token-Aad-Id-Token')

    return user_object
</file>

<file path="frontend/authConfig.d.ts">
// TypeScript declaration for authConfig.js
export const msalConfig: any;
export const loginRequest: any;
</file>

<file path="frontend/polyfills.js">
const replaceAllInserter = require('string.prototype.replaceall')

replaceAllInserter.shim()
</file>

<file path="frontend/SignInButton.tsx">
import React from "react";
import { useMsal, useIsAuthenticated } from "@azure/msal-react";
import { loginRequest } from "./authConfig.js";

export const SignInButton = () => {
    const { instance } = useMsal();
    const handleLogin = () => {
        instance.loginRedirect(loginRequest); // Use default redirectUri from MSAL config
    };
    return <button onClick={handleLogin}>Login</button>;
};
</file>

<file path="frontend/SignOutButton.tsx">
import React from "react";
import { useMsal } from "@azure/msal-react";

export const SignOutButton = () => {
    const { instance } = useMsal();

    const handleLogout = () => {
        // Clear session storage (removes MSAL tokens and app state)
        sessionStorage.clear();
        // Redirect to MSAL logout page (removes MSAL cookies and ends session)
        instance.logoutRedirect();
    };

    return <button onClick={handleLogout}>Sign out</button>;
};
</file>

<file path="frontend/src/components/Answer/Answer.module.css">
.answerContainer {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  padding: 8.1285px;
  gap: 5.42px;
  background: #ffffff;
  box-shadow:
    0px 1px 2px rgba(0, 0, 0, 0.14),
    0px 0px 2px rgba(0, 0, 0, 0.12);
  border-radius: 5.419px;
}

.answerText {
  font-style: normal;
  font-weight: 400;
  font-size: 14px;
  line-height: 20px;
  color: #323130;
  flex: none;
  order: 1;
  align-self: stretch;
  flex-grow: 0;
  margin: 11px;
  white-space: normal;
  word-wrap: break-word;
  max-width: 800px;
  overflow-x: auto;
}

.answerHeader {
  position: relative;
}

.answerFooter {
  display: flex;
  flex-flow: row nowrap;
  width: 100%;
  height: auto;
  box-sizing: border-box;
  justify-content: space-between;
}

.answerDisclaimerContainer {
  justify-content: center;
  display: flex;
}

.answerDisclaimer {
  font-style: normal;
  font-weight: 400;
  font-size: 12px;
  line-height: 16px;

  display: flex;
  align-items: center;
  text-align: center;
  color: #707070;
  flex: none;
  order: 1;
  flex-grow: 0;
}

.citationWrapper {
  margin-top: 8;
  display: flex;
  flex-flow: wrap column;
  max-height: 150px;
  gap: 4px;
}

.citationContainer {
  margin-left: 10px;
  font-style: normal;
  font-weight: 600;
  font-size: 12px;
  line-height: 16px;

  color: #115ea3;
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px 6px;
  gap: 4px;
  border: 1px solid #d1d1d1;
  border-radius: 4px;
}

.citationContainer:hover {
  text-decoration: underline;
  cursor: pointer;
}

.citation {
  box-sizing: border-box;
  display: inline-flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 0px;
  width: 14px;
  height: 14px;
  border: 1px solid #e0e0e0;
  border-radius: 4px;
  flex: none;
  flex-grow: 0;
  z-index: 2;
  font-style: normal;
  font-weight: 600;
  font-size: 10px;
  line-height: 14px;
  text-align: center;
  color: #424242;
  cursor: pointer;
}

.citation:hover {
  text-decoration: underline;
  cursor: pointer;
}

.accordionIcon {
  display: inline-flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  padding: 0px;
  margin-top: 4px;
  color: #616161;
  font-size: 10px;
}

.accordionIcon:hover {
  cursor: pointer;
}

.accordionTitle {
  margin-right: 5px;
  margin-left: 10px;
  font-style: normal;
  font-weight: 400;
  font-size: 12px;
  line-height: 16px;
  display: flex;
  align-items: center;
  color: #616161;
}

.accordionTitle:hover {
  cursor: pointer;
}

.clickableSup {
  box-sizing: border-box;
  display: inline-flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 0px;
  width: 14px;
  height: 14px;
  border: 1px solid #e0e0e0;
  border-radius: 4px;
  flex: none;
  order: 2;
  flex-grow: 0;
  z-index: 2;
  font-style: normal;
  font-weight: 600;
  font-size: 10px;
  line-height: 14px;
  text-align: center;
  color: #424242;
  cursor: pointer;
}

.clickableSup:hover {
  text-decoration: underline;
  cursor: pointer;
}

sup {
  font-size: 10px;
  line-height: 10px;
}

@media (max-width: 480px) {
  .answerFooter {
    flex-direction: column-reverse;
  }

  .citationWrapper {
    max-height: max-content;
  }

  .citationContainer {
    margin-left: 0;
  }

  .answerDisclaimer {
    margin-bottom: 5px;
  }
}
</file>

<file path="frontend/src/components/ChatHistory/ChatHistoryList.tsx">
import React, { useContext } from 'react'
import { Stack, StackItem, Text } from '@fluentui/react'

import { Conversation } from '../../api/models'
import { AppStateContext } from '../../state/AppProvider'

import { ChatHistoryListItemGroups } from './ChatHistoryListItem'

interface ChatHistoryListProps {}

export interface GroupedChatHistory {
  month: string
  entries: Conversation[]
}

const groupByMonth = (entries: Conversation[]) => {
  const groups: GroupedChatHistory[] = [{ month: 'Recent', entries: [] }]
  const currentDate = new Date()

  entries.forEach(entry => {
    const date = new Date(entry.date)
    const daysDifference = (currentDate.getTime() - date.getTime()) / (1000 * 60 * 60 * 24)
    const monthYear = date.toLocaleString('default', { month: 'long', year: 'numeric' })
    const existingGroup = groups.find(group => group.month === monthYear)

    if (daysDifference <= 7) {
      groups[0].entries.push(entry)
    } else {
      if (existingGroup) {
        existingGroup.entries.push(entry)
      } else {
        groups.push({ month: monthYear, entries: [entry] })
      }
    }
  })

  groups.sort((a, b) => {
    // Check if either group has no entries and handle it
    if (a.entries.length === 0 && b.entries.length === 0) {
      return 0 // No change in order
    } else if (a.entries.length === 0) {
      return 1 // Move 'a' to a higher index (bottom)
    } else if (b.entries.length === 0) {
      return -1 // Move 'b' to a higher index (bottom)
    }
    const dateA = new Date(a.entries[0].date)
    const dateB = new Date(b.entries[0].date)
    return dateB.getTime() - dateA.getTime()
  })

  groups.forEach(group => {
    group.entries.sort((a, b) => {
      const dateA = new Date(a.date)
      const dateB = new Date(b.date)
      return dateB.getTime() - dateA.getTime()
    })
  })

  return groups
}

const ChatHistoryList: React.FC<ChatHistoryListProps> = () => {
  const appStateContext = useContext(AppStateContext)
  const chatHistory = appStateContext?.state.chatHistory

  React.useEffect(() => {}, [appStateContext?.state.chatHistory])

  let groupedChatHistory
  if (chatHistory && chatHistory.length > 0) {
    groupedChatHistory = groupByMonth(chatHistory)
  } else {
    return (
      <Stack horizontal horizontalAlign="center" verticalAlign="center" style={{ width: '100%', marginTop: 10 }}>
        <StackItem>
          <Text style={{ alignSelf: 'center', fontWeight: '400', fontSize: 14 }}>
            <span>No chat history.</span>
          </Text>
        </StackItem>
      </Stack>
    )
  }

  return <ChatHistoryListItemGroups groupedChatHistory={groupedChatHistory} />
}

export default ChatHistoryList
</file>

<file path="frontend/src/components/common/Button.module.css">
.shareButtonRoot {
  width: 86px;
  height: 32px;
  border-radius: 4px;
  background: radial-gradient(109.81% 107.82% at 100.1% 90.19%, #0f6cbd 33.63%, #2d87c3 70.31%, #8dddd8 100%);
  padding: 5px 12px;
}

.shareButtonRoot:hover {
  background: linear-gradient(135deg, #0f6cbd 0%, #2d87c3 51.04%, #8dddd8 100%);
}

.shareButtonRoot span {
  font-weight: 600;
  font-size: 14px;
  line-height: 20px;
  color: #ffffff;
}

.shareButtonRoot i,
.shareButtonRoot:hover i {
  color: #ffffff !important;
}

.historyButtonRoot {
  width: 180px;
  border: 1px solid #d1d1d1;
}

.historyButtonRoot:hover {
  border: 1px solid #d1d1d1;
}

.historyButtonRoot:active {
  border: 1px solid #d1d1d1;
}

@media (max-width: 480px) {
  .shareButtonRoot {
    width: auto;
    padding: 5px 8px;
  }

  .historyButtonRoot {
    width: auto;
    padding: 0 8px;
  }
}
</file>

<file path="frontend/src/components/QuestionInput/QuestionInput.module.css">
.questionInputContainer {
  height: 120px;
  position: absolute;
  left: 6.5%;
  right: 0%;
  top: 0%;
  bottom: 0%;
  background: #ffffff;
  box-shadow:
    0px 8px 16px rgba(0, 0, 0, 0.14),
    0px 0px 2px rgba(0, 0, 0, 0.12);
  border-radius: 8px;
}

.questionInputTextArea {
  width: 100%;
  line-height: 40px;
  margin-top: 10px;
  margin-bottom: 10px;
  margin-left: 12px;
  margin-right: 12px;
}

.questionInputSendButtonContainer {
  position: absolute;
  right: 24px;
  bottom: 20px;
}

.questionInputSendButton {
  width: 24px;
  height: 23px;
}

.questionInputSendButtonDisabled {
  /* opacity: 0.4; */
  width: 24px;
  height: 23px;
  background: none;
  color: #424242;
}

.questionInputBottomBorder {
  position: absolute;
  width: 100%;
  height: 4px;
  left: 0%;
  bottom: 0%;
  background: radial-gradient(106.04% 106.06% at 100.1% 90.19%, #0f6cbd 33.63%, #8dddd8 100%);
  border-bottom-left-radius: 8px;
  border-bottom-right-radius: 8px;
}

.questionInputOptionsButton {
  cursor: pointer;
  width: 27px;
  height: 30px;
}

@media (max-width: 480px) {
  .questionInputContainer {
    left: 16.5%;
  }
}

.fileInputContainer {
  position: absolute;
  right: 24px;
  top: 20px;
}

.fileInput {
  width: 0;
  height: 0;
  opacity: 0;
  overflow: hidden;
  position: absolute;
  z-index: -1;
}

.fileLabel {
  display: inline-block;
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
  font-size: 14px;
}

.fileIcon {
  font-size: 20px;
  color: #424242;
}

.uploadedImage {
  margin-right: 70px;
}
</file>

<file path="frontend/src/index.css">
* {
  box-sizing: border-box;
}

html,
body {
  height: 100%;
  margin: 0;
  padding: 0;
}

html {
  background: #860038; /* Updated to CSUDH Maroon from the cheat sheet */
  font-family:
    'Segoe UI',
    'Segoe UI Web (West European)',
    'Segoe UI',
    -apple-system,
    BlinkMacSystemFont,
    Roboto,
    'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#root {
  height: 100%;
}
</file>

<file path="frontend/src/utils/resizeImage.ts">
export const resizeImage = (file: Blob, maxWidth: number, maxHeight: number): Promise<string> => {
  return new Promise((resolve, reject) => {
    const img = new Image()
    const reader = new FileReader()

    reader.readAsDataURL(file)
    reader.onloadend = () => {
      img.src = reader.result as string
      img.onload = () => {
        const canvas = document.createElement('canvas')
        const ctx = canvas.getContext('2d')

        let { width, height } = img

        // Calculate the new dimensions
        if (width > maxWidth || height > maxHeight) {
          if (width > height) {
            height = (maxWidth / width) * height
            width = maxWidth
          } else {
            width = (maxHeight / height) * width
            height = maxHeight
          }
        }

        canvas.width = width
        canvas.height = height

        if (ctx) {
          ctx.drawImage(img, 0, 0, width, height)
        }

        // Convert the canvas to a base64 string
        const resizedBase64 = canvas.toDataURL('image/jpeg', 0.8)
        resolve(resizedBase64)
      }

      img.onerror = error => {
        reject('Error loading image: ' + error)
      }
    }

    reader.onerror = error => {
      reject('Error reading file: ' + error)
    }
  })
}
</file>

<file path="frontend/tsconfig.json">
{
  "compilerOptions": {
    "target": "ESNext",
    "useDefineForClassFields": true,
    "lib": ["DOM", "DOM.Iterable", "ESNext"],
    "allowJs": false,
    "skipLibCheck": true,
    "esModuleInterop": false,
    "allowSyntheticDefaultImports": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "module": "ESNext",
    "moduleResolution": "Node",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",
    "types": ["vite/client", "jest", "mocha"],
    "noUnusedLocals": false
  },
  "include": ["src"],
  "references": [{ "path": "./tsconfig.node.json" }]
}
</file>

<file path="infra/main.bicep">
targetScope = 'subscription'

@minLength(1)
@maxLength(64)
@description('Name of the the environment which is used to generate a short unique hash used in all resources.')
param environmentName string

@minLength(1)
@description('Primary location for all resources')
param location string

param appServicePlanName string = ''
param backendServiceName string = ''
param resourceGroupName string = ''

param searchServiceName string = ''
param searchServiceResourceGroupName string = ''
param searchServiceResourceGroupLocation string = location
param searchServiceSkuName string = ''
param searchIndexName string = 'gptkbindex'
param searchUseSemanticSearch bool = false
param searchSemanticSearchConfig string = 'default'
param searchTopK int = 5
param searchEnableInDomain bool = true
param searchContentColumns string = 'content'
param searchFilenameColumn string = 'filepath'
param searchTitleColumn string = 'title'
param searchUrlColumn string = 'url'

param openAiResourceName string = ''
param openAiResourceGroupName string = ''
param openAiResourceGroupLocation string = location
param openAiSkuName string = ''
param openAIModel string = 'turbo16k'
param openAIModelName string = 'gpt-35-turbo-16k'
param openAITemperature int = 0
param openAITopP int = 1
param openAIMaxTokens int = 1000
param openAIStopSequence string = ''
param openAISystemMessage string = 'You are an AI assistant that helps people find information.'
param openAIStream bool = true
param embeddingDeploymentName string = 'embedding'
param embeddingModelName string = 'text-embedding-ada-002'

// Used by prepdocs.py: Form recognizer
param formRecognizerServiceName string = ''
param formRecognizerResourceGroupName string = ''
param formRecognizerResourceGroupLocation string = location
param formRecognizerSkuName string = ''

// Used for the Azure AD application
param authClientId string
@secure()
param authClientSecret string

// Used for Cosmos DB
param cosmosAccountName string = ''

@description('Id of the user or app to assign application roles')
param principalId string = ''

var abbrs = loadJsonContent('abbreviations.json')
var resourceToken = toLower(uniqueString(subscription().id, environmentName, location))
var tags = { 'azd-env-name': environmentName }

// Organize resources in a resource group
resource resourceGroup 'Microsoft.Resources/resourceGroups@2021-04-01' = {
  name: !empty(resourceGroupName) ? resourceGroupName : '${abbrs.resourcesResourceGroups}${environmentName}'
  location: location
  tags: tags
}

resource openAiResourceGroup 'Microsoft.Resources/resourceGroups@2021-04-01' existing = if (!empty(openAiResourceGroupName)) {
  name: !empty(openAiResourceGroupName) ? openAiResourceGroupName : resourceGroup.name
}

resource searchServiceResourceGroup 'Microsoft.Resources/resourceGroups@2021-04-01' existing = if (!empty(searchServiceResourceGroupName)) {
  name: !empty(searchServiceResourceGroupName) ? searchServiceResourceGroupName : resourceGroup.name
}


// Create an App Service Plan to group applications under the same payment plan and SKU
module appServicePlan 'core/host/appserviceplan.bicep' = {
  name: 'appserviceplan'
  scope: resourceGroup
  params: {
    name: !empty(appServicePlanName) ? appServicePlanName : '${abbrs.webServerFarms}${resourceToken}'
    location: location
    tags: tags
    sku: {
      name: 'B1'
      capacity: 1
    }
    kind: 'linux'
  }
}

// The application frontend
var appServiceName = !empty(backendServiceName) ? backendServiceName : '${abbrs.webSitesAppService}backend-${resourceToken}'
var authIssuerUri = '${environment().authentication.loginEndpoint}${tenant().tenantId}/v2.0'
module backend 'core/host/appservice.bicep' = {
  name: 'web'
  scope: resourceGroup
  params: {
    name: appServiceName
    location: location
    tags: union(tags, { 'azd-service-name': 'backend' })
    appServicePlanId: appServicePlan.outputs.id
    runtimeName: 'python'
    runtimeVersion: '3.10'
    scmDoBuildDuringDeployment: true
    managedIdentity: true
    authClientSecret: authClientSecret
    authClientId: authClientId
    authIssuerUri: authIssuerUri
    appSettings: {
      // search
      AZURE_SEARCH_INDEX: searchIndexName
      AZURE_SEARCH_SERVICE: searchService.outputs.name
      AZURE_SEARCH_KEY: searchService.outputs.adminKey
      AZURE_SEARCH_USE_SEMANTIC_SEARCH: searchUseSemanticSearch
      AZURE_SEARCH_SEMANTIC_SEARCH_CONFIG: searchSemanticSearchConfig
      AZURE_SEARCH_TOP_K: searchTopK
      AZURE_SEARCH_ENABLE_IN_DOMAIN: searchEnableInDomain
      AZURE_SEARCH_CONTENT_COLUMNS: searchContentColumns
      AZURE_SEARCH_FILENAME_COLUMN: searchFilenameColumn
      AZURE_SEARCH_TITLE_COLUMN: searchTitleColumn
      AZURE_SEARCH_URL_COLUMN: searchUrlColumn
      // openai
      AZURE_OPENAI_RESOURCE: openAi.outputs.name
      AZURE_OPENAI_MODEL: openAIModel
      AZURE_OPENAI_MODEL_NAME: openAIModelName
      AZURE_OPENAI_KEY: openAi.outputs.key
      AZURE_OPENAI_TEMPERATURE: openAITemperature
      AZURE_OPENAI_TOP_P: openAITopP
      AZURE_OPENAI_MAX_TOKENS: openAIMaxTokens
      AZURE_OPENAI_STOP_SEQUENCE: openAIStopSequence
      AZURE_OPENAI_SYSTEM_MESSAGE: openAISystemMessage
      AZURE_OPENAI_STREAM: openAIStream
    }
  }
}


module openAi 'core/ai/cognitiveservices.bicep' = {
  name: 'openai'
  scope: openAiResourceGroup
  params: {
    name: !empty(openAiResourceName) ? openAiResourceName : '${abbrs.cognitiveServicesAccounts}${resourceToken}'
    location: openAiResourceGroupLocation
    tags: tags
    sku: {
      name: !empty(openAiSkuName) ? openAiSkuName : 'S0'
    }
    deployments: [
      {
        name: openAIModel
        model: {
          format: 'OpenAI'
          name: openAIModelName
          version: '0613'
        }
        capacity: 30
      }
      {
        name: embeddingDeploymentName
        model: {
          format: 'OpenAI'
          name: embeddingModelName
          version: '2'
        }
        capacity: 30
      }
    ]
  }
}

module searchService 'core/search/search-services.bicep' = {
  name: 'search-service'
  scope: searchServiceResourceGroup
  params: {
    name: !empty(searchServiceName) ? searchServiceName : 'gptkb-${resourceToken}'
    location: searchServiceResourceGroupLocation
    tags: tags
    authOptions: {
      aadOrApiKey: {
        aadAuthFailureMode: 'http401WithBearerChallenge'
      }
    }
    sku: {
      name: !empty(searchServiceSkuName) ? searchServiceSkuName : 'standard'
    }
    semanticSearch: 'free'
  }
}

// The application database
module cosmos 'db.bicep' = {
  name: 'cosmos'
  scope: resourceGroup
  params: {
    accountName: !empty(cosmosAccountName) ? cosmosAccountName : '${abbrs.documentDBDatabaseAccounts}${resourceToken}'
    location: resourceGroup.location
    tags: tags
    principalIds: [principalId, backend.outputs.identityPrincipalId]
  }
}


// USER ROLES
module openAiRoleUser 'core/security/role.bicep' = {
  scope: openAiResourceGroup
  name: 'openai-role-user'
  params: {
    principalId: principalId
    roleDefinitionId: '5e0bd9bd-7b93-4f28-af87-19fc36ad61bd'
    principalType: 'User'
  }
}

module searchRoleUser 'core/security/role.bicep' = {
  scope: searchServiceResourceGroup
  name: 'search-role-user'
  params: {
    principalId: principalId
    roleDefinitionId: '1407120a-92aa-4202-b7e9-c0e197c71c8f'
    principalType: 'User'
  }
}

module searchIndexDataContribRoleUser 'core/security/role.bicep' = {
  scope: searchServiceResourceGroup
  name: 'search-index-data-contrib-role-user'
  params: {
    principalId: principalId
    roleDefinitionId: '8ebe5a00-799e-43f5-93ac-243d3dce84a7'
    principalType: 'User'
  }
}

module searchServiceContribRoleUser 'core/security/role.bicep' = {
  scope: searchServiceResourceGroup
  name: 'search-service-contrib-role-user'
  params: {
    principalId: principalId
    roleDefinitionId: '7ca78c08-252a-4471-8644-bb5ff32d4ba0'
    principalType: 'User'
  }
}

// SYSTEM IDENTITIES
module openAiRoleBackend 'core/security/role.bicep' = {
  scope: openAiResourceGroup
  name: 'openai-role-backend'
  params: {
    principalId: backend.outputs.identityPrincipalId
    roleDefinitionId: '5e0bd9bd-7b93-4f28-af87-19fc36ad61bd'
    principalType: 'ServicePrincipal'
  }
}

module searchRoleBackend 'core/security/role.bicep' = {
  scope: searchServiceResourceGroup
  name: 'search-role-backend'
  params: {
    principalId: backend.outputs.identityPrincipalId
    roleDefinitionId: '1407120a-92aa-4202-b7e9-c0e197c71c8f'
    principalType: 'ServicePrincipal'
  }
}

// For doc prep
module docPrepResources 'docprep.bicep' = {
  name: 'docprep-resources${resourceToken}'
  params: {
    location: location
    resourceToken: resourceToken
    tags: tags
    principalId: principalId
    resourceGroupName: resourceGroup.name
    formRecognizerServiceName: formRecognizerServiceName
    formRecognizerResourceGroupName: formRecognizerResourceGroupName
    formRecognizerResourceGroupLocation: formRecognizerResourceGroupLocation
    formRecognizerSkuName: !empty(formRecognizerSkuName) ? formRecognizerSkuName : 'S0'
  }
}
output AZURE_LOCATION string = location
output AZURE_TENANT_ID string = tenant().tenantId
output AZURE_RESOURCE_GROUP string = resourceGroup.name

output BACKEND_URI string = backend.outputs.uri

// search
output AZURE_SEARCH_INDEX string = searchIndexName
output AZURE_SEARCH_SERVICE string = searchService.outputs.name
output AZURE_SEARCH_SERVICE_RESOURCE_GROUP string = searchServiceResourceGroup.name
output AZURE_SEARCH_SKU_NAME string = searchService.outputs.skuName
output AZURE_SEARCH_KEY string = searchService.outputs.adminKey
output AZURE_SEARCH_USE_SEMANTIC_SEARCH bool = searchUseSemanticSearch
output AZURE_SEARCH_SEMANTIC_SEARCH_CONFIG string = searchSemanticSearchConfig
output AZURE_SEARCH_TOP_K int = searchTopK
output AZURE_SEARCH_ENABLE_IN_DOMAIN bool = searchEnableInDomain
output AZURE_SEARCH_CONTENT_COLUMNS string = searchContentColumns
output AZURE_SEARCH_FILENAME_COLUMN string = searchFilenameColumn
output AZURE_SEARCH_TITLE_COLUMN string = searchTitleColumn
output AZURE_SEARCH_URL_COLUMN string = searchUrlColumn

// openai
output AZURE_OPENAI_RESOURCE string = openAi.outputs.name
output AZURE_OPENAI_RESOURCE_GROUP string = openAiResourceGroup.name
output AZURE_OPENAI_ENDPOINT string = openAi.outputs.endpoint
output AZURE_OPENAI_MODEL string = openAIModel
output AZURE_OPENAI_MODEL_NAME string = openAIModelName
output AZURE_OPENAI_SKU_NAME string = openAi.outputs.skuName
output AZURE_OPENAI_KEY string = openAi.outputs.key
output AZURE_OPENAI_EMBEDDING_NAME string = '${embeddingDeploymentName}'
output AZURE_OPENAI_TEMPERATURE int = openAITemperature
output AZURE_OPENAI_TOP_P int = openAITopP
output AZURE_OPENAI_MAX_TOKENS int = openAIMaxTokens
output AZURE_OPENAI_STOP_SEQUENCE string = openAIStopSequence
output AZURE_OPENAI_SYSTEM_MESSAGE string = openAISystemMessage
output AZURE_OPENAI_STREAM bool = openAIStream

// Used by prepdocs.py:
output AZURE_FORMRECOGNIZER_SERVICE string = docPrepResources.outputs.AZURE_FORMRECOGNIZER_SERVICE
output AZURE_FORMRECOGNIZER_RESOURCE_GROUP string = docPrepResources.outputs.AZURE_FORMRECOGNIZER_RESOURCE_GROUP
output AZURE_FORMRECOGNIZER_SKU_NAME string = docPrepResources.outputs.AZURE_FORMRECOGNIZER_SKU_NAME

// cosmos
output AZURE_COSMOSDB_ACCOUNT string = cosmos.outputs.accountName
output AZURE_COSMOSDB_DATABASE string = cosmos.outputs.databaseName
output AZURE_COSMOSDB_CONVERSATIONS_CONTAINER string = cosmos.outputs.containerName

output AUTH_ISSUER_URI string = authIssuerUri
</file>

<file path="scripts/.env.sample">
# resource switch 
FLAG_EMBEDDING_MODEL = "AOAI" # "AOAI" or "COHERE"
FLAG_COHERE = "ENGLISH" # "MULTILINGUAL" or "ENGLISH" options for Cohere embedding models
FLAG_AOAI = "V3" # "V2" or "V3" options for AOAI embedding models

# update vector dimension based on model chosen
VECTOR_DIMENSION = 1536 # change it to desired, e.g., 1536 for AOAI ada 002, 1024 for COHERE

# AOAI resource
AZURE_OPENAI_API_VERSION = '2023-05-15'
AZURE_OPENAI_ENDPOINT = ""
AZURE_OPENAI_API_KEY = ""

# Cohere multilingual resource
COHERE_MULTILINGUAL_ENDPOINT = ""
COHERE_MULTILINGUAL_API_KEY = ""

# Cohere English resource
COHERE_ENGLISH_ENDPOINT = ""
COHERE_ENGLISH_API_KEY = ""
</file>

<file path="scripts/readme.md">
# Data Preparation

# Prepare Data Locally
Follow the instructions in this section to prepare your data locally. This is easiest for small data sets. For much larger sets, see the [instructions to use AML below](#use-aml-to-prepare-data).
## Setup
- Install the necessary packages listed in requirements.txt, e.g. `pip install --user -r requirements.txt`

## Configure
- Create a .env file similar to the .env.example file. Fill in the values for the environment variables.
- Create a config file like `config.json`. The format should be a list of JSON objects, with each object specifying a configuration of local data path and target search service and index.

```
[
    {
        "data_path": "<local path or blob URL>",
        "location": "<azure region, e.g. 'westus2'>", 
        "subscription_id": "<subscription id>",
        "resource_group": "<resource group name>",
        "search_service_name": "<search service name to use or create>",
        "index_name": "<index name to use or create>",
        "chunk_size": 1024, // set to null to disable chunking before ingestion
        "token_overlap": 128 // number of tokens to overlap between chunks
        "semantic_config_name": "default",
        "language": "en" // setting to set language of your documents. Change if your documents are not in English. Look in data_preparation.py for SUPPORTED_LANGUAGE_CODES,
        "vector_config_name": "default" // used if adding vectors to index
    }
]
```

Note: `data_path` can be a path to files located locally on your machine, or an Azure Blob URL, e.g. of the format `"https://<storage account name>.blob.core.windows.net/<container name>/<path>/"`. If a blob URL is used, the data will first be downloaded from Blob Storage to a temporary directory on your machine before data preparation proceeds.

## Create Indexes and Ingest Data
Disclaimer: Make sure there are no duplicate pages in your data. That could impact the quality of the responses you get in a negative way.

- Run the data preparation script, passing in your config file. You can set njobs for parallel parsing of your files.

     `python data_preparation.py --config config.json --njobs=4`

### Batch creation of index
Refer to the script run_batch_create_index.py to create multiple indexes in batch using one script.

## Optional: Use URL prefix
Each document can be associated with a URL that is stored with each document chunk in the Azure Cognitive Search index in the `url` field. If your documents were downloaded from the web, you can specify a URL prefix to use to construct the document URLs when ingesting your data. Your config file should have an additional `url_prefix` parameter like so:

```
[
    {
        "data_path": "<local path or blob URL>",
        "url_prefix": "https://<source website URL>.com/"
        "location": "<azure region, e.g. 'westus2'>", 
        "subscription_id": "<subscription id>",
        "resource_group": "<resource group name>",
        "search_service_name": "<search service name to use or create>",
        "index_name": "<index name to use or create>",
        "chunk_size": 1024, // set to null to disable chunking before ingestion
        "token_overlap": 128 // number of tokens to overlap between chunks
        "semantic_config_name": "default",
        "language": "en" // setting to set language of your documents. Change if your documents are not in English. Look in data_preparation.py for SUPPORTED_LANGUAGE_CODES,
        "vector_config_name": "default" // used if adding vectors to index
    }
]
```

For each document, the URL stored with chunks from that document will be `url_prefix` concatenated with the relative path of the document in `data_path`. For example, if my `data_path` is `mydata` containing the following structure:
```
mydata
       overview.html
    
    examples
            example1.html
            example2.html
```
And `url_prefix` is `"https://my-wiki.com/"`, the resulting URLs will be:
|File| URL|
|---|---|
|overview.html | `"https://my-wiki.com/overview.html"`|
|example1.html | `"https://my-wiki.com/examples/example1.html"`|
|example2.html | `"https://my-wiki.com/examples/example2.html"`|

These URLs can then be used in the citation display in the web app. See the [README](../README.md#changing-citation-display) for more detail.

If you have documents from multiple source websites, you can specify multiple paths and prefixes following the example in `config_multiple_url.json`. 
```
[
    {
        "data_paths": [
            {
                "path": "data/source1",
                "url_prefix": "https://<URL for source 1>.com/"
            },
            {
                "path": "data/source2",
                "url_prefix": "https://<URL for source 2>.com/"
            }
        ],
        "subscription_id": "<subscription id>",
        "resource_group": "<resource group name>",
        "search_service_name": "<search service name to use or create>",
        "index_name": "<index name to use or create>",
        "chunk_size": 1024,
        "token_overlap": 128,
        "semantic_config_name": "default",
        "language": "<Language to support for example use 'en' for English. Checked supported languages here under lucene - https://learn.microsoft.com/en-us/azure/search/index-add-language-analyzers"
    }
]
```

The ingestion script will loop through each path in `data_paths` and construct the document URLs following the same pattern as described above, using the specific URL prefix for each data path.

You can modify the URL construction logic in `process_file()` in [data_utils.py](./data_utils.py):
```
url_path = None
rel_file_path = os.path.relpath(file_path, directory_path)
if url_prefix:
    url_path = url_prefix + rel_file_path
    url_path = convert_escaped_to_posix(url_path)
```

## Optional: Add vector embeddings
Azure Cognitive Search supports vector search in public preview. See [the docs](https://learn.microsoft.com/en-us/azure/search/vector-search-overview) for more information.

To add vectors to your index, you will first need an [Azure OpenAI resource](https://learn.microsoft.com/en-us/azure/ai-services/openai/overview) with an [Ada embedding model deployment](https://learn.microsoft.com/en-us/azure/ai-services/openai/concepts/models#embeddings-models). The `text-embedding-ada-002` model is supported.

- Get the endpoint for embedding model deployment. The endpoint will generally be of the format `https://<azure openai resource name>.openai.azure.com/openai/deployments/<ada deployment name>/embeddings?api-version=2023-06-01-preview`.
- Run the data preparation script, passing in your config file and the embedding endpoint and key as extra arguments:

      `python data_preparation.py --config config.json --embedding-model-endpoint "<embedding endpoint>"`

## Optional: Crack PDFs to Text
If your data is in PDF format, you'll first need to convert from PDF to .txt format. You can use your own script for this, or use the provided conversion code here. 

### Setup for PDF Cracking
- Create a [Form Recognizer](https://learn.microsoft.com/en-us/azure/applied-ai-services/form-recognizer/create-a-form-recognizer-resource?view=form-recog-3.0.0) resource in your subscription 
- Make sure you have the Form Recognizer SDK: `pip install azure-ai-formrecognizer`
- Run the following command to get an access key for your Form Recognizer resource:
  `az cognitiveservices account keys list --name "<form-rec-resource-name>" --resource-group "<resource-group-name>"`

  Copy one of the keys returned by this command.

### Create Indexes and Ingest Data from PDF with Form Recognizer
Pass in your Form Recognizer resource name and key when running the data preparation script:

`python data_preparation.py --config config.json --njobs=4 --form-rec-resource <form-rec-resource-name> --form-rec-key <form-rec-key>`

This will use the Form Recognizer Read model by default. 

If your documents have a lot of tables and relevant layout information, you can use the Form Recognizer Layout model, which is more costly and slower to run but will preserve table information with better quality. The Layout model will also help preserve some of the formatting information in your document such as titles and sub-headings, which will make the citations more readable. To use the Layout model instead of the default Read model, pass in the argument `--form-rec-use-layout`.

`python data_preparation.py --config config.json --njobs=4 --form-rec-resource <form-rec-resource-name> --form-rec-key <form-rec-key> --form-rec-use-layout`

# Use AML to Prepare Data
## Setup 
- Install the [Azure ML CLI v2](https://learn.microsoft.com/en-us/azure/machine-learning/concept-v2?view=azureml-api-2)

## Prerequisites
- Azure Machine Learning (AML) Workspace with associated Keyvault
- Azure Cognitive Search (ACS) resource
- (Optional if processing PDF) [Azure AI Document Intelligence](https://learn.microsoft.com/en-us/azure/ai-services/document-intelligence/overview?view=doc-intel-3.1.0) resource
- (Optional if adding embeddings for vector search) Azure OpenAI resource with Ada (text-embedding-ada-002) deployment
- (Optional) Azure Blob Storage account

## Configure
- Create secrets in the AML keyvault for the Azure Cognitive Search resource admin key, Document Intelligence access key, and Azure OpenAI API key (if using)
- Create a config file like `aml_config.json`. The format can be a single JSON object or a list of them, with each object specifying a configuration of Keyvault secrets, chunking settings, and index configuration.
```
{
        "chunk_size": 1024,
        "token_overlap": 128,
        "keyvault_url": "https://<keyvault name>.vault.azure.net/",
        "document_intelligence_secret_name": "myDocIntelligenceKey",
        "document_intelligence_endpoint": "https://<document intelligence resource name>.cognitiveservices.azure.com/",
        "embedding_key_secret_name": "myAzureOpenAIKey",
        "embedding_endpoint": "https:/<azure openai resource name>.openai.azure.com/openai/deployments/<Ada deployment name>/embeddings?api-version=2023-06-01-preview",
        "index_name": "<new index name>",
        "search_service_name": "<search service name>",
        "search_key_secret_name": "mySearchServiceKey"
}
```

## Optional: Create an AML Datastore
If your data is in Azure Blob Storage, you can first create an AML Datastore that will be used to connect to your data during ingestion. Update `datastore.yml` with your storage account information including the account key. Then run this command, using the resource group and workspace name of your AML workspace:

```
az ml datastore create --resource-group <workspace resource group> --workspace-name <workspace name> --file datastore.yml
```

## Submit the data processing pipeline job
In `pipeline.yml`, update the inputs to point to your config file name and the datastore you created. If you're using data stored locally, comment out the datastore path and uncomment the local path, updating to point to your local data location. Then submit the pipeline job to your AML workspace:

```
az ml job create --resource-group <workspace resource group> --workspace-name <workspace name> --file pipeline.yml
```
</file>

<file path="scripts/run_batch_create_index.py">
import copy
import json
import os
from pathlib import Path
import subprocess
import tqdm
from openai import AzureOpenAI
from dotenv import load_dotenv

load_dotenv()  

FORM_RECOGNIZER_KEY = os.getenv("FORM_RECOGNIZER_KEY")

with open("./config.json", "r") as f:
    config = json.loads(f.read())

# this is an example, 
# it address how to handle subfolders 
# it also provide option wether to use form recognizer
run_config_by_data_path_3_small_512_512 = {
    "aks": "aks_embed_003_small_512_512_index",
    "azure-docs": {
        "index": "azure_embed_003_small_512_512_index",
        "subfolder": "azure-docs",
    },
    "test_loranorm": {
        "index": "test_loranorm_embed_003_small_512_512_index",
        "form-rec-use-layout": False,
    },
    
}

# change path and embedding models
Path("logs").mkdir(exist_ok=True)
for key, cfg in tqdm.tqdm(run_config_by_data_path_3_small_512_512.items()):
    folder = os.path.join("/index_data", key)
    
    if isinstance(cfg, str):
        index = cfg
        form_rec_use_layout = True
    else:
        index = cfg["index"]
        form_rec_use_layout = cfg.get("form-rec-use-layout", True)
        if "subfolder" in cfg:
            folder = os.path.join(folder, cfg["subfolder"])


    config_key = copy.deepcopy(config[0])
    config_key["data_path"] = os.path.abspath(folder)
    config_key["index_name"] = index

    print(config_key["data_path"])
    with open(f"./config.{key}.json", "w") as f:
        f.write(json.dumps([config_key]))
    
    command = [
        "python",
        "data_preparation.py",
        "--config",
        f"config.{key}.json",
        "--embedding-model-endpoint",
        '"EMBEDDING_MODEL_ENDPOINT"',
        "--form-rec-resource",
        "test-tprompt",
        "--form-rec-key",
        FORM_RECOGNIZER_KEY,
    ] + (["--form-rec-use-layout"] if form_rec_use_layout else []) + [
        "--njobs=8",
    ]
    str_command = " ".join(command)
    with open(f"logs/stdout.{key}.txt", "w") as f_stdout, open(f"logs/stderr.{key}.txt", "w") as f_stderr:
        subprocess.run(str_command, stdout=f_stdout, stderr=f_stderr)
</file>

<file path="start.cmd">
@echo off

echo.
echo Restoring backend python packages
echo.
call python -m pip install -r requirements.txt
if "%errorlevel%" neq "0" (
    echo Failed to restore backend python packages
    exit /B %errorlevel%
)

echo.
echo Restoring frontend npm packages
echo.
cd frontend
call npm install
if "%errorlevel%" neq "0" (
    echo Failed to restore frontend npm packages
    exit /B %errorlevel%
)

echo.
echo Building frontend
echo.
call npm run build
if "%errorlevel%" neq "0" (
    echo Failed to build frontend
    exit /B %errorlevel%
)

echo.    
echo Starting backend    
echo.    
cd ..  
start http://127.0.0.1:50505
call python -m uvicorn app:app  --port 50505 --reload
if "%errorlevel%" neq "0" (    
    echo Failed to start backend    
    exit /B %errorlevel%    
)
</file>

<file path="start.sh">
#!/bin/bash

echo ""
echo "Restoring frontend npm packages"
echo ""
cd frontend
npm install
if [ $? -ne 0 ]; then
    echo "Failed to restore frontend npm packages"
    exit $?
fi

echo ""
echo "Building frontend"
echo ""
npm run build
if [ $? -ne 0 ]; then
    echo "Failed to build frontend"
    exit $?
fi

cd ..
. ./scripts/loadenv.sh

echo ""
echo "Starting backend"
echo ""
./.venv/bin/python -m quart run --port=50505 --host=127.0.0.1 --reload
if [ $? -ne 0 ]; then
    echo "Failed to start backend"
    exit $?
fi
</file>

<file path="tests/conftest.py">
import pytest


def pytest_addoption(parser):
    parser.addoption(
        "--use-keyvault-secrets",
        help='Get secrets from a keyvault instead of the environment.',
        action='store_true', default=False
)


@pytest.fixture(scope="session")
def use_keyvault_secrets(request) -> str:
    return request.config.getoption("use_keyvault_secrets")
</file>

<file path="tests/integration_tests/conftest.py">
import json
import os
import pytest
from azure.identity import AzureCliCredential
from azure.keyvault.secrets import SecretClient
from pydantic.alias_generators import to_snake


VAULT_NAME = os.environ.get("VAULT_NAME")


@pytest.fixture(scope="module")
def secret_client() -> SecretClient: 
    kv_uri = f"https://{VAULT_NAME}.vault.azure.net"
    print(f"init secret_client from kv_uri={kv_uri}")
    credential = AzureCliCredential(additionally_allowed_tenants="*")
    return SecretClient(vault_url=kv_uri, credential=credential)


@pytest.fixture(scope="module")
def dotenv_template_params_from_kv(secret_client: SecretClient) -> dict[str, str]:
    secrets_properties_list = secret_client.list_properties_of_secrets()
    secrets = {}
    for secret in secrets_properties_list:
        secret_name = to_snake(secret.name).upper()
        secrets[secret_name] = secret_client.get_secret(secret.name).value

    return secrets


@pytest.fixture(scope="module")
def dotenv_template_params_from_env() -> dict[str, str]:
    def get_and_unset_variable(var_name):
        # we need this function to ensure that the environment is clean before
        # testing with generated dotenv files.
        var_value = os.getenv(var_name)
        os.environ[var_name] = ""
        return var_value
        
    env_secrets = [
        "AZURE_COSMOSDB_ACCOUNT",
        "AZURE_COSMOSDB_ACCOUNT_KEY",
        "AZURE_COSMOSDB_CONVERSATIONS_CONTAINER",
        "AZURE_COSMOSDB_DATABASE",
        "AZURE_OPENAI_EMBEDDING_NAME"
        "AZURE_OPENAI_ENDPOINT",
        "AZURE_OPENAI_MODEL",
        "AZURE_OPENAI_KEY",
        "AZURE_SEARCH_INDEX",
        "AZURE_SEARCH_KEY",
        "AZURE_SEARCH_QUERY",
        "AZURE_SEARCH_SERVICE",
        "ELASTICSEARCH_EMBEDDING_MODEL_ID",
        "ELASTICSEARCH_ENCODED_API_KEY",
        "ELASTICSEARCH_ENDPOINT",
        "ELASTICSEARCH_INDEX",
        "ELASTICSEARCH_QUERY"
    ]
    
    return {s: get_and_unset_variable(s) for s in env_secrets}


@pytest.fixture(scope="module")
def dotenv_template_params(request, use_keyvault_secrets):
    if use_keyvault_secrets:
        return request.getfixturevalue("dotenv_template_params_from_kv")
    
    return request.getfixturevalue("dotenv_template_params_from_env")
</file>

<file path=".github/workflows/docker-image-build.yml">
name: Docker Image Build

on:
  pull_request:
    branches:
    - main

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3
    - name: Build the Docker image
      run:         
        docker build . --file WebApp.Dockerfile --tag sampleappaoaichatgpt.azurecr.io/sample-app-aoai-chatgpt:$(date +'%Y-%m-%d')_$GITHUB_RUN_NUMBER
</file>

<file path="backend/security/ms_defender_utils.py">
import json

def get_msdefender_user_json(authenticated_user_details, request_headers, conversation_id, application_name):
    auth_provider = authenticated_user_details.get('auth_provider')
    source_ip = request_headers.get('Remote-Addr', '')
    header_names = ['User-Agent', 'X-Forwarded-For', 'Forwarded', 'X-Real-IP', 'True-Client-IP', 'CF-Connecting-IP']
    user_args = {
        "EndUserId": authenticated_user_details.get('user_principal_id'),
        "EndUserIdType": "EntraId" if auth_provider == "aad" else auth_provider,
        "SourceIp": source_ip.split(':')[0], #remove port
        "SourceRequestHeaders": {header: request_headers[header] for header in header_names if header in request_headers},
        "ConversationId": conversation_id,
        "ApplicationName": application_name,
    }
    return json.dumps(user_args)
</file>

<file path="frontend/jest.config.ts">
import type { Config } from '@jest/types'

const config: Config.InitialOptions = {
  verbose: true,
  transform: {
    '^.+\\.tsx?$': 'ts-jest'
  },
  setupFilesAfterEnv: ['<rootDir>/polyfills.js']
}

export default config
</file>

<file path="frontend/src/components/QuestionInput/QuestionInput.tsx">
import { useContext, useState } from 'react'
import { FontIcon, Stack, TextField } from '@fluentui/react'
import { SendRegular } from '@fluentui/react-icons'

import Send from '../../assets/Send.svg'

import styles from './QuestionInput.module.css'
import { ChatMessage } from '../../api'
import { AppStateContext } from '../../state/AppProvider'
import { resizeImage } from '../../utils/resizeImage'

interface Props {
  onSend: (question: ChatMessage['content'], id?: string) => void
  disabled: boolean
  placeholder?: string
  clearOnSend?: boolean
  conversationId?: string
}

export const QuestionInput = ({ onSend, disabled, placeholder, clearOnSend, conversationId }: Props) => {
  const [question, setQuestion] = useState<string>('')
  const [base64Image, setBase64Image] = useState<string | null>(null);

  const appStateContext = useContext(AppStateContext)
  const OYD_ENABLED = appStateContext?.state.frontendSettings?.oyd_enabled || false;

  const handleImageUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {
    const file = event.target.files?.[0];

    if (file) {
      await convertToBase64(file);
    }
  };

  const convertToBase64 = async (file: Blob) => {
    try {
      const resizedBase64 = await resizeImage(file, 800, 800);
      setBase64Image(resizedBase64);
    } catch (error) {
      console.error('Error:', error);
    }
  };

  const sendQuestion = () => {
    if (disabled || !question.trim()) {
      return
    }

    const questionTest: ChatMessage["content"] = base64Image ? [{ type: "text", text: question }, { type: "image_url", image_url: { url: base64Image } }] : question.toString();

    if (conversationId && questionTest !== undefined) {
      onSend(questionTest, conversationId)
      setBase64Image(null)
    } else {
      onSend(questionTest)
      setBase64Image(null)
    }

    if (clearOnSend) {
      setQuestion('')
    }
  }

  const onEnterPress = (ev: React.KeyboardEvent<Element>) => {
    if (ev.key === 'Enter' && !ev.shiftKey && !(ev.nativeEvent?.isComposing === true)) {
      ev.preventDefault()
      sendQuestion()
    }
  }

  const onQuestionChange = (_ev: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {
    setQuestion(newValue || '')
  }

  const sendQuestionDisabled = disabled || !question.trim()

  return (
    <Stack horizontal className={styles.questionInputContainer}>
      <TextField
        className={styles.questionInputTextArea}
        placeholder={placeholder}
        multiline
        resizable={false}
        borderless
        value={question}
        onChange={onQuestionChange}
        onKeyDown={onEnterPress}
      />
      {!OYD_ENABLED && (
        <div className={styles.fileInputContainer}>
          <input
            type="file"
            id="fileInput"
            onChange={(event) => handleImageUpload(event)}
            accept="image/*"
            className={styles.fileInput}
          />
          <label htmlFor="fileInput" className={styles.fileLabel} aria-label='Upload Image'>
            <FontIcon
              className={styles.fileIcon}
              iconName={'PhotoCollection'}
              aria-label='Upload Image'
            />
          </label>
        </div>)}
      {base64Image && <img className={styles.uploadedImage} src={base64Image} alt="Uploaded Preview" />}
      <div
        className={styles.questionInputSendButtonContainer}
        role="button"
        tabIndex={0}
        aria-label="Ask question button"
        onClick={sendQuestion}
        onKeyDown={e => (e.key === 'Enter' || e.key === ' ' ? sendQuestion() : null)}>
        {sendQuestionDisabled ? (
          <SendRegular className={styles.questionInputSendButtonDisabled} />
        ) : (
          <img src={Send} className={styles.questionInputSendButton} alt="Send Button" />
        )}
      </div>
      <div className={styles.questionInputBottomBorder} />
    </Stack>
  )
}
</file>

<file path="frontend/src/index.tsx">
import React from 'react'
import ReactDOM from 'react-dom/client'
import { HashRouter, Route, Routes } from 'react-router-dom'
import { initializeIcons } from '@fluentui/react'
import { MsalProvider } from '@azure/msal-react'
import { PublicClientApplication } from '@azure/msal-browser'

import Chat from './pages/chat/Chat'
import Layout from './pages/layout/Layout'
import NoPage from './pages/NoPage'
import { AppStateProvider } from './state/AppProvider'
import { msalConfig } from '../authConfig.js'

import './index.css'

initializeIcons("https://res.cdn.office.net/files/fabric-cdn-prod_20241209.001/assets/icons/")

const msalInstance = new PublicClientApplication(msalConfig)

export default function App() {
  return (
    <MsalProvider instance={msalInstance}>
      <AppStateProvider>
        <HashRouter>
          <Routes>
            <Route path="/" element={<Layout />}>
              <Route index element={<Chat />} />
              <Route path="*" element={<NoPage />} />
            </Route>
          </Routes>
        </HashRouter>
      </AppStateProvider>
    </MsalProvider>
  )
}

ReactDOM.createRoot(document.getElementById('root') as HTMLElement).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
)
</file>

<file path="frontend/src/pages/layout/Layout.module.css">
.layout {
  display: flex;
  flex-direction: column;
  height: 100%;
}

.header {
  background-color: #eeeeee;
}

.headerContainer {
  display: flex;
  justify-content: left;
  align-items: center;
}

.headerTitleContainer {
  display: flex;
  align-items: center;
  margin-left: 14px;
  text-decoration: none;
}

.headerTitle {
  font-style: normal;
  font-weight: 600;
  font-size: 20px;
  line-height: 28px;
  display: flex;
  align-items: flex-end;
  color: #242424;
}

.headerIcon {
  height: 32px;
  width: auto;
  margin-left: 36px;
}

.shareButtonContainer {
  display: flex;
  flex-direction: row;
  justify-content: center;
  margin-right: 20px;
}

.shareButton {
  color: #ffffff;
}

.shareButtonText {
  font-style: normal;
  font-weight: 600;
  font-size: 14px;
  line-height: 20px;
  display: flex;
  align-items: center;
  color: #ffffff;
}

.urlTextBox {
  font-style: normal;
  font-weight: 400;
  font-size: 14px;
  line-height: 20px;
  color: #707070;
  border: 1px solid #d1d1d1;
  border-radius: 4px;
}

.copyButtonContainer {
  box-sizing: border-box;
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  padding: 5px 12px;
  gap: 4px;
  background: #ffffff;
  border: 1px solid #d1d1d1;
  border-radius: 4px;
}

.copyButtonContainer:hover {
  cursor: pointer;
  background: #d1d1d1;
}

.copyButton {
  color: #424242;
}

.copyButtonText {
  font-style: normal;
  font-weight: 600;
  font-size: 14px;
  line-height: 20px;
  display: flex;
  align-items: center;
  color: #242424;
}

@media (max-width: 480px) {
  .headerTitleContainer {
    margin-left: 4px;
  }

  .headerIcon {
    margin-left: 26px;
  }
  
}
._authButtonsBar {
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    justify-content: center;
    gap: 16px;
    padding: 16px 0;
    background: #860038;
    z-index: 1000;
    box-shadow: 0 -2px 8px #00000014;
}
</file>

<file path="frontend/src/state/AppReducer.tsx">
import { Action, AppState } from './AppProvider'

// Define the reducer function
export const appStateReducer = (state: AppState, action: Action): AppState => {
  switch (action.type) {
    case 'TOGGLE_CHAT_HISTORY':
      return { ...state, isChatHistoryOpen: !state.isChatHistoryOpen }
    case 'UPDATE_CURRENT_CHAT':
      return { ...state, currentChat: action.payload }
    case 'UPDATE_CHAT_HISTORY_LOADING_STATE':
      return { ...state, chatHistoryLoadingState: action.payload }
    case 'UPDATE_CHAT_HISTORY':
      if (!state.chatHistory || !state.currentChat) {
        return state
      }
      const conversationIndex = state.chatHistory.findIndex(conv => conv.id === action.payload.id)
      if (conversationIndex !== -1) {
        const updatedChatHistory = [...state.chatHistory]
        updatedChatHistory[conversationIndex] = state.currentChat
        return { ...state, chatHistory: updatedChatHistory }
      } else {
        return { ...state, chatHistory: [...state.chatHistory, action.payload] }
      }
    case 'UPDATE_CHAT_TITLE':
      if (!state.chatHistory) {
        return { ...state, chatHistory: [] }
      }
      const updatedChats = state.chatHistory.map(chat => {
        if (chat.id === action.payload.id) {
          if (state.currentChat?.id === action.payload.id) {
            state.currentChat.title = action.payload.title
          }
          //TODO: make api call to save new title to DB
          return { ...chat, title: action.payload.title }
        }
        return chat
      })
      return { ...state, chatHistory: updatedChats }
    case 'DELETE_CHAT_ENTRY':
      if (!state.chatHistory) {
        return { ...state, chatHistory: [] }
      }
      const filteredChat = state.chatHistory.filter(chat => chat.id !== action.payload)
      state.currentChat = null
      //TODO: make api call to delete conversation from DB
      return { ...state, chatHistory: filteredChat }
    case 'DELETE_CHAT_HISTORY':
      //TODO: make api call to delete all conversations from DB
      return { ...state, chatHistory: [], filteredChatHistory: [], currentChat: null }
    case 'DELETE_CURRENT_CHAT_MESSAGES':
      //TODO: make api call to delete current conversation messages from DB
      if (!state.currentChat || !state.chatHistory) {
        return state
      }
      const updatedCurrentChat = {
        ...state.currentChat,
        messages: []
      }
      return {
        ...state,
        currentChat: updatedCurrentChat
      }
    case 'FETCH_CHAT_HISTORY':
      return { ...state, chatHistory: action.payload }
    case 'SET_COSMOSDB_STATUS':
      return { ...state, isCosmosDBAvailable: action.payload }
    case 'FETCH_FRONTEND_SETTINGS':
      return { ...state, isLoading: false, frontendSettings: action.payload }
    case 'SET_FEEDBACK_STATE':
      return {
        ...state,
        feedbackState: {
          ...state.feedbackState,
          [action.payload.answerId]: action.payload.feedback
        }
      }
    case 'SET_ANSWER_EXEC_RESULT':
      return {
        ...state,
        answerExecResult: {
          ...state.answerExecResult,
          [action.payload.answerId]: action.payload.exec_result
        }
      }
    default:
      return state
  }
}
</file>

<file path="frontend/vite.config.ts">
import react from '@vitejs/plugin-react'
import { defineConfig } from 'vite'

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [react()],
  build: {
    outDir: '../static',
    emptyOutDir: false, // Prevents clearing the folder
    sourcemap: true
  },
  server: {
    proxy: {
      '/ask': 'http://localhost:5000',
      '/chat': 'http://localhost:5000',
      
    }
  }
})
</file>

<file path="requirements-dev.txt">
-r requirements.txt
azure-ai-documentintelligence==1.0.0b2
Markdown==3.4.4
requests==2.31.0
tqdm==4.66.1
tiktoken==0.4.0
langchain==0.0.340
bs4==0.0.1
urllib3==2.1.0
pytest==7.4.0
pytest-asyncio==0.23.2
PyMuPDF==1.24.5
azure-storage-blob
chardet
azure-keyvault-secrets
coverage
</file>

<file path="tests/integration_tests/dotenv_templates/dotenv.jinja2">
DATASOURCE_TYPE={{ DATASOURCE_TYPE }}
AZURE_OPENAI_ENDPOINT={{ AZURE_OPENAI_ENDPOINT }}
AZURE_OPENAI_MODEL={{ AZURE_OPENAI_MODEL }}
{% if not USE_MI %}
AZURE_OPENAI_KEY={{ AZURE_OPENAI_KEY }}
{% endif %}
AZURE_OPENAI_TEMPERATURE=0
AZURE_OPENAI_TOP_P=1.0
AZURE_OPENAI_MAX_TOKENS=1000
AZURE_OPENAI_STOP_SEQUENCE=
AZURE_OPENAI_SYSTEM_MESSAGE=You are an AI assistant that helps people find information.
AZURE_OPENAI_PREVIEW_API_VERSION=2024-05-01-preview
AZURE_OPENAI_STREAM={{ AZURE_OPENAI_STREAM }}
{% if USE_AOAI_EMBEDDINGS and AZURE_OPENAI_EMBEDDING_NAME %}
AZURE_OPENAI_EMBEDDING_NAME={{ AZURE_OPENAI_EMBEDDING_NAME }}
{% endif %}
{% if USE_AOAI_EMBEDDINGS %}
AZURE_OPENAI_EMBEDDING_ENDPOINT={{ AZURE_OPENAI_ENDPOINT }}/openai/deployments/ada/embeddings?api-version=2023-03-15-preview
{% if not USE_MI %}
AZURE_OPENAI_EMBEDDING_KEY={{ AZURE_OPENAI_KEY }}
{% endif %}
{% endif %}
{% if ENABLE_CHAT_HISTORY %}
AZURE_COSMOSDB_ACCOUNT={{ AZURE_COSMOSDB_ACCOUNT }}
AZURE_COSMOSDB_DATABASE={{ AZURE_COSMOSDB_DATABASE }}
AZURE_COSMOSDB_CONVERSATIONS_CONTAINER={{ AZURE_COSMOSDB_CONVERSATIONS_CONTAINER }}
AZURE_COSMOSDB_ACCOUNT_KEY={{ AZURE_COSMOSDB_ACCOUNT_KEY }}
AZURE_COSMOSDB_ENABLE_FEEDBACK={{ AZURE_COSMOSDB_ENABLE_FEEDBACK }}
{% endif %}
{% if DATASOURCE_TYPE == "AzureCognitiveSearch" %}
AZURE_SEARCH_SERVICE={{ AZURE_SEARCH_SERVICE }}
AZURE_SEARCH_INDEX={{ AZURE_SEARCH_INDEX }}
AZURE_SEARCH_KEY={{ AZURE_SEARCH_KEY }}
AZURE_SEARCH_SEMANTIC_SEARCH_CONFIG=
AZURE_SEARCH_CONTENT_COLUMNS=content
AZURE_SEARCH_FILENAME_COLUMN=
AZURE_SEARCH_TITLE_COLUMN=
AZURE_SEARCH_URL_COLUMN=
AZURE_SEARCH_VECTOR_COLUMNS=contentVector
AZURE_SEARCH_QUERY_TYPE={{ AZURE_SEARCH_QUERY_TYPE }}
AZURE_SEARCH_PERMITTED_GROUPS_COLUMN={{ AZURE_SEARCH_PERMITTED_GROUPS_COLUMN }}
{% elif DATASOURCE_TYPE == "Elasticsearch" %}
ELASTICSEARCH_ENDPOINT={{ ELASTICSEARCH_ENDPOINT }}
ELASTICSEARCH_ENCODED_API_KEY={{ ELASTICSEARCH_ENCODED_API_KEY }}
ELASTICSEARCH_INDEX={{ ELASTICSEARCH_INDEX }}
ELASTICSEARCH_QUERY_TYPE={{ ELASTICSEARCH_QUERY_TYPE }}
ELASTICSEARCH_CONTENT_COLUMNS=text
ELASTICSEARCH_FILENAME_COLUMN=
ELASTICSEARCH_TITLE_COLUMN=
ELASTICSEARCH_URL_COLUMN=
ELASTICSEARCH_VECTOR_COLUMNS=text_embedding.predicted_value
{% if USE_ELASTICSEARCH_EMBEDDINGS and ELASTICSEARCH_EMBEDDING_MODEL_ID %}
ELASTICSEARCH_EMBEDDING_MODEL_ID={{ ELASTICSEARCH_EMBEDDING_MODEL_ID }}
{% endif %}
{% elif DATASOURCE_TYPE == "AzureCosmosDB" %}
AZURE_COSMOSDB_MONGO_VCORE_CONNECTION_STRING={{ AZURE_COSMOSDB_MONGO_VCORE_CONNECTION_STRING }}
AZURE_COSMOSDB_MONGO_VCORE_DATABASE={{ AZURE_COSMOSDB_MONGO_VCORE_DATABASE }}
AZURE_COSMOSDB_MONGO_VCORE_CONTAINER={{ AZURE_COSMOSDB_MONGO_VCORE_CONTAINER }}
AZURE_COSMOSDB_MONGO_VCORE_INDEX={{ AZURE_COSMOSDB_MONGO_VCORE_INDEX }}
AZURE_COSMOSDB_MONGO_VCORE_CONTENT_COLUMNS={{ AZURE_COSMOSDB_MONGO_VCORE_CONTENT_COLUMNS }}
AZURE_COSMOSDB_MONGO_VCORE_FILENAME_COLUMN=
AZURE_COSMOSDB_MONGO_VCORE_TITLE_COLUMN=
AZURE_COSMOSDB_MONGO_VCORE_URL_COLUMN=
AZURE_COSMOSDB_MONGO_VCORE_VECTOR_COLUMNS={{ AZURE_COSMOSDB_MONGO_VCORE_VECTOR_COLUMNS }}
{% elif DATASOURCE_TYPE == "Pinecone" %}
PINECONE_ENVIRONMENT={{ PINECONE_ENVIRONMENT }}
PINECONE_API_KEY={{ PINECONE_API_KEY }}
PINECONE_INDEX_NAME={{ PINECONE_INDEX_NAME }}
PINECONE_CONTENT_COLUMNS={{ PINECONE_CONTENT_COLUMNS }}
PINECONE_FILENAME_COLUMN=
PINECONE_TITLE_COLUMN=
PINECONE_URL_COLUMN=
PINECONE_VECTOR_COLUMNS={{ PINECONE_VECTOR_COLUMNS }}
{% elif DATASOURCE_TYPE == "AzureMLIndex" %}
AZURE_MLINDEX_NAME={{ AZURE_ML_INDEX_NAME }}
AZURE_MLINDEX_VERSION={{ AZURE_ML_INDEX_VERSION }}
AZURE_ML_PROJECT_RESOURCE_ID={{ AZURE_ML_PROJECT_RESOURCE_ID }}
AZURE_MLINDEX_CONTENT_COLUMNS={{ AZURE_ML_INDEX_CONTENT_COLUMNS }}
AZURE_MLINDEX_FILENAME_COLUMN=
AZURE_MLINDEX_TITLE_COLUMN= 
AZURE_MLINDEX_URL_COLUMN= 
AZURE_MLINDEX_VECTOR_COLUMNS={{ AZURE_ML_INDEX_VECTOR_COLUMNS }}
{% endif %}
</file>

<file path="tests/integration_tests/test_datasources.py">
import os
import pytest
from tempfile import NamedTemporaryFile
from importlib import import_module, reload
from jinja2 import FileSystemLoader
from jinja2 import Environment
from quart import Quart


datasources = [
    "AzureCognitiveSearch",
    "Elasticsearch",
    "none"  # TODO: add tests for additional data sources
]


def render_template_to_tempfile(
    template_prefix,
    input_template,
    **template_params
):
    template_environment = Environment()
    template_environment.loader = FileSystemLoader(
        os.path.dirname(input_template)
    )
    template_environment.trim_blocks = True
    template = template_environment.get_template(
        os.path.basename(input_template)
    )

    with NamedTemporaryFile(
        'w',
        prefix=f"{template_prefix}-",
        delete=False
    ) as g:
        g.write(template.render(**template_params))
        rendered_output = g.name

    print(f"Rendered template at {rendered_output}")
    return rendered_output


@pytest.fixture(scope="function", params=datasources, ids=datasources)
def datasource(request):
    return request.param


@pytest.fixture(scope="function", params=[True, False], ids=["with_chat_history", "no_chat_history"])
def enable_chat_history(request):
    return request.param


@pytest.fixture(scope="function", params=[True, False], ids=["streaming", "nonstreaming"])
def stream(request):
    return request.param


@pytest.fixture(scope="function", params=[True, False], ids=["with_aoai_embeddings", "no_aoai_embeddings"])
def use_aoai_embeddings(request):
    return request.param


@pytest.fixture(scope="function", params=[True, False], ids=["with_es_embeddings", "no_es_embeddings"])
def use_elasticsearch_embeddings(request):
    return request.param

@pytest.fixture(scope="function", params=[True, False], ids=["use_mi", "use_keys"])
def use_mi(request):
    return request.param


@pytest.fixture(scope="function")
def dotenv_rendered_template_path(
    request,
    dotenv_template_params,
    datasource,
    enable_chat_history,
    stream, 
    use_aoai_embeddings,
    use_elasticsearch_embeddings, 
    use_mi
):
    rendered_template_name = request.node.name.replace("[", "_").replace("]", "_")
    template_path = os.path.join(
        os.path.dirname(__file__),
        "dotenv_templates",
        "dotenv.jinja2"
    )

    if datasource != "none":
        dotenv_template_params["DATASOURCE_TYPE"] = datasource
    
    if datasource != "Elasticsearch" and use_elasticsearch_embeddings:
        pytest.skip("Elasticsearch embeddings not supported for test.")
        
    if datasource == "Elasticsearch":
        dotenv_template_params["USE_ELASTICSEARCH_EMBEDDINGS"] = use_elasticsearch_embeddings
    
    dotenv_template_params["USE_AOAI_EMBEDDINGS"] = use_aoai_embeddings
    dotenv_template_params["USE_MI"] = use_mi
    
    if use_aoai_embeddings or use_elasticsearch_embeddings:
        dotenv_template_params["AZURE_SEARCH_QUERY_TYPE"] = "vector"
        dotenv_template_params["ELASTICSEARCH_QUERY_TYPE"] = "vector"
    else:
        dotenv_template_params["AZURE_SEARCH_QUERY_TYPE"] = "simple"
        dotenv_template_params["ELASTICSEARCH_QUERY_TYPE"] = "simple"
    
    dotenv_template_params["ENABLE_CHAT_HISTORY"] = enable_chat_history
    dotenv_template_params["AZURE_OPENAI_STREAM"] = stream
    
    return render_template_to_tempfile(
        rendered_template_name,
        template_path,
        **dotenv_template_params
    )


@pytest.fixture(scope="function")
def test_app(dotenv_rendered_template_path) -> Quart:
    os.environ["DOTENV_PATH"] = dotenv_rendered_template_path
    app_module = import_module("app")
    app_module = reload(app_module)
    
    app = getattr(app_module, "app")
    return app


@pytest.mark.asyncio
async def test_dotenv(test_app: Quart, dotenv_template_params: dict[str, str]):
    if dotenv_template_params["DATASOURCE_TYPE"] == "AzureCognitiveSearch":
        message_content = dotenv_template_params["AZURE_SEARCH_QUERY"]
        
    elif dotenv_template_params["DATASOURCE_TYPE"] == "Elasticsearch":
        message_content = dotenv_template_params["ELASTICSEARCH_QUERY"]
        
    else:
        message_content = "What is Contoso?"
        
    request_path = "/conversation"
    request_data = {
        "messages": [
            {
                "role": "user",
                "content": message_content
            }
        ]
    }
    
    test_client = test_app.test_client()
    response = await test_client.post(request_path, json=request_data)
    assert response.status_code == 200
    response_content = await response.get_data()
    print(response_content)
</file>

<file path="tests/unit_tests/test_settings.py">
import os
import pytest
from importlib import import_module, reload


@pytest.fixture(scope="function")
def dotenv_path(request):
    test_case_name = request.node.originalname.partition("test_")[2]
    return os.path.join(
        os.path.dirname(__file__),
        "dotenv_data",
        test_case_name
    )


@pytest.fixture(scope="function")
def app_settings(dotenv_path):
    # Reload module object to pick up new environment
    os.environ["DOTENV_PATH"] = dotenv_path
    settings_module = import_module("backend.settings")
    settings_module = reload(settings_module)
    
    yield getattr(settings_module, "app_settings")


def test_dotenv_no_datasource_1(app_settings):    
    # Validate model object
    assert app_settings.base_settings.datasource_type is None
    assert app_settings.datasource is None
    assert app_settings.azure_openai is not None
    
    
def test_dotenv_no_datasource_2(app_settings):    
    # Validate model object
    assert app_settings.datasource is None
    assert app_settings.azure_openai is not None

    
def test_dotenv_with_azure_search_success(app_settings):
    # Validate model object
    assert app_settings.search is not None
    assert app_settings.base_settings.datasource_type == "AzureCognitiveSearch"
    assert app_settings.datasource is not None
    assert app_settings.datasource.service == "search_service"
    assert app_settings.azure_openai is not None
    
    # Validate API payload structure
    payload = app_settings.datasource.construct_payload_configuration()
    assert payload["type"] == "azure_search"
    assert payload["parameters"] is not None
    assert payload["parameters"]["endpoint"] == "https://search_service.search.windows.net"
    print(payload)


def test_dotenv_with_elasticsearch_success(app_settings):
    # Validate model object
    assert app_settings.search is not None
    assert app_settings.base_settings.datasource_type == "Elasticsearch"
    assert app_settings.datasource is not None
    assert app_settings.datasource.endpoint == "dummy"
    assert app_settings.azure_openai is not None
    
    # Validate API payload structure
    payload = app_settings.datasource.construct_payload_configuration()
    assert payload["type"] == "elasticsearch"
    assert payload["parameters"] is not None
    assert payload["parameters"]["endpoint"] == "dummy"
    print(payload)
</file>

<file path="frontend/src/state/AppProvider.tsx">
import React, {
  createContext,
  ReactNode,
  useEffect,
  useReducer
} from 'react'

import {
  ChatHistoryLoadingState,
  Conversation,
  CosmosDBHealth,
  CosmosDBStatus,
  Feedback,
  FrontendSettings,
  frontendSettings,
  historyEnsure,
  historyList
} from '../api'

import { appStateReducer } from './AppReducer'

export interface AppState {
  isChatHistoryOpen: boolean
  chatHistoryLoadingState: ChatHistoryLoadingState
  isCosmosDBAvailable: CosmosDBHealth
  chatHistory: Conversation[] | null
  filteredChatHistory: Conversation[] | null
  currentChat: Conversation | null
  frontendSettings: FrontendSettings | null
  feedbackState: { [answerId: string]: Feedback.Neutral | Feedback.Positive | Feedback.Negative }
  isLoading: boolean;
  answerExecResult: { [answerId: string]: [] }
}

export type Action =
  | { type: 'TOGGLE_CHAT_HISTORY' }
  | { type: 'SET_COSMOSDB_STATUS'; payload: CosmosDBHealth }
  | { type: 'UPDATE_CHAT_HISTORY_LOADING_STATE'; payload: ChatHistoryLoadingState }
  | { type: 'UPDATE_CURRENT_CHAT'; payload: Conversation | null }
  | { type: 'UPDATE_FILTERED_CHAT_HISTORY'; payload: Conversation[] | null }
  | { type: 'UPDATE_CHAT_HISTORY'; payload: Conversation }
  | { type: 'UPDATE_CHAT_TITLE'; payload: Conversation }
  | { type: 'DELETE_CHAT_ENTRY'; payload: string }
  | { type: 'DELETE_CHAT_HISTORY' }
  | { type: 'DELETE_CURRENT_CHAT_MESSAGES'; payload: string }
  | { type: 'FETCH_CHAT_HISTORY'; payload: Conversation[] | null }
  | { type: 'FETCH_FRONTEND_SETTINGS'; payload: FrontendSettings | null }
  | {
    type: 'SET_FEEDBACK_STATE'
    payload: { answerId: string; feedback: Feedback.Positive | Feedback.Negative | Feedback.Neutral }
  }
  | { type: 'GET_FEEDBACK_STATE'; payload: string }
  | { type: 'SET_ANSWER_EXEC_RESULT'; payload: { answerId: string, exec_result: [] } }

const initialState: AppState = {
  isChatHistoryOpen: false,
  chatHistoryLoadingState: ChatHistoryLoadingState.Loading,
  chatHistory: null,
  filteredChatHistory: null,
  currentChat: null,
  isCosmosDBAvailable: {
    cosmosDB: false,
    status: CosmosDBStatus.NotConfigured
  },
  frontendSettings: null,
  feedbackState: {},
  isLoading: true,
  answerExecResult: {},
}

export const AppStateContext = createContext<
  | {
    state: AppState
    dispatch: React.Dispatch<Action>
    devLog: (...args: unknown[]) => void
  }
  | undefined
>(undefined)


// 3) Create the function in the provider and pass it in value
const devLog = (...args: unknown[]) => {
  console.log("devLog:", import.meta.env.DEV)
  if (import.meta.env.DEV) {
    console.log(...args)
  }
}


type AppStateProviderProps = {
  children: ReactNode
}

export const AppStateProvider: React.FC<AppStateProviderProps> = ({ children }) => {
  const [state, dispatch] = useReducer(appStateReducer, initialState)

  useEffect(() => {
    // Check for cosmosdb config and fetch initial data here
    const fetchChatHistory = async (offset = 0): Promise<Conversation[] | null> => {
      const result = await historyList(offset)
        .then(response => {
          if (response) {
            dispatch({ type: 'FETCH_CHAT_HISTORY', payload: response })
          } else {
            dispatch({ type: 'FETCH_CHAT_HISTORY', payload: null })
          }
          return response
        })
        .catch(_err => {
          dispatch({ type: 'UPDATE_CHAT_HISTORY_LOADING_STATE', payload: ChatHistoryLoadingState.Fail })
          dispatch({ type: 'FETCH_CHAT_HISTORY', payload: null })
          console.error('There was an issue fetching your data.')
          return null
        })
      return result
    }

    const getHistoryEnsure = async () => {
      dispatch({ type: 'UPDATE_CHAT_HISTORY_LOADING_STATE', payload: ChatHistoryLoadingState.Loading })
      historyEnsure()
        .then(response => {
          if (response?.cosmosDB) {
            fetchChatHistory()
              .then(res => {
                if (res) {
                  dispatch({ type: 'UPDATE_CHAT_HISTORY_LOADING_STATE', payload: ChatHistoryLoadingState.Success })
                  dispatch({ type: 'SET_COSMOSDB_STATUS', payload: response })
                } else {
                  dispatch({ type: 'UPDATE_CHAT_HISTORY_LOADING_STATE', payload: ChatHistoryLoadingState.Fail })
                  dispatch({
                    type: 'SET_COSMOSDB_STATUS',
                    payload: { cosmosDB: false, status: CosmosDBStatus.NotWorking }
                  })
                }
              })
              .catch(_err => {
                dispatch({ type: 'UPDATE_CHAT_HISTORY_LOADING_STATE', payload: ChatHistoryLoadingState.Fail })
                dispatch({
                  type: 'SET_COSMOSDB_STATUS',
                  payload: { cosmosDB: false, status: CosmosDBStatus.NotWorking }
                })
              })
          } else {
            dispatch({ type: 'UPDATE_CHAT_HISTORY_LOADING_STATE', payload: ChatHistoryLoadingState.Fail })
            dispatch({ type: 'SET_COSMOSDB_STATUS', payload: response })
          }
        })
        .catch(_err => {
          dispatch({ type: 'UPDATE_CHAT_HISTORY_LOADING_STATE', payload: ChatHistoryLoadingState.Fail })
          dispatch({ type: 'SET_COSMOSDB_STATUS', payload: { cosmosDB: false, status: CosmosDBStatus.NotConfigured } })
        })
    }
    getHistoryEnsure()
  }, [])

  useEffect(() => {
    const getFrontendSettings = async () => {
      frontendSettings()
        .then(response => {
          dispatch({ type: 'FETCH_FRONTEND_SETTINGS', payload: response as FrontendSettings })
        })
        .catch(_err => {
          console.error('There was an issue fetching your data.')
        })
    }
    getFrontendSettings()
  }, [])

  return <AppStateContext.Provider value={{ state, dispatch, devLog }}>{children}</AppStateContext.Provider>
}
</file>

<file path="requirements.txt">
azure-identity==1.15.0
Flask[async]==3.0.3
openai==1.55.3
azure-search-documents==11.4.0b6
azure-storage-blob==12.17.0
python-dotenv==1.0.0
azure-cosmos==4.5.0
quart==0.19.9
uvicorn==0.24.0
aiohttp==3.9.2
gunicorn==20.1.0
pydantic-settings==2.2.1
</file>

<file path="scripts/data_preparation.py">
"""Data Preparation Script for an Azure Cognitive Search Index."""
import argparse
import dataclasses
import json
import os
import subprocess
import time

import requests
from azure.ai.documentintelligence import DocumentIntelligenceClient
from azure.core.credentials import AzureKeyCredential
from azure.identity import AzureCliCredential
from azure.search.documents import SearchClient
from dotenv import load_dotenv
from tqdm import tqdm

from data_utils import chunk_directory, chunk_blob_container

# Configure environment variables  
load_dotenv() # take environment variables from .env.

SUPPORTED_LANGUAGE_CODES = {
    "ar": "Arabic",
    "hy": "Armenian",
    "eu": "Basque",
    "bg": "Bulgarian",
    "ca": "Catalan",
    "zh-Hans": "Chinese Simplified",
    "zh-Hant": "Chinese Traditional",
    "cs": "Czech",
    "da": "Danish",
    "nl": "Dutch",
    "en": "English",
    "fi": "Finnish",
    "fr": "French",
    "gl": "Galician",
    "de": "German",
    "el": "Greek",
    "hi": "Hindi",
    "hu": "Hungarian",
    "id": "Indonesian (Bahasa)",
    "ga": "Irish",
    "it": "Italian",
    "ja": "Japanese",
    "ko": "Korean",
    "lv": "Latvian",
    "no": "Norwegian",
    "fa": "Persian",
    "pl": "Polish",
    "pt-Br": "Portuguese (Brazil)",
    "pt-Pt": "Portuguese (Portugal)",
    "ro": "Romanian",
    "ru": "Russian",
    "es": "Spanish",
    "sv": "Swedish",
    "th": "Thai",
    "tr": "Turkish"
}


def check_if_search_service_exists(search_service_name: str,
    subscription_id: str,
    resource_group: str,
    credential = None):
    """_summary_

    Args:
        search_service_name (str): _description_
        subscription_id (str): _description_
        resource_group (str): _description_
        credential: Azure credential to use for getting acs instance
    """
    if credential is None:
        raise ValueError("credential cannot be None")
    url = (
        f"https://management.azure.com/subscriptions/{subscription_id}"
        f"/resourceGroups/{resource_group}/providers/Microsoft.Search/searchServices"
        f"/{search_service_name}?api-version=2024-03-01-Preview"
    )

    headers = {
        "Content-Type": "application/json",
        "Authorization": f"Bearer {credential.get_token('https://management.azure.com/.default').token}",
    }

    response = requests.get(url, headers=headers)
    return response.status_code == 200


def create_search_service(
    search_service_name: str,
    subscription_id: str,
    resource_group: str,
    location: str,
    sku: str = "standard",
    credential = None,
):
    """_summary_

    Args:
        search_service_name (str): _description_
        subscription_id (str): _description_
        resource_group (str): _description_
        location (str): _description_
        credential: Azure credential to use for creating acs instance

    Raises:
        Exception: _description_
    """
    if credential is None:
        raise ValueError("credential cannot be None")
    url = (
        f"https://management.azure.com/subscriptions/{subscription_id}"
        f"/resourceGroups/{resource_group}/providers/Microsoft.Search/searchServices"
        f"/{search_service_name}?api-version=2024-03-01-Preview"
    )

    payload = {
        "location": f"{location}",
        "sku": {"name": sku},
        "properties": {
            "replicaCount": 1,
            "partitionCount": 1,
            "hostingMode": "default",
            "semanticSearch": "free",
        },
    }

    headers = {
        "Content-Type": "application/json",
        "Authorization": f"Bearer {credential.get_token('https://management.azure.com/.default').token}",
    }

    response = requests.put(url, json=payload, headers=headers)
    if response.status_code != 201:
        raise Exception(
            f"Failed to create search service. Error: {response.text}")

def create_or_update_search_index(
        service_name, 
        subscription_id=None, 
        resource_group=None, 
        index_name="default-index", 
        semantic_config_name="default", 
        credential=None, 
        language=None,
        vector_config_name=None,
        admin_key=None):
    
    if credential is None and admin_key is None:
        raise ValueError("credential and admin key cannot be None")
    
    if not admin_key:
        admin_key = json.loads(
            subprocess.run(
                f"az search admin-key show --subscription {subscription_id} --resource-group {resource_group} --service-name {service_name}",
                shell=True,
                capture_output=True,
            ).stdout
        )["primaryKey"]

    url = f"https://{service_name}.search.windows.net/indexes/{index_name}?api-version=2024-03-01-Preview"
    headers = {
        "Content-Type": "application/json",
        "api-key": admin_key,
    }

    body = {
        "fields": [
            {
                "name": "id",
                "type": "Edm.String",
                "searchable": True,
                "key": True,
            },
            {
                "name": "content",
                "type": "Edm.String",
                "searchable": True,
                "sortable": False,
                "facetable": False,
                "filterable": False,
                "analyzer": f"{language}.lucene" if language else None,
            },
            {
                "name": "title",
                "type": "Edm.String",
                "searchable": True,
                "sortable": False,
                "facetable": False,
                "filterable": False,
                "analyzer": f"{language}.lucene" if language else None,
            },
            {
                "name": "filepath",
                "type": "Edm.String",
                "searchable": True,
                "sortable": False,
                "facetable": False,
                "filterable": False,
            },
            {
                "name": "url",
                "type": "Edm.String",
                "searchable": True,
            },
            {
                "name": "metadata",
                "type": "Edm.String",
                "searchable": True,
            },
            {
                "name": "image_mapping",
                "type": "Edm.String",
                "searchable": False,
                "sortable": False,
                "facetable": False,
                "filterable": False
            }
        ],
        "suggesters": [],
        "scoringProfiles": [],
        "semantic": {
            "configurations": [
                {
                    "name": semantic_config_name,
                    "prioritizedFields": {
                        "titleField": {"fieldName": "title"},
                        "prioritizedContentFields": [{"fieldName": "content"}],
                        "prioritizedKeywordsFields": [],
                    },
                }
            ]
        },
    }

    if vector_config_name:
        body["fields"].append({
            "name": "contentVector",
            "type": "Collection(Edm.Single)",
            "searchable": True,
            "retrievable": True,
            "stored": True,
            "dimensions": int(os.getenv("VECTOR_DIMENSION", 1536)),
            "vectorSearchProfile": vector_config_name
        })

        body["vectorSearch"] = {
        "algorithms": [
            {
                "name": "my-hnsw-config-1",
                "kind": "hnsw",
                "hnswParameters": {
                    "m": 4,
                    "efConstruction": 400,
                    "efSearch": 500,
                    "metric": "cosine"
                }
            }
        ],
        "profiles": [
            {
                "name": vector_config_name,
                "algorithm": "my-hnsw-config-1"
            }
        ]
        }

    response = requests.put(url, json=body, headers=headers)
    if response.status_code == 201:
        print(f"Created search index {index_name}")
    elif response.status_code == 204:
        print(f"Updated existing search index {index_name}")
    else:
        raise Exception(f"Failed to create search index. Error: {response.text}")
    
    return True


def upload_documents_to_index(service_name, subscription_id, resource_group, index_name, docs, credential=None, upload_batch_size = 50, admin_key=None):
    if credential is None and admin_key is None:
        raise ValueError("credential and admin_key cannot be None")
    
    to_upload_dicts = []

    id = 0
    for d in docs:
        if type(d) is not dict:
            d = dataclasses.asdict(d)
        # add id to documents
        d.update({"@search.action": "upload", "id": str(id)})
        if "contentVector" in d and d["contentVector"] is None:
            del d["contentVector"]
        to_upload_dicts.append(d)
        id += 1
    
    endpoint = "https://{}.search.windows.net/".format(service_name)
    if not admin_key:
        admin_key = json.loads(
            subprocess.run(
                f"az search admin-key show --subscription {subscription_id} --resource-group {resource_group} --service-name {service_name}",
                shell=True,
                capture_output=True,
            ).stdout
        )["primaryKey"]

    search_client = SearchClient(
        endpoint=endpoint,
        index_name=index_name,
        credential=AzureKeyCredential(admin_key),
    )
    # Upload the documents in batches of upload_batch_size
    for i in tqdm(range(0, len(to_upload_dicts), upload_batch_size), desc="Indexing Chunks..."):
        batch = to_upload_dicts[i: i + upload_batch_size]
        results = search_client.upload_documents(documents=batch)
        num_failures = 0
        errors = set()
        for result in results:
            if not result.succeeded:
                print(f"Indexing Failed for {result.key} with ERROR: {result.error_message}")
                num_failures += 1
                errors.add(result.error_message)
        if num_failures > 0:
            raise Exception(f"INDEXING FAILED for {num_failures} documents. Please recreate the index."
                            f"To Debug: PLEASE CHECK chunk_size and upload_batch_size. \n Error Messages: {list(errors)}")

def validate_index(service_name, subscription_id, resource_group, index_name):
    api_version = "2024-03-01-Preview"
    admin_key = json.loads(
        subprocess.run(
            f"az search admin-key show --subscription {subscription_id} --resource-group {resource_group} --service-name {service_name}",
            shell=True,
            capture_output=True,
        ).stdout
    )["primaryKey"]

    headers = {
        "Content-Type": "application/json", 
        "api-key": admin_key}
    params = {"api-version": api_version}
    url = f"https://{service_name}.search.windows.net/indexes/{index_name}/stats"
    for retry_count in range(5):
        response = requests.get(url, headers=headers, params=params)

        if response.status_code == 200:
            response = response.json()
            num_chunks = response['documentCount']
            if num_chunks==0 and retry_count < 4:
                print("Index is empty. Waiting 60 seconds to check again...")
                time.sleep(60)
            elif num_chunks==0 and retry_count == 4:
                print("Index is empty. Please investigate and re-index.")
            else:
                print(f"The index contains {num_chunks} chunks.")
                average_chunk_size = response['storageSize']/num_chunks
                print(f"The average chunk size of the index is {average_chunk_size} bytes.")
                break
        else:
            if response.status_code==404:
                print(f"The index does not seem to exist. Please make sure the index was created correctly, and that you are using the correct service and index names")
            elif response.status_code==403:
                print(f"Authentication Failure: Make sure you are using the correct key")
            else:
                print(f"Request failed. Please investigate. Status code: {response.status_code}")
            break

def create_index(config, credential, form_recognizer_client=None, embedding_model_endpoint=None, use_layout=False, njobs=4, captioning_model_endpoint=None, captioning_model_key=None):
    service_name = config["search_service_name"]
    subscription_id = config["subscription_id"]
    resource_group = config["resource_group"]
    location = config["location"]
    index_name = config["index_name"]
    language = config.get("language", None)

    if language and language not in SUPPORTED_LANGUAGE_CODES:
        raise Exception(f"ERROR: Ingestion does not support {language} documents. "
                        f"Please use one of {SUPPORTED_LANGUAGE_CODES}."
                        f"Language is set as two letter code for e.g. 'en' for English."
                        f"If you donot want to set a language just remove this prompt config or set as None")


    # check if search service exists, create if not
    try:
        if check_if_search_service_exists(service_name, subscription_id, resource_group, credential):
            print(f"Using existing search service {service_name}")
        else:
            print(f"Creating search service {service_name}")
            create_search_service(service_name, subscription_id, resource_group, location, credential=credential)
    except Exception as e:
        print(f"Unable to verify if search service exists. Error: {e}")
        print("Proceeding to attempt to create index.")

    # create or update search index with compatible schema
    admin_key = os.environ.get("AZURE_SEARCH_ADMIN_KEY", None)
    if not create_or_update_search_index(service_name, subscription_id, resource_group, index_name, config["semantic_config_name"], credential, language, vector_config_name=config.get("vector_config_name", None), admin_key=admin_key):
        raise Exception(f"Failed to create or update index {index_name}")
    
    data_configs = []
    if "data_path" in config:
        data_configs.append({
            "path": config["data_path"],
            "url_prefix": config.get("url_prefix", None),
        })
    if "data_paths" in config:
        data_configs.extend(config["data_paths"])

    for data_config in data_configs:
        # chunk directory
        print(f"Chunking path {data_config['path']}...")
        add_embeddings = False
        if config.get("vector_config_name") and embedding_model_endpoint:
            add_embeddings = True

        if "blob.core" in data_config["path"]:
            result = chunk_blob_container(data_config["path"], credential=credential, num_tokens=config["chunk_size"], token_overlap=config.get("token_overlap",0),
                                azure_credential=credential, form_recognizer_client=form_recognizer_client, use_layout=use_layout, njobs=njobs,
                                add_embeddings=add_embeddings, embedding_endpoint=embedding_model_endpoint, url_prefix=data_config["url_prefix"])
        elif os.path.exists(data_config["path"]):
            result = chunk_directory(data_config["path"], num_tokens=config["chunk_size"], token_overlap=config.get("token_overlap",0),
                                    azure_credential=credential, form_recognizer_client=form_recognizer_client, use_layout=use_layout, njobs=njobs,
                                    add_embeddings=add_embeddings, embedding_endpoint=embedding_model_endpoint, url_prefix=data_config["url_prefix"],
                                    captioning_model_endpoint=captioning_model_endpoint, captioning_model_key=captioning_model_key)
        else:
            raise Exception(f"Path {data_config['path']} does not exist and is not a blob URL. Please check the path and try again.")

        if len(result.chunks) == 0:
            raise Exception("No chunks found. Please check the data path and chunk size.")

        print(f"Processed {result.total_files} files")
        print(f"Unsupported formats: {result.num_unsupported_format_files} files")
        print(f"Files with errors: {result.num_files_with_errors} files")
        print(f"Found {len(result.chunks)} chunks")

        # upload documents to index
        print("Uploading documents to index...")
        upload_documents_to_index(service_name, subscription_id, resource_group, index_name, result.chunks, credential)

    # check if index is ready/validate index
    print("Validating index...")
    validate_index(service_name, subscription_id, resource_group, index_name)
    print("Index validation completed")


def valid_range(n):
    n = int(n)
    if n < 1 or n > 32:
        raise argparse.ArgumentTypeError("njobs must be an Integer between 1 and 32.")
    return n

if __name__ == "__main__": 
    parser = argparse.ArgumentParser()
    parser.add_argument("--config", type=str, help="Path to config file containing settings for data preparation")
    parser.add_argument("--form-rec-resource", type=str, help="Name of your Form Recognizer resource to use for PDF cracking.")
    parser.add_argument("--form-rec-key", type=str, help="Key for your Form Recognizer resource to use for PDF cracking.")
    parser.add_argument("--form-rec-use-layout", default=True, action='store_true', help="Whether to use Layout model for PDF cracking, if False will use Read model.")
    parser.add_argument("--njobs", type=valid_range, default=4, help="Number of jobs to run (between 1 and 32). Default=4")
    parser.add_argument("--embedding-model-endpoint", type=str, help="Endpoint for the embedding model to use for vector search. Format: 'https://<AOAI resource name>.openai.azure.com/openai/deployments/<Ada deployment name>/embeddings?api-version=2024-03-01-Preview'")
    parser.add_argument("--embedding-model-key", type=str, help="Key for the embedding model to use for vector search.")
    parser.add_argument("--search-admin-key", type=str, help="Admin key for the search service. If not provided, will use Azure CLI to get the key.")
    parser.add_argument("--azure-openai-endpoint", type=str, help="Endpoint for the (Azure) OpenAI API. Format: 'https://<AOAI resource name>.openai.azure.com/openai/deployments/<vision model name>/chat/completions?api-version=2024-04-01-preview'")
    parser.add_argument("--azure-openai-key", type=str, help="Key for the (Azure) OpenAI API.")
    args = parser.parse_args()

    with open(args.config) as f:
        config = json.load(f)

    credential = AzureCliCredential()
    form_recognizer_client = None

    print("Data preparation script started")
    if args.search_admin_key:
        os.environ["AZURE_SEARCH_ADMIN_KEY"] = args.search_admin_key

    if args.form_rec_resource and args.form_rec_key:
        os.environ["FORM_RECOGNIZER_ENDPOINT"] = f"https://{args.form_rec_resource}.cognitiveservices.azure.com/"
        os.environ["FORM_RECOGNIZER_KEY"] = args.form_rec_key
        if args.njobs==1:
            form_recognizer_client = DocumentIntelligenceClient(endpoint=f"https://{args.form_rec_resource}.cognitiveservices.azure.com/", credential=AzureKeyCredential(args.form_rec_key))
        print(f"Using Form Recognizer resource {args.form_rec_resource} for PDF cracking, with the {'Layout' if args.form_rec_use_layout else 'Read'} model.")

    for index_config in config:
        print("Preparing data for index:", index_config["index_name"])
        if index_config.get("vector_config_name") and not args.embedding_model_endpoint:
            raise Exception("ERROR: Vector search is enabled in the config, but no embedding model endpoint and key were provided. Please provide these values or disable vector search.")
    
        create_index(index_config, credential, form_recognizer_client, embedding_model_endpoint=args.embedding_model_endpoint, use_layout=args.form_rec_use_layout, njobs=args.njobs, captioning_model_endpoint=args.azure_openai_endpoint, captioning_model_key=args.azure_openai_key)
        print("Data preparation for index", index_config["index_name"], "completed")

    print(f"Data preparation script completed. {len(config)} indexes updated.")
</file>

<file path=".github/workflows/node.js.yml">
# This workflow will do a clean installation of node dependencies, cache/restore them, build the source code and run tests across different versions of node
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-nodejs

name: Build Frontend

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
    

jobs:
  build:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: frontend
    strategy:
      matrix:
        node-version: [14.x, 16.x, 18.x, 21.x]
        # See supported Node.js release schedule at https://nodejs.org/en/about/releases/

    steps:
    - uses: actions/checkout@v3
    - name: Use Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v3
      with:
        node-version: ${{ matrix.node-version }}
        cache: 'npm'
        cache-dependency-path: '**/package-lock.json'
    - run: npm ci
    - run: NODE_OPTIONS=--max_old_space_size=8192 npm run build --if-present
    - run: npm run test --if-present
</file>

<file path=".github/workflows/python-app.yml">
# This workflow will install Python dependencies, run tests and lint with a single version of Python
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-python

name: Python application

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

permissions:
  contents: read

jobs:
  test_linux:
    runs-on:
    - ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Set up Python 3.11
      uses: actions/setup-python@v3
      with:
        python-version: "3.11"
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements-dev.txt
    - name: Test with pytest
      env:
        AZURE_OPENAI_ENDPOINT: ${{ secrets.AZUREOPENAIENDPOINT }}
        AZURE_OPENAI_MODEL: ${{ secrets.AZUREOPENAIMODEL }}
        AZURE_OPENAI_KEY: ${{ secrets.AZUREOPENAIKEY }}
        AZURE_OPENAI_EMBEDDING_NAME: ${{ secrets.AZUREOPENAIEMBEDDINGNAME }}
        AZURE_COSMOSDB_ACCOUNT: ${{ secrets.AZURECOSMOSDBACCOUNT }}
        AZURE_COSMOSDB_DATABASE: ${{ secrets.AZURECOSMOSDBDATABASE }}
        AZURE_COSMOSDB_CONVERSATIONS_CONTAINER: ${{ secrets.AZURECOSMOSDBCONVERSATIONSCONTAINER }}
        AZURE_COSMOSDB_ACCOUNT_KEY: ${{ secrets.AZURECOSMOSDBACCOUNTKEY }}
        AZURE_SEARCH_SERVICE: ${{ secrets.AZURESEARCHSERVICE }}
        AZURE_SEARCH_INDEX: ${{ secrets.AZURESEARCHINDEX }}
        AZURE_SEARCH_KEY: ${{ secrets.AZURESEARCHKEY }}
        AZURE_SEARCH_QUERY: ${{ secrets.AZURESEARCHQUERY }}
        ELASTICSEARCH_EMBEDDING_MODEL_ID: ${{ secrets.ELASTICSEARCHEMBEDDINGMODELID }}
        ELASTICSEARCH_ENCODED_API_KEY: ${{ secrets.ELASTICSEARCHENCODEDAPIKEY }}
        ELASTICSEARCH_ENDPOINT: ${{ secrets.ELASTICSEARCHENDPOINT }}
        ELASTICSEARCH_INDEX: ${{ secrets.ELASTICSEARCHINDEX }}
        ELASTICSEARCH_QUERY: ${{ secrets.ELASTICSEARCHQUERY }}
      run: |
        export PYTHONPATH=$(pwd)
        coverage run -m pytest -v --show-capture=stdout
        coverage report -m --include=app.py,backend/*,tests/*
        coverage xml

    - name: Code Coverage Report
      uses: irongut/CodeCoverageSummary@v1.3.0
      with:
        filename: coverage.xml
        badge: true
        fail_below_min: true
        format: markdown
        hide_branch_rate: false
        hide_complexity: true
        indicators: true
        output: both
        thresholds: '50 80'

  test_windows:
    runs-on:
    - windows-latest
    steps:
    - uses: actions/checkout@v3
    - name: Set up Python 3.11
      uses: actions/setup-python@v3
      with:
        python-version: "3.11"
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements-dev.txt
    - name: Test with pytest
      run: |
        $env:PYTHONPATH=$pwd
        pytest -v --show-capture=stdout -k "not integration"
</file>

<file path="frontend/src/components/Answer/AnswerParser.test.ts">
import { cloneDeep } from 'lodash'

import { AskResponse, Citation } from '../../api' // Ensure this path matches the location of your types

import { enumerateCitations, parseAnswer, ParsedAnswer } from './AnswerParser' // Update the path accordingly

const sampleCitations: Citation[] = [
  {
    id: 'doc1',
    filepath: 'file1.pdf',
    part_index: undefined,
    content: '',
    title: null,
    url: null,
    metadata: null,
    chunk_id: null,
    reindex_id: null
  },
  {
    id: 'doc2',
    filepath: 'file1.pdf',
    part_index: undefined,
    content: '',
    title: null,
    url: null,
    metadata: null,
    chunk_id: null,
    reindex_id: null
  },
  {
    id: 'doc3',
    filepath: 'file2.pdf',
    part_index: undefined,
    content: '',
    title: null,
    url: null,
    metadata: null,
    chunk_id: null,
    reindex_id: null
  }
]

const sampleAnswer: AskResponse = {
  answer: 'This is an example answer with citations [doc1] and [doc2].',
  citations: cloneDeep(sampleCitations),
  generated_chart: null
}

describe('enumerateCitations', () => {
  it('assigns unique part_index based on filepath', () => {
    const results = enumerateCitations(cloneDeep(sampleCitations))
    expect(results[0].part_index).toEqual(1)
    expect(results[1].part_index).toEqual(2)
    expect(results[2].part_index).toEqual(1)
  })
})
</file>

<file path="frontend/src/pages/chat/Chat.module.css">
.container {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.chatRoot {
  flex: 1;
  display: flex;
  margin-top: 0px;
  margin-bottom: 20px;
  margin-left: 20px;
  margin-right: 20px;
  gap: 5px;
}

.chatContainer {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  background: radial-gradient(108.78% 108.78% at 50.02% 19.78%, #ffffff 57.29%, #eef6fe 100%);
  box-shadow:
    0px 2px 4px rgba(0, 0, 0, 0.14),
    0px 0px 2px rgba(0, 0, 0, 0.12);
  border-radius: 8px;
  overflow-y: auto;
  max-height: calc(100vh - 100px);
}

.chatEmptyState {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.chatEmptyStateTitle {
  font-style: normal;
  font-weight: 700;
  font-size: 36px;
  display: flex;
  align-items: flex-end;
  text-align: center;
  line-height: 24px;
  margin-top: 36px;
  margin-bottom: 0px;
}

.chatEmptyStateSubtitle {
  margin-top: 20px;
  font-style: normal;
  font-weight: 400;
  font-size: 16px;
  line-height: 150%;
  align-items: flex-end;
  text-align: center;
  letter-spacing: -0.01em;
  color: #616161;
}

.chatIcon {
  height: 62px;
  width: auto;
}

.chatMessageStream {
  flex-grow: 1;
  max-width: 1028px;
  width: 100%;
  overflow-y: auto;
  padding-left: 24px;
  padding-right: 24px;
  display: flex;
  flex-direction: column;
  margin-top: 24px;
}

.chatMessageUser {
  display: flex;
  justify-content: flex-end;
  margin-bottom: 12px;
}

.chatMessageUserMessage {
  position: relative;
  display: flex;
  padding: 20px;
  background: #edf5fd;
  border-radius: 8px;
  box-shadow:
    0px 2px 4px rgba(0, 0, 0, 0.14),
    0px 0px 2px rgba(0, 0, 0, 0.12);
  font-style: normal;
  font-weight: 400;
  font-size: 14px;
  line-height: 22px;
  color: #242424;
  order: 0;
  flex-grow: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
  max-width: 80%;
}

.chatMessageGpt {
  margin-bottom: 12px;
  max-width: 80%;
  display: flex;
}

.chatMessageError {
  padding: 20px;
  border-radius: 8px;
  box-shadow:
    rgba(182, 52, 67, 1) 1px 1px 2px,
    rgba(182, 52, 67, 1) 0px 0px 1px;
  color: #242424;
  flex: none;
  order: 0;
  flex-grow: 0;
  max-width: 800px;
  margin-bottom: 12px;
}

.chatMessageErrorContent {
  font-family: 'Segoe UI';
  font-style: normal;
  font-weight: 400;
  font-size: 14px;
  line-height: 22px;
  white-space: pre-wrap;
  word-wrap: break-word;
  gap: 12px;
  align-items: center;
}

.chatInput {
  position: sticky;
  flex: 0 0 100px;
  padding-top: 12px;
  padding-bottom: 24px;
  padding-left: 24px;
  padding-right: 24px;
  width: calc(100% - 100px);
  max-width: 1028px;
  margin-bottom: 50px;
  margin-top: 8px;
}

.clearChatBroom {
  box-sizing: border-box;
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  position: absolute;
  width: 40px;
  height: 40px;
  left: 7px;
  top: 13px;
  color: #ffffff;
  border-radius: 4px;
  z-index: 1;
}

.clearChatBroomNoCosmos {
  box-sizing: border-box;
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  position: absolute;
  width: 40px;
  height: 40px;
  left: 7px;
  top: 66px;
  color: #ffffff;
  border-radius: 4px;
  z-index: 1;
}

.newChatIcon {
  box-sizing: border-box;
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  position: absolute;
  width: 40px;
  height: 40px;
  left: 7px;
  top: 66px;
  color: #ffffff;
  border-radius: 4px;
  z-index: 1;
}

.stopGeneratingContainer {
  box-sizing: border-box;
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  padding: 5px 16px;
  gap: 4px;
  position: absolute;
  width: 161px;
  height: 32px;
  left: calc(50% - 161px / 2 + 25.8px);
  bottom: 116px;
  border: 1px solid #d1d1d1;
  border-radius: 16px;
}

.stopGeneratingIcon {
  width: 14px;
  height: 14px;
  color: #424242;
}

.stopGeneratingText {
  width: 103px;
  height: 20px;
  font-style: normal;
  font-weight: 600;
  font-size: 14px;
  line-height: 20px;
  display: flex;
  align-items: center;
  color: #242424;
  flex: none;
  order: 0;
  flex-grow: 0;
}

.citationPanel {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  padding: 16px 16px;
  gap: 8px;
  background: #ffffff;
  box-shadow:
    0px 2px 4px rgba(0, 0, 0, 0.14),
    0px 0px 2px rgba(0, 0, 0, 0.12);
  border-radius: 8px;
  flex: auto;
  order: 0;
  align-self: stretch;
  flex-grow: 0.3;
  max-width: 30%;
  overflow-y: scroll;
  max-height: calc(100vh - 100px);
}

.citationPanelHeaderContainer {
  width: 100%;
}

.citationPanelHeader {
  font-style: normal;
  font-weight: 600;
  font-size: 18px;
  line-height: 24px;
  color: #000000;
  flex: none;
  order: 0;
  flex-grow: 0;
}

.citationPanelDismiss {
  width: 18px;
  height: 18px;
  color: #424242;
}

.citationPanelDismiss:hover {
  background-color: #d1d1d1;
  cursor: pointer;
}

.citationPanelTitle {
  font-style: normal;
  font-weight: 600;
  font-size: 16px;
  line-height: 22px;
  color: #323130;
  margin-top: 12px;
  margin-bottom: 12px;
}

.citationPanelTitle:hover {
  text-decoration: underline;
  cursor: pointer;
}

.citationPanelContent {
  font-style: normal;
  font-weight: 400;
  font-size: 14px;
  line-height: 20px;
  color: #000000;
  flex: none;
  order: 1;
  align-self: stretch;
  flex-grow: 0;
}

.exectResultList {
  display: flex;
  flex-direction: column;
  gap: 2px;
  border-bottom: 1px solid #ccc;
  margin-top: 12px;
}

.exectResultList:first-child {
  margin-top: 0;
}

.exectResultList:last-child {
  border-bottom: none;
}

.exectResultList > p {
  display: flex;
  flex-direction: row;
  gap: 4px;
  margin: 0;
  margin-bottom: 16px;
}

.exectResultList > span {
  font-weight: 600;
}

a {
  padding-left: 5px;
  padding-right: 5px;
}

.viewSourceButton {
  font-style: normal;
  font-weight: 600;
  font-size: 12px;
  line-height: 16px;
  color: #115ea3;
  flex-direction: row;
  align-items: center;
  padding: 4px 6px;
  gap: 4px;
  border: 1px solid #d1d1d1;
  border-radius: 4px;
}

.viewSourceButton:hover {
  text-decoration: underline;
  cursor: pointer;
}

.uploadedImageChat {
  position: absolute;
  right: -23px;
  bottom: -35px;
  max-width: 70%;
  max-height: 70%;
  border-radius: 4px;
}

@media (max-width: 480px) {
  .chatInput {
    width: 90%;
    max-width: 90%;
  }

  .newChatIcon {
    left: 0px;
  }

  .clearChatBroom {
    left: 0px;
  }

  .clearChatBroomNoCosmos {
    left: 0px;
  }

  .chatEmptyStateTitle {
    line-height: 36px;
  }

  .citationPanel {
    max-width: 100%;
  }
}
</file>

<file path=".env.sample">
# Chat
DEBUG=True
AZURE_OPENAI_RESOURCE=
AZURE_OPENAI_MODEL=
AZURE_OPENAI_KEY=
AZURE_OPENAI_MODEL_NAME=gpt-35-turbo-16k
AZURE_OPENAI_TEMPERATURE=0
AZURE_OPENAI_TOP_P=1.0
AZURE_OPENAI_MAX_TOKENS=1000
AZURE_OPENAI_STOP_SEQUENCE=
AZURE_OPENAI_SEED=
AZURE_OPENAI_CHOICES_COUNT=1
AZURE_OPENAI_PRESENCE_PENALTY=0.0
AZURE_OPENAI_FREQUENCY_PENALTY=0.0
AZURE_OPENAI_LOGIT_BIAS=
AZURE_OPENAI_USER=
AZURE_OPENAI_TOOLS=
AZURE_OPENAI_TOOL_CHOICE=
AZURE_OPENAI_SYSTEM_MESSAGE=You are an AI assistant that helps people find information.
AZURE_OPENAI_PREVIEW_API_VERSION=2024-05-01-preview
AZURE_OPENAI_STREAM=True
AZURE_OPENAI_ENDPOINT=
AZURE_OPENAI_EMBEDDING_NAME=
AZURE_OPENAI_EMBEDDING_ENDPOINT=
AZURE_OPENAI_EMBEDDING_KEY=
# User Interface
UI_TITLE=
UI_LOGO=
UI_CHAT_LOGO=
UI_CHAT_TITLE=
UI_CHAT_DESCRIPTION=
UI_FAVICON=
# Chat history
AZURE_COSMOSDB_ACCOUNT=
AZURE_COSMOSDB_DATABASE=db_conversation_history
AZURE_COSMOSDB_CONVERSATIONS_CONTAINER=conversations
AZURE_COSMOSDB_ACCOUNT_KEY=
AZURE_COSMOSDB_ENABLE_FEEDBACK=False
# Chat with data: common settings
DATASOURCE_TYPE=
SEARCH_TOP_K=5
SEARCH_STRICTNESS=3
SEARCH_ENABLE_IN_DOMAIN=True
# Chat with data: Azure AI Search
AZURE_SEARCH_SERVICE=
AZURE_SEARCH_INDEX=
AZURE_SEARCH_KEY=
AZURE_SEARCH_SEMANTIC_SEARCH_CONFIG=
AZURE_SEARCH_INDEX_IS_PRECHUNKED=False
AZURE_SEARCH_TOP_K=5
AZURE_SEARCH_ENABLE_IN_DOMAIN=False
AZURE_SEARCH_CONTENT_COLUMNS=
AZURE_SEARCH_FILENAME_COLUMN=
AZURE_SEARCH_TITLE_COLUMN=
AZURE_SEARCH_URL_COLUMN=
AZURE_SEARCH_VECTOR_COLUMNS=
AZURE_SEARCH_QUERY_TYPE=simple
AZURE_SEARCH_PERMITTED_GROUPS_COLUMN=
AZURE_SEARCH_STRICTNESS=3
# Chat with data: Azure CosmosDB Mongo VCore
AZURE_COSMOSDB_MONGO_VCORE_CONNECTION_STRING=
AZURE_COSMOSDB_MONGO_VCORE_DATABASE=
AZURE_COSMOSDB_MONGO_VCORE_CONTAINER=
AZURE_COSMOSDB_MONGO_VCORE_INDEX=
AZURE_COSMOSDB_MONGO_VCORE_INDEX=
AZURE_COSMOSDB_MONGO_VCORE_TOP_K=
AZURE_COSMOSDB_MONGO_VCORE_STRICTNESS=
AZURE_COSMOSDB_MONGO_VCORE_ENABLE_IN_DOMAIN=
AZURE_COSMOSDB_MONGO_VCORE_CONTENT_COLUMNS=
AZURE_COSMOSDB_MONGO_VCORE_FILENAME_COLUMN=
AZURE_COSMOSDB_MONGO_VCORE_TITLE_COLUMN=
AZURE_COSMOSDB_MONGO_VCORE_URL_COLUMN=
AZURE_COSMOSDB_MONGO_VCORE_VECTOR_COLUMNS=
# Chat with data: Elasticsearch
ELASTICSEARCH_ENDPOINT=
ELASTICSEARCH_ENCODED_API_KEY=
ELASTICSEARCH_INDEX=
ELASTICSEARCH_QUERY_TYPE=
ELASTICSEARCH_TOP_K=
ELASTICSEARCH_ENABLE_IN_DOMAIN= 
ELASTICSEARCH_CONTENT_COLUMNS= 
ELASTICSEARCH_FILENAME_COLUMN=
ELASTICSEARCH_TITLE_COLUMN=
ELASTICSEARCH_URL_COLUMN=
ELASTICSEARCH_VECTOR_COLUMNS=
ELASTICSEARCH_STRICTNESS=
ELASTICSEARCH_EMBEDDING_MODEL_ID= 
# Chat with data: Pinecone
PINECONE_ENVIRONMENT=
PINECONE_API_KEY=
PINECONE_INDEX_NAME=
PINECONE_TOP_K=
PINECONE_STRICTNESS=
PINECONE_ENABLE_IN_DOMAIN=
PINECONE_CONTENT_COLUMNS=
PINECONE_FILENAME_COLUMN=
PINECONE_TITLE_COLUMN=
PINECONE_URL_COLUMN=
PINECONE_VECTOR_COLUMNS= 
# Chat with data: Azure Machine Learning MLIndex
AZURE_MLINDEX_NAME=
AZURE_MLINDEX_VERSION=
AZURE_ML_PROJECT_RESOURCE_ID=
AZURE_MLINDEX_TOP_K= 
AZURE_MLINDEX_STRICTNESS= 
AZURE_MLINDEX_ENABLE_IN_DOMAIN=
AZURE_MLINDEX_CONTENT_COLUMNS= 
AZURE_MLINDEX_FILENAME_COLUMN=
AZURE_MLINDEX_TITLE_COLUMN= 
AZURE_MLINDEX_URL_COLUMN= 
AZURE_MLINDEX_VECTOR_COLUMNS=
AZURE_MLINDEX_QUERY_TYPE=
# Chat with data: Prompt flow API
USE_PROMPTFLOW=False
PROMPTFLOW_ENDPOINT=
PROMPTFLOW_API_KEY=
PROMPTFLOW_RESPONSE_TIMEOUT=120
PROMPTFLOW_REQUEST_FIELD_NAME=query
PROMPTFLOW_RESPONSE_FIELD_NAME=reply
PROMPTFLOW_CITATIONS_FIELD_NAME=documents
# Chat with data: MongoDB database
MONGODB_ENDPOINT=
MONGODB_USERNAME=
MONGODB_PASSWORD=
MONGODB_DATABASE_NAME=
MONGODB_COLLECTION_NAME=
MONGODB_APP_NAME=
MONGODB_INDEX_NAME=
MONGODB_TOP_K=
MONGODB_STRICTNESS=
MONGODB_ENABLE_IN_DOMAIN=
MONGODB_CONTENT_COLUMNS=
MONGODB_FILENAME_COLUMN=
MONGODB_TITLE_COLUMN=
MONGODB_URL_COLUMN=
MONGODB_VECTOR_COLUMNS=
</file>

<file path="frontend/src/components/Answer/AnswerParser.tsx">
import { cloneDeep } from 'lodash'

import { AskResponse, Citation } from '../../api'

export type ParsedAnswer = {
  citations: Citation[]
  markdownFormatText: string,
  generated_chart: string | null
} | null

export const enumerateCitations = (citations: Citation[]) => {
  const filepathMap = new Map()
  for (const citation of citations) {
    const { filepath } = citation
    let part_i = 1
    if (filepathMap.has(filepath)) {
      part_i = filepathMap.get(filepath) + 1
    }
    filepathMap.set(filepath, part_i)
    citation.part_index = part_i
  }
  return citations
}

export function parseAnswer(answer: AskResponse): ParsedAnswer {
  if (typeof answer.answer !== "string") return null
  let answerText = answer.answer
  const citationLinks = answerText.match(/\[(doc\d\d?\d?)]/g)

  const lengthDocN = '[doc'.length

  let filteredCitations = [] as Citation[]
  let citationReindex = 0
  citationLinks?.forEach(link => {
    // Replacing the links/citations with number
    const citationIndex = link.slice(lengthDocN, link.length - 1)
    const citation = cloneDeep(answer.citations[Number(citationIndex) - 1]) as Citation
    if (!filteredCitations.find(c => c.id === citationIndex) && citation) {
      answerText = answerText.replaceAll(link, ` ^${++citationReindex}^ `)
      citation.id = citationIndex // original doc index to de-dupe
      citation.reindex_id = citationReindex.toString() // reindex from 1 for display
      filteredCitations.push(citation)
    }
  })

  filteredCitations = enumerateCitations(filteredCitations)

  return {
    citations: filteredCitations,
    markdownFormatText: answerText,
    generated_chart: answer.generated_chart
  }
}
</file>

<file path="frontend/src/pages/layout/Layout.tsx">
import { useContext, useEffect, useState } from 'react'
import { Link, Outlet } from 'react-router-dom'
import { Dialog, Stack, TextField } from '@fluentui/react'
import { CopyRegular } from '@fluentui/react-icons'

import { CosmosDBStatus } from '../../api'
import Contoso from '../../assets/csudhsvg.svg'
import { HistoryButton, ShareButton } from '../../components/common/Button'
import { AppStateContext } from '../../state/AppProvider'

import styles from './Layout.module.css'

const Layout = () => {
  const [isSharePanelOpen, setIsSharePanelOpen] = useState<boolean>(false)
  const [copyClicked, setCopyClicked] = useState<boolean>(false)
  const [copyText, setCopyText] = useState<string>('Copy URL')
  const [shareLabel, setShareLabel] = useState<string | undefined>('Share')
  const [hideHistoryLabel, setHideHistoryLabel] = useState<string>('Hide chat history')
  const [showHistoryLabel, setShowHistoryLabel] = useState<string>('Show chat history')
  const [logo, setLogo] = useState('')
  const appStateContext = useContext(AppStateContext)
  const ui = appStateContext?.state.frontendSettings?.ui

  const handleShareClick = () => {
    setIsSharePanelOpen(true)
  }

  const handleSharePanelDismiss = () => {
    setIsSharePanelOpen(false)
    setCopyClicked(false)
    setCopyText('Copy URL')
  }

  const handleCopyClick = () => {
    navigator.clipboard.writeText(window.location.href)
    setCopyClicked(true)
  }

  const handleHistoryClick = () => {
    appStateContext?.dispatch({ type: 'TOGGLE_CHAT_HISTORY' })
  }

  useEffect(() => {
    if (!appStateContext?.state.isLoading) {
      setLogo(ui?.logo || Contoso)
    }
  }, [appStateContext?.state.isLoading])

  useEffect(() => {
    if (copyClicked) {
      setCopyText('Copied URL')
    }
  }, [copyClicked])

  useEffect(() => { }, [appStateContext?.state.isCosmosDBAvailable.status])

  useEffect(() => {
    const handleResize = () => {
      if (window.innerWidth < 480) {
        setShareLabel(undefined)
        setHideHistoryLabel('Hide history')
        setShowHistoryLabel('Show history')
      } else {
        setShareLabel('Share')
        setHideHistoryLabel('Hide chat history')
        setShowHistoryLabel('Show chat history')
      }
    }

    window.addEventListener('resize', handleResize)
    handleResize()

    return () => window.removeEventListener('resize', handleResize)
  }, [])

  return (
    <div className={styles.layout}>
      <header className={styles.header} role={'banner'}>
        <Stack horizontal verticalAlign="center" horizontalAlign="space-between">
          <Stack horizontal verticalAlign="center">
            <img src={logo} className={styles.headerIcon} aria-hidden="true" alt="" />
            <Link to="/" className={styles.headerTitleContainer}>
              <h1 className={styles.headerTitle}>{ui?.title}</h1>
            </Link>
          </Stack>
          <Stack horizontal tokens={{ childrenGap: 4 }} className={styles.shareButtonContainer}>
            {appStateContext?.state.isCosmosDBAvailable?.status !== CosmosDBStatus.NotConfigured && ui?.show_chat_history_button !== false && (
              <HistoryButton
                onClick={handleHistoryClick}
                text={appStateContext?.state?.isChatHistoryOpen ? hideHistoryLabel : showHistoryLabel}
              />
            )}
           {/* {ui?.show_share_button && <ShareButton onClick={handleShareClick} text={shareLabel} />} */}
          </Stack>
        </Stack>
      </header>
      <Outlet />
      <Dialog
        onDismiss={handleSharePanelDismiss}
        hidden={!isSharePanelOpen}
        styles={{
          main: [
            {
              selectors: {
                ['@media (min-width: 480px)']: {
                  maxWidth: '600px',
                  background: '#FFFFFF',
                  boxShadow: '0px 14px 28.8px rgba(0, 0, 0, 0.24), 0px 0px 8px rgba(0, 0, 0, 0.2)',
                  borderRadius: '8px',
                  maxHeight: '200px',
                  minHeight: '100px'
                }
              }
            }
          ]
        }}
        dialogContentProps={{
          title: 'Share the web app',
          showCloseButton: true
        }}>
        <Stack horizontal verticalAlign="center" style={{ gap: '8px' }}>
          <TextField className={styles.urlTextBox} defaultValue={window.location.href} readOnly />
          <div
            className={styles.copyButtonContainer}
            role="button"
            tabIndex={0}
            aria-label="Copy"
            onClick={handleCopyClick}
            onKeyDown={e => (e.key === 'Enter' || e.key === ' ' ? handleCopyClick() : null)}>
            <CopyRegular className={styles.copyButton} />
            <span className={styles.copyButtonText}>{copyText}</span>
          </div>
        </Stack>
      </Dialog>
    </div>
  )
}

export default Layout
</file>

<file path="scripts/data_utils.py">
"""Data utilities for index preparation."""
import ast
import html
import json
import os
import re
import ssl
import subprocess
import tempfile
import time
import urllib.request
from abc import ABC, abstractmethod
from concurrent.futures import ProcessPoolExecutor
from dataclasses import dataclass
from functools import partial
from typing import Any, Callable, Dict, Generator, List, Optional, Tuple, Union
from azure.ai.documentintelligence.models import AnalyzeDocumentRequest
import fitz
import requests
import base64

import markdown
import requests
import tiktoken
from azure.ai.documentintelligence import DocumentIntelligenceClient
from azure.core.credentials import AzureKeyCredential
from azure.identity import DefaultAzureCredential
from azure.storage.blob import ContainerClient
from bs4 import BeautifulSoup
from dotenv import load_dotenv
from langchain.text_splitter import TextSplitter, MarkdownTextSplitter, RecursiveCharacterTextSplitter, PythonCodeTextSplitter
from openai import AzureOpenAI
from tqdm import tqdm

# Configure environment variables  
load_dotenv() # take environment variables from .env.

FILE_FORMAT_DICT = {
        "md": "markdown",
        "txt": "text",
        "html": "html",
        "shtml": "html",
        "htm": "html",
        "py": "python",
        "pdf": "pdf",
        "docx": "docx",
        "pptx": "pptx",
        "png": "png",
        "jpg": "jpg",
        "jpeg": "jpeg",
        "gif": "gif",
        "webp": "webp"
    }

RETRY_COUNT = 5

SENTENCE_ENDINGS = [".", "!", "?"]
WORDS_BREAKS = list(reversed([",", ";", ":", " ", "(", ")", "[", "]", "{", "}", "\t", "\n"]))

HTML_TABLE_TAGS = {"table_open": "<table>", "table_close": "</table>", "row_open":"<tr>"}

PDF_HEADERS = {
    "title": "h1",
    "sectionHeading": "h2"
}

class TokenEstimator(object):
    GPT2_TOKENIZER = tiktoken.get_encoding("gpt2")

    def estimate_tokens(self, text: Union[str, List]) -> int:

        return len(self.GPT2_TOKENIZER.encode(text, allowed_special="all"))

    def construct_tokens_with_size(self, tokens: str, numofTokens: int) -> str:
        newTokens = self.GPT2_TOKENIZER.decode(
            self.GPT2_TOKENIZER.encode(tokens, allowed_special="all")[:numofTokens]
        )
        return newTokens

TOKEN_ESTIMATOR = TokenEstimator()

class PdfTextSplitter(TextSplitter):
    def __init__(self, length_function: Callable[[str], int] =TOKEN_ESTIMATOR.estimate_tokens, separator: str = "\n\n", **kwargs: Any):
        """Create a new TextSplitter for htmls from extracted pdfs."""
        super().__init__(**kwargs)
        self._table_tags = HTML_TABLE_TAGS
        self._separators = separator or ["\n\n", "\n", " ", ""]
        self._length_function = length_function
        self._noise = 50 # tokens to accommodate differences in token calculation, we don't want the chunking-on-the-fly to inadvertently chunk anything due to token calc mismatch

    def extract_caption(self, text):
        separator = self._separators[-1]
        for _s in self._separators:
            if _s == "":
                separator = _s
                break
            if _s in text:
                separator = _s
                break
        
        # Now that we have the separator, split the text
        if separator:
            lines = text.split(separator)
        else:
            lines = list(text)
        
        # remove empty lines
        lines = [line for line in lines if line!='']
        caption = ""
        
        if len(text.split(f"<{PDF_HEADERS['title']}>"))>1:
            caption +=  text.split(f"<{PDF_HEADERS['title']}>")[-1].split(f"</{PDF_HEADERS['title']}>")[0]
        if len(text.split(f"<{PDF_HEADERS['sectionHeading']}>"))>1:
            caption +=  text.split(f"<{PDF_HEADERS['sectionHeading']}>")[-1].split(f"</{PDF_HEADERS['sectionHeading']}>")[0]
        
        caption += "\n"+ lines[-1].strip()

        return caption
    
    def mask_urls_and_imgs(self, text) -> Tuple[Dict[str, str], str]:

        def find_urls(string):
            regex = r"(?i)\b((?:https?://|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}/)(?:[^()\s<>]+|\(([^()\s<>]+|(\([^()\s<>]+\)))*\))+(?:\(([^()\s<>]+|(\([^()\s<>]+\)))*\)|[^()\s`!()\[\]{};:'\".,<>?]))"
            urls = re.findall(regex, string)
            return [x[0] for x in urls]
        
        def find_imgs(string):
            regex = r'(<img\s+src="[^"]+"[^>]*>.*?</img>)'
            imgs = re.findall(regex, string, re.DOTALL)
            return imgs
        
        content_dict = {}
        masked_text = text
        urls = set(find_urls(text))

        for i, url in enumerate(urls):
            masked_text = masked_text.replace(url, f"##URL{i}##")
            content_dict[f"##URL{i}##"] = url

        imgs = set(find_imgs(text))
        for i, img in enumerate(imgs):
            masked_text = masked_text.replace(img, f"##IMG{i}##")
            content_dict[f"##IMG{i}##"] = img

        return content_dict, masked_text

    def split_text(self, text: str) -> List[str]:
        content_dict, masked_text = self.mask_urls_and_imgs(text)
        start_tag = self._table_tags["table_open"]
        end_tag = self._table_tags["table_close"]
        splits = masked_text.split(start_tag)
        
        final_chunks = self.chunk_rest(splits[0]) # the first split is before the first table tag so it is regular text
        
        table_caption_prefix = ""
        if len(final_chunks)>0:
            table_caption_prefix += self.extract_caption(final_chunks[-1]) # extracted from the last chunk before the table
        for part in splits[1:]:
            table, rest = part.split(end_tag)
            table = start_tag + table + end_tag 
            minitables = self.chunk_table(table, table_caption_prefix)
            final_chunks.extend(minitables)

            if rest.strip()!="":
                text_minichunks = self.chunk_rest(rest)
                final_chunks.extend(text_minichunks)
                table_caption_prefix = self.extract_caption(text_minichunks[-1])
            else:
                table_caption_prefix = ""
            

        final_final_chunks = [chunk for chunk, chunk_size in merge_chunks_serially(final_chunks, self._chunk_size, content_dict)]

        return final_final_chunks



    def chunk_rest(self, item):
        separator = self._separators[-1]
        for _s in self._separators:
            if _s == "":
                separator = _s
                break
            if _s in item:
                separator = _s
                break
        chunks = []
        if separator:
            splits = item.split(separator)
        else:
            splits = list(item)
        _good_splits = []
        for s in splits:
            if self._length_function(s) < self._chunk_size - self._noise:
                _good_splits.append(s)
            else:
                if _good_splits:
                    merged_text = self._merge_splits(_good_splits, separator)
                    chunks.extend(merged_text)
                    _good_splits = []
                other_info = self.chunk_rest(s)
                chunks.extend(other_info)
        if _good_splits:
            merged_text = self._merge_splits(_good_splits, separator)
            chunks.extend(merged_text)
        return chunks
        
    def chunk_table(self, table, caption):
        if self._length_function("\n".join([caption, table])) < self._chunk_size - self._noise:
            return ["\n".join([caption, table])]
        else:
            headers = ""
            if re.search("<th.*>.*</th>", table):
                headers += re.search("<th.*>.*</th>", table).group() # extract the header out. Opening tag may contain rowspan/colspan
            splits = table.split(self._table_tags["row_open"]) #split by row tag
            tables = []
            current_table = caption + "\n"
            for part in splits:
                if len(part)>0:
                    if self._length_function(current_table + self._table_tags["row_open"] + part) < self._chunk_size: # if current table length is within permissible limit, keep adding rows
                        if part not in [self._table_tags["table_open"], self._table_tags["table_close"]]: # need add the separator (row tag) when the part is not a table tag
                            current_table += self._table_tags["row_open"]
                        current_table += part
                        
                    else:
                        
                        # if current table size is beyond the permissible limit, complete this as a mini-table and add to final mini-tables list
                        current_table += self._table_tags["table_close"]
                        tables.append(current_table)

                        # start a new table
                        current_table = "\n".join([caption, self._table_tags["table_open"], headers])
                        if part not in [self._table_tags["table_open"], self._table_tags["table_close"]]:
                            current_table += self._table_tags["row_open"]
                        current_table += part

            
            # TO DO: fix the case where the last mini table only contain tags
            
            if not current_table.endswith(self._table_tags["table_close"]):
                
                tables.append(current_table + self._table_tags["table_close"])
            else:
                tables.append(current_table)
            return tables

    
@dataclass
class Document(object):
    """A data class for storing documents

    Attributes:
        content (str): The content of the document.
        id (Optional[str]): The id of the document.
        title (Optional[str]): The title of the document.
        filepath (Optional[str]): The filepath of the document.
        url (Optional[str]): The url of the document.
        metadata (Optional[Dict]): The metadata of the document.    
    """

    content: str
    id: Optional[str] = None
    title: Optional[str] = None
    filepath: Optional[str] = None
    url: Optional[str] = None
    metadata: Optional[Dict] = None
    contentVector: Optional[List[float]] = None
    image_mapping: Optional[Dict] = None

def cleanup_content(content: str) -> str:
    """Cleans up the given content using regexes
    Args:
        content (str): The content to clean up.
    Returns:
        str: The cleaned up content.
    """
    output = re.sub(r"\n{2,}", "\n", content)
    output = re.sub(r"[^\S\n]{2,}", " ", output)
    output = re.sub(r"-{2,}", "--", output)

    return output.strip()

class BaseParser(ABC):
    """A parser parses content to produce a document."""

    @abstractmethod
    def parse(self, content: str, file_name: Optional[str] = None) -> Document:
        """Parses the given content.
        Args:
            content (str): The content to parse.
            file_name (str): The file name associated with the content.
        Returns:
            Document: The parsed document.
        """
        pass

    def parse_file(self, file_path: str) -> Document:
        """Parses the given file.
        Args:
            file_path (str): The file to parse.
        Returns:
            Document: The parsed document.
        """
        with open(file_path, "r") as f:
            return self.parse(f.read(), os.path.basename(file_path))

    def parse_directory(self, directory_path: str) -> List[Document]:
        """Parses the given directory.
        Args:
            directory_path (str): The directory to parse.
        Returns:
            List[Document]: List of parsed documents.
        """
        documents = []
        for file_name in os.listdir(directory_path):
            file_path = os.path.join(directory_path, file_name)
            if os.path.isfile(file_path):
                documents.append(self.parse_file(file_path))
        return documents

class MarkdownParser(BaseParser):
    """Parses Markdown content."""

    def __init__(self) -> None:
        super().__init__()
        self._html_parser = HTMLParser()

    def parse(self, content: str, file_name: Optional[str] = None) -> Document:
        """Parses the given content.
        Args:
            content (str): The content to parse.
            file_name (str): The file name associated with the content.
        Returns:
            Document: The parsed document.
        """
        html_content = markdown.markdown(content, extensions=['fenced_code', 'toc', 'tables', 'sane_lists'])

        return self._html_parser.parse(html_content, file_name)


class HTMLParser(BaseParser):
    """Parses HTML content."""
    TITLE_MAX_TOKENS = 128
    NEWLINE_TEMPL = "<NEWLINE_TEXT>"

    def __init__(self) -> None:
        super().__init__()
        self.token_estimator = TokenEstimator()

    def parse(self, content: str, file_name: Optional[str] = None) -> Document:
        """Parses the given content.
        Args:
            content (str): The content to parse.
            file_name (str): The file name associated with the content.
        Returns:
            Document: The parsed document.
        """
        soup = BeautifulSoup(content, 'html.parser')

        # Extract the title
        title = ''
        if soup.title and soup.title.string:
            title = soup.title.string
        else:
            # Try to find the first <h1> tag
            h1_tag = soup.find('h1')
            if h1_tag:
                title = h1_tag.get_text(strip=True)
            else:
                h2_tag = soup.find('h2')
                if h2_tag:
                    title = h2_tag.get_text(strip=True)
        if title is None or title == '':
            # if title is still not found, guess using the next string
            try:
                title = next(soup.stripped_strings)
                title = self.token_estimator.construct_tokens_with_size(title, self.TITLE_MAX_TOKENS)

            except StopIteration:
                title = file_name

                # Helper function to process text nodes

        # Parse the content as it is without any formatting changes
        result = content
        if title is None:
            title = '' # ensure no 'None' type title

        return Document(content=cleanup_content(result), title=str(title))

class TextParser(BaseParser):
    """Parses text content."""

    def __init__(self) -> None:
        super().__init__()

    def _get_first_alphanum_line(self, content: str) -> Optional[str]:
        title = None
        for line in content.splitlines():
            if any([c.isalnum() for c in line]):
                title = line.strip()
                break
        return title

    def _get_first_line_with_property(
        self, content: str, property: str = "title: "
    ) -> Optional[str]:
        title = None
        for line in content.splitlines():
            if line.startswith(property):
                title = line[len(property) :].strip()
                break
        return title

    def parse(self, content: str, file_name: Optional[str] = None) -> Document:
        """Parses the given content.
        Args:
            content (str): The content to parse.
            file_name (str): The file name associated with the content.
        Returns:
            Document: The parsed document.
        """
        title = self._get_first_line_with_property(
            content
        ) or self._get_first_alphanum_line(content)

        return Document(content=cleanup_content(content), title=title or file_name)


class PythonParser(BaseParser):
    def _get_topdocstring(self, text):
        tree = ast.parse(text)
        docstring = ast.get_docstring(tree)  # returns top docstring
        return docstring

    def parse(self, content: str, file_name: Optional[str] = None) -> Document:
        """Parses the given content.
        Args:
            content (str): The content to parse.
            file_name (str): The file name associated with the content.
        Returns:
            Document: The parsed document.
        """
        docstring = self._get_topdocstring(content)
        if docstring:
            title = f"{file_name}: {docstring}"
        else:
            title = file_name
        return Document(content=content, title=title)

    def __init__(self) -> None:
        super().__init__()

class ImageParser(BaseParser):
    def parse(self, content: str, file_name: Optional[str] = None) -> Document:
        return Document(content=content, title=file_name)

class ParserFactory:
    def __init__(self):
        self._parsers = {
            "html": HTMLParser(),
            "text": TextParser(),
            "markdown": MarkdownParser(),
            "python": PythonParser(),
            "png": ImageParser(),
            "jpg": ImageParser(),
            "jpeg": ImageParser(),
            "gif": ImageParser(),
            "webp": ImageParser()
        }

    @property
    def supported_formats(self) -> List[str]:
        "Returns a list of supported formats"
        return list(self._parsers.keys())

    def __call__(self, file_format: str) -> BaseParser:
        parser = self._parsers.get(file_format, None)
        if parser is None:
            raise UnsupportedFormatError(f"{file_format} is not supported")

        return parser

parser_factory = ParserFactory()

class UnsupportedFormatError(Exception):
    """Exception raised when a format is not supported by a parser."""

    pass

@dataclass
class ChunkingResult:
    """Data model for chunking result

    Attributes:
        chunks (List[Document]): List of chunks.
        total_files (int): Total number of files.
        num_unsupported_format_files (int): Number of files with unsupported format.
        num_files_with_errors (int): Number of files with errors.
        skipped_chunks (int): Number of chunks skipped.
    """
    chunks: List[Document]
    total_files: int
    num_unsupported_format_files: int = 0
    num_files_with_errors: int = 0
    # some chunks might be skipped to small number of tokens
    skipped_chunks: int = 0

def extractStorageDetailsFromUrl(url):
    matches = re.fullmatch(r'https:\/\/([^\/.]*)\.blob\.core\.windows\.net\/([^\/]*)\/(.*)', url)
    if not matches:
        raise Exception(f"Not a valid blob storage URL: {url}")
    return (matches.group(1), matches.group(2), matches.group(3))

def downloadBlobUrlToLocalFolder(blob_url, local_folder, credential):
    (storage_account, container_name, path) = extractStorageDetailsFromUrl(blob_url)
    container_url = f'https://{storage_account}.blob.core.windows.net/{container_name}'
    container_client = ContainerClient.from_container_url(container_url, credential=credential)
    if path and not path.endswith('/'):
        path = path + '/'

    last_destination_folder = None
    for blob in container_client.list_blobs(name_starts_with=path):
        relative_path = blob.name[len(path):]
        destination_path = os.path.join(local_folder, relative_path)
        destination_folder = os.path.dirname(destination_path)
        if destination_folder != last_destination_folder:
            os.makedirs(destination_folder, exist_ok=True)
            last_destination_folder = destination_folder
        blob_client = container_client.get_blob_client(blob.name)
        with open(file=destination_path, mode='wb') as local_file:
            stream = blob_client.download_blob()
            local_file.write(stream.readall())

def get_files_recursively(directory_path: str) -> List[str]:
    """Gets all files in the given directory recursively.
    Args:
        directory_path (str): The directory to get files from.
    Returns:
        List[str]: List of file paths.
    """
    file_paths = []
    for dirpath, _, files in os.walk(directory_path):
        for file_name in files:
            file_path = os.path.join(dirpath, file_name)
            file_paths.append(file_path)
    return file_paths

def convert_escaped_to_posix(escaped_path):
    windows_path = escaped_path.replace("\\\\", "\\")
    posix_path = windows_path.replace("\\", "/")
    return posix_path

def _get_file_format(file_name: str, extensions_to_process: List[str]) -> Optional[str]:
    """Gets the file format from the file name.
    Returns None if the file format is not supported.
    Args:
        file_name (str): The file name.
        extensions_to_process (List[str]): List of extensions to process.
    Returns:
        str: The file format.
    """

    # in case the caller gives us a file path
    file_name = os.path.basename(file_name)
    file_extension = file_name.split(".")[-1]
    if file_extension not in extensions_to_process:
        return None
    return FILE_FORMAT_DICT.get(file_extension, None)

def table_to_html(table):
    table_html = "<table>"
    rows = [sorted([cell for cell in table.cells if cell.row_index == i], key=lambda cell: cell.column_index) for i in range(table.row_count)]
    for row_cells in rows:
        table_html += "<tr>"
        for cell in row_cells:
            tag = "th" if (cell.kind == "columnHeader" or cell.kind == "rowHeader") else "td"
            cell_spans = ""
            if cell.column_span and cell.column_span > 1: cell_spans += f" colSpan={cell.column_span}"
            if cell.row_span and cell.row_span > 1: cell_spans += f" rowSpan={cell.row_span}"
            table_html += f"<{tag}{cell_spans}>{html.escape(cell.content)}</{tag}>"
        table_html +="</tr>"
    table_html += "</table>"
    return table_html

def polygon_to_bbox(polygon, dpi=72):
    x_coords = polygon[0::2]
    y_coords = polygon[1::2]
    x0, y0 = min(x_coords)*dpi, min(y_coords)*dpi
    x1, y1 = max(x_coords)*dpi, max(y_coords)*dpi
    return x0, y0, x1, y1

def extract_pdf_content(file_path, form_recognizer_client, use_layout=False): 
    offset = 0
    page_map = []
    model = "prebuilt-layout" if use_layout else "prebuilt-read"
    
    base64file = base64.b64encode(open(file_path, "rb").read()).decode()
    poller = form_recognizer_client.begin_analyze_document(model, AnalyzeDocumentRequest(bytes_source=base64file))
    form_recognizer_results = poller.result()

    # (if using layout) mark all the positions of headers
    roles_start = {}
    roles_end = {}
    for paragraph in form_recognizer_results.paragraphs:
        if paragraph.role!=None:
            para_start = paragraph.spans[0].offset
            para_end = paragraph.spans[0].offset + paragraph.spans[0].length
            roles_start[para_start] = paragraph.role
            roles_end[para_end] = paragraph.role

    for page_num, page in enumerate(form_recognizer_results.pages):
        page_offset = page.spans[0].offset
        page_length = page.spans[0].length

        if use_layout:
            tables_on_page = []
            for table in form_recognizer_results.tables:
                # If the table is empty, the span is empty, so we skip it
                if len(table.spans) > 0:
                    table_offset = table.spans[0].offset
                    table_length = table.spans[0].length
                    if page_offset <= table_offset and table_offset + table_length < page_offset + page_length:
                        tables_on_page.append(table)
        else:
            tables_on_page = []

        # (if using layout) mark all positions of the table spans in the page
        table_chars = [-1]*page_length
        for table_id, table in enumerate(tables_on_page):
            for span in table.spans:
                # replace all table spans with "table_id" in table_chars array
                for i in range(span.length):
                    idx = span.offset - page_offset + i
                    if idx >=0 and idx < page_length:
                        table_chars[idx] = table_id

        # build page text by replacing charcters in table spans with table html and replace the characters corresponding to headers with html headers, if using layout
        page_text = ""
        added_tables = set()
        for idx, table_id in enumerate(table_chars):
            if table_id == -1:
                position = page_offset + idx
                if position in roles_start.keys():
                    role = roles_start[position]
                    if role in PDF_HEADERS:
                        page_text += f"<{PDF_HEADERS[role]}>"
                if position in roles_end.keys():
                    role = roles_end[position]
                    if role in PDF_HEADERS:
                        page_text += f"</{PDF_HEADERS[role]}>"

                page_text += form_recognizer_results.content[page_offset + idx]
                
            elif not table_id in added_tables:
                page_text += table_to_html(tables_on_page[table_id])
                added_tables.add(table_id)

        page_text += " "
        page_map.append((page_num, offset, page_text))
        offset += len(page_text)

    full_text = "".join([page_text for _, _, page_text in page_map])

    # Extract any images
    image_mapping = {}

    if "figures" in form_recognizer_results.keys() and file_path.endswith(".pdf"):
        document = fitz.open(file_path)

        for figure in form_recognizer_results["figures"]:
            bounding_box = figure.bounding_regions[0]

            page_number = bounding_box['pageNumber'] - 1  # Page numbers in PyMuPDF start from 0
            x0, y0, x1, y1 = polygon_to_bbox(bounding_box['polygon'])

            page = document.load_page(page_number)
            bbox = fitz.Rect(x0, y0, x1, y1)

            # If either the width or height of the bounding box is less than 3 inches, we upscale by 2x
            if bbox.width < 72*3 or bbox.height < 72*3:
                zoom = 2.0
            else:
                zoom = 1.0 
            mat = fitz.Matrix(zoom, zoom)
            image = page.get_pixmap(matrix=mat, clip=bbox)

            # Save the extracted image to a base64 string
            image_data = image.tobytes(output='jpg')
            image_base64 = base64.b64encode(image_data).decode("utf-8")
            image_base64 = f"data:image/jpg;base64,{image_base64}"

            # Identify the text that corresponds to the figure
            replace_start = figure["spans"][0]["offset"]
            replace_end = figure["spans"][0]["offset"] + figure["spans"][0]["length"]

            # Sometimes the figure doesn't correspond to any text, in which case we skip it
            if replace_start == replace_end:
                continue
            
            # Now we get the image tag
            original_text = form_recognizer_results.content[replace_start:replace_end]

            if original_text not in full_text:
                continue
            
            img_tag = image_content_to_tag(original_text)
            
            # We replace only the first occurrence of the original text
            full_text = full_text.replace(original_text, img_tag, 1)
            image_mapping[img_tag] = image_base64

    return full_text, image_mapping

def merge_chunks_serially(chunked_content_list: List[str], num_tokens: int, content_dict: Dict[str, str]={}) -> Generator[Tuple[str, int], None, None]:
    def unmask_urls_and_imgs(text, content_dict={}):
        if "##URL" in text or "##IMG" in text:
            for key, value in content_dict.items():
                text = text.replace(key, value)
        return text
    # TODO: solve for token overlap
    current_chunk = ""
    total_size = 0
    for chunked_content in chunked_content_list:
        chunked_content = unmask_urls_and_imgs(chunked_content, content_dict)
        chunk_size = TOKEN_ESTIMATOR.estimate_tokens(chunked_content)
        if total_size > 0:
            new_size = total_size + chunk_size
            if new_size > num_tokens:
                yield current_chunk, total_size
                current_chunk = ""
                total_size = 0
        total_size += chunk_size
        current_chunk += chunked_content
    if total_size > 0:
        yield current_chunk, total_size

def get_payload_and_headers_cohere(
    text, aad_token) -> Tuple[Dict, Dict]:
    oai_headers =  {
        "Content-Type": "application/json",
        "Authorization": f"Bearer {aad_token}",
    }

    cohere_body = { "texts": [text], "input_type": "search_document" }
    return cohere_body, oai_headers
    
def get_embedding(text, embedding_model_endpoint=None, embedding_model_key=None, azure_credential=None):
    endpoint = embedding_model_endpoint if embedding_model_endpoint else os.environ.get("EMBEDDING_MODEL_ENDPOINT")
    
    FLAG_EMBEDDING_MODEL = os.getenv("FLAG_EMBEDDING_MODEL", "AOAI")
    FLAG_COHERE = os.getenv("FLAG_COHERE", "ENGLISH")
    FLAG_AOAI = os.getenv("FLAG_AOAI", "V3")

    if azure_credential is None and (endpoint is None or key is None):
        raise Exception("EMBEDDING_MODEL_ENDPOINT and EMBEDDING_MODEL_KEY are required for embedding")

    try:
        if FLAG_EMBEDDING_MODEL == "AOAI":
            endpoint_parts = endpoint.split("/openai/deployments/")
            base_url = endpoint_parts[0]
            deployment_id = endpoint_parts[1].split("/embeddings")[0]
            api_version = endpoint_parts[1].split("api-version=")[1].split("&")[0]
            if azure_credential is not None:
                api_key = azure_credential.get_token("https://cognitiveservices.azure.com/.default").token
            else:
                api_key = embedding_model_key if embedding_model_key else os.getenv("AZURE_OPENAI_API_KEY")
            
            client = AzureOpenAI(api_version=api_version, azure_endpoint=base_url, api_key=api_key)
            if FLAG_AOAI == "V2":
                embeddings = client.embeddings.create(model=deployment_id, input=text)
            elif FLAG_AOAI == "V3":   
                embeddings = client.embeddings.create(model=deployment_id, 
                                                      input=text, 
                                                      dimensions=int(os.getenv("VECTOR_DIMENSION", 1536)))
            
            return embeddings.model_dump()['data'][0]['embedding']
        
        if FLAG_EMBEDDING_MODEL == "COHERE":
            if FLAG_COHERE == "MULTILINGUAL":
                key = embedding_model_key if embedding_model_key else os.getenv("COHERE_MULTILINGUAL_API_KEY")
            elif FLAG_COHERE == "ENGLISH":
                key = embedding_model_key if embedding_model_key else os.getenv("COHERE_ENGLISH_API_KEY")
            data, headers = get_payload_and_headers_cohere(text, key)

            body = str.encode(json.dumps(data))
            req = urllib.request.Request(endpoint, body, headers)
            response = urllib.request.urlopen(req)
            result = response.read()
            result_content = json.loads(result.decode('utf-8'))
                        
            return result_content["embeddings"][0]   
        

    except Exception as e:
        raise Exception(f"Error getting embeddings with endpoint={endpoint} with error={e}")


def chunk_content_helper(
        content: str, file_format: str, file_name: Optional[str],
        token_overlap: int,
        num_tokens: int = 256
) -> Generator[Tuple[str, int, Document], None, None]:
    if num_tokens is None:
        num_tokens = 1000000000

    parser = parser_factory(file_format.split("_pdf")[0]) # to handle cracked pdf converted to html
    doc = parser.parse(content, file_name=file_name)
    # if the original doc after parsing is < num_tokens return as it is
    doc_content_size = TOKEN_ESTIMATOR.estimate_tokens(doc.content)
    if doc_content_size < num_tokens or file_format in ["png", "jpg", "jpeg", "gif", "webp"]:
        yield doc.content, doc_content_size, doc
    else:
        if file_format == "markdown":
            splitter = MarkdownTextSplitter.from_tiktoken_encoder(
                chunk_size=num_tokens, chunk_overlap=token_overlap)
            chunked_content_list = splitter.split_text(
                content)  # chunk the original content
            for chunked_content, chunk_size in merge_chunks_serially(chunked_content_list, num_tokens):
                chunk_doc = parser.parse(chunked_content, file_name=file_name)
                chunk_doc.title = doc.title
                yield chunk_doc.content, chunk_size, chunk_doc
        else:
            if file_format == "python":
                splitter = PythonCodeTextSplitter.from_tiktoken_encoder(
                    chunk_size=num_tokens, chunk_overlap=token_overlap)
            else:
                if file_format == "html_pdf": # cracked pdf converted to html
                    splitter = PdfTextSplitter(separator=SENTENCE_ENDINGS + WORDS_BREAKS, chunk_size=num_tokens, chunk_overlap=token_overlap)
                else:
                    splitter = RecursiveCharacterTextSplitter.from_tiktoken_encoder(
                            separators=SENTENCE_ENDINGS + WORDS_BREAKS,
                            chunk_size=num_tokens, chunk_overlap=token_overlap)
            chunked_content_list = splitter.split_text(doc.content)
            for chunked_content in chunked_content_list:
                chunk_size = TOKEN_ESTIMATOR.estimate_tokens(chunked_content)
                yield chunked_content, chunk_size, doc

def chunk_content(
    content: str,
    file_name: Optional[str] = None,
    url: Optional[str] = None,
    ignore_errors: bool = True,
    num_tokens: int = 256,
    min_chunk_size: int = 10,
    token_overlap: int = 0,
    extensions_to_process = FILE_FORMAT_DICT.keys(),
    cracked_pdf = False,
    use_layout = False,
    add_embeddings = False,
    azure_credential = None,
    embedding_endpoint = None,
    image_mapping = {}
) -> ChunkingResult:
    """Chunks the given content. If ignore_errors is true, returns None
        in case of an error
    Args:
        content (str): The content to chunk.
        file_name (str): The file name. used for title, file format detection.
        url (str): The url. used for title.
        ignore_errors (bool): If true, ignores errors and returns None.
        num_tokens (int): The number of tokens in each chunk.
        min_chunk_size (int): The minimum chunk size below which chunks will be filtered.
        token_overlap (int): The number of tokens to overlap between chunks.
    Returns:
        List[Document]: List of chunked documents.
    """

    try:
        if file_name is None or (cracked_pdf and not use_layout):
            file_format = "text"
        elif cracked_pdf:
            file_format = "html_pdf" # differentiate it from native html
        else:
            file_format = _get_file_format(file_name, extensions_to_process)
            if file_format is None:
                raise Exception(
                    f"{file_name} is not supported")

        chunked_context = chunk_content_helper(
            content=content,
            file_name=file_name,
            file_format=file_format,
            num_tokens=num_tokens,
            token_overlap=token_overlap
        )
        chunks = []
        skipped_chunks = 0
        for chunk, chunk_size, doc in chunked_context:
            if chunk_size >= min_chunk_size:
                if add_embeddings:
                    for i in range(RETRY_COUNT):
                        try:
                            doc.contentVector = get_embedding(chunk, azure_credential=azure_credential, embedding_model_endpoint=embedding_endpoint)
                            break
                        except Exception as e:
                            print(f"Error getting embedding for chunk with error={e}, retrying, current at {i + 1} retry, {RETRY_COUNT - (i + 1)} retries left")
                            time.sleep(30)
                    if doc.contentVector is None:
                        raise Exception(f"Error getting embedding for chunk={chunk}")
                    
                doc.image_mapping = {}
                for key, value in image_mapping.items():
                    if key in chunk:
                        doc.image_mapping[key] = value
                chunks.append(
                    Document(
                        content=chunk,
                        title=doc.title,
                        url=url,
                        contentVector=doc.contentVector,
                        metadata=doc.metadata,
                        image_mapping=doc.image_mapping
                    )
                )
            else:
                skipped_chunks += 1

    except UnsupportedFormatError as e:
        if ignore_errors:
            return ChunkingResult(
                chunks=[], total_files=1, num_unsupported_format_files=1
            )
        else:
            raise e
    except Exception as e:
        if ignore_errors:
            return ChunkingResult(chunks=[], total_files=1, num_files_with_errors=1)
        else:
            raise e
    return ChunkingResult(
        chunks=chunks,
        total_files=1,
        skipped_chunks=skipped_chunks,
    )

def image_content_to_tag(image_content: str) -> str:
    # We encode the images in an XML-like format to make the replacement very unlikely to conflict with other text
    # This also lets us preserve the content with minimal escaping, just escaping the <img> tags
    random_id = str(time.time()).replace(".", "")[-4:]
    img_tag = f'<img src="IMG_{random_id}.jpg">{image_content.replace("<img>", "&lt;img&gt;").replace("</img>", "&lt;/img&gt;")}</img>'
    return img_tag

def get_caption(image_path, captioning_model_endpoint, captioning_model_key):
    encoded_image = base64.b64encode(open(image_path, 'rb').read()).decode('ascii')
    file_ext = image_path.split(".")[-1]
    headers = {
        "Content-Type": "application/json",
        "api-key": captioning_model_key,
    }

    payload = {
        "messages": [
            {
            "role": "system",
            "content": [
                {
                "type": "text",
                "text": "You are a captioning model that helps uses find descriptive captions."
                }
            ]
            },
            {
            "role": "user",
            "content": [
                {
                "type": "text",
                "text": "Describe this image as if you were describing it to someone who can't see it. "
                },
                {
                "type": "image_url",
                "image_url": {
                    "url": f"data:image/{file_ext};base64,{encoded_image}"
                }
                }
            ]
            }
        ],
        "temperature": 0
    }

    for i in range(RETRY_COUNT):
        try:
            response = requests.post(captioning_model_endpoint, headers=headers, json=payload)
            response.raise_for_status()  # Will raise an HTTPError if the HTTP request returned an unsuccessful status code
            break
        except Exception as e:
            print(f"Error getting caption with error={e}, retrying, current at {i + 1} retry, {RETRY_COUNT - (i + 1)} retries left")
            time.sleep(15)

    if response.status_code != 200:
        raise Exception(f"Error getting caption with status_code={response.status_code}")
    
    caption = response.json()["choices"][0]["message"]["content"]
    img_tag = image_content_to_tag(caption)
    mapping = {img_tag: f"data:image/{file_ext};base64,{encoded_image}"}

    return img_tag, mapping

def chunk_file(
    file_path: str,
    ignore_errors: bool = True,
    num_tokens=256,
    min_chunk_size=10,
    url = None,
    token_overlap: int = 0,
    extensions_to_process = FILE_FORMAT_DICT.keys(),
    form_recognizer_client = None,
    use_layout = False,
    add_embeddings=False,
    azure_credential = None,
    embedding_endpoint = None,
    captioning_model_endpoint = None,
    captioning_model_key = None
) -> ChunkingResult:
    """Chunks the given file.
    Args:
        file_path (str): The file to chunk.
    Returns:
        List[Document]: List of chunked documents.
    """
    file_name = os.path.basename(file_path)
    file_format = _get_file_format(file_name, extensions_to_process)
    image_mapping = {}
    if not file_format:
        if ignore_errors:
            return ChunkingResult(
                chunks=[], total_files=1, num_unsupported_format_files=1
            )
        else:
            raise UnsupportedFormatError(f"{file_name} is not supported")

    cracked_pdf = False
    if file_format in ["pdf", "docx", "pptx"]:
        if form_recognizer_client is None:
            raise UnsupportedFormatError("form_recognizer_client is required for pdf files")
        content, image_mapping = extract_pdf_content(file_path, form_recognizer_client, use_layout=use_layout)
        cracked_pdf = True
    elif file_format in ["png", "jpg", "jpeg", "webp"]:
        # Make call to LLM for a descriptive caption
        if captioning_model_endpoint is None or captioning_model_key is None:
            raise Exception("CAPTIONING_MODEL_ENDPOINT and CAPTIONING_MODEL_KEY are required for images")
        content, image_mapping = get_caption(file_path, captioning_model_endpoint, captioning_model_key)
    else:
        try:
            with open(file_path, "r", encoding="utf8") as f:
                content = f.read()
        except UnicodeDecodeError:
            from chardet import detect
            with open(file_path, "rb") as f:
                binary_content = f.read()
                encoding = detect(binary_content).get('encoding', 'utf8')
                content = binary_content.decode(encoding)
        
    return chunk_content(
        content=content,
        file_name=file_name,
        ignore_errors=ignore_errors,
        num_tokens=num_tokens,
        min_chunk_size=min_chunk_size,
        url=url,
        token_overlap=max(0, token_overlap),
        extensions_to_process=extensions_to_process,
        cracked_pdf=cracked_pdf,
        use_layout=use_layout,
        add_embeddings=add_embeddings,
        azure_credential=azure_credential,
        embedding_endpoint=embedding_endpoint,
        image_mapping=image_mapping
    )


def process_file(
        file_path: str, # !IMP: Please keep this as the first argument
        directory_path: str,
        ignore_errors: bool = True,
        num_tokens: int = 1024,
        min_chunk_size: int = 10,
        url_prefix = None,
        token_overlap: int = 0,
        extensions_to_process: List[str] = FILE_FORMAT_DICT.keys(),
        form_recognizer_client = None,
        use_layout = False,
        add_embeddings = False,
        azure_credential = None,
        embedding_endpoint = None,
        captioning_model_endpoint = None,
        captioning_model_key = None
    ):

    if not form_recognizer_client:
        form_recognizer_client = SingletonFormRecognizerClient()

    is_error = False
    try:
        url_path = None
        rel_file_path = os.path.relpath(file_path, directory_path)
        if url_prefix:
            url_path = url_prefix + rel_file_path
            url_path = convert_escaped_to_posix(url_path)

        result = chunk_file(
            file_path,
            ignore_errors=ignore_errors,
            num_tokens=num_tokens,
            min_chunk_size=min_chunk_size,
            url=url_path,
            token_overlap=token_overlap,
            extensions_to_process=extensions_to_process,
            form_recognizer_client=form_recognizer_client,
            use_layout=use_layout,
            add_embeddings=add_embeddings,
            azure_credential=azure_credential,
            embedding_endpoint=embedding_endpoint,
            captioning_model_endpoint=captioning_model_endpoint,
            captioning_model_key=captioning_model_key
        )
        for chunk_idx, chunk_doc in enumerate(result.chunks):
            chunk_doc.filepath = rel_file_path
            chunk_doc.metadata = json.dumps({"chunk_id": str(chunk_idx)})
            chunk_doc.image_mapping = json.dumps(chunk_doc.image_mapping) if chunk_doc.image_mapping else None
    except Exception as e:
        print(e)
        if not ignore_errors:
            raise
        print(f"File ({file_path}) failed with ", e)
        is_error = True
        result =None
    return result, is_error

def chunk_blob_container(
        blob_url: str,
        credential,
        ignore_errors: bool = True,
        num_tokens: int = 1024,
        min_chunk_size: int = 10,
        url_prefix = None,
        token_overlap: int = 0,
        extensions_to_process: List[str] = list(FILE_FORMAT_DICT.keys()),
        form_recognizer_client = None,
        use_layout = False,
        njobs=4,
        add_embeddings = False,
        azure_credential = None,
        embedding_endpoint = None
):
    with tempfile.TemporaryDirectory() as local_data_folder:
        print(f'Downloading {blob_url} to local folder')
        downloadBlobUrlToLocalFolder(blob_url, local_data_folder, credential)
        print(f'Downloaded.')

        result = chunk_directory(
            local_data_folder,
            ignore_errors=ignore_errors,
            num_tokens=num_tokens,
            min_chunk_size=min_chunk_size,
            url_prefix=url_prefix,
            token_overlap=token_overlap,
            extensions_to_process=extensions_to_process,
            form_recognizer_client=form_recognizer_client,
            use_layout=use_layout,
            njobs=njobs,
            add_embeddings=add_embeddings,
            azure_credential=azure_credential,
            embedding_endpoint=embedding_endpoint
        )

    return result


def chunk_directory(
        directory_path: str,
        ignore_errors: bool = True,
        num_tokens: int = 1024,
        min_chunk_size: int = 10,
        url_prefix = None,
        token_overlap: int = 0,
        extensions_to_process: List[str] = list(FILE_FORMAT_DICT.keys()),
        form_recognizer_client = None,
        use_layout = False,
        njobs=4,
        add_embeddings = False,
        azure_credential = None,
        embedding_endpoint = None,
        captioning_model_endpoint = None,
        captioning_model_key = None
):
    """
    Chunks the given directory recursively
    Args:
        directory_path (str): The directory to chunk.
        ignore_errors (bool): If true, ignores errors and returns None.
        num_tokens (int): The number of tokens to use for chunking.
        min_chunk_size (int): The minimum chunk size.
        url_prefix (str): The url prefix to use for the files. If None, the url will be None. If not None, the url will be url_prefix + relpath. 
                            For example, if the directory path is /home/user/data and the url_prefix is https://example.com/data, 
                            then the url for the file /home/user/data/file1.txt will be https://example.com/data/file1.txt
        token_overlap (int): The number of tokens to overlap between chunks.
        extensions_to_process (List[str]): The list of extensions to process. 
        form_recognizer_client: Optional form recognizer client to use for pdf files.
        use_layout (bool): If true, uses Layout model for pdf files. Otherwise, uses Read.
        add_embeddings (bool): If true, adds a vector embedding to each chunk using the embedding model endpoint and key.

    Returns:
        List[Document]: List of chunked documents.
    """
    chunks = []
    total_files = 0
    num_unsupported_format_files = 0
    num_files_with_errors = 0
    skipped_chunks = 0

    all_files_directory = get_files_recursively(directory_path)
    files_to_process = [file_path for file_path in all_files_directory if os.path.isfile(file_path)]
    print(f"Total files to process={len(files_to_process)} out of total directory size={len(all_files_directory)}")


    if njobs==1:
        print("Single process to chunk and parse the files. --njobs > 1 can help performance.")
        for file_path in tqdm(files_to_process):
            total_files += 1
            result, is_error = process_file(file_path=file_path,directory_path=directory_path, ignore_errors=ignore_errors,
                                       num_tokens=num_tokens,
                                       min_chunk_size=min_chunk_size, url_prefix=url_prefix,
                                       token_overlap=token_overlap,
                                       extensions_to_process=extensions_to_process,
                                       form_recognizer_client=form_recognizer_client, use_layout=use_layout, add_embeddings=add_embeddings,
                                       azure_credential=azure_credential, embedding_endpoint=embedding_endpoint,
                                       captioning_model_endpoint=captioning_model_endpoint, captioning_model_key=captioning_model_key)
            if is_error:
                num_files_with_errors += 1
                continue
            chunks.extend(result.chunks)
            num_unsupported_format_files += result.num_unsupported_format_files
            num_files_with_errors += result.num_files_with_errors
            skipped_chunks += result.skipped_chunks
    elif njobs > 1:
        print(f"Multiprocessing with njobs={njobs}")
        process_file_partial = partial(process_file, directory_path=directory_path, ignore_errors=ignore_errors,
                                       num_tokens=num_tokens,
                                       min_chunk_size=min_chunk_size, url_prefix=url_prefix,
                                       token_overlap=token_overlap,
                                       extensions_to_process=extensions_to_process,
                                       form_recognizer_client=None, use_layout=use_layout, add_embeddings=add_embeddings,
                                       azure_credential=azure_credential, embedding_endpoint=embedding_endpoint,
                                       captioning_model_endpoint=captioning_model_endpoint, captioning_model_key=captioning_model_key)
        with ProcessPoolExecutor(max_workers=njobs) as executor:
            futures = list(tqdm(executor.map(process_file_partial, files_to_process), total=len(files_to_process)))
            for result, is_error in futures:
                total_files += 1
                if is_error:
                    num_files_with_errors += 1
                    continue
                chunks.extend(result.chunks)
                num_unsupported_format_files += result.num_unsupported_format_files
                num_files_with_errors += result.num_files_with_errors
                skipped_chunks += result.skipped_chunks

    return ChunkingResult(
            chunks=chunks,
            total_files=total_files,
            num_unsupported_format_files=num_unsupported_format_files,
            num_files_with_errors=num_files_with_errors,
            skipped_chunks=skipped_chunks,
        )


class SingletonFormRecognizerClient:
    instance = None
    def __new__(cls, *args, **kwargs):
        if not cls.instance:
            print("SingletonFormRecognizerClient: Creating instance of Form recognizer per process")
            url = os.getenv("FORM_RECOGNIZER_ENDPOINT")
            key = os.getenv("FORM_RECOGNIZER_KEY")
            if url and key:
                cls.instance = DocumentIntelligenceClient(
                        endpoint=url, credential=AzureKeyCredential(key), headers={"x-ms-useragent": "sample-app-aoai-chatgpt/1.0.0"})
            else:
                print("SingletonFormRecognizerClient: Skipping since credentials not provided. Assuming NO form recognizer extensions(like .pdf) in directory")
                cls.instance = object() # dummy object
        return cls.instance

    def __getstate__(self):
        return self.url, self.key

    def __setstate__(self, state):
        url, key = state
        self.instance = DocumentIntelligenceClient(endpoint=url, credential=AzureKeyCredential(key), headers={"x-ms-useragent": "sample-app-aoai-chatgpt/1.0.0"})
</file>

<file path="backend/utils.py">
import os
import json
import logging
import requests
import dataclasses

from typing import List

DEBUG = os.environ.get("DEBUG", "false")
if DEBUG.lower() == "true":
    logging.basicConfig(level=logging.DEBUG)

AZURE_SEARCH_PERMITTED_GROUPS_COLUMN = os.environ.get(
    "AZURE_SEARCH_PERMITTED_GROUPS_COLUMN"
)


class JSONEncoder(json.JSONEncoder):
    def default(self, o):
        if dataclasses.is_dataclass(o):
            return dataclasses.asdict(o)
        return super().default(o)


async def format_as_ndjson(r):
    try:
        async for event in r:
            yield json.dumps(event, cls=JSONEncoder) + "\n"
    except Exception as error:
        logging.exception("Exception while generating response stream: %s", error)
        yield json.dumps({"error": str(error)})


def parse_multi_columns(columns: str) -> list:
    if "|" in columns:
        return columns.split("|")
    else:
        return columns.split(",")


def fetchUserGroups(userToken, nextLink=None):
    # Recursively fetch group membership
    if nextLink:
        endpoint = nextLink
    else:
        endpoint = "https://graph.microsoft.com/v1.0/me/transitiveMemberOf?$select=id"

    headers = {"Authorization": "bearer " + userToken}
    try:
        r = requests.get(endpoint, headers=headers)
        if r.status_code != 200:
            logging.error(f"Error fetching user groups: {r.status_code} {r.text}")
            return []

        r = r.json()
        if "@odata.nextLink" in r:
            nextLinkData = fetchUserGroups(userToken, r["@odata.nextLink"])
            r["value"].extend(nextLinkData)

        return r["value"]
    except Exception as e:
        logging.error(f"Exception in fetchUserGroups: {e}")
        return []


def generateFilterString(userToken):
    # Get list of groups user is a member of
    userGroups = fetchUserGroups(userToken)

    # Construct filter string
    if not userGroups:
        logging.debug("No user groups found")

    group_ids = ", ".join([obj["id"] for obj in userGroups])
    return f"{AZURE_SEARCH_PERMITTED_GROUPS_COLUMN}/any(g:search.in(g, '{group_ids}'))"


def format_non_streaming_response(chatCompletion, history_metadata, apim_request_id):
    response_obj = {
        "id": chatCompletion.id,
        "model": chatCompletion.model,
        "created": chatCompletion.created,
        "object": chatCompletion.object,
        "choices": [{"messages": []}],
        "history_metadata": history_metadata,
        "apim-request-id": apim_request_id,
    }

    if len(chatCompletion.choices) > 0:
        message = chatCompletion.choices[0].message
        if message:
            if hasattr(message, "context"):
                response_obj["choices"][0]["messages"].append(
                    {
                        "role": "tool",
                        "content": json.dumps(message.context),
                    }
                )
            response_obj["choices"][0]["messages"].append(
                {
                    "role": "assistant",
                    "content": message.content,
                }
            )
            return response_obj

    return {}

def format_stream_response(chatCompletionChunk, history_metadata, apim_request_id):
    response_obj = {
        "id": chatCompletionChunk.id,
        "model": chatCompletionChunk.model,
        "created": chatCompletionChunk.created,
        "object": chatCompletionChunk.object,
        "choices": [{"messages": []}],
        "history_metadata": history_metadata,
        "apim-request-id": apim_request_id,
    }

    if len(chatCompletionChunk.choices) > 0:
        delta = chatCompletionChunk.choices[0].delta
        if delta:
            if hasattr(delta, "context"):
                messageObj = {"role": "tool", "content": json.dumps(delta.context)}
                response_obj["choices"][0]["messages"].append(messageObj)
                return response_obj
            if delta.role == "assistant" and hasattr(delta, "context"):
                messageObj = {
                    "role": "assistant",
                    "context": delta.context,
                }
                response_obj["choices"][0]["messages"].append(messageObj)
                return response_obj
            if delta.tool_calls:
                messageObj = {
                    "role": "tool",
                    "tool_calls": {
                        "id": delta.tool_calls[0].id,
                        "function": {
                            "name" : delta.tool_calls[0].function.name,
                            "arguments": delta.tool_calls[0].function.arguments
                        },
                        "type": delta.tool_calls[0].type
                    }
                }
                if hasattr(delta, "context"):
                    messageObj["context"] = json.dumps(delta.context)
                response_obj["choices"][0]["messages"].append(messageObj)
                return response_obj
            else:
                if delta.content:
                    messageObj = {
                        "role": "assistant",
                        "content": delta.content,
                    }
                    response_obj["choices"][0]["messages"].append(messageObj)
                    return response_obj

    return {}


def format_pf_non_streaming_response(
    chatCompletion, history_metadata, response_field_name, citations_field_name, message_uuid=None
):
    if chatCompletion is None:
        logging.error(
            "chatCompletion object is None - Increase PROMPTFLOW_RESPONSE_TIMEOUT parameter"
        )
        return {
            "error": "No response received from promptflow endpoint increase PROMPTFLOW_RESPONSE_TIMEOUT parameter or check the promptflow endpoint."
        }
    if "error" in chatCompletion:
        logging.error(f"Error in promptflow response api: {chatCompletion['error']}")
        return {"error": chatCompletion["error"]}

    logging.debug(f"chatCompletion: {chatCompletion}")
    try:
        messages = []
        if response_field_name in chatCompletion:
            messages.append({
                "role": "assistant",
                "content": chatCompletion[response_field_name] 
            })
        if citations_field_name in chatCompletion:
            citation_content= {"citations": chatCompletion[citations_field_name]}
            messages.append({ 
                "role": "tool",
                "content": json.dumps(citation_content)
            })

        response_obj = {
            "id": chatCompletion["id"],
            "model": "",
            "created": "",
            "object": "",
            "history_metadata": history_metadata,
            "choices": [
                {
                    "messages": messages,
                }
            ]
        }
        return response_obj
    except Exception as e:
        logging.error(f"Exception in format_pf_non_streaming_response: {e}")
        return {}


def convert_to_pf_format(input_json, request_field_name, response_field_name):
    output_json = []
    logging.debug(f"Input json: {input_json}")
    # align the input json to the format expected by promptflow chat flow
    for message in input_json["messages"]:
        if message:
            if message["role"] == "user":
                new_obj = {
                    "inputs": {request_field_name: message["content"]},
                    "outputs": {response_field_name: ""},
                }
                output_json.append(new_obj)
            elif message["role"] == "assistant" and len(output_json) > 0:
                output_json[-1]["outputs"][response_field_name] = message["content"]
    logging.debug(f"PF formatted response: {output_json}")
    return output_json


def comma_separated_string_to_list(s: str) -> List[str]:
    '''
    Split comma-separated values into a list.
    '''
    return s.strip().replace(' ', '').split(',')
</file>

<file path="frontend/src/api/models.ts">
export type AskResponse = {
  answer: string | []
  citations: Citation[]
  generated_chart: string | null
  error?: string
  message_id?: string
  feedback?: Feedback
  exec_results?: ExecResults[]
}

export type Citation = {
  part_index?: number
  content: string
  id: string
  title: string | null
  filepath: string | null
  url: string | null
  metadata: string | null
  chunk_id: string | null
  reindex_id: string | null
}

export type ToolMessageContent = {
  citations: Citation[]
  intent: string
}

export type AzureSqlServerExecResult = {
  intent: string
  search_query: string | null
  search_result: string | null
  code_generated: string | null
  code_exec_result?: string | undefined
}

export type AzureSqlServerExecResults = {
  all_exec_results: AzureSqlServerExecResult[]
}

export type ChatMessage = {
  id: string
  role: string
  content: string | [{ type: string; text: string }, { type: string; image_url: { url: string } }]
  end_turn?: boolean
  date: string
  feedback?: Feedback
  context?: string
}

export type ExecResults = {
  intent: string
  search_query: string | null
  search_result: string | null
  code_generated: string | null
}

export type Conversation = {
  id: string
  title: string
  messages: ChatMessage[]
  date: string
}

export enum ChatCompletionType {
  ChatCompletion = 'chat.completion',
  ChatCompletionChunk = 'chat.completion.chunk'
}

export type ChatResponseChoice = {
  messages: ChatMessage[]
}

export type ChatResponse = {
  id: string
  model: string
  created: number
  object: ChatCompletionType
  choices: ChatResponseChoice[]
  history_metadata: {
    conversation_id: string
    title: string
    date: string
  }
  error?: any
}

export type ConversationRequest = {
  messages: ChatMessage[]
}

export type UserInfo = {
  access_token: string
  expires_on: string
  id_token: string
  provider_name: string
  user_claims: any[]
  user_id: string
}

export enum CosmosDBStatus {
  NotConfigured = 'CosmosDB is not configured',
  NotWorking = 'CosmosDB is not working',
  InvalidCredentials = 'CosmosDB has invalid credentials',
  InvalidDatabase = 'Invalid CosmosDB database name',
  InvalidContainer = 'Invalid CosmosDB container name',
  Working = 'CosmosDB is configured and working'
}

export type CosmosDBHealth = {
  cosmosDB: boolean
  status: string
}

export enum ChatHistoryLoadingState {
  Loading = 'loading',
  Success = 'success',
  Fail = 'fail',
  NotStarted = 'notStarted'
}

export type ErrorMessage = {
  title: string
  subtitle: string
}

export type UI = {
  title: string
  chat_title: string
  chat_description: string
  preset_starting_message?: string
  logo?: string
  chat_logo?: string
  show_share_button?: boolean
  show_chat_history_button?: boolean
}

export type FrontendSettings = {
  auth_enabled?: string | null
  feedback_enabled?: string | null
  ui?: UI
  sanitize_answer?: boolean
  oyd_enabled?: boolean
}

export enum Feedback {
  Neutral = 'neutral',
  Positive = 'positive',
  Negative = 'negative',
  MissingCitation = 'missing_citation',
  WrongCitation = 'wrong_citation',
  OutOfScope = 'out_of_scope',
  InaccurateOrIrrelevant = 'inaccurate_or_irrelevant',
  OtherUnhelpful = 'other_unhelpful',
  HateSpeech = 'hate_speech',
  Violent = 'violent',
  Sexual = 'sexual',
  Manipulative = 'manipulative',
  OtherHarmful = 'other_harmlful'
}
</file>

<file path="frontend/package.json">
{
  "name": "frontend",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "watch": "tsc && vite build --watch",
    "test": "jest",
    "lint": "npx eslint src",
    "lint:fix": "npx eslint --fix",
    "prettier": "npx prettier src --check",
    "prettier:fix": "npx prettier src --write",
    "format": "npm run prettier:fix && npm run lint:fix"
  },
  "dependencies": {
    "@azure/msal-browser": "^4.14.0",
    "@azure/msal-react": "^3.0.14",
    "@fluentui/react": "^8.109.0",
    "@fluentui/react-hooks": "^8.6.29",
    "@fluentui/react-icons": "^2.0.195",
    "dompurify": "^3.0.8",
    "lodash": "^4.17.21",
    "lodash-es": "^4.17.21",
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-markdown": "^7.0.1",
    "react-router-dom": "^6.8.1",
    "react-syntax-highlighter": "^15.5.0",
    "react-uuid": "^2.0.0",
    "rehype-raw": "^6.1.1",
    "remark-gfm": "^3.0.1",
    "remark-supersub": "^1.0.0"
  },
  "devDependencies": {
    "@eslint/eslintrc": "^3.0.2",
    "@eslint/js": "^9.1.1",
    "@types/dompurify": "^3.0.5",
    "@types/eslint-config-prettier": "^6.11.3",
    "@types/jest": "^29.5.12",
    "@types/lodash-es": "^4.17.12",
    "@types/mocha": "^10.0.6",
    "@types/node": "^20.12.7",
    "@types/react": "^18.0.27",
    "@types/react-dom": "^18.0.10",
    "@types/react-syntax-highlighter": "^15.5.11",
    "@typescript-eslint/eslint-plugin": "^6.21.0",
    "@typescript-eslint/parser": "^6.21.0",
    "@vitejs/plugin-react": "^3.1.0",
    "eslint": "^8.57.0",
    "eslint-config-prettier": "^9.1.0",
    "eslint-config-standard-with-typescript": "^43.0.1",
    "eslint-plugin-jsx-a11y": "^6.8.0",
    "eslint-plugin-n": "^16.6.2",
    "eslint-plugin-prettier": "^5.1.3",
    "eslint-plugin-promise": "^6.1.1",
    "eslint-plugin-react": "^7.34.1",
    "eslint-plugin-react-hooks": "^4.6.0",
    "eslint-plugin-simple-import-sort": "^12.1.0",
    "globals": "^15.0.0",
    "jest": "^29.7.0",
    "lint-staged": "^15.2.2",
    "prettier": "^3.2.5",
    "react-test-renderer": "^18.2.0",
    "string.prototype.replaceall": "^1.0.10",
    "ts-jest": "^29.1.2",
    "ts-node": "^10.9.2",
    "typescript": "^4.9.5",
    "vite": "^4.1.5"
  }
}
</file>

<file path="frontend/src/components/Answer/Answer.tsx">
import { FormEvent, useContext, useEffect, useMemo, useState } from 'react'
import ReactMarkdown from 'react-markdown'
import { Prism as SyntaxHighlighter } from 'react-syntax-highlighter'
import { nord } from 'react-syntax-highlighter/dist/esm/styles/prism'
import { Checkbox, DefaultButton, Dialog, FontIcon, Stack, Text } from '@fluentui/react'
import { useBoolean } from '@fluentui/react-hooks'
import { ThumbDislike20Filled, ThumbLike20Filled } from '@fluentui/react-icons'
import DOMPurify from 'dompurify'
import remarkGfm from 'remark-gfm'
import supersub from 'remark-supersub'
import { AskResponse, Citation, Feedback, historyMessageFeedback } from '../../api'
import { XSSAllowTags, XSSAllowAttributes } from '../../constants/sanatizeAllowables'
import { AppStateContext } from '../../state/AppProvider'

import { parseAnswer } from './AnswerParser'

import styles from './Answer.module.css'

interface Props {
  answer: AskResponse
  onCitationClicked: (citedDocument: Citation) => void
  onExectResultClicked: (answerId: string) => void
}

export const Answer = ({ answer, onCitationClicked, onExectResultClicked }: Props) => {
  const initializeAnswerFeedback = (answer: AskResponse) => {
    if (answer.message_id == undefined) return undefined
    if (answer.feedback == undefined) return undefined
    if (answer.feedback.split(',').length > 1) return Feedback.Negative
    if (Object.values(Feedback).includes(answer.feedback)) return answer.feedback
    return Feedback.Neutral
  }

  const [isRefAccordionOpen, { toggle: toggleIsRefAccordionOpen }] = useBoolean(false)
  const filePathTruncationLimit = 50

  const parsedAnswer = useMemo(() => parseAnswer(answer), [answer])
  const [chevronIsExpanded, setChevronIsExpanded] = useState(isRefAccordionOpen)
  const [feedbackState, setFeedbackState] = useState(initializeAnswerFeedback(answer))
  const [isFeedbackDialogOpen, setIsFeedbackDialogOpen] = useState(false)
  const [showReportInappropriateFeedback, setShowReportInappropriateFeedback] = useState(false)
  const [negativeFeedbackList, setNegativeFeedbackList] = useState<Feedback[]>([])
  const appStateContext = useContext(AppStateContext)
  const FEEDBACK_ENABLED =
    appStateContext?.state.frontendSettings?.feedback_enabled && appStateContext?.state.isCosmosDBAvailable?.cosmosDB
  const SANITIZE_ANSWER = appStateContext?.state.frontendSettings?.sanitize_answer

  const handleChevronClick = () => {
    setChevronIsExpanded(!chevronIsExpanded)
    toggleIsRefAccordionOpen()
  }

  useEffect(() => {
    setChevronIsExpanded(isRefAccordionOpen)
  }, [isRefAccordionOpen])

  useEffect(() => {
    if (answer.message_id == undefined) return

    let currentFeedbackState
    if (appStateContext?.state.feedbackState && appStateContext?.state.feedbackState[answer.message_id]) {
      currentFeedbackState = appStateContext?.state.feedbackState[answer.message_id]
    } else {
      currentFeedbackState = initializeAnswerFeedback(answer)
    }
    setFeedbackState(currentFeedbackState)
  }, [appStateContext?.state.feedbackState, feedbackState, answer.message_id])

  const createCitationFilepath = (citation: Citation, index: number, truncate: boolean = false) => {
    let citationFilename = ''

    if (citation.filepath) {
      const part_i = citation.part_index ?? (citation.chunk_id ? parseInt(citation.chunk_id) + 1 : '')
      if (truncate && citation.filepath.length > filePathTruncationLimit) {
        const citationLength = citation.filepath.length
        citationFilename = `${citation.filepath.substring(0, 20)}...${citation.filepath.substring(citationLength - 20)} - Part ${part_i}`
      } else {
        citationFilename = `${citation.filepath} - Part ${part_i}`
      }
    } else if (citation.filepath && citation.reindex_id) {
      citationFilename = `${citation.filepath} - Part ${citation.reindex_id}`
    } else {
      citationFilename = `Citation ${index}`
    }
    return citationFilename
  }

  const onLikeResponseClicked = async () => {
    if (answer.message_id == undefined) return

    let newFeedbackState = feedbackState
    // Set or unset the thumbs up state
    if (feedbackState == Feedback.Positive) {
      newFeedbackState = Feedback.Neutral
    } else {
      newFeedbackState = Feedback.Positive
    }
    appStateContext?.dispatch({
      type: 'SET_FEEDBACK_STATE',
      payload: { answerId: answer.message_id, feedback: newFeedbackState }
    })
    setFeedbackState(newFeedbackState)

    // Update message feedback in db
    await historyMessageFeedback(answer.message_id, newFeedbackState)
  }

  const onDislikeResponseClicked = async () => {
    if (answer.message_id == undefined) return

    let newFeedbackState = feedbackState
    if (feedbackState === undefined || feedbackState === Feedback.Neutral || feedbackState === Feedback.Positive) {
      newFeedbackState = Feedback.Negative
      setFeedbackState(newFeedbackState)
      setIsFeedbackDialogOpen(true)
    } else {
      // Reset negative feedback to neutral
      newFeedbackState = Feedback.Neutral
      setFeedbackState(newFeedbackState)
      await historyMessageFeedback(answer.message_id, Feedback.Neutral)
    }
    appStateContext?.dispatch({
      type: 'SET_FEEDBACK_STATE',
      payload: { answerId: answer.message_id, feedback: newFeedbackState }
    })
  }

  const updateFeedbackList = (ev?: FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {
    if (answer.message_id == undefined) return
    const selectedFeedback = (ev?.target as HTMLInputElement)?.id as Feedback

    let feedbackList = negativeFeedbackList.slice()
    if (checked) {
      feedbackList.push(selectedFeedback)
    } else {
      feedbackList = feedbackList.filter(f => f !== selectedFeedback)
    }

    setNegativeFeedbackList(feedbackList)
  }

  const onSubmitNegativeFeedback = async () => {
    if (answer.message_id == undefined) return
    await historyMessageFeedback(answer.message_id, negativeFeedbackList.join(','))
    resetFeedbackDialog()
  }

  const resetFeedbackDialog = () => {
    setIsFeedbackDialogOpen(false)
    setShowReportInappropriateFeedback(false)
    setNegativeFeedbackList([])
  }

  const UnhelpfulFeedbackContent = () => {
    return (
      <>
        <div>Why wasn't this response helpful?</div>
        <Stack tokens={{ childrenGap: 4 }}>
          <Checkbox
            label="Citations are missing"
            id={Feedback.MissingCitation}
            defaultChecked={negativeFeedbackList.includes(Feedback.MissingCitation)}
            onChange={updateFeedbackList}></Checkbox>
          <Checkbox
            label="Citations are wrong"
            id={Feedback.WrongCitation}
            defaultChecked={negativeFeedbackList.includes(Feedback.WrongCitation)}
            onChange={updateFeedbackList}></Checkbox>
          <Checkbox
            label="The response is not from my data"
            id={Feedback.OutOfScope}
            defaultChecked={negativeFeedbackList.includes(Feedback.OutOfScope)}
            onChange={updateFeedbackList}></Checkbox>
          <Checkbox
            label="Inaccurate or irrelevant"
            id={Feedback.InaccurateOrIrrelevant}
            defaultChecked={negativeFeedbackList.includes(Feedback.InaccurateOrIrrelevant)}
            onChange={updateFeedbackList}></Checkbox>
          <Checkbox
            label="Other"
            id={Feedback.OtherUnhelpful}
            defaultChecked={negativeFeedbackList.includes(Feedback.OtherUnhelpful)}
            onChange={updateFeedbackList}></Checkbox>
        </Stack>
        <div onClick={() => setShowReportInappropriateFeedback(true)} style={{ color: '#115EA3', cursor: 'pointer' }}>
          Report inappropriate content
        </div>
      </>
    )
  }

  const ReportInappropriateFeedbackContent = () => {
    return (
      <>
        <div>
          The content is <span style={{ color: 'red' }}>*</span>
        </div>
        <Stack tokens={{ childrenGap: 4 }}>
          <Checkbox
            label="Hate speech, stereotyping, demeaning"
            id={Feedback.HateSpeech}
            defaultChecked={negativeFeedbackList.includes(Feedback.HateSpeech)}
            onChange={updateFeedbackList}></Checkbox>
          <Checkbox
            label="Violent: glorification of violence, self-harm"
            id={Feedback.Violent}
            defaultChecked={negativeFeedbackList.includes(Feedback.Violent)}
            onChange={updateFeedbackList}></Checkbox>
          <Checkbox
            label="Sexual: explicit content, grooming"
            id={Feedback.Sexual}
            defaultChecked={negativeFeedbackList.includes(Feedback.Sexual)}
            onChange={updateFeedbackList}></Checkbox>
          <Checkbox
            label="Manipulative: devious, emotional, pushy, bullying"
            defaultChecked={negativeFeedbackList.includes(Feedback.Manipulative)}
            id={Feedback.Manipulative}
            onChange={updateFeedbackList}></Checkbox>
          <Checkbox
            label="Other"
            id={Feedback.OtherHarmful}
            defaultChecked={negativeFeedbackList.includes(Feedback.OtherHarmful)}
            onChange={updateFeedbackList}></Checkbox>
        </Stack>
      </>
    )
  }

  const components = {
    code({ node, ...props }: { node: any;[key: string]: any }) {
      let language
      if (props.className) {
        const match = props.className.match(/language-(\w+)/)
        language = match ? match[1] : undefined
      }
      const codeString = node.children[0].value ?? ''
      return (
        <SyntaxHighlighter style={nord} language={language} PreTag="div" {...props}>
          {codeString}
        </SyntaxHighlighter>
      )
    }
  }
  return (
    <>
      <Stack className={styles.answerContainer} tabIndex={0}>
        <Stack.Item>
          <Stack horizontal grow>
            <Stack.Item grow>
              {parsedAnswer && <ReactMarkdown
                linkTarget="_blank"
                remarkPlugins={[remarkGfm, supersub]}
                children={
                  SANITIZE_ANSWER
                    ? DOMPurify.sanitize(parsedAnswer?.markdownFormatText, { ALLOWED_TAGS: XSSAllowTags, ALLOWED_ATTR: XSSAllowAttributes })
                    : parsedAnswer?.markdownFormatText
                }
                className={styles.answerText}
                components={components}
              />}
            </Stack.Item>
            <Stack.Item className={styles.answerHeader}>
              {FEEDBACK_ENABLED && answer.message_id !== undefined && (
                <Stack horizontal horizontalAlign="space-between">
                  <ThumbLike20Filled
                    aria-hidden="false"
                    aria-label="Like this response"
                    onClick={() => onLikeResponseClicked()}
                    style={
                      feedbackState === Feedback.Positive ||
                        appStateContext?.state.feedbackState[answer.message_id] === Feedback.Positive
                        ? { color: 'darkgreen', cursor: 'pointer' }
                        : { color: 'slategray', cursor: 'pointer' }
                    }
                  />
                  <ThumbDislike20Filled
                    aria-hidden="false"
                    aria-label="Dislike this response"
                    onClick={() => onDislikeResponseClicked()}
                    style={
                      feedbackState !== Feedback.Positive &&
                        feedbackState !== Feedback.Neutral &&
                        feedbackState !== undefined
                        ? { color: 'darkred', cursor: 'pointer' }
                        : { color: 'slategray', cursor: 'pointer' }
                    }
                  />
                </Stack>
              )}
            </Stack.Item>
          </Stack>
        </Stack.Item>
        {parsedAnswer?.generated_chart !== null && (
          <Stack className={styles.answerContainer}>
            <Stack.Item grow>
              <img src={`data:image/png;base64, ${parsedAnswer?.generated_chart}`} />
            </Stack.Item>
          </Stack>
        )}
        <Stack horizontal className={styles.answerFooter}>
          {!!parsedAnswer?.citations.length && (
            <Stack.Item onKeyDown={e => (e.key === 'Enter' || e.key === ' ' ? toggleIsRefAccordionOpen() : null)}>
              <Stack style={{ width: '100%' }}>
                <Stack horizontal horizontalAlign="start" verticalAlign="center">
                  <Text
                    className={styles.accordionTitle}
                    onClick={toggleIsRefAccordionOpen}
                    aria-label="Open references"
                    tabIndex={0}
                    role="button">
                    <span>
                      {parsedAnswer.citations.length > 1
                        ? parsedAnswer.citations.length + ' references'
                        : '1 reference'}
                    </span>
                  </Text>
                  <FontIcon
                    className={styles.accordionIcon}
                    onClick={handleChevronClick}
                    iconName={chevronIsExpanded ? 'ChevronDown' : 'ChevronRight'}
                  />
                </Stack>
              </Stack>
            </Stack.Item>
          )}
          <Stack.Item className={styles.answerDisclaimerContainer}>
            <span className={styles.answerDisclaimer}>AI-generated content may be incorrect</span>
          </Stack.Item>
          {!!answer.exec_results?.length && (
            <Stack.Item onKeyDown={e => (e.key === 'Enter' || e.key === ' ' ? toggleIsRefAccordionOpen() : null)}>
              <Stack style={{ width: '100%' }}>
                <Stack horizontal horizontalAlign="start" verticalAlign="center">
                  <Text
                    className={styles.accordionTitle}
                    onClick={() => onExectResultClicked(answer.message_id ?? '')}
                    aria-label="Open Intents"
                    tabIndex={0}
                    role="button">
                    <span>
                      Show Intents
                    </span>
                  </Text>
                  <FontIcon
                    className={styles.accordionIcon}
                    onClick={handleChevronClick}
                    iconName={'ChevronRight'}
                  />
                </Stack>
              </Stack>
            </Stack.Item>
          )}
        </Stack>
        {chevronIsExpanded && (
          <div className={styles.citationWrapper}>
            {parsedAnswer?.citations.map((citation, idx) => {
              return (
                <span
                  title={createCitationFilepath(citation, ++idx)}
                  tabIndex={0}
                  role="link"
                  key={idx}
                  onClick={() => onCitationClicked(citation)}
                  onKeyDown={e => (e.key === 'Enter' || e.key === ' ' ? onCitationClicked(citation) : null)}
                  className={styles.citationContainer}
                  aria-label={createCitationFilepath(citation, idx)}>
                  <div className={styles.citation}>{idx}</div>
                  {createCitationFilepath(citation, idx, true)}
                </span>
              )
            })}
          </div>
        )}
      </Stack>
      <Dialog
        onDismiss={() => {
          resetFeedbackDialog()
          setFeedbackState(Feedback.Neutral)
        }}
        hidden={!isFeedbackDialogOpen}
        styles={{
          main: [
            {
              selectors: {
                ['@media (min-width: 480px)']: {
                  maxWidth: '600px',
                  background: '#FFFFFF',
                  boxShadow: '0px 14px 28.8px rgba(0, 0, 0, 0.24), 0px 0px 8px rgba(0, 0, 0, 0.2)',
                  borderRadius: '8px',
                  maxHeight: '600px',
                  minHeight: '100px'
                }
              }
            }
          ]
        }}
        dialogContentProps={{
          title: 'Submit Feedback',
          showCloseButton: true
        }}>
        <Stack tokens={{ childrenGap: 4 }}>
          <div>Your feedback will improve this experience.</div>

          {!showReportInappropriateFeedback ? <UnhelpfulFeedbackContent /> : <ReportInappropriateFeedbackContent />}

          <div>By pressing submit, your feedback will be visible to the application owner.</div>

          <DefaultButton disabled={negativeFeedbackList.length < 1} onClick={onSubmitNegativeFeedback}>
            Submit
          </DefaultButton>
        </Stack>
      </Dialog>
    </>
  )
}
</file>

<file path="backend/settings.py">
import os
import json
import logging
from abc import ABC, abstractmethod
from pydantic import (
    BaseModel,
    confloat,
    conint,
    conlist,
    Field,
    field_validator,
    model_validator,
    PrivateAttr,
    ValidationError,
    ValidationInfo
)
from pydantic.alias_generators import to_snake
from pydantic_settings import BaseSettings, SettingsConfigDict
from typing import List, Literal, Optional
from typing_extensions import Self
from quart import Request
from backend.utils import parse_multi_columns, generateFilterString

DOTENV_PATH = os.environ.get(
    "DOTENV_PATH",
    os.path.join(
        os.path.dirname(
            os.path.dirname(__file__)
        ),
        ".env"
    )
)
MINIMUM_SUPPORTED_AZURE_OPENAI_PREVIEW_API_VERSION = "2024-05-01-preview"


class _UiSettings(BaseSettings):
    model_config = SettingsConfigDict(
        env_prefix="UI_",
        env_file=DOTENV_PATH,
        extra="ignore",
        env_ignore_empty=True
    )

    title: str = "Contoso"
    logo: Optional[str] = None
    chat_logo: Optional[str] = None
    chat_title: str = "Start chatting"
    chat_description: str = "This chatbot is configured to answer your questions"
    preset_starting_message: str = "I am here to help you with anything you need today."
    favicon: str = "/favicon.ico"
    show_share_button: bool = True
    show_chat_history_button: bool = True


class _ChatHistorySettings(BaseSettings):
    model_config = SettingsConfigDict(
        env_prefix="AZURE_COSMOSDB_",
        env_file=DOTENV_PATH,
        extra="ignore",
        env_ignore_empty=True
    )

    database: str
    account: str
    account_key: Optional[str] = None
    conversations_container: str
    enable_feedback: bool = False


class _PromptflowSettings(BaseSettings):
    model_config = SettingsConfigDict(
        env_prefix="PROMPTFLOW_",
        env_file=DOTENV_PATH,
        extra="ignore",
        env_ignore_empty=True
    )

    endpoint: str
    api_key: str
    response_timeout: float = 30.0
    request_field_name: str = "query"
    response_field_name: str = "reply"
    citations_field_name: str = "documents"


class _AzureOpenAIFunction(BaseModel):
    name: str = Field(..., min_length=1)
    description: str = Field(..., min_length=1)
    parameters: Optional[dict] = None


class _AzureOpenAITool(BaseModel):
    type: Literal['function'] = 'function'
    function: _AzureOpenAIFunction
    

class _AzureOpenAISettings(BaseSettings):
    model_config = SettingsConfigDict(
        env_prefix="AZURE_OPENAI_",
        env_file=DOTENV_PATH,
        extra='ignore',
        env_ignore_empty=True
    )
    
    model: str
    key: Optional[str] = None
    resource: Optional[str] = None
    endpoint: Optional[str] = None
    temperature: float = 0
    top_p: float = 0
    max_tokens: int = 1000
    stream: bool = True
    stop_sequence: Optional[List[str]] = None
    seed: Optional[int] = None
    choices_count: Optional[conint(ge=1, le=128)] = Field(default=1, serialization_alias="n")
    user: Optional[str] = None
    tools: Optional[conlist(_AzureOpenAITool, min_length=1)] = None
    tool_choice: Optional[str] = None
    logit_bias: Optional[dict] = None
    presence_penalty: Optional[confloat(ge=-2.0, le=2.0)] = 0.0
    frequency_penalty: Optional[confloat(ge=-2.0, le=2.0)] = 0.0
    system_message: str = "You are an AI assistant that helps people find information."
    preview_api_version: str = MINIMUM_SUPPORTED_AZURE_OPENAI_PREVIEW_API_VERSION
    embedding_endpoint: Optional[str] = None
    embedding_key: Optional[str] = None
    embedding_name: Optional[str] = None
    function_call_azure_functions_enabled: Optional[bool] = False
    function_call_azure_functions_tools_key: Optional[str] = None
    function_call_azure_functions_tools_base_url: Optional[str] = None
    function_call_azure_functions_tool_key: Optional[str] = None
    function_call_azure_functions_tool_base_url: Optional[str] = None
    
    @field_validator('tools', mode='before')
    @classmethod
    def deserialize_tools(cls, tools_json_str: str) -> List[_AzureOpenAITool]:
        if isinstance(tools_json_str, str):
            try:
                tools_dict = json.loads(tools_json_str)
                return _AzureOpenAITool(**tools_dict)
            except json.JSONDecodeError:
                logging.warning("No valid tool definition found in the environment.  If you believe this to be in error, please check that the value of AZURE_OPENAI_TOOLS is a valid JSON string.")
            
            except ValidationError as e:
                logging.warning(f"An error occurred while deserializing the tool definition - {str(e)}")
            
        return None
    
    @field_validator('logit_bias', mode='before')
    @classmethod
    def deserialize_logit_bias(cls, logit_bias_json_str: str) -> dict:
        if isinstance(logit_bias_json_str, str):
            try:
                return json.loads(logit_bias_json_str)
            except json.JSONDecodeError as e:
                logging.warning(f"An error occurred while deserializing the logit bias string -- {str(e)}")
                
        return None
        
    @field_validator('stop_sequence', mode='before')
    @classmethod
    def split_contexts(cls, comma_separated_string: str) -> List[str]:
        if isinstance(comma_separated_string, str) and len(comma_separated_string) > 0:
            return parse_multi_columns(comma_separated_string)
        
        return None
    
    @model_validator(mode="after")
    def ensure_endpoint(self) -> Self:
        if self.endpoint:
            return Self
        
        elif self.resource:
            self.endpoint = f"https://{self.resource}.openai.azure.com"
            return Self
        
        raise ValidationError("AZURE_OPENAI_ENDPOINT or AZURE_OPENAI_RESOURCE is required")
        
    def extract_embedding_dependency(self) -> Optional[dict]:
        if self.embedding_name:
            return {
                "type": "deployment_name",
                "deployment_name": self.embedding_name
            }
        elif self.embedding_endpoint:
            if self.embedding_key:
                return {
                    "type": "endpoint",
                    "endpoint": self.embedding_endpoint,
                    "authentication": {
                        "type": "api_key",
                        "key": self.embedding_key
                    }
                }
            else:
                return {
                    "type": "endpoint",
                    "endpoint": self.embedding_endpoint,
                    "authentication": {
                        "type": "system_assigned_managed_identity"
                    }
                }
        else:   
            return None
    

class _SearchCommonSettings(BaseSettings):
    model_config = SettingsConfigDict(
        env_prefix="SEARCH_",
        env_file=DOTENV_PATH,
        extra="ignore",
        env_ignore_empty=True
    )
    max_search_queries: Optional[int] = None
    allow_partial_result: bool = False
    include_contexts: Optional[List[str]] = ["citations", "intent"]
    vectorization_dimensions: Optional[int] = None
    role_information: str = Field(
        default="You are an AI assistant that helps people find information.",
        validation_alias="AZURE_OPENAI_SYSTEM_MESSAGE"
    )

    @field_validator('include_contexts', mode='before')
    @classmethod
    def split_contexts(cls, comma_separated_string: str, info: ValidationInfo) -> List[str]:
        if isinstance(comma_separated_string, str) and len(comma_separated_string) > 0:
            return parse_multi_columns(comma_separated_string)
        
        return cls.model_fields[info.field_name].get_default()


class DatasourcePayloadConstructor(BaseModel, ABC):
    _settings: '_AppSettings' = PrivateAttr()
    
    def __init__(self, settings: '_AppSettings', **data):
        super().__init__(**data)
        self._settings = settings
    
    @abstractmethod
    def construct_payload_configuration(
        self,
        *args,
        **kwargs
    ):
        pass


class _AzureSearchSettings(BaseSettings, DatasourcePayloadConstructor):
    model_config = SettingsConfigDict(
        env_prefix="AZURE_SEARCH_",
        env_file=DOTENV_PATH,
        extra="ignore",
        env_ignore_empty=True
    )
    _type: Literal["azure_search"] = PrivateAttr(default="azure_search")
    top_k: int = Field(default=5, serialization_alias="top_n_documents")
    strictness: int = 3
    enable_in_domain: bool = Field(default=True, serialization_alias="in_scope")
    service: str = Field(exclude=True)
    endpoint_suffix: str = Field(default="search.windows.net", exclude=True)
    index: str = Field(serialization_alias="index_name")
    key: Optional[str] = Field(default=None, exclude=True)
    use_semantic_search: bool = Field(default=False, exclude=True)
    semantic_search_config: str = Field(default="", serialization_alias="semantic_configuration")
    content_columns: Optional[List[str]] = Field(default=None, exclude=True)
    vector_columns: Optional[List[str]] = Field(default=None, exclude=True)
    title_column: Optional[str] = Field(default=None, exclude=True)
    url_column: Optional[str] = Field(default=None, exclude=True)
    filename_column: Optional[str] = Field(default=None, exclude=True)
    query_type: Literal[
        'simple',
        'vector',
        'semantic',
        'vector_simple_hybrid',
        'vectorSimpleHybrid',
        'vector_semantic_hybrid',
        'vectorSemanticHybrid'
    ] = "simple"
    permitted_groups_column: Optional[str] = Field(default=None, exclude=True)
    
    # Constructed fields
    endpoint: Optional[str] = None
    authentication: Optional[dict] = None
    embedding_dependency: Optional[dict] = None
    fields_mapping: Optional[dict] = None
    filter: Optional[str] = Field(default=None, exclude=True)
    
    @field_validator('content_columns', 'vector_columns', mode="before")
    @classmethod
    def split_columns(cls, comma_separated_string: str) -> List[str]:
        if isinstance(comma_separated_string, str) and len(comma_separated_string) > 0:
            return parse_multi_columns(comma_separated_string)
        
        return None
    
    @model_validator(mode="after")
    def set_endpoint(self) -> Self:
        self.endpoint = f"https://{self.service}.{self.endpoint_suffix}"
        return self
    
    @model_validator(mode="after")
    def set_authentication(self) -> Self:
        if self.key:
            self.authentication = {"type": "api_key", "key": self.key}
        else:
            self.authentication = {"type": "system_assigned_managed_identity"}
            
        return self
    
    @model_validator(mode="after")
    def set_fields_mapping(self) -> Self:
        self.fields_mapping = {
            "content_fields": self.content_columns,
            "title_field": self.title_column,
            "url_field": self.url_column,
            "filepath_field": self.filename_column,
            "vector_fields": self.vector_columns
        }
        return self
    
    @model_validator(mode="after")
    def set_query_type(self) -> Self:
        self.query_type = to_snake(self.query_type)

    def _set_filter_string(self, request: Request) -> str:
        if self.permitted_groups_column:
            user_token = request.headers.get("X-MS-TOKEN-AAD-ACCESS-TOKEN", "")
            logging.debug(f"USER TOKEN is {'present' if user_token else 'not present'}")
            if not user_token:
                raise ValueError(
                    "Document-level access control is enabled, but user access token could not be fetched."
                )

            filter_string = generateFilterString(user_token)
            logging.debug(f"FILTER: {filter_string}")
            return filter_string
        
        return None
            
    def construct_payload_configuration(
        self,
        *args,
        **kwargs
    ):
        request = kwargs.pop('request', None)
        if request and self.permitted_groups_column:
            self.filter = self._set_filter_string(request)
            
        self.embedding_dependency = \
            self._settings.azure_openai.extract_embedding_dependency()
        parameters = self.model_dump(exclude_none=True, by_alias=True)
        parameters.update(self._settings.search.model_dump(exclude_none=True, by_alias=True))
        
        return {
            "type": self._type,
            "parameters": parameters
        }


class _AzureCosmosDbMongoVcoreSettings(
    BaseSettings,
    DatasourcePayloadConstructor
):
    model_config = SettingsConfigDict(
        env_prefix="AZURE_COSMOSDB_MONGO_VCORE_",
        env_file=DOTENV_PATH,
        extra="ignore",
        env_ignore_empty=True
    )
    _type: Literal["azure_cosmosdb"] = PrivateAttr(default="azure_cosmosdb")
    top_k: int = Field(default=5, serialization_alias="top_n_documents")
    strictness: int = 3
    enable_in_domain: bool = Field(default=True, serialization_alias="in_scope")
    query_type: Literal['vector'] = "vector"
    connection_string: str = Field(exclude=True)
    index: str = Field(serialization_alias="index_name")
    database: str = Field(serialization_alias="database_name")
    container: str = Field(serialization_alias="container_name")
    content_columns: Optional[List[str]] = Field(default=None, exclude=True)
    vector_columns: Optional[List[str]] = Field(default=None, exclude=True)
    title_column: Optional[str] = Field(default=None, exclude=True)
    url_column: Optional[str] = Field(default=None, exclude=True)
    filename_column: Optional[str] = Field(default=None, exclude=True)
    
    # Constructed fields
    authentication: Optional[dict] = None
    embedding_dependency: Optional[dict] = None
    fields_mapping: Optional[dict] = None
    
    @field_validator('content_columns', 'vector_columns', mode="before")
    @classmethod
    def split_columns(cls, comma_separated_string: str) -> List[str]:
        if isinstance(comma_separated_string, str) and len(comma_separated_string) > 0:
            return parse_multi_columns(comma_separated_string)
        
        return None
    
    @model_validator(mode="after")
    def construct_authentication(self) -> Self:
        self.authentication = {
            "type": "connection_string",
            "connection_string": self.connection_string
        }
        return self
    
    @model_validator(mode="after")
    def set_fields_mapping(self) -> Self:
        self.fields_mapping = {
            "content_fields": self.content_columns,
            "title_field": self.title_column,
            "url_field": self.url_column,
            "filepath_field": self.filename_column,
            "vector_fields": self.vector_columns
        }
        return self
    
    def construct_payload_configuration(
        self,
        *args,
        **kwargs
    ):
        self.embedding_dependency = \
            self._settings.azure_openai.extract_embedding_dependency()
        parameters = self.model_dump(exclude_none=True, by_alias=True)
        parameters.update(self._settings.search.model_dump(exclude_none=True, by_alias=True))
        return {
            "type": self._type,
            "parameters": parameters
        }


class _ElasticsearchSettings(BaseSettings, DatasourcePayloadConstructor):
    model_config = SettingsConfigDict(
        env_prefix="ELASTICSEARCH_",
        env_file=DOTENV_PATH,
        extra="ignore",
        env_ignore_empty=True
    )
    _type: Literal["elasticsearch"] = PrivateAttr(default="elasticsearch")
    top_k: int = Field(default=5, serialization_alias="top_n_documents")
    strictness: int = 3
    enable_in_domain: bool = Field(default=True, serialization_alias="in_scope")
    endpoint: str
    encoded_api_key: str = Field(exclude=True)
    index: str = Field(serialization_alias="index_name")
    query_type: Literal['simple', 'vector'] = "simple"
    content_columns: Optional[List[str]] = Field(default=None, exclude=True)
    vector_columns: Optional[List[str]] = Field(default=None, exclude=True)
    title_column: Optional[str] = Field(default=None, exclude=True)
    url_column: Optional[str] = Field(default=None, exclude=True)
    filename_column: Optional[str] = Field(default=None, exclude=True)
    embedding_model_id: Optional[str] = Field(default=None, exclude=True)
    
    # Constructed fields
    authentication: Optional[dict] = None
    embedding_dependency: Optional[dict] = None
    fields_mapping: Optional[dict] = None
    
    @field_validator('content_columns', 'vector_columns', mode="before")
    @classmethod
    def split_columns(cls, comma_separated_string: str) -> List[str]:
        if isinstance(comma_separated_string, str) and len(comma_separated_string) > 0:
            return parse_multi_columns(comma_separated_string)
        
        return None
    
    @model_validator(mode="after")
    def set_authentication(self) -> Self:
        self.authentication = {
            "type": "encoded_api_key",
            "encoded_api_key": self.encoded_api_key
        }
        
        return self
    
    @model_validator(mode="after")
    def set_fields_mapping(self) -> Self:
        self.fields_mapping = {
            "content_fields": self.content_columns,
            "title_field": self.title_column,
            "url_field": self.url_column,
            "filepath_field": self.filename_column,
            "vector_fields": self.vector_columns
        }
        return self
    
    def construct_payload_configuration(
        self,
        *args,
        **kwargs
    ):
        self.embedding_dependency = \
            {"type": "model_id", "model_id": self.embedding_model_id} if self.embedding_model_id else \
            self._settings.azure_openai.extract_embedding_dependency() 
            
        parameters = self.model_dump(exclude_none=True, by_alias=True)
        parameters.update(self._settings.search.model_dump(exclude_none=True, by_alias=True))
                
        return {
            "type": self._type,
            "parameters": parameters
        }


class _PineconeSettings(BaseSettings, DatasourcePayloadConstructor):
    model_config = SettingsConfigDict(
        env_prefix="PINECONE_",
        env_file=DOTENV_PATH,
        extra="ignore",
        env_ignore_empty=True
    )
    _type: Literal["pinecone"] = PrivateAttr(default="pinecone")
    top_k: int = Field(default=5, serialization_alias="top_n_documents")
    strictness: int = 3
    enable_in_domain: bool = Field(default=True, serialization_alias="in_scope")
    environment: str
    api_key: str = Field(exclude=True)
    index_name: str
    query_type: Literal["vector"] = "vector"
    content_columns: Optional[List[str]] = Field(default=None, exclude=True)
    vector_columns: Optional[List[str]] = Field(default=None, exclude=True)
    title_column: Optional[str] = Field(default=None, exclude=True)
    url_column: Optional[str] = Field(default=None, exclude=True)
    filename_column: Optional[str] = Field(default=None, exclude=True)
    
    # Constructed fields
    authentication: Optional[dict] = None
    embedding_dependency: Optional[dict] = None
    fields_mapping: Optional[dict] = None
    
    @field_validator('content_columns', 'vector_columns', mode="before")
    @classmethod
    def split_columns(cls, comma_separated_string: str) -> List[str]:
        if isinstance(comma_separated_string, str) and len(comma_separated_string) > 0:
            return parse_multi_columns(comma_separated_string)
        
        return None
    
    @model_validator(mode="after")
    def set_authentication(self) -> Self:
        self.authentication = {
            "type": "api_key",
            "api_key": self.api_key
        }
        
        return self
    
    @model_validator(mode="after")
    def set_fields_mapping(self) -> Self:
        self.fields_mapping = {
            "content_fields": self.content_columns,
            "title_field": self.title_column,
            "url_field": self.url_column,
            "filepath_field": self.filename_column,
            "vector_fields": self.vector_columns
        }
        return self
    
    def construct_payload_configuration(
        self,
        *args,
        **kwargs
    ):
        self.embedding_dependency = \
            self._settings.azure_openai.extract_embedding_dependency()
        parameters = self.model_dump(exclude_none=True, by_alias=True)
        parameters.update(self._settings.search.model_dump(exclude_none=True, by_alias=True))
        
        return {
            "type": self._type,
            "parameters": parameters
        }


class _AzureMLIndexSettings(BaseSettings, DatasourcePayloadConstructor):
    model_config = SettingsConfigDict(
        env_prefix="AZURE_MLINDEX_",
        env_file=DOTENV_PATH,
        extra="ignore",
        env_ignore_empty=True
    )
    _type: Literal["azure_ml_index"] = PrivateAttr(default="azure_ml_index")
    top_k: int = Field(default=5, serialization_alias="top_n_documents")
    strictness: int = 3
    enable_in_domain: bool = Field(default=True, serialization_alias="in_scope")
    name: str
    version: str
    project_resource_id: str = Field(validation_alias="AZURE_ML_PROJECT_RESOURCE_ID")
    content_columns: Optional[List[str]] = Field(default=None, exclude=True)
    vector_columns: Optional[List[str]] = Field(default=None, exclude=True)
    title_column: Optional[str] = Field(default=None, exclude=True)
    url_column: Optional[str] = Field(default=None, exclude=True)
    filename_column: Optional[str] = Field(default=None, exclude=True)
    
    # Constructed fields
    fields_mapping: Optional[dict] = None
    
    @field_validator('content_columns', 'vector_columns', mode="before")
    @classmethod
    def split_columns(cls, comma_separated_string: str) -> List[str]:
        if isinstance(comma_separated_string, str) and len(comma_separated_string) > 0:
            return parse_multi_columns(comma_separated_string)
        
        return None
    
    @model_validator(mode="after")
    def set_fields_mapping(self) -> Self:
        self.fields_mapping = {
            "content_fields": self.content_columns,
            "title_field": self.title_column,
            "url_field": self.url_column,
            "filepath_field": self.filename_column,
            "vector_fields": self.vector_columns
        }
        return self
    
    def construct_payload_configuration(
        self,
        *args,
        **kwargs
    ):
        parameters = self.model_dump(exclude_none=True, by_alias=True)
        parameters.update(self._settings.search.model_dump(exclude_none=True, by_alias=True))
        
        return {
            "type": self._type,
            "parameters": parameters
        }


class _AzureSqlServerSettings(BaseSettings, DatasourcePayloadConstructor):
    model_config = SettingsConfigDict(
        env_prefix="AZURE_SQL_SERVER_",
        env_file=DOTENV_PATH,
        extra="ignore",
        env_ignore_empty=True
    )
    _type: Literal["azure_sql_server"] = PrivateAttr(default="azure_sql_server")
    
    connection_string: Optional[str] = Field(default=None, exclude=True)
    table_schema: Optional[str] = None
    schema_max_row: Optional[int] = None
    top_n_results: Optional[int] = None
    database_server: Optional[str] = None
    database_name: Optional[str] = None
    port: Optional[int] = None
    
    # Constructed fields
    authentication: Optional[dict] = None
    
    @model_validator(mode="after")
    def construct_authentication(self) -> Self:
        if self.connection_string:
            self.authentication = {
                "type": "connection_string",
                "connection_string": self.connection_string
            }
        elif self.database_server and self.database_name and self.port:
            self.authentication = {
                "type": "system_assigned_managed_identity"
            }
        return self
    
    def construct_payload_configuration(
        self,
        *args,
        **kwargs
    ):
        parameters = self.model_dump(exclude_none=True, by_alias=True)
        #parameters.update(self._settings.search.model_dump(exclude_none=True, by_alias=True))
        
        return {
            "type": self._type,
            "parameters": parameters
        }
    

class _MongoDbSettings(BaseSettings, DatasourcePayloadConstructor):
    model_config = SettingsConfigDict(
        env_prefix="MONGODB_",
        env_file=DOTENV_PATH,
        extra="ignore",
        env_ignore_empty=True
    )
    _type: Literal["mongo_db"] = PrivateAttr(default="mongo_db")
    
    endpoint: str
    username: str = Field(exclude=True)
    password: str = Field(exclude=True)
    database_name: str
    collection_name: str
    app_name: str
    index_name: str
    query_type: Literal["vector"] = "vector"
    top_k: int = Field(default=5, serialization_alias="top_n_documents")
    strictness: int = 3
    enable_in_domain: bool = Field(default=True, serialization_alias="in_scope")
    content_columns: Optional[List[str]] = Field(default=None, exclude=True)
    vector_columns: Optional[List[str]] = Field(default=None, exclude=True)
    title_column: Optional[str] = Field(default=None, exclude=True)
    url_column: Optional[str] = Field(default=None, exclude=True)
    filename_column: Optional[str] = Field(default=None, exclude=True)
    
    
    # Constructed fields
    authentication: Optional[dict] = None
    embedding_dependency: Optional[dict] = None
    fields_mapping: Optional[dict] = None
    
    @field_validator('content_columns', 'vector_columns', mode="before")
    @classmethod
    def split_columns(cls, comma_separated_string: str) -> List[str]:
        if isinstance(comma_separated_string, str) and len(comma_separated_string) > 0:
            return parse_multi_columns(comma_separated_string)
        
        return None
    
    @model_validator(mode="after")
    def set_fields_mapping(self) -> Self:
        self.fields_mapping = {
            "content_fields": self.content_columns,
            "title_field": self.title_column,
            "url_field": self.url_column,
            "filepath_field": self.filename_column,
            "vector_fields": self.vector_columns
        }
        return self
    
    @model_validator(mode="after")
    def construct_authentication(self) -> Self:
        self.authentication = {
            "type": "username_and_password",
            "username": self.username,
            "password": self.password
        }
        return self
    
    def construct_payload_configuration(
        self,
        *args,
        **kwargs
    ):
        self.embedding_dependency = \
            self._settings.azure_openai.extract_embedding_dependency()
            
        parameters = self.model_dump(exclude_none=True, by_alias=True)
        parameters.update(self._settings.search.model_dump(exclude_none=True, by_alias=True))
        
        return {
            "type": self._type,
            "parameters": parameters
        }
        
        
class _BaseSettings(BaseSettings):
    model_config = SettingsConfigDict(
        env_file=DOTENV_PATH,
        extra="ignore",
        arbitrary_types_allowed=True,
        env_ignore_empty=True
    )
    datasource_type: Optional[str] = None
    auth_enabled: bool = True
    sanitize_answer: bool = False
    use_promptflow: bool = False


class _AppSettings(BaseModel):
    base_settings: _BaseSettings = _BaseSettings()
    azure_openai: _AzureOpenAISettings = _AzureOpenAISettings()
    search: _SearchCommonSettings = _SearchCommonSettings()
    ui: Optional[_UiSettings] = _UiSettings()
    
    # Constructed properties
    chat_history: Optional[_ChatHistorySettings] = None
    datasource: Optional[DatasourcePayloadConstructor] = None
    promptflow: Optional[_PromptflowSettings] = None

    @model_validator(mode="after")
    def set_promptflow_settings(self) -> Self:
        try:
            self.promptflow = _PromptflowSettings()
            
        except ValidationError:
            self.promptflow = None
            
        return self
    
    @model_validator(mode="after")
    def set_chat_history_settings(self) -> Self:
        try:
            self.chat_history = _ChatHistorySettings()
        
        except ValidationError:
            self.chat_history = None
        
        return self
    
    @model_validator(mode="after")
    def set_datasource_settings(self) -> Self:
        try:
            if self.base_settings.datasource_type == "AzureCognitiveSearch":
                self.datasource = _AzureSearchSettings(settings=self, _env_file=DOTENV_PATH)
                logging.debug("Using Azure Cognitive Search")
            
            elif self.base_settings.datasource_type == "AzureCosmosDB":
                self.datasource = _AzureCosmosDbMongoVcoreSettings(settings=self, _env_file=DOTENV_PATH)
                logging.debug("Using Azure CosmosDB Mongo vcore")
            
            elif self.base_settings.datasource_type == "Elasticsearch":
                self.datasource = _ElasticsearchSettings(settings=self, _env_file=DOTENV_PATH)
                logging.debug("Using Elasticsearch")
            
            elif self.base_settings.datasource_type == "Pinecone":
                self.datasource = _PineconeSettings(settings=self, _env_file=DOTENV_PATH)
                logging.debug("Using Pinecone")
            
            elif self.base_settings.datasource_type == "AzureMLIndex":
                self.datasource = _AzureMLIndexSettings(settings=self, _env_file=DOTENV_PATH)
                logging.debug("Using Azure ML Index")
            
            elif self.base_settings.datasource_type == "AzureSqlServer":
                self.datasource = _AzureSqlServerSettings(settings=self, _env_file=DOTENV_PATH)
                logging.debug("Using SQL Server")
            
            elif self.base_settings.datasource_type == "MongoDB":
                self.datasource = _MongoDbSettings(settings=self, _env_file=DOTENV_PATH)
                logging.debug("Using Mongo DB")
                
            else:
                self.datasource = None
                logging.warning("No datasource configuration found in the environment -- calls will be made to Azure OpenAI without grounding data.")
                
            return self

        except ValidationError as e:
            logging.warning("No datasource configuration found in the environment -- calls will be made to Azure OpenAI without grounding data.")
            logging.warning(e.errors())


app_settings = _AppSettings()
</file>

<file path="README.md">
# [Preview] Sample Chat App with AOAI

This repo contains sample code for a simple chat webapp that integrates with Azure OpenAI. Note: some portions of the app use preview APIs.

## Prerequisites
- An existing Azure OpenAI resource and model deployment of a chat model (e.g. `gpt-35-turbo-16k`, `gpt-4`)
- To use Azure OpenAI on your data, one of the following data sources:
  - Azure AI Search Index
  - Azure CosmosDB Mongo vCore vector index
  - Elasticsearch index (preview)
  - Pinecone index (private preview)
  - Azure SQL Server (private preview)
  - Mongo DB (preview)

## Configure the app

### Create a .env file for local development

Follow instructions below in the [app configuration](#app-settings) section to create a .env file for local development of your app.  This file can be used as a reference to populate the app settings for your Azure App Service deployed webapp.

### Create a JSON file for populating Azure App Service app settings

After creating your .env file, run one of the following commands in your preferred shell to create a JSON representation of your environment which is recognized by Azure App Service.

#### Powershell
```powershell
Get-Content .env | ForEach-Object {  
 if ($_ -match "(?<name>[A-Z_]+)=(?<value>.*)") {  
 [PSCustomObject]@{  
 name = $matches["name"]  
 value = $matches["value"]  
 slotSetting = $false  
 }  
 }  
} | ConvertTo-Json | Out-File -FilePath env.json
```

#### Bash
```bash
cat .env | jq -R '. | capture("(?<name>[A-Z_]+)=(?<value>.*)")' | jq -s '.[].slotSetting=false' > env.json
```

## Deploy the app

### Deploy with Azure Developer CLI
Please see [README_azd.md](./README_azd.md) for detailed instructions.

### One click Azure deployment
[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmicrosoft%2Fsample-app-aoai-chatGPT%2Fmain%2Finfrastructure%2Fdeployment.json)

Click on the Deploy to Azure button and configure your settings in the Azure Portal as described in the [Environment variables](#environment-variables) section.

Please see the [section below](#add-an-identity-provider) for important information about adding authentication to your app.

### Deploy from your local machine

1. Follow the steps below in the [app configuration](#app-settings) section to construct your .env file with the appropriate variables for your use case.

2. Start the app with `start.cmd`. This will build the frontend, install backend dependencies, and then start the app. Or, just run the backend in debug mode using the VSCode debug configuration in `.vscode/launch.json`.

3. You can see the local running app at http://127.0.0.1:50505.

### Deploy with the Azure CLI

#### Create the Azure App Service
**NOTE**: If you've made code changes, be sure to **build the app code** with `start.cmd` or `start.sh` before you deploy, otherwise your changes will not be picked up. If you've updated any files in the `frontend` folder, make sure you see updates to the files in the `static` folder before you deploy.

You can use the [Azure CLI](https://learn.microsoft.com/en-us/cli/azure/install-azure-cli) to deploy the app from your local machine. Make sure you have version 2.48.1 or later.

If this is your first time deploying the app, you can use [az webapp up](https://learn.microsoft.com/en-us/cli/azure/webapp?view=azure-cli-latest#az-webapp-up). Run the following command from the root folder of the repo, updating the placeholder values to your desired app name, resource group, location, and subscription. You can also change the SKU if desired.

`az webapp up --runtime PYTHON:3.11 --sku B1 --name <new-app-name> --resource-group <resource-group-name> --location <azure-region> --subscription <subscription-name>`

Note: if using the Azure CLI version 2.62 or greater, you may also want to add the flag `--track-status False` to prevent the command from failing due to startup errors.  Startup errors can be solved by following the instructions in the next section about [updating app configuration](#update-app-configuration).

#### Update app configuration

After creating your Azure App Service, follow these steps to update the configuration to allow your application to properly start up.

1. Set the app startup command
```
az webapp config set --startup-file "python3 -m gunicorn app:app" --name <new-app-name>
```
2. Set `WEBSITE_WEBDEPLOY_USE_SCM=false` to allow local code deployment.
```
az webapp config appsettings set -g <resource-group-name> -n <existing-app-name> --settings WEBSITE_WEBDEPLOY_USE_SCM=false
```
3. Set all of your app settings in your local .env file at once by [creating a JSON representation](#create-a-json-file-for-populating-azure-app-service-app-settings) of the .env file, and then run the following command.
```
az webapp config appsettings set -g <resource-group-name> -n <existing-app-name> --settings "@env.json"
```

#### Update an existing app

Check the runtime stack for your app by viewing the app service resource in the Azure Portal. If it shows "Python - 3.10", use `PYTHON:3.10` in the runtime argument below. If it shows "Python - 3.11", use `PYTHON:3.11` in the runtime argument below. 

Check the SKU in the same way. Use the abbreviated SKU name in the argument below, e.g. for "Basic (B1)" the SKU is `B1`. 

Then, use these commands to deploy your local code to the existing app:

1. `az webapp up --runtime <runtime-stack> --sku <sku> --name <existing-app-name> --resource-group <resource-group-name>`
1. `az webapp config set --startup-file "python3 -m gunicorn app:app" --name <existing-app-name>`

Make sure that the app name and resource group match exactly for the app that was previously deployed.

Deployment will take several minutes. When it completes, you should be able to navigate to your app at {app-name}.azurewebsites.net.

## Authentication

### Add an identity provider
After deployment, you will need to add an identity provider to provide authentication support in your app. See [this tutorial](https://learn.microsoft.com/en-us/azure/app-service/scenario-secure-app-authentication-app-service) for more information.

If you don't add an identity provider, the chat functionality of your app will be blocked to prevent unauthorized access to your resources and data. 

To remove this restriction, you can add `AUTH_ENABLED=False` to the environment variables. This will disable authentication and allow anyone to access the chat functionality of your app. **This is not recommended for production apps.**

To add further access controls, update the logic in `getUserInfoList` in `frontend/src/pages/chat/Chat.tsx`. 

### Using Microsoft Entra ID

To enable Microsoft Entra ID for intra-service authentication:

1. Enable managed identity on Azure OpenAI
2. Configure AI search to allow access from Azure OpenAI
   1. Enable Role Based Access control on the used AI search instance [(see documentation)](https://learn.microsoft.com/en-us/azure/search/search-security-enable-roles)
   2. Assign `Search Index Data Reader` and `Search Service Contributor` to the identity of the Azure OpenAI instance
3. Do not configure `AZURE_SEARCH_KEY` and `AZURE_OPENAI_KEY` to use Entra ID authentication.
4. Configure the webapp identity
   1. Enable managed identity in the app service that hosts the webapp
   2. Go to the Azure OpenAI instance and assign the role `Cognitive Services OpenAI User` to the identity of the webapp

Note: RBAC assignments can take a few minutes before becoming effective.

## App Configuration

### App Settings

#### Basic Chat Experience
1. Copy `.env.sample` to a new file called `.env` and configure the settings as described in the table below.

    | App Setting | Required? | Default Value | Note |
    | --- | --- | --- | ------------- |
    |AZURE_OPENAI_RESOURCE| Only if `AZURE_OPENAI_ENDPOINT` is not set || The name of your Azure OpenAI resource (only one of AZURE_OPENAI_RESOURCE/AZURE_OPENAI_ENDPOINT is required)|
    |AZURE_OPENAI_ENDPOINT| Only if `AZURE_OPENAI_RESOURCE` is not set ||The endpoint of your Azure OpenAI resource (only one of AZURE_OPENAI_RESOURCE/AZURE_OPENAI_ENDPOINT is required)|
    |AZURE_OPENAI_MODEL|Yes||The name of your model deployment|
    |AZURE_OPENAI_KEY|Optional if using Microsoft Entra ID -- see our documentation on the required resource setup for identity-based authentication.||One of the API keys of your Azure OpenAI resource|
    |AZURE_OPENAI_TEMPERATURE|No|0|What sampling temperature to use, between 0 and 2. Higher values like 0.8 will make the output more random, while lower values like 0.2 will make it more focused and deterministic. A value of 0 is recommended when using your data.|
    |AZURE_OPENAI_TOP_P|No|1.0|An alternative to sampling with temperature, called nucleus sampling, where the model considers the results of the tokens with top_p probability mass. We recommend setting this to 1.0 when using your data.|
    |AZURE_OPENAI_MAX_TOKENS|No|1000|The maximum number of tokens allowed for the generated answer.|
    |AZURE_OPENAI_STOP_SEQUENCE|No||Up to 4 sequences where the API will stop generating further tokens. Represent these as a string joined with "|", e.g. `"stop1|stop2|stop3"`|
    |AZURE_OPENAI_SYSTEM_MESSAGE|No|You are an AI assistant that helps people find information.|A brief description of the role and tone the model should use|
    |AZURE_OPENAI_STREAM|No|True|Whether or not to use streaming for the response. Note: Setting this to true prevents the use of prompt flow.|
    |AZURE_OPENAI_EMBEDDING_NAME|Only if using vector search using an Azure OpenAI embedding model||The name of your embedding model deployment if using vector search.

    See the [documentation](https://learn.microsoft.com/en-us/azure/cognitive-services/openai/reference#example-response-2) for more information on these parameters.


#### Chat with your data

[More information about Azure OpenAI on your data](https://learn.microsoft.com/en-us/azure/cognitive-services/openai/concepts/use-your-data)

#### Chat with your data using Azure Cognitive Search

1. Update the `AZURE_OPENAI_*` environment variables as described in the [basic chat experience](#basic-chat-experience) above. 

2. To connect to your data, you need to specify an Azure Cognitive Search index to use. You can [create this index yourself](https://learn.microsoft.com/en-us/azure/search/search-get-started-portal) or use the [Azure AI Studio](https://oai.azure.com/portal/chat) to create the index for you.

3. Configure data source settings as described in the table below.

    | App Setting | Required? | Default Value | Note |
    | --- | --- | --- | ------------- |
    |DATASOURCE_TYPE|Yes||Must be set to `AzureCognitiveSearch`|
    |AZURE_SEARCH_SERVICE|Yes||The name of your Azure AI Search resource|
    |AZURE_SEARCH_INDEX|Yes||The name of your Azure AI Search Index|
    |AZURE_SEARCH_KEY|Optional if using Microsoft Entra ID -- see our documentation on the required resource setup for identity-based authentication.||An **admin key** for your Azure AI Search resource.|
    |AZURE_SEARCH_USE_SEMANTIC_SEARCH|No|False|Whether or not to use semantic search|
    |AZURE_SEARCH_QUERY_TYPE|No|simple|Query type: simple, semantic, vector, vectorSimpleHybrid, or vectorSemanticHybrid. Takes precedence over AZURE_SEARCH_USE_SEMANTIC_SEARCH|
    |AZURE_SEARCH_SEMANTIC_SEARCH_CONFIG|No||The name of the semantic search configuration to use if using semantic search.|
    |AZURE_SEARCH_TOP_K|No|5|The number of documents to retrieve when querying your search index.|
    |AZURE_SEARCH_ENABLE_IN_DOMAIN|No|True|Limits responses to only queries relating to your data.|
    |AZURE_SEARCH_STRICTNESS|No|3|Integer from 1 to 5 specifying the strictness for the model limiting responses to your data.|
    |AZURE_SEARCH_CONTENT_COLUMNS|No||List of fields in your search index that contains the text content of your documents to use when formulating a bot response. Represent these as a string joined with "|", e.g. `"product_description|product_manual"`|
    |AZURE_SEARCH_FILENAME_COLUMN|No|| Field from your search index that gives a unique identifier of the source of your data to display in the UI.|
    |AZURE_SEARCH_TITLE_COLUMN|No||Field from your search index that gives a relevant title or header for your data content to display in the UI.|
    |AZURE_SEARCH_URL_COLUMN|No||Field from your search index that contains a URL for the document, e.g. an Azure Blob Storage URI. This value is not currently used.|
    |AZURE_SEARCH_VECTOR_COLUMNS|No||List of fields in your search index that contain vector embeddings of your documents to use when formulating a bot response. Represent these as a string joined with "|", e.g. `"product_description|product_manual"`|
    |AZURE_SEARCH_PERMITTED_GROUPS_COLUMN|No||Field from your Azure AI Search index that contains AAD group IDs that determine document-level access control.|

    When using your own data with a vector index, ensure these settings are configured on your app:
    - `AZURE_SEARCH_QUERY_TYPE`: can be `vector`, `vectorSimpleHybrid`, or `vectorSemanticHybrid`,
    - `AZURE_OPENAI_EMBEDDING_NAME`: the name of your Ada (text-embedding-ada-002) model deployment on your Azure OpenAI resource.
    - `AZURE_SEARCH_VECTOR_COLUMNS`: the vector columns in your index to use when searching. Join them with `|` like `contentVector|titleVector`.

#### Chat with your data using Azure Cosmos DB

1. Update the `AZURE_OPENAI_*` environment variables as described in the [basic chat experience](#basic-chat-experience) above. 

2. To connect to your data, you need to specify an Azure Cosmos DB database configuration.  Learn more about [creating an Azure Cosmos DB resource](https://learn.microsoft.com/en-us/azure/cosmos-db/nosql/quickstart-portal).

3. Configure data source settings as described in the table below.

    | App Setting | Required? | Default Value | Note |
    | --- | --- | --- | ------------- |
    |DATASOURCE_TYPE|Yes||Must be set to `AzureCosmosDB`|
    |AZURE_COSMOSDB_MONGO_VCORE_CONNECTION_STRING|Yes||The connection string used to connect to your Azure Cosmos DB instance|
    |AZURE_COSMOSDB_MONGO_VCORE_INDEX|Yes||The name of your Azure Cosmos DB vector index|
    |AZURE_COSMOSDB_MONGO_VCORE_DATABASE|Yes||The name of your Azure Cosmos DB database|
    |AZURE_COSMOSDB_MONGO_VCORE_CONTAINER|Yes||The name of your Azure Cosmos DB container|
    |AZURE_COSMOSDB_MONGO_VCORE_TOP_K|No|5|The number of documents to retrieve when querying your search index.|
    |AZURE_COSMOSDB_MONGO_VCORE_ENABLE_IN_DOMAIN|No|True|Limits responses to only queries relating to your data.|
    |AZURE_COSMOSDB_MONGO_VCORE_STRICTNESS|No|3|Integer from 1 to 5 specifying the strictness for the model limiting responses to your data.|
    |AZURE_COSMOSDB_MONGO_VCORE_CONTENT_COLUMNS|No||List of fields in your search index that contains the text content of your documents to use when formulating a bot response. Represent these as a string joined with "|", e.g. `"product_description|product_manual"`|
    |AZURE_COSMOSDB_MONGO_VCORE_FILENAME_COLUMN|No|| Field from your search index that gives a unique identifier of the source of your data to display in the UI.|
    |AZURE_COSMOSDB_MONGO_VCORE_TITLE_COLUMN|No||Field from your search index that gives a relevant title or header for your data content to display in the UI.|
    |AZURE_COSMOSDB_MONGO_VCORE_URL_COLUMN|No||Field from your search index that contains a URL for the document, e.g. an Azure Blob Storage URI. This value is not currently used.|
    |AZURE_COSMOSDB_MONGO_VCORE_VECTOR_COLUMNS|No||List of fields in your search index that contain vector embeddings of your documents to use when formulating a bot response. Represent these as a string joined with "|", e.g. `"product_description|product_manual"`|

    Azure Cosmos DB uses vector search by default, so ensure these settings are configured on your app:
    - `AZURE_OPENAI_EMBEDDING_NAME`: the name of your Ada (text-embedding-ada-002) model deployment on your Azure OpenAI resource.
    - `AZURE_COSMOSDB_MONGO_VCORE_VECTOR_COLUMNS`: the vector columns in your index to use when searching. Join them with `|` like `contentVector|titleVector`.

#### Chat with your data using Elasticsearch (Preview)

1. Update the `AZURE_OPENAI_*` environment variables as described in the [basic chat experience](#basic-chat-experience) above. 

2. To connect to your data, you need to specify an Elasticsearch cluster configuration. Learn more about [Elasticsearch](https://www.elastic.co/).

3. Configure data source settings as described in the table below.

    | App Setting | Required? | Default Value | Note |
    | --- | --- | --- | ------------- |
    |DATASOURCE_TYPE|Yes||Must be set to `Elasticsearch`|
    |ELASTICSEARCH_ENDPOINT|Yes||The base URL of your Elasticsearch cluster API|
    |ELASTICSEARCH_ENCODED_API_KEY|Yes||The encoded API key for your user identity on your Elasticsearch cluster|
    |ELASTICSEARCH_INDEX|Yes||The name of your Elasticsearch index|
    |ELASTICSEARCH_QUERY_TYPE|No|simple|Can be one of `simple` or `vector`|
    |ELASTICSEARCH_EMBEDDING_MODEL_ID|Only if using vector search with an Elasticsearch embedding model||The name of the embedding model deployed to your Elasticsearch cluster which was used to produce embeddings for your index|
    |ELASTICSEARCH_TOP_K|No|5|The number of documents to retrieve when querying your search index.|
    |ELASTICSEARCH_ENABLE_IN_DOMAIN|No|True|Limits responses to only queries relating to your data.|
    |ELASTICSEARCH_STRICTNESS|No|3|Integer from 1 to 5 specifying the strictness for the model limiting responses to your data.|
    |ELASTICSEARCH_CONTENT_COLUMNS|No||List of fields in your search index that contains the text content of your documents to use when formulating a bot response. Represent these as a string joined with "|", e.g. `"product_description|product_manual"`|
    |ELASTICSEARCH_FILENAME_COLUMN|No|| Field from your search index that gives a unique identifier of the source of your data to display in the UI.|
    |ELASTICSEARCH_TITLE_COLUMN|No||Field from your search index that gives a relevant title or header for your data content to display in the UI.|
    |ELASTICSEARCH_URL_COLUMN|No||Field from your search index that contains a URL for the document, e.g. an Azure Blob Storage URI. This value is not currently used.|
    |ELASTICSEARCH_VECTOR_COLUMNS|No||List of fields in your search index that contain vector embeddings of your documents to use when formulating a bot response. Represent these as a string joined with "|", e.g. `"product_description|product_manual"`|

    To use vector search with Elasticsearch, there are two options:

    1. To use Azure OpenAI embeddings, ensure that your index contains Azure OpenAI embeddings, and that the following variables are set:
    - `AZURE_OPENAI_EMBEDDING_NAME`: the name of your Ada (text-embedding-ada-002) model deployment on your Azure OpenAI resource, which was also used to create the embeddings in your index.
    - `ELASTICSEARCH_VECTOR_COLUMNS`: the vector columns in your index to use when searching. Join them with `|` like `contentVector|titleVector`.

    2. Use Elasticsearch embeddings, ensure that your index contains embeddings produced from a trained model on your Elasticsearch cluster, and that the following variables are set:
    - `ELASTICSEARCH_EMBEDDING_MODEL_ID`: the ID of the trained model used to produce embeddings on your index.
    - `ELASTICSEARCH_VECTOR_COLUMNS`: the vector columns in your index to use when searching. Join them with `|` like `contentVector|titleVector`.

#### Chat with your data using Pinecone (Private Preview)

1. Update the `AZURE_OPENAI_*` environment variables as described in the [basic chat experience](#basic-chat-experience) above. 

2. To connect to your data, you need to specify an Pinecone vector database configuration. Learn more about [Pinecone](https://www.pinecone.io/).

3. Configure data source settings as described in the table below.

    | App Setting | Required? | Default Value | Note |
    | --- | --- | --- | ------------- |
    |DATASOURCE_TYPE|Yes||Must be set to `Pinecone`|
    |PINECONE_ENVIRONMENT|Yes||The name of your Pinecone environment|
    |PINECONE_INDEX_NAME|Yes||The name of your Pinecone index|
    |PINECONE_API_KEY|Yes||The API key used to connect to your Pinecone instance|
    |PINECONE_TOP_K|No|5|The number of documents to retrieve when querying your search index.|
    |PINECONE_ENABLE_IN_DOMAIN|No|True|Limits responses to only queries relating to your data.|
    |PINECONE_STRICTNESS|No|3|Integer from 1 to 5 specifying the strictness for the model limiting responses to your data.|
    |PINECONE_CONTENT_COLUMNS|No||List of fields in your search index that contains the text content of your documents to use when formulating a bot response. Represent these as a string joined with "|", e.g. `"product_description|product_manual"`|
    |PINECONE_FILENAME_COLUMN|No|| Field from your search index that gives a unique identifier of the source of your data to display in the UI.|
    |PINECONE_TITLE_COLUMN|No||Field from your search index that gives a relevant title or header for your data content to display in the UI.|
    |PINECONE_URL_COLUMN|No||Field from your search index that contains a URL for the document, e.g. an Azure Blob Storage URI. This value is not currently used.|
    |PINECONE_VECTOR_COLUMNS|No||List of fields in your search index that contain vector embeddings of your documents to use when formulating a bot response. Represent these as a string joined with "|", e.g. `"product_description|product_manual"`|

    Pinecone uses vector search by default, so ensure these settings are configured on your app:
    - `AZURE_OPENAI_EMBEDDING_NAME`: the name of your Ada (text-embedding-ada-002) model deployment on your Azure OpenAI resource.
    - `PINECONE_VECTOR_COLUMNS`: the vector columns in your index to use when searching. Join them with `|` like `contentVector|titleVector`.

#### Chat with your data using Mongo DB (Private Preview)

1. Update the `AZURE_OPENAI_*` environment variables as described in the [basic chat experience](#basic-chat-experience) above. 

2. To connect to your data, you need to specify an Mongo DB database configuration.  Learn more about [MongoDB](https://www.mongodb.com/).

3. Configure data source settings as described in the table below.

    | App Setting | Required? | Default Value | Note |
    | --- | --- | --- | ------------- |
    |DATASOURCE_TYPE|Yes||Must be set to `MongoDB`|
    |MONGODB_CONNECTION_STRING|Yes||The connection string used to connect to your Mongo DB instance|
    |MONGODB_VECTOR_INDEX|Yes||The name of your Mongo DB vector index|
    |MONGODB_DATABASE_NAME|Yes||The name of your Mongo DB database|
    |MONGODB_CONTAINER_NAME|Yes||The name of your Mongo DB container|
    |MONGODB_TOP_K|No|5|The number of documents to retrieve when querying your search index.|
    |MONGODB_ENABLE_IN_DOMAIN|No|True|Limits responses to only queries relating to your data.|
    |MONGODB_STRICTNESS|No|3|Integer from 1 to 5 specifying the strictness for the model limiting responses to your data.|
    |MONGODB_CONTENT_COLUMNS|No||List of fields in your search index that contains the text content of your documents to use when formulating a bot response. Represent these as a string joined with "|", e.g. `"product_description|product_manual"`|
    |MONGODB_FILENAME_COLUMN|No|| Field from your search index that gives a unique identifier of the source of your data to display in the UI.|
    |MONGODB_TITLE_COLUMN|No||Field from your search index that gives a relevant title or header for your data content to display in the UI.|
    |MONGODB_URL_COLUMN|No||Field from your search index that contains a URL for the document, e.g. an Azure Blob Storage URI. This value is not currently used.|
    |MONGODB_VECTOR_COLUMNS|No||List of fields in your search index that contain vector embeddings of your documents to use when formulating a bot response. Represent these as a string joined with "|", e.g. `"product_description|product_manual"`|

    MongoDB uses vector search by default, so ensure these settings are configured on your app:
    - `AZURE_OPENAI_EMBEDDING_NAME`: the name of your Ada (text-embedding-ada-002) model deployment on your Azure OpenAI resource.
    - `MONGODB_VECTOR_COLUMNS`: the vector columns in your index to use when searching. Join them with `|` like `contentVector|titleVector`.
    
#### Chat with your data using Azure SQL Server (Private Preview)

1. Update the `AZURE_OPENAI_*` environment variables as described in the [basic chat experience](#basic-chat-experience) above. 

2. To enable Azure SQL Server, you will need to set up Azure SQL Server resources.  Refer to this [instruction guide](https://learn.microsoft.com/en-us/azure/azure-sql/database/single-database-create-quickstart) to create an Azure SQL database. 

3. Configure data source settings as described in the table below.

    | App Setting | Required? | Default Value | Note |
    | --- | --- | --- | ------------- |
    |DATASOURCE_TYPE|Yes||Must be set to `AzureSqlServer`|
    |AZURE_SQL_SERVER_CONNECTION_STRING|Yes||The connection string to use to connect to your Azure SQL Server instance|
    |AZURE_SQL_SERVER_TABLE_SCHEMA|Yes||The table schema for your Azure SQL Server table.  Must be surrounded by double quotes (`"`).|
    |AZURE_SQL_SERVER_PORT||Not publicly available at this time.|The port to use to connect to your Azure SQL Server instance.|
    |AZURE_SQL_SERVER_DATABASE_NAME||Not publicly available at this time.|
    |AZURE_SQL_SERVER_DATABASE_SERVER||Not publicly available at this time.|

#### Chat with your data using Promptflow

Configure your settings using the table below.

| App Setting | Required? | Default Value | Note |
| --- | --- | --- | ------------- |
|USE_PROMPTFLOW|No|False|Use existing Promptflow deployed endpoint. If set to `True` then both `PROMPTFLOW_ENDPOINT` and `PROMPTFLOW_API_KEY` also need to be set.|
|PROMPTFLOW_ENDPOINT|Only if `USE_PROMPTFLOW` is True||URL of the deployed Promptflow endpoint e.g. https://pf-deployment-name.region.inference.ml.azure.com/score|
|PROMPTFLOW_API_KEY|Only if `USE_PROMPTFLOW` is True||Auth key for deployed Promptflow endpoint. Note: only Key-based authentication is supported.|
|PROMPTFLOW_RESPONSE_TIMEOUT|No|120|Timeout value in seconds for the Promptflow endpoint to respond.|
|PROMPTFLOW_REQUEST_FIELD_NAME|No|query|Default field name to construct Promptflow request. Note: chat_history is auto constucted based on the interaction, if your API expects other mandatory field you will need to change the request parameters under `promptflow_request` function.|
|PROMPTFLOW_RESPONSE_FIELD_NAME|No|reply|Default field name to process the response from Promptflow request.|
|PROMPTFLOW_CITATIONS_FIELD_NAME|No|documents|Default field name to process the citations output from Promptflow request.|

#### Enable Chat History

1. Update the `AZURE_OPENAI_*` environment variables as described in the [basic chat experience](#basic-chat-experience) above.

2. Add any additional configuration (described in previous sections) needed for chatting with data, if required.

3. To enable chat history, you will need to set up CosmosDB resources. The ARM template in the `infrastructure` folder can be used to deploy an app service and a CosmosDB with the database and container configured.

4. Configure data source settings as described in the table below.

    | App Setting | Required? | Default Value | Note |
    | --- | --- | --- | ------------- |
    |AZURE_COSMOSDB_ACCOUNT|Only if using chat history||The name of the Azure Cosmos DB account used for storing chat history|
    |AZURE_COSMOSDB_DATABASE|Only if using chat history||The name of the Azure Cosmos DB database used for storing chat history|
    |AZURE_COSMOSDB_CONVERSATIONS_CONTAINER|Only if using chat history||The name of the Azure Cosmos DB container used for storing chat history|
    |AZURE_COSMOSDB_ACCOUNT_KEY|Only if using chat history||The account key for the Azure Cosmos DB account used for storing chat history|
    |AZURE_COSMOSDB_ENABLE_FEEDBACK|No|False|Whether or not to enable message feedback on chat history messages|


#### Enable Azure OpenAI function calling via Azure Functions

Refer to this article to learn more about [function calling with Azure OpenAI Service](https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/function-calling).

1. Update the `AZURE_OPENAI_*` environment variables as described in the [basic chat experience](#basic-chat-experience) above.

2. Add any additional configuration (described in previous sections) needed for chatting with data, if required.

3. To enable function calling via remote Azure Functions, you will need to set up an Azure Function resource. Refer to this [instruction guide](https://learn.microsoft.com/azure/azure-functions/functions-create-function-app-portal?pivots=programming-language-python) to create an Azure Function resource.

4. You will need to create the following Azure Functions to implement function calling logic:

    * Create one function with routing, e.g. /tools, that will return a JSON array with the function definitions.
    * Create a second function with routing, e.g. /tool, that will execute the functions with the given arguments.
    The request body will be a JSON structure with the function name and arguments of the function to be executed.   
    Use this sample as function request body to test your function call:

        ```
        {
            "tool_name" : "get_current_weather",
            "tool_arguments" : {"location":"Lamego"}
        }
        ```

    * Create functions without routing to implement all the functions defined in the JSON definition.
    
    Sample code for the Azure Functions:

    ```
    import azure.functions as func
    import logging
    import json
    import random

    app = func.FunctionApp(http_auth_level=func.AuthLevel.FUNCTION)

    azure_openai_tools_json = """[{
        "type": "function",
        "function": {
            "name": "get_current_weather",
            "description": "Get the current weather in a given location",
            "parameters": {
                "type": "object",
                "properties": {
                    "location": {
                        "type": "string",
                        "description": "The city name, e.g. San Francisco"
                    }
                },
                "required": ["location"]
            }
        }
    }]"""

    azure_openai_available_tools = ["get_current_weather"]

    @app.route(route="tools")
    def tools(req: func.HttpRequest) -> func.HttpResponse:
        logging.info('tools function processed a request.')

        return func.HttpResponse(
            azure_openai_tools_json,
            status_code=200
        )

    @app.route(route="tool")
    def tool(req: func.HttpRequest) -> func.HttpResponse:
        logging.info('tool function processed a request.')

        tool_name = req.params.get('tool_name')
        if not tool_name:
            try:
                req_body = req.get_json()
            except ValueError:
                pass
            else:
                tool_name = req_body.get('tool_name')

        tool_arguments = req.params.get('tool_arguments')
        if not tool_arguments:
            try:
                req_body = req.get_json()
            except ValueError:
                pass
            else:
                tool_arguments = req_body.get('tool_arguments')

        if tool_name and tool_arguments:
            if tool_name in azure_openai_available_tools:
                logging.info('tool function: tool_name and tool_arguments are valid.')
                result = globals()[tool_name](**tool_arguments)
                return func.HttpResponse(
                    result,
                    status_code = 200
                )

        logging.info('tool function: tool_name or tool_arguments are invalid.')
        return func.HttpResponse(
                "The tool function we executed successfully but the tool name or arguments were invalid. ",
                status_code=400
        )

    def get_current_weather(location: str) -> str:
        logging.info('get_current_weather function processed a request.')
        temperature = random.randint(10, 30)
        weather = random.choice(["sunny", "cloudy", "rainy", "windy"])
        return f"The current weather in {location} is {temperature}C and {weather}."
    ```

4. Configure data source settings as described in the table below:

    | App Setting | Required? | Default Value | Note |
    | ----------- | --------- | ------------- | ---- |
    | AZURE_OPENAI_FUNCTION_CALL_AZURE_FUNCTIONS_ENABLED | No |  |  |
    | AZURE_OPENAI_FUNCTION_CALL_AZURE_FUNCTIONS_TOOL_BASE_URL | Only if using function calling |  | The base URL of your Azure Function "tool", e.g. [https://<azure-function-name>.azurewebsites.net/api/tool]() |
    | AZURE_OPENAI_FUNCTION_CALL_AZURE_FUNCTIONS_TOOL_KEY | Only if using function calling |  | The function key used to access the Azure Function "tool" |
    | AZURE_OPENAI_FUNCTION_CALL_AZURE_FUNCTIONS_TOOLS_BASE_URL | Only if using function calling |  | The base URL of your Azure Function "tools", e.g. [https://<azure-function-name>.azurewebsites.net/api/tools]() |
    | AZURE_OPENAI_FUNCTION_CALL_AZURE_FUNCTIONS_TOOLS_KEY | Only if using function calling |  | The function key used to access the Azure Function "tools" |


#### Common Customization Scenarios (e.g. updating the default chat logo and headers)

The interface allows for easy adaptation of the UI by modifying certain elements, such as the title and logo, through the use of the following environment variables.

| App Setting | Required? | Default Value | Note |
|---|---|---|---|
|UI_TITLE|No|Contoso| Chat title (left-top) and page title (HTML)
|UI_LOGO|No|| Logo (left-top). Defaults to Contoso logo. Configure the URL to your logo image to modify.
|UI_CHAT_LOGO|No|| Logo (chat window). Defaults to Contoso logo. Configure the URL to your logo image to modify.
|UI_CHAT_TITLE|No|Start chatting| Title (chat window)
|UI_CHAT_DESCRIPTION|No|This chatbot is configured to answer your questions| Description (chat window)
|UI_FAVICON|No|| Defaults to Contoso favicon. Configure the URL to your favicon to modify.
|UI_SHOW_SHARE_BUTTON|No|True|Share button (right-top)
|UI_SHOW_CHAT_HISTORY_BUTTON|No|True|Show chat history button (right-top)
|SANITIZE_ANSWER|No|False|Whether to sanitize the answer from Azure OpenAI. Set to True to remove any HTML tags from the response.|

Any custom images assigned to variables `UI_LOGO`, `UI_CHAT_LOGO` or `UI_FAVICON` should be added to the [public](https://github.com/microsoft/sample-app-aoai-chatGPT/tree/main/frontend/public) folder before building the project. The Vite build process will automatically copy theses files to the [static](https://github.com/microsoft/sample-app-aoai-chatGPT/tree/main/static) folder on each build of the frontend. The corresponding environment variables should then be set using a relative path such as `static/<my image filename>` to ensure that the frontend code can find them.

Feel free to fork this repository and make your own modifications to the UX or backend logic. You can modify the source (`frontend/src`). For example, you may want to change aspects of the chat display, or expose some of the settings in `app.py` in the UI for users to try out different behaviors. After your code changes, you will need to rebuild the front-end via `start.sh` or `start.cmd`.

### Scalability
You can configure the number of threads and workers in `gunicorn.conf.py`. After making a change, redeploy your app using the commands listed above.

See the [Oryx documentation](https://github.com/microsoft/Oryx/blob/main/doc/configuration.md) for more details on these settings.

### Debugging your deployed app
First, add an environment variable on the app service resource called "DEBUG". Set this to "true".

Next, enable logging on the app service. Go to "App Service logs" under Monitoring, and change Application logging to File System. Save the change.

Now, you should be able to see logs from your app by viewing "Log stream" under Monitoring.

### Changing Citation Display
The Citation panel is defined at the end of `frontend/src/pages/chat/Chat.tsx`. The citations returned from Azure OpenAI On Your Data will include `content`, `title`, `filepath`, and in some cases `url`. You can customize the Citation section to use and display these as you like. For example, the title element is a clickable hyperlink if `url` is not a blob URL.

```
    <h5 
        className={styles.citationPanelTitle} 
        tabIndex={0} 
        title={activeCitation.url && !activeCitation.url.includes("blob.core") ? activeCitation.url : activeCitation.title ?? ""} 
        onClick={() => onViewSource(activeCitation)}
    >{activeCitation.title}</h5>

    const onViewSource = (citation: Citation) => {
        if (citation.url && !citation.url.includes("blob.core")) {
            window.open(citation.url, "_blank");
        }
    };

```

## Best Practices
We recommend keeping these best practices in mind:

- Reset the chat session (clear chat) if the user changes any settings. Notify the user that their chat history will be lost.
- Clearly communicate to the user what impact each setting will have on their experience.
- When you rotate API keys for your AOAI or ACS resource, be sure to update the app settings for each of your deployed apps to use the new key.
- Pull in changes from `main` frequently to ensure you have the latest bug fixes and improvements, especially when using Azure OpenAI on your data.

**A note on Azure OpenAI API versions**: The application code in this repo will implement the request and response contracts for the most recent preview API version supported for Azure OpenAI.  To keep your application up-to-date as the Azure OpenAI API evolves with time, be sure to merge the latest API version update into your own application code and redeploy using the methods described in this document.

## Contributing

This project welcomes contributions and suggestions.  Most contributions require you to agree to a
Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us
the rights to use your contribution. For details, visit https://cla.opensource.microsoft.com.

When you submit a pull request, a CLA bot will automatically determine whether you need to provide
a CLA and decorate the PR appropriately (e.g., status check, comment). Simply follow the instructions
provided by the bot. You will only need to do this once across all repos using our CLA.

This project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).
For more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or
contact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.

When contributing to this repository, please help keep the codebase clean and maintainable by running 
the formatter and linter with `npm run format` this will run `npx eslint --fix` and `npx prettier --write` 
on the frontebnd codebase. 

If you are using VSCode, you can add the following settings to your `settings.json` to format and lint on save:

```json
{
    "editor.codeActionsOnSave": {
        "source.fixAll.eslint": "explicit"
    },
    "editor.formatOnSave": true,
    "prettier.requireConfig": true,
}
```

## Trademarks

This project may contain trademarks or logos for projects, products, or services. Authorized use of Microsoft 
trademarks or logos is subject to and must follow 
[Microsoft's Trademark & Brand Guidelines](https://www.microsoft.com/en-us/legal/intellectualproperty/trademarks/usage/general).
Use of Microsoft trademarks or logos in modified versions of this project must not cause confusion or imply Microsoft sponsorship.
Any use of third-party trademarks or logos are subject to those third-party's policies.
</file>

<file path="frontend/src/pages/chat/Chat.tsx">
import { useRef, useState, useEffect, useContext, useLayoutEffect } from 'react'
import { CommandBarButton, IconButton, Dialog, DialogType, Stack } from '@fluentui/react'
import { SquareRegular, ShieldLockRegular, ErrorCircleRegular } from '@fluentui/react-icons'

import ReactMarkdown from 'react-markdown'
import remarkGfm from 'remark-gfm'
import rehypeRaw from 'rehype-raw'
import uuid from 'react-uuid'
import { isEmpty } from 'lodash'
import DOMPurify from 'dompurify'
import { Prism as SyntaxHighlighter } from 'react-syntax-highlighter'
import { nord } from 'react-syntax-highlighter/dist/esm/styles/prism'

import styles from './Chat.module.css'
import CSUDHLogo from '../../assets/csudh_brand_kit.svg';
import { XSSAllowTags } from '../../constants/sanatizeAllowables'

import {
  ChatMessage,
  ConversationRequest,
  conversationApi,
  Citation,
  ToolMessageContent,
  AzureSqlServerExecResults,
  ChatResponse,
  getUserInfo,
  Conversation,
  historyGenerate,
  historyUpdate,
  historyClear,
  ChatHistoryLoadingState,
  CosmosDBStatus,
  ErrorMessage,
  ExecResults,
} from "../../api";
import { Answer } from "../../components/Answer";
import { QuestionInput } from "../../components/QuestionInput";
import { ChatHistoryPanel } from "../../components/ChatHistory/ChatHistoryPanel";
import { AppStateContext } from "../../state/AppProvider";
import { useBoolean } from "@fluentui/react-hooks";
import AuthButtonsBar from '../../components/AuthButtonsBar';
import { HistoryButton } from "../../components/common/Button";

const enum messageStatus {
  NotRunning = 'Not Running',
  Processing = 'Processing',
  Done = 'Done'
}

const Chat = () => {
  const appStateContext = useContext(AppStateContext)
  const devLog = appStateContext?.devLog
  const ui = appStateContext?.state.frontendSettings?.ui
  const AUTH_ENABLED = appStateContext?.state.frontendSettings?.auth_enabled
  const chatMessageStreamEnd = useRef<HTMLDivElement | null>(null)
  const initialPresetAdded = useRef<boolean>(false)
  const [isLoading, setIsLoading] = useState<boolean>(false)
  const [showLoadingMessage, setShowLoadingMessage] = useState<boolean>(false)
  const [activeCitation, setActiveCitation] = useState<Citation>()
  const [isCitationPanelOpen, setIsCitationPanelOpen] = useState<boolean>(false)
  const [isIntentsPanelOpen, setIsIntentsPanelOpen] = useState<boolean>(false)
  const abortFuncs = useRef([] as AbortController[])
  const [showAuthMessage, setShowAuthMessage] = useState<boolean | undefined>()
  const [messages, setMessages] = useState<ChatMessage[]>([])
  const [execResults, setExecResults] = useState<ExecResults[]>([])
  const [processMessages, setProcessMessages] = useState<messageStatus>(messageStatus.NotRunning)
  const [clearingChat, setClearingChat] = useState<boolean>(false)
  const [hideErrorDialog, { toggle: toggleErrorDialog }] = useBoolean(true)
  const [errorMsg, setErrorMsg] = useState<ErrorMessage | null>()
  const [logo, setLogo] = useState('')
  const [answerId, setAnswerId] = useState<string>('')

  const errorDialogContentProps = {
    type: DialogType.close,
    title: errorMsg?.title,
    closeButtonAriaLabel: 'Close',
    subText: errorMsg?.subtitle
  }

  const modalProps = {
    titleAriaId: 'labelId',
    subtitleAriaId: 'subTextId',
    isBlocking: true,
    styles: { main: { maxWidth: 450 } }
  }

  const [ASSISTANT, TOOL, ERROR] = ['assistant', 'tool', 'error']
  const NO_CONTENT_ERROR = 'No content in messages object.'

  useEffect(() => {
    if (
      appStateContext?.state.isCosmosDBAvailable?.status !== CosmosDBStatus.Working &&
      appStateContext?.state.isCosmosDBAvailable?.status !== CosmosDBStatus.NotConfigured &&
      appStateContext?.state.chatHistoryLoadingState === ChatHistoryLoadingState.Fail &&
      hideErrorDialog
    ) {
      let subtitle = `${appStateContext.state.isCosmosDBAvailable.status}. Please contact the site administrator.`
      setErrorMsg({
        title: 'Chat history is not enabled',
        subtitle: subtitle
      })
      toggleErrorDialog()
    }
  }, [appStateContext?.state.isCosmosDBAvailable])

  const handleErrorDialogClose = () => {
    toggleErrorDialog()
    setTimeout(() => {
      setErrorMsg(null)
    }, 500)
  }

  useEffect(() => {
    if (!appStateContext?.state.isLoading) {
      setLogo(ui?.chat_logo || ui?.logo || CSUDHLogo)
    }
  }, [appStateContext?.state.isLoading])

  useEffect(() => {
    setIsLoading(appStateContext?.state.chatHistoryLoadingState === ChatHistoryLoadingState.Loading)
  }, [appStateContext?.state.chatHistoryLoadingState])

  const getUserInfoList = async () => {
    if (!AUTH_ENABLED) {
      setShowAuthMessage(false)
      return
    }
    const userInfoList = await getUserInfo()
    if (userInfoList.length === 0 && window.location.hostname !== '127.0.0.1') {
      setShowAuthMessage(true)
    } else {
      setShowAuthMessage(false)
    }
  }

  let assistantMessage = {} as ChatMessage
  let toolMessage = {} as ChatMessage
  let assistantContent = ''

  useEffect(() => parseExecResults(execResults), [execResults])

  const parseExecResults = (exec_results_: any): void => {
    if (exec_results_ == undefined) return
    const exec_results = exec_results_.length === 2 ? exec_results_ : exec_results_.splice(2)
    appStateContext?.dispatch({ type: 'SET_ANSWER_EXEC_RESULT', payload: { answerId: answerId, exec_result: exec_results } })
  }

  const processResultMessage = (resultMessage: ChatMessage, userMessage: ChatMessage | null, conversationId?: string) => {
    if (typeof resultMessage.content === "string" && resultMessage.content.includes('all_exec_results')) {
      const parsedExecResults = JSON.parse(resultMessage.content) as AzureSqlServerExecResults
      setExecResults(parsedExecResults.all_exec_results)
      assistantMessage.context = JSON.stringify({
        all_exec_results: parsedExecResults.all_exec_results
      })
    }

    if (resultMessage.role === ASSISTANT) {
      setAnswerId(resultMessage.id)
      assistantContent += resultMessage.content
      assistantMessage = { ...assistantMessage, ...resultMessage }
      assistantMessage.content = assistantContent

      if (resultMessage.context) {
        toolMessage = {
          id: uuid(),
          role: TOOL,
          content: resultMessage.context,
          date: new Date().toISOString()
        }
      }
    }

    if (resultMessage.role === TOOL) toolMessage = resultMessage


    if (userMessage && !conversationId) {
      isEmpty(toolMessage)
        ? setMessages([...messages, userMessage, assistantMessage])
        : setMessages([...messages, userMessage, toolMessage, assistantMessage])
    } else {
      isEmpty(toolMessage)
        ? setMessages([...messages, assistantMessage])
        : setMessages([...messages, toolMessage, assistantMessage])
    }
  }

  const makeApiRequestWithoutCosmosDB = async (question: ChatMessage["content"], conversationId?: string) => {
    //devLog?.("No api cosmo db")
    //console.log("No api cosmo db||")
    setIsLoading(true)
    setShowLoadingMessage(true)
    const abortController = new AbortController()
    abortFuncs.current.unshift(abortController)

    const questionContent = typeof question === 'string' ? question : [{ type: "text", text: question[0].text }, { type: "image_url", image_url: { url: question[1].image_url.url } }]
    question = typeof question !== 'string' && question[0]?.text?.length > 0 ? question[0].text : question

    const userMessage: ChatMessage = {
      id: uuid(),
      role: 'user',
      content: questionContent as string,
      date: new Date().toISOString()
    }


    let conversation: Conversation | null | undefined
    if (!conversationId) {
      conversation = {
        id: conversationId ?? uuid(),
        title: question as string,
        messages: [userMessage],
        date: new Date().toISOString()
      }
    } else {
      conversation = appStateContext?.state?.currentChat
      if (!conversation) {
        console.error('Conversation not found.')
        setIsLoading(false)
        setShowLoadingMessage(false)
        abortFuncs.current = abortFuncs.current.filter(a => a !== abortController)
        return
      } else {
        conversation.messages.push(userMessage)
      }
    }

    appStateContext?.dispatch({ type: 'UPDATE_CURRENT_CHAT', payload: conversation })
    setMessages(conversation.messages)

    const request: ConversationRequest = {
      messages: [...conversation.messages.filter(answer => answer.role !== ERROR)]
    }

    let result = {} as ChatResponse
    try {
      const response = await conversationApi(request, abortController.signal)
      if (response?.body) {
        const reader = response.body.getReader()

        let runningText = ''
        while (true) {
          setProcessMessages(messageStatus.Processing)
          const { done, value } = await reader.read()
          if (done) break

          var text = new TextDecoder('utf-8').decode(value)
          const objects = text.split('\n')
          objects.forEach(obj => {
            try {
              if (obj !== '' && obj !== '{}') {
                runningText += obj
                result = JSON.parse(runningText)
                if (result.choices?.length > 0) {
                  result.choices[0].messages.forEach(msg => {
                    msg.id = result.id
                    msg.date = new Date().toISOString()
                  })
                  if (result.choices[0].messages?.some(m => m.role === ASSISTANT)) {
                    setShowLoadingMessage(false)
                  }
                  result.choices[0].messages.forEach(resultObj => {
                    processResultMessage(resultObj, userMessage, conversationId)
                  })
                } else if (result.error) {
                  throw Error(result.error)
                }
                runningText = ''
              }
            } catch (e) {
              if (!(e instanceof SyntaxError)) {
                console.error(e)
                throw e
              } else {
                console.log('Incomplete message. Continuing...')
              }
            }
          })
        }
        conversation.messages.push(toolMessage, assistantMessage)
        appStateContext?.dispatch({ type: 'UPDATE_CURRENT_CHAT', payload: conversation })
        setMessages([...messages, toolMessage, assistantMessage])
      }
    } catch (e) {
      if (!abortController.signal.aborted) {
        let errorMessage =
          'An error occurred. Please try again. If the problem persists, please contact the site administrator.'
        if (result.error?.message) {
          errorMessage = result.error.message
        } else if (typeof result.error === 'string') {
          errorMessage = result.error
        }

        errorMessage = parseErrorMessage(errorMessage)

        let errorChatMsg: ChatMessage = {
          id: uuid(),
          role: ERROR,
          content: errorMessage,
          date: new Date().toISOString()
        }
        conversation.messages.push(errorChatMsg)
        appStateContext?.dispatch({ type: 'UPDATE_CURRENT_CHAT', payload: conversation })
        setMessages([...messages, errorChatMsg])
      } else {
        setMessages([...messages, userMessage])
      }
    } finally {
      setIsLoading(false)
      setShowLoadingMessage(false)
      abortFuncs.current = abortFuncs.current.filter(a => a !== abortController)
      setProcessMessages(messageStatus.Done)
    }

    return abortController.abort()
  }

  const makeApiRequestWithCosmosDB = async (question: ChatMessage["content"], conversationId?: string) => {
    //devLog?.("cosmo api exists!")
    //console.log("cosmo api exists!")
    setIsLoading(true)
    setShowLoadingMessage(true)
    const abortController = new AbortController()
    abortFuncs.current.unshift(abortController)
    const questionContent = typeof question === 'string' ? question : [{ type: "text", text: question[0].text }, { type: "image_url", image_url: { url: question[1].image_url.url } }]
    question = typeof question !== 'string' && question[0]?.text?.length > 0 ? question[0].text : question

    const userMessage: ChatMessage = {
      id: uuid(),
      role: 'user',
      content: questionContent as string,
      date: new Date().toISOString()
    }

    let request: ConversationRequest
    let conversation
    if (conversationId) {
      conversation = appStateContext?.state?.chatHistory?.find(conv => conv.id === conversationId)
      if (!conversation) {
        console.error('Conversation not found.')
        setIsLoading(false)
        setShowLoadingMessage(false)
        abortFuncs.current = abortFuncs.current.filter(a => a !== abortController)
        return
      } else {
        conversation.messages.push(userMessage)
        request = {
          messages: [...conversation.messages.filter(answer => answer.role !== ERROR)]
        }
      }
    } else {
      request = {
        messages: [userMessage].filter(message => message.role !== ERROR)
      }
      setMessages(request.messages)
    }
    let result = {} as ChatResponse
    var errorResponseMessage = 'Please try again. If the problem persists, please contact the site administrator.'
    try {
      const response = conversationId
        ? await historyGenerate(request, abortController.signal, conversationId)
        : await historyGenerate(request, abortController.signal)
      if (!response?.ok) {
        const responseJson = await response.json()
        errorResponseMessage =
          responseJson.error === undefined ? errorResponseMessage : parseErrorMessage(responseJson.error)
        let errorChatMsg: ChatMessage = {
          id: uuid(),
          role: ERROR,
          content: `There was an error generating a response. Chat history can't be saved at this time. ${errorResponseMessage}`,
          date: new Date().toISOString()
        }
        let resultConversation
        if (conversationId) {
          resultConversation = appStateContext?.state?.chatHistory?.find(conv => conv.id === conversationId)
          if (!resultConversation) {
            console.error('Conversation not found.')
            setIsLoading(false)
            setShowLoadingMessage(false)
            abortFuncs.current = abortFuncs.current.filter(a => a !== abortController)
            return
          }
          resultConversation.messages.push(errorChatMsg)
        } else {
          setMessages([...messages, userMessage, errorChatMsg])
          setIsLoading(false)
          setShowLoadingMessage(false)
          abortFuncs.current = abortFuncs.current.filter(a => a !== abortController)
          return
        }
        appStateContext?.dispatch({ type: 'UPDATE_CURRENT_CHAT', payload: resultConversation })
        setMessages([...resultConversation.messages])
        return
      }
      if (response?.body) {
        const reader = response.body.getReader()

        let runningText = ''
        while (true) {
          setProcessMessages(messageStatus.Processing)
          const { done, value } = await reader.read()
          if (done) break

          var text = new TextDecoder('utf-8').decode(value)
          const objects = text.split('\n')
          objects.forEach(obj => {
            try {
              if (obj !== '' && obj !== '{}') {
                runningText += obj
                result = JSON.parse(runningText)
                if (!result.choices?.[0]?.messages?.[0].content) {
                  errorResponseMessage = NO_CONTENT_ERROR
                  throw Error()
                }
                if (result.choices?.length > 0) {
                  result.choices[0].messages.forEach(msg => {
                    msg.id = result.id
                    msg.date = new Date().toISOString()
                  })
                  if (result.choices[0].messages?.some(m => m.role === ASSISTANT)) {
                    setShowLoadingMessage(false)
                  }
                  result.choices[0].messages.forEach(resultObj => {
                    processResultMessage(resultObj, userMessage, conversationId)
                  })
                }
                runningText = ''
              } else if (result.error) {
                throw Error(result.error)
              }
            } catch (e) {
              if (!(e instanceof SyntaxError)) {
                console.error(e)
                throw e
              } else {
                console.log('Incomplete message. Continuing...')
              }
            }
          })
        }

        let resultConversation
        if (conversationId) {
          resultConversation = appStateContext?.state?.chatHistory?.find(conv => conv.id === conversationId)
          if (!resultConversation) {
            console.error('Conversation not found.')
            setIsLoading(false)
            setShowLoadingMessage(false)
            abortFuncs.current = abortFuncs.current.filter(a => a !== abortController)
            return
          }
          isEmpty(toolMessage)
            ? resultConversation.messages.push(assistantMessage)
            : resultConversation.messages.push(toolMessage, assistantMessage)
        } else {
          resultConversation = {
            id: result.history_metadata.conversation_id,
            title: result.history_metadata.title,
            messages: [userMessage],
            date: result.history_metadata.date
          }
          isEmpty(toolMessage)
            ? resultConversation.messages.push(assistantMessage)
            : resultConversation.messages.push(toolMessage, assistantMessage)
        }
        if (!resultConversation) {
          setIsLoading(false)
          setShowLoadingMessage(false)
          abortFuncs.current = abortFuncs.current.filter(a => a !== abortController)
          return
        }
        appStateContext?.dispatch({ type: 'UPDATE_CURRENT_CHAT', payload: resultConversation })
        isEmpty(toolMessage)
          ? setMessages([...messages, assistantMessage])
          : setMessages([...messages, toolMessage, assistantMessage])
      }
    } catch (e) {
      if (!abortController.signal.aborted) {
        let errorMessage = `An error occurred. ${errorResponseMessage}`
        if (result.error?.message) {
          errorMessage = result.error.message
        } else if (typeof result.error === 'string') {
          errorMessage = result.error
        }

        errorMessage = parseErrorMessage(errorMessage)

        let errorChatMsg: ChatMessage = {
          id: uuid(),
          role: ERROR,
          content: errorMessage,
          date: new Date().toISOString()
        }
        let resultConversation
        if (conversationId) {
          resultConversation = appStateContext?.state?.chatHistory?.find(conv => conv.id === conversationId)
          if (!resultConversation) {
            console.error('Conversation not found.')
            setIsLoading(false)
            setShowLoadingMessage(false)
            abortFuncs.current = abortFuncs.current.filter(a => a !== abortController)
            return
          }
          resultConversation.messages.push(errorChatMsg)
        } else {
          if (!result.history_metadata) {
            console.error('Error retrieving data.', result)
            let errorChatMsg: ChatMessage = {
              id: uuid(),
              role: ERROR,
              content: errorMessage,
              date: new Date().toISOString()
            }
            setMessages([...messages, userMessage, errorChatMsg])
            setIsLoading(false)
            setShowLoadingMessage(false)
            abortFuncs.current = abortFuncs.current.filter(a => a !== abortController)
            return
          }
          resultConversation = {
            id: result.history_metadata.conversation_id,
            title: result.history_metadata.title,
            messages: [userMessage],
            date: result.history_metadata.date
          }
          resultConversation.messages.push(errorChatMsg)
        }
        if (!resultConversation) {
          setIsLoading(false)
          setShowLoadingMessage(false)
          abortFuncs.current = abortFuncs.current.filter(a => a !== abortController)
          return
        }
        appStateContext?.dispatch({ type: 'UPDATE_CURRENT_CHAT', payload: resultConversation })
        setMessages([...messages, errorChatMsg])
      } else {
        setMessages([...messages, userMessage])
      }
    } finally {
      setIsLoading(false)
      setShowLoadingMessage(false)
      abortFuncs.current = abortFuncs.current.filter(a => a !== abortController)
      setProcessMessages(messageStatus.Done)
    }
    return abortController.abort()
  }

  const clearChat = async () => {
    setClearingChat(true)
    if (appStateContext?.state.currentChat?.id && appStateContext?.state.isCosmosDBAvailable.cosmosDB) {
      let response = await historyClear(appStateContext?.state.currentChat.id)
      if (!response.ok) {
        setErrorMsg({
          title: 'Error clearing current chat',
          subtitle: 'Please try again. If the problem persists, please contact the site administrator.'
        })
        toggleErrorDialog()
      } else {
        appStateContext?.dispatch({
          type: 'DELETE_CURRENT_CHAT_MESSAGES',
          payload: appStateContext?.state.currentChat.id
        })
        appStateContext?.dispatch({ type: 'UPDATE_CHAT_HISTORY', payload: appStateContext?.state.currentChat })
        setActiveCitation(undefined)
        setIsCitationPanelOpen(false)
        setIsIntentsPanelOpen(false)
        setMessages([])
        initialPresetAdded.current = false // Reset so preset message can be shown again
      }
    }
    setClearingChat(false)
  }
  // Handler to toggle chat history panel
  const handleHistoryClick = () => {
    appStateContext?.dispatch({ type: 'TOGGLE_CHAT_HISTORY' })
  }
  // Determine button text based on history visibility
  const historyButtonText = appStateContext?.state.isChatHistoryOpen
    ? 'Hide History'
    : 'Show History'

  const tryGetRaiPrettyError = (errorMessage: string) => {
    try {
      // Using a regex to extract the JSON part that contains "innererror"
      const match = errorMessage.match(/'innererror': ({.*})\}\}/)
      if (match) {
        // Replacing single quotes with double quotes and converting Python-like booleans to JSON booleans
        const fixedJson = match[1]
          .replace(/'/g, '"')
          .replace(/\bTrue\b/g, 'true')
          .replace(/\bFalse\b/g, 'false')
        const innerErrorJson = JSON.parse(fixedJson)
        let reason = ''
        // Check if jailbreak content filter is the reason of the error
        const jailbreak = innerErrorJson.content_filter_result.jailbreak
        if (jailbreak.filtered === true) {
          reason = 'Jailbreak'
        }

        // Returning the prettified error message
        if (reason !== '') {
          return (
            'The prompt was filtered due to triggering Azure OpenAIs content filtering system.\n' +
            'Reason: This prompt contains content flagged as ' +
            reason +
            '\n\n' +
            'Please modify your prompt and retry. Learn more: https://go.microsoft.com/fwlink/?linkid=2198766'
          )
        }
      }
    } catch (e) {
      console.error('Failed to parse the error:', e)
    }
    return errorMessage
  }

  const parseErrorMessage = (errorMessage: string) => {
    let errorCodeMessage = errorMessage.substring(0, errorMessage.indexOf('-') + 1)
    const innerErrorCue = "{\\'error\\': {\\'message\\': "
    if (errorMessage.includes(innerErrorCue)) {
      try {
        let innerErrorString = errorMessage.substring(errorMessage.indexOf(innerErrorCue))
        if (innerErrorString.endsWith("'}}")) {
          innerErrorString = innerErrorString.substring(0, innerErrorString.length - 3)
        }
        innerErrorString = innerErrorString.replaceAll("\\'", "'")
        let newErrorMessage = errorCodeMessage + ' ' + innerErrorString
        errorMessage = newErrorMessage
      } catch (e) {
        console.error('Error parsing inner error message: ', e)
      }
    }

    return tryGetRaiPrettyError(errorMessage)
  }

  const newChat = () => {
    setProcessMessages(messageStatus.Processing)
    setMessages([])
    setIsCitationPanelOpen(false)
    setIsIntentsPanelOpen(false)
    setActiveCitation(undefined)
    initialPresetAdded.current = false // Reset so preset message can be shown again
    appStateContext?.dispatch({ type: 'UPDATE_CURRENT_CHAT', payload: null })
    setProcessMessages(messageStatus.Done)
  }

  const stopGenerating = () => {
    abortFuncs.current.forEach(a => a.abort())
    setShowLoadingMessage(false)
    setIsLoading(false)
  }

  useEffect(() => {
    if (appStateContext?.state.currentChat) {
      setMessages(appStateContext.state.currentChat.messages)
    } else {
      setMessages([])
    }
  }, [appStateContext?.state.currentChat])

  useLayoutEffect(() => {
    const saveToDB = async (messages: ChatMessage[], id: string) => {
      const response = await historyUpdate(messages, id)
      return response
    }

    if (appStateContext && appStateContext.state.currentChat && processMessages === messageStatus.Done) {
      if (appStateContext.state.isCosmosDBAvailable.cosmosDB) {
        if (!appStateContext?.state.currentChat?.messages) {
          console.error('Failure fetching current chat state.')
          return
        }
        const noContentError = appStateContext.state.currentChat.messages.find(m => m.role === ERROR)

        if (!noContentError) {
          saveToDB(appStateContext.state.currentChat.messages, appStateContext.state.currentChat.id)
            .then(res => {
              if (!res.ok) {
                let errorMessage =
                  "An error occurred. Answers can't be saved at this time. If the problem persists, please contact the site administrator."
                let errorChatMsg: ChatMessage = {
                  id: uuid(),
                  role: ERROR,
                  content: errorMessage,
                  date: new Date().toISOString()
                }
                if (!appStateContext?.state.currentChat?.messages) {
                  let err: Error = {
                    ...new Error(),
                    message: 'Failure fetching current chat state.'
                  }
                  throw err
                }
                setMessages([...appStateContext?.state.currentChat?.messages, errorChatMsg])
              }
              return res as Response
            })
            .catch(err => {
              console.error('Error: ', err)
              let errRes: Response = {
                ...new Response(),
                ok: false,
                status: 500
              }
              return errRes
            })
        }
      } else {
      }
      appStateContext?.dispatch({ type: 'UPDATE_CHAT_HISTORY', payload: appStateContext.state.currentChat })
      setMessages(appStateContext.state.currentChat.messages)
      setProcessMessages(messageStatus.NotRunning)
    }
  }, [processMessages])

  useEffect(() => {
    if (AUTH_ENABLED !== undefined) getUserInfoList()
  }, [AUTH_ENABLED])
 
  // Send a preset assistant message at the start of a new conversation
  useEffect(() => {
    sendPresetMessage()
  }, [
    messages,
    isLoading,
    appStateContext?.state.currentChat?.id,
    appStateContext?.state.chatHistoryLoadingState,
    ui?.preset_starting_message
  ])

  


  useLayoutEffect(() => {
    chatMessageStreamEnd.current?.scrollIntoView({ behavior: 'smooth' })
  }, [showLoadingMessage, processMessages])

  
  const sendPresetMessage = () => {
    if (
      (!messages || messages.length === 0) &&
      !isLoading &&
      !appStateContext?.state.currentChat?.id &&
      appStateContext?.state.chatHistoryLoadingState !== ChatHistoryLoadingState.Loading &&
      !initialPresetAdded.current &&
      ui?.preset_starting_message
    ) {
      initialPresetAdded.current = true
      const presetMessage = ui?.preset_starting_message
      
      //Generate a starting message for the conversation
      const startingMessage: ChatMessage = {
        id: uuid(),
        role: ASSISTANT,
        content: presetMessage as string,
        date: new Date().toISOString()
      }
  
      //Generate a conversation object for the starting message
      let conversation: Conversation | null | undefined
      conversation = {
        id: uuid(),
        title: presetMessage as string,
        messages: [startingMessage],
        date: new Date().toISOString()
      }
      //Update the current chat in the state with the conversation object
      appStateContext?.dispatch({ type: 'UPDATE_CURRENT_CHAT', payload: conversation })
      setMessages(conversation.messages)
      processResultMessage(startingMessage, null, conversation.id)
    }
  }

  const onShowCitation = (citation: Citation) => {
    setActiveCitation(citation)
    setIsCitationPanelOpen(true)
  }

  const onShowExecResult = (answerId: string) => {
    setIsIntentsPanelOpen(true)
  }

  const onViewSource = (citation: Citation) => {
    if (citation.url && !citation.url.includes('blob.core')) {
      window.open(citation.url, '_blank')
    }
  }

  const parseCitationFromMessage = (message: ChatMessage) => {
    if (message?.role && message?.role === 'tool' && typeof message?.content === "string") {
      try {
        const toolMessage = JSON.parse(message.content) as ToolMessageContent
        return toolMessage.citations
      } catch {
        return []
      }
    }
    return []
  }

  const parsePlotFromMessage = (message: ChatMessage) => {
    if (message?.role && message?.role === "tool" && typeof message?.content === "string") {
      try {
        const execResults = JSON.parse(message.content) as AzureSqlServerExecResults;
        const codeExecResult = execResults.all_exec_results.at(-1)?.code_exec_result;

        if (codeExecResult === undefined) {
          return null;
        }
        return codeExecResult.toString();
      }
      catch {
        return null;
      }
      // const execResults = JSON.parse(message.content) as AzureSqlServerExecResults;
      // return execResults.all_exec_results.at(-1)?.code_exec_result;
    }
    return null;
  }

  const disabledButton = () => {
    return (
      isLoading ||
      (messages && messages.length === 0) ||
      clearingChat ||
      appStateContext?.state.chatHistoryLoadingState === ChatHistoryLoadingState.Loading
    )
  }

  return (
    <div className={styles.container} role="main">
      {showAuthMessage ? (
        <Stack className={styles.chatEmptyState}>
          <ShieldLockRegular
            className={styles.chatIcon}
            style={{ color: 'darkorange', height: '200px', width: '200px' }}
          />
          <h1 className={styles.chatEmptyStateTitle}>Authentication Not Configured</h1>
          <h2 className={styles.chatEmptyStateSubtitle}>
            This app does not have authentication configured. Please add an identity provider by finding your app in the{' '}
            <a href="https://portal.azure.com/" target="_blank">
              Azure Portal
            </a>
            and following{' '}
            <a
              href="https://learn.microsoft.com/en-us/azure/app-service/scenario-secure-app-authentication-app-service#3-configure-authentication-and-authorization"
              target="_blank">
              these instructions
            </a>
            .
          </h2>
          <h2 className={styles.chatEmptyStateSubtitle} style={{ fontSize: '20px' }}>
            <strong>Authentication configuration takes a few minutes to apply. </strong>
          </h2>
          <h2 className={styles.chatEmptyStateSubtitle} style={{ fontSize: '20px' }}>
            <strong>If you deployed in the last 10 minutes, please wait and reload the page after 10 minutes.</strong>
          </h2>
        </Stack>
      ) : (
        <Stack horizontal className={styles.chatRoot}>
          <div className={styles.chatContainer}>
            {!messages || messages.length < 1 ? (
              <Stack className={styles.chatEmptyState}>
                <img src={logo} className={styles.chatIcon} aria-hidden="true" />
                <h1 className={styles.chatEmptyStateTitle}>{ui?.chat_title}</h1>
                <h2 className={styles.chatEmptyStateSubtitle}>{ui?.chat_description}</h2>
              </Stack>
            ) : (
              <div className={styles.chatMessageStream} style={{ marginBottom: isLoading ? '40px' : '0px' }} role="log">
                {messages.map((answer, index) => (
                  <>
                    {answer.role === 'user' ? (
                      <div className={styles.chatMessageUser} tabIndex={0}>
                        <div className={styles.chatMessageUserMessage}>
                          {typeof answer.content === "string" && answer.content ? answer.content : Array.isArray(answer.content) ? <>{answer.content[0].text} <img className={styles.uploadedImageChat} src={answer.content[1].image_url.url} alt="Uploaded Preview" /></> : null}
                        </div>
                      </div>
                    ) : answer.role === 'assistant' ? (
                      <div className={styles.chatMessageGpt}>
                        {typeof answer.content === "string" && <Answer
                          answer={{
                            answer: answer.content,
                            citations: parseCitationFromMessage(messages[index - 1]),
                            generated_chart: parsePlotFromMessage(messages[index - 1]),
                            message_id: answer.id,
                            feedback: answer.feedback,
                            exec_results: execResults
                          }}
                          onCitationClicked={c => onShowCitation(c)}
                          onExectResultClicked={() => onShowExecResult(answerId)}
                        />}
                      </div>
                    ) : answer.role === ERROR ? (
                      <div className={styles.chatMessageError}>
                        <Stack horizontal className={styles.chatMessageErrorContent}>
                          <ErrorCircleRegular className={styles.errorIcon} style={{ color: 'rgba(182, 52, 67, 1)' }} />
                          <span>Error</span>
                        </Stack>
                        <span className={styles.chatMessageErrorContent}>{typeof answer.content === "string" && answer.content}</span>
                      </div>
                    ) : null}
                  </>
                ))}
                {showLoadingMessage && (
                  <>
                    <div className={styles.chatMessageGpt}>
                      <Answer
                        answer={{
                          answer: "Generating answer...",
                          citations: [],
                          generated_chart: null
                        }}
                        onCitationClicked={() => null}
                        onExectResultClicked={() => null}
                      />
                    </div>
                  </>
                )}
                <div ref={chatMessageStreamEnd} />
              </div>
            )}

            <Stack horizontal className={styles.chatInput}>
              {isLoading && messages.length > 0 && (
                <Stack
                  horizontal
                  className={styles.stopGeneratingContainer}
                  role="button"
                  aria-label="Stop generating"
                  tabIndex={0}
                  onClick={stopGenerating}
                  onKeyDown={e => (e.key === 'Enter' || e.key === ' ' ? stopGenerating() : null)}>
                  <SquareRegular className={styles.stopGeneratingIcon} aria-hidden="true" />
                  <span className={styles.stopGeneratingText} aria-hidden="true">
                    Stop generating
                  </span>
                </Stack>
              )}
              <Stack>
                {appStateContext?.state.isCosmosDBAvailable?.status !== CosmosDBStatus.NotConfigured && (
                  <CommandBarButton
                    role="button"
                    styles={{
                      icon: {
                        color: '#FFFFFF'
                      },
                      iconDisabled: {
                        color: '#BDBDBD !important'
                      },
                      root: {
                        color: '#FFFFFF',
                        background:
                          'radial-gradient(109.81% 107.82% at 100.1% 90.19%, #0F6CBD 33.63%, #2D87C3 70.31%, #8DDDD8 100%)'
                      },
                      rootDisabled: {
                        background: '#F0F0F0'
                      }
                    }}
                    className={styles.newChatIcon}
                    iconProps={{ iconName: 'Add' }}
                    onClick={newChat}
                    disabled={disabledButton()}
                    aria-label="start a new chat button"
                  />
                )}
                <CommandBarButton
                  role="button"
                  styles={{
                    icon: {
                      color: '#FFFFFF'
                    },
                    iconDisabled: {
                      color: '#BDBDBD !important'
                    },
                    root: {
                      color: '#FFFFFF',
                      background:
                        'radial-gradient(109.81% 107.82% at 100.1% 90.19%, #0F6CBD 33.63%, #2D87C3 70.31%, #8DDDD8 100%)'
                    },
                    rootDisabled: {
                      background: '#F0F0F0'
                    }
                  }}
                  className={
                    appStateContext?.state.isCosmosDBAvailable?.status !== CosmosDBStatus.NotConfigured
                      ? styles.clearChatBroom
                      : styles.clearChatBroomNoCosmos
                  }
                  iconProps={{ iconName: 'Broom' }}
                  onClick={
                    appStateContext?.state.isCosmosDBAvailable?.status !== CosmosDBStatus.NotConfigured
                      ? clearChat
                      : newChat
                  }
                  disabled={disabledButton()}
                  aria-label="clear chat button"
                />
                {/* Button to toggle chat history panel */}
                <HistoryButton
                  onClick={handleHistoryClick}
                  text={historyButtonText}
                />
                <Dialog
                  hidden={hideErrorDialog}
                  onDismiss={handleErrorDialogClose}
                  dialogContentProps={errorDialogContentProps}
                  modalProps={modalProps}></Dialog>
              </Stack>
              <QuestionInput
                clearOnSend
                placeholder= "Type a new question..."
                disabled={isLoading}
                onSend={(question, id) => {
                  appStateContext?.state.isCosmosDBAvailable?.cosmosDB
                    ? makeApiRequestWithCosmosDB(question, id)
                    : makeApiRequestWithoutCosmosDB(question, id)
                }}
                conversationId={
                  appStateContext?.state.currentChat?.id ? appStateContext?.state.currentChat?.id : undefined
                }
              />
            </Stack>
          </div>
          {/* Citation Panel */}
          {messages && messages.length > 0 && isCitationPanelOpen && activeCitation && (
            <Stack.Item className={styles.citationPanel} tabIndex={0} role="tabpanel" aria-label="Citations Panel">
              <Stack
                aria-label="Citations Panel Header Container"
                horizontal
                className={styles.citationPanelHeaderContainer}
                horizontalAlign="space-between"
                verticalAlign="center">
                <span aria-label="Citations" className={styles.citationPanelHeader}>
                  Citations
                </span>
                <IconButton
                  iconProps={{ iconName: 'Cancel' }}
                  aria-label="Close citations panel"
                  onClick={() => setIsCitationPanelOpen(false)}
                />
              </Stack>
              <h5
                className={styles.citationPanelTitle}
                tabIndex={0}
                title={
                  activeCitation.url && !activeCitation.url.includes('blob.core')
                    ? activeCitation.url
                    : activeCitation.title ?? ''
                }
                onClick={() => onViewSource(activeCitation)}>
                {activeCitation.title}
              </h5>
              <div tabIndex={0}>
                <ReactMarkdown
                  linkTarget="_blank"
                  className={styles.citationPanelContent}
                  children={DOMPurify.sanitize(activeCitation.content, { ALLOWED_TAGS: XSSAllowTags })}
                  remarkPlugins={[remarkGfm]}
                  rehypePlugins={[rehypeRaw]}
                />
              </div>
            </Stack.Item>
          )}
          {messages && messages.length > 0 && isIntentsPanelOpen && (
            <Stack.Item className={styles.citationPanel} tabIndex={0} role="tabpanel" aria-label="Intents Panel">
              <Stack
                aria-label="Intents Panel Header Container"
                horizontal
                className={styles.citationPanelHeaderContainer}
                horizontalAlign="space-between"
                verticalAlign="center">
                <span aria-label="Intents" className={styles.citationPanelHeader}>
                  Intents
                </span>
                <IconButton
                  iconProps={{ iconName: 'Cancel' }}
                  aria-label="Close intents panel"
                  onClick={() => setIsIntentsPanelOpen(false)}
                />
              </Stack>
              <Stack horizontalAlign="space-between">
                {appStateContext?.state?.answerExecResult[answerId]?.map((execResult: ExecResults, index) => (
                  <Stack className={styles.exectResultList} verticalAlign="space-between">
                    <><span>Intent:</span> <p>{execResult.intent}</p></>
                    {execResult.search_query && <><span>Search Query:</span>
                      <SyntaxHighlighter
                        style={nord}
                        wrapLines={true}
                        lineProps={{ style: { wordBreak: 'break-all', whiteSpace: 'pre-wrap' } }}
                        language="sql"
                        PreTag="p">
                        {execResult.search_query}
                      </SyntaxHighlighter></>}
                    {execResult.search_result && <><span>Search Result:</span> <p>{execResult.search_result}</p></>}
                    {execResult.code_generated && <><span>Code Generated:</span>
                      <SyntaxHighlighter
                        style={nord}
                        wrapLines={true}
                        lineProps={{ style: { wordBreak: 'break-all', whiteSpace: 'pre-wrap' } }}
                        language="python"
                        PreTag="p">
                        {execResult.code_generated}
                      </SyntaxHighlighter>
                    </>}
                  </Stack>
                ))}
              </Stack>
            </Stack.Item>
          )}
          {appStateContext?.state.isChatHistoryOpen &&
            appStateContext?.state.isCosmosDBAvailable?.status !== CosmosDBStatus.NotConfigured && <ChatHistoryPanel />}
        </Stack>
      )}
      <AuthButtonsBar />
    </div>
  )
}

export default Chat
</file>

<file path="app.py">
import copy
import json
import os
import logging
import uuid
import httpx
import asyncio
from quart import (
    Blueprint,
    Quart,
    jsonify,
    make_response,
    request,
    send_from_directory,
    render_template,
    current_app,
)

from openai import AsyncAzureOpenAI
from azure.identity.aio import (
    DefaultAzureCredential,
    get_bearer_token_provider
)
from backend.auth.auth_utils import get_authenticated_user_details
from backend.security.ms_defender_utils import get_msdefender_user_json
from backend.history.cosmosdbservice import CosmosConversationClient
from backend.settings import (
    app_settings,
    MINIMUM_SUPPORTED_AZURE_OPENAI_PREVIEW_API_VERSION
)
from backend.utils import (
    format_as_ndjson,
    format_stream_response,
    format_non_streaming_response,
    convert_to_pf_format,
    format_pf_non_streaming_response,
)

bp = Blueprint("routes", __name__, static_folder="static", template_folder="static")

cosmos_db_ready = asyncio.Event()


def create_app():
    app = Quart(__name__)
    app.register_blueprint(bp)
    app.config["TEMPLATES_AUTO_RELOAD"] = True
    
    @app.before_serving
    async def init():
        try:
            app.cosmos_conversation_client = await init_cosmosdb_client()
            cosmos_db_ready.set()
        except Exception as e:
            logging.exception("Failed to initialize CosmosDB client")
            app.cosmos_conversation_client = None
            raise e
    
    return app


@bp.route("/")
async def index():
    return await render_template(
        "index.html",
        title=app_settings.ui.title,
        favicon=app_settings.ui.favicon
    )


@bp.route("/favicon.ico")
async def favicon():
    return await bp.send_static_file("favicon.ico")


@bp.route("/assets/<path:path>")
async def assets(path):
    return await send_from_directory("static/assets", path)


# Debug settings
DEBUG = os.environ.get("DEBUG", "false")
if DEBUG.lower() == "true":
    logging.basicConfig(level=logging.DEBUG)

USER_AGENT = "GitHubSampleWebApp/AsyncAzureOpenAI/1.0.0"


# Frontend Settings via Environment Variables
frontend_settings = {
    "auth_enabled": app_settings.base_settings.auth_enabled,
    "feedback_enabled": (
        app_settings.chat_history and
        app_settings.chat_history.enable_feedback
    ),
    "ui": {
        "title": app_settings.ui.title,
        "logo": app_settings.ui.logo,
        "chat_logo": app_settings.ui.chat_logo or app_settings.ui.logo,
        "chat_title": app_settings.ui.chat_title,
        "chat_description": app_settings.ui.chat_description,
        "preset_starting_message": app_settings.ui.preset_starting_message,
        "show_share_button": app_settings.ui.show_share_button,
        "show_chat_history_button": app_settings.ui.show_chat_history_button,
    },
    "sanitize_answer": app_settings.base_settings.sanitize_answer,
    "oyd_enabled": app_settings.base_settings.datasource_type,
}


# Enable Microsoft Defender for Cloud Integration
MS_DEFENDER_ENABLED = os.environ.get("MS_DEFENDER_ENABLED", "true").lower() == "true"


azure_openai_tools = []
azure_openai_available_tools = []

# Initialize Azure OpenAI Client
async def init_openai_client():
    azure_openai_client = None
    
    try:
        # API version check
        if (
            app_settings.azure_openai.preview_api_version
            < MINIMUM_SUPPORTED_AZURE_OPENAI_PREVIEW_API_VERSION
        ):
            raise ValueError(
                f"The minimum supported Azure OpenAI preview API version is '{MINIMUM_SUPPORTED_AZURE_OPENAI_PREVIEW_API_VERSION}'"
            )

        # Endpoint
        if (
            not app_settings.azure_openai.endpoint and
            not app_settings.azure_openai.resource
        ):
            raise ValueError(
                "AZURE_OPENAI_ENDPOINT or AZURE_OPENAI_RESOURCE is required"
            )

        endpoint = (
            app_settings.azure_openai.endpoint
            if app_settings.azure_openai.endpoint
            else f"https://{app_settings.azure_openai.resource}.openai.azure.com/"
        )

        # Authentication
        aoai_api_key = app_settings.azure_openai.key
        ad_token_provider = None
        if not aoai_api_key:
            logging.debug("No AZURE_OPENAI_KEY found, using Azure Entra ID auth")
            async with DefaultAzureCredential() as credential:
                ad_token_provider = get_bearer_token_provider(
                    credential,
                    "https://cognitiveservices.azure.com/.default"
                )

        # Deployment
        deployment = app_settings.azure_openai.model
        if not deployment:
            raise ValueError("AZURE_OPENAI_MODEL is required")

        # Default Headers
        default_headers = {"x-ms-useragent": USER_AGENT}

        # Remote function calls
        if app_settings.azure_openai.function_call_azure_functions_enabled:
            azure_functions_tools_url = f"{app_settings.azure_openai.function_call_azure_functions_tools_base_url}?code={app_settings.azure_openai.function_call_azure_functions_tools_key}"
            async with httpx.AsyncClient() as client:
                response = await client.get(azure_functions_tools_url)
            response_status_code = response.status_code
            if response_status_code == httpx.codes.OK:
                azure_openai_tools.extend(json.loads(response.text))
                for tool in azure_openai_tools:
                    azure_openai_available_tools.append(tool["function"]["name"])
            else:
                logging.error(f"An error occurred while getting OpenAI Function Call tools metadata: {response.status_code}")

        
        azure_openai_client = AsyncAzureOpenAI(
            api_version=app_settings.azure_openai.preview_api_version,
            api_key=aoai_api_key,
            azure_ad_token_provider=ad_token_provider,
            default_headers=default_headers,
            azure_endpoint=endpoint,
        )

        return azure_openai_client
    except Exception as e:
        logging.exception("Exception in Azure OpenAI initialization", e)
        azure_openai_client = None
        raise e

async def openai_remote_azure_function_call(function_name, function_args):
    if app_settings.azure_openai.function_call_azure_functions_enabled is not True:
        return

    azure_functions_tool_url = f"{app_settings.azure_openai.function_call_azure_functions_tool_base_url}?code={app_settings.azure_openai.function_call_azure_functions_tool_key}"
    headers = {'content-type': 'application/json'}
    body = {
        "tool_name": function_name,
        "tool_arguments": json.loads(function_args)
    }
    async with httpx.AsyncClient() as client:
        response = await client.post(azure_functions_tool_url, data=json.dumps(body), headers=headers)
    response.raise_for_status()

    return response.text

async def init_cosmosdb_client():
    cosmos_conversation_client = None
    if app_settings.chat_history:
        try:
            cosmos_endpoint = (
                f"https://{app_settings.chat_history.account}.documents.azure.com:443/"
            )

            if not app_settings.chat_history.account_key:
                async with DefaultAzureCredential() as cred:
                    credential = cred
                    
            else:
                credential = app_settings.chat_history.account_key

            cosmos_conversation_client = CosmosConversationClient(
                cosmosdb_endpoint=cosmos_endpoint,
                credential=credential,
                database_name=app_settings.chat_history.database,
                container_name=app_settings.chat_history.conversations_container,
                enable_message_feedback=app_settings.chat_history.enable_feedback,
            )
        except Exception as e:
            logging.exception("Exception in CosmosDB initialization", e)
            cosmos_conversation_client = None
            raise e
    else:
        logging.debug("CosmosDB not configured")

    return cosmos_conversation_client


def prepare_model_args(request_body, request_headers):
    request_messages = request_body.get("messages", [])
    messages = []
    if not app_settings.datasource:
        messages = [
            {
                "role": "system",
                "content": app_settings.azure_openai.system_message
            }
        ]

    for message in request_messages:
        if message:
            match message["role"]:
                case "user":
                    messages.append(
                        {
                            "role": message["role"],
                            "content": message["content"]
                        }
                    )
                case "assistant" | "function" | "tool":
                    messages_helper = {}
                    messages_helper["role"] = message["role"]
                    if "name" in message:
                        messages_helper["name"] = message["name"]
                    if "function_call" in message:
                        messages_helper["function_call"] = message["function_call"]
                    messages_helper["content"] = message["content"]
                    if "context" in message:
                        context_obj = json.loads(message["context"])
                        messages_helper["context"] = context_obj
                    
                    messages.append(messages_helper)


    user_json = None
    if (MS_DEFENDER_ENABLED):
        authenticated_user_details = get_authenticated_user_details(request_headers)
        conversation_id = request_body.get("conversation_id", None)
        application_name = app_settings.ui.title
        user_json = get_msdefender_user_json(authenticated_user_details, request_headers, conversation_id, application_name)

    model_args = {
        "messages": messages,
        "temperature": app_settings.azure_openai.temperature,
        "max_tokens": app_settings.azure_openai.max_tokens,
        "top_p": app_settings.azure_openai.top_p,
        "stop": app_settings.azure_openai.stop_sequence,
        "stream": app_settings.azure_openai.stream,
        "model": app_settings.azure_openai.model,
        "user": user_json
    }

    if len(messages) > 0:
        if messages[-1]["role"] == "user":
            if app_settings.azure_openai.function_call_azure_functions_enabled and len(azure_openai_tools) > 0:
                model_args["tools"] = azure_openai_tools

            if app_settings.datasource:
                model_args["extra_body"] = {
                    "data_sources": [
                        app_settings.datasource.construct_payload_configuration(
                            request=request
                        )
                    ]
                }

    model_args_clean = copy.deepcopy(model_args)
    if model_args_clean.get("extra_body"):
        secret_params = [
            "key",
            "connection_string",
            "embedding_key",
            "encoded_api_key",
            "api_key",
        ]
        for secret_param in secret_params:
            if model_args_clean["extra_body"]["data_sources"][0]["parameters"].get(
                secret_param
            ):
                model_args_clean["extra_body"]["data_sources"][0]["parameters"][
                    secret_param
                ] = "*****"
        authentication = model_args_clean["extra_body"]["data_sources"][0][
            "parameters"
        ].get("authentication", {})
        for field in authentication:
            if field in secret_params:
                model_args_clean["extra_body"]["data_sources"][0]["parameters"][
                    "authentication"
                ][field] = "*****"
        embeddingDependency = model_args_clean["extra_body"]["data_sources"][0][
            "parameters"
        ].get("embedding_dependency", {})
        if "authentication" in embeddingDependency:
            for field in embeddingDependency["authentication"]:
                if field in secret_params:
                    model_args_clean["extra_body"]["data_sources"][0]["parameters"][
                        "embedding_dependency"
                    ]["authentication"][field] = "*****"

    logging.debug(f"REQUEST BODY: {json.dumps(model_args_clean, indent=4)}")

    return model_args


async def promptflow_request(request):
    try:
        headers = {
            "Content-Type": "application/json",
            "Authorization": f"Bearer {app_settings.promptflow.api_key}",
        }
        # Adding timeout for scenarios where response takes longer to come back
        logging.debug(f"Setting timeout to {app_settings.promptflow.response_timeout}")
        async with httpx.AsyncClient(
            timeout=float(app_settings.promptflow.response_timeout)
        ) as client:
            pf_formatted_obj = convert_to_pf_format(
                request,
                app_settings.promptflow.request_field_name,
                app_settings.promptflow.response_field_name
            )
            # NOTE: This only support question and chat_history parameters
            # If you need to add more parameters, you need to modify the request body
            response = await client.post(
                app_settings.promptflow.endpoint,
                json={
                    app_settings.promptflow.request_field_name: pf_formatted_obj[-1]["inputs"][app_settings.promptflow.request_field_name],
                    "chat_history": pf_formatted_obj[:-1],
                },
                headers=headers,
            )
        resp = response.json()
        resp["id"] = request["messages"][-1]["id"]
        return resp
    except Exception as e:
        logging.error(f"An error occurred while making promptflow_request: {e}")


async def process_function_call(response):
    response_message = response.choices[0].message
    messages = []

    if response_message.tool_calls:
        for tool_call in response_message.tool_calls:
            # Check if function exists
            if tool_call.function.name not in azure_openai_available_tools:
                continue
            
            function_response = await openai_remote_azure_function_call(tool_call.function.name, tool_call.function.arguments)

            # adding assistant response to messages
            messages.append(
                {
                    "role": response_message.role,
                    "function_call": {
                        "name": tool_call.function.name,
                        "arguments": tool_call.function.arguments,
                    },
                    "content": None,
                }
            )
            
            # adding function response to messages
            messages.append(
                {
                    "role": "function",
                    "name": tool_call.function.name,
                    "content": function_response,
                }
            )  # extend conversation with function response
        
        return messages
    
    return None

async def send_chat_request(request_body, request_headers):
    filtered_messages = []
    messages = request_body.get("messages", [])
    for message in messages:
        if message.get("role") != 'tool':
            filtered_messages.append(message)
            
    request_body['messages'] = filtered_messages
    model_args = prepare_model_args(request_body, request_headers)

    try:
        azure_openai_client = await init_openai_client()
        raw_response = await azure_openai_client.chat.completions.with_raw_response.create(**model_args)
        response = raw_response.parse()
        apim_request_id = raw_response.headers.get("apim-request-id") 
    except Exception as e:
        logging.exception("Exception in send_chat_request")
        raise e

    return response, apim_request_id


async def complete_chat_request(request_body, request_headers):
    if app_settings.base_settings.use_promptflow:
        response = await promptflow_request(request_body)
        history_metadata = request_body.get("history_metadata", {})
        return format_pf_non_streaming_response(
            response,
            history_metadata,
            app_settings.promptflow.response_field_name,
            app_settings.promptflow.citations_field_name
        )
    else:
        response, apim_request_id = await send_chat_request(request_body, request_headers)
        history_metadata = request_body.get("history_metadata", {})
        non_streaming_response = format_non_streaming_response(response, history_metadata, apim_request_id)

        if app_settings.azure_openai.function_call_azure_functions_enabled:
            function_response = await process_function_call(response)  # Add await here

            if function_response:
                request_body["messages"].extend(function_response)

                response, apim_request_id = await send_chat_request(request_body, request_headers)
                history_metadata = request_body.get("history_metadata", {})
                non_streaming_response = format_non_streaming_response(response, history_metadata, apim_request_id)

    return non_streaming_response

class AzureOpenaiFunctionCallStreamState():
    def __init__(self):
        self.tool_calls = []                # All tool calls detected in the stream
        self.tool_name = ""                 # Tool name being streamed
        self.tool_arguments_stream = ""     # Tool arguments being streamed
        self.current_tool_call = None       # JSON with the tool name and arguments currently being streamed
        self.function_messages = []         # All function messages to be appended to the chat history
        self.streaming_state = "INITIAL"    # Streaming state (INITIAL, STREAMING, COMPLETED)


async def process_function_call_stream(completionChunk, function_call_stream_state, request_body, request_headers, history_metadata, apim_request_id):
    if hasattr(completionChunk, "choices") and len(completionChunk.choices) > 0:
        response_message = completionChunk.choices[0].delta
        
        # Function calling stream processing
        if response_message.tool_calls and function_call_stream_state.streaming_state in ["INITIAL", "STREAMING"]:
            function_call_stream_state.streaming_state = "STREAMING"
            for tool_call_chunk in response_message.tool_calls:
                # New tool call
                if tool_call_chunk.id:
                    if function_call_stream_state.current_tool_call:
                        function_call_stream_state.tool_arguments_stream += tool_call_chunk.function.arguments if tool_call_chunk.function.arguments else ""
                        function_call_stream_state.current_tool_call["tool_arguments"] = function_call_stream_state.tool_arguments_stream
                        function_call_stream_state.tool_arguments_stream = ""
                        function_call_stream_state.tool_name = ""
                        function_call_stream_state.tool_calls.append(function_call_stream_state.current_tool_call)

                    function_call_stream_state.current_tool_call = {
                        "tool_id": tool_call_chunk.id,
                        "tool_name": tool_call_chunk.function.name if function_call_stream_state.tool_name == "" else function_call_stream_state.tool_name
                    }
                else:
                    function_call_stream_state.tool_arguments_stream += tool_call_chunk.function.arguments if tool_call_chunk.function.arguments else ""
                
        # Function call - Streaming completed
        elif response_message.tool_calls is None and function_call_stream_state.streaming_state == "STREAMING":
            function_call_stream_state.current_tool_call["tool_arguments"] = function_call_stream_state.tool_arguments_stream
            function_call_stream_state.tool_calls.append(function_call_stream_state.current_tool_call)
            
            for tool_call in function_call_stream_state.tool_calls:
                tool_response = await openai_remote_azure_function_call(tool_call["tool_name"], tool_call["tool_arguments"])

                function_call_stream_state.function_messages.append({
                    "role": "assistant",
                    "function_call": {
                        "name" : tool_call["tool_name"],
                        "arguments": tool_call["tool_arguments"]
                    },
                    "content": None
                })
                function_call_stream_state.function_messages.append({
                    "tool_call_id": tool_call["tool_id"],
                    "role": "function",
                    "name": tool_call["tool_name"],
                    "content": tool_response,
                })
            
            function_call_stream_state.streaming_state = "COMPLETED"
            return function_call_stream_state.streaming_state
        
        else:
            return function_call_stream_state.streaming_state


async def stream_chat_request(request_body, request_headers):
    response, apim_request_id = await send_chat_request(request_body, request_headers)
    history_metadata = request_body.get("history_metadata", {})
    
    async def generate(apim_request_id, history_metadata):
        if app_settings.azure_openai.function_call_azure_functions_enabled:
            # Maintain state during function call streaming
            function_call_stream_state = AzureOpenaiFunctionCallStreamState()
            
            async for completionChunk in response:
                stream_state = await process_function_call_stream(completionChunk, function_call_stream_state, request_body, request_headers, history_metadata, apim_request_id)
                
                # No function call, asistant response
                if stream_state == "INITIAL":
                    yield format_stream_response(completionChunk, history_metadata, apim_request_id)

                # Function call stream completed, functions were executed.
                # Append function calls and results to history and send to OpenAI, to stream the final answer.
                if stream_state == "COMPLETED":
                    request_body["messages"].extend(function_call_stream_state.function_messages)
                    function_response, apim_request_id = await send_chat_request(request_body, request_headers)
                    async for functionCompletionChunk in function_response:
                        yield format_stream_response(functionCompletionChunk, history_metadata, apim_request_id)
                
        else:
            async for completionChunk in response:
                yield format_stream_response(completionChunk, history_metadata, apim_request_id)

    return generate(apim_request_id=apim_request_id, history_metadata=history_metadata)


async def conversation_internal(request_body, request_headers):
    try:
        if app_settings.azure_openai.stream and not app_settings.base_settings.use_promptflow:
            result = await stream_chat_request(request_body, request_headers)
            response = await make_response(format_as_ndjson(result))
            response.timeout = None
            response.mimetype = "application/json-lines"
            return response
        else:
            result = await complete_chat_request(request_body, request_headers)
            return jsonify(result)

    except Exception as ex:
        logging.exception(ex)
        if hasattr(ex, "status_code"):
            return jsonify({"error": str(ex)}), ex.status_code
        else:
            return jsonify({"error": str(ex)}), 500


@bp.route("/conversation", methods=["POST"])
async def conversation():
    if not request.is_json:
        return jsonify({"error": "request must be json"}), 415
    request_json = await request.get_json()

    return await conversation_internal(request_json, request.headers)


@bp.route("/frontend_settings", methods=["GET"])
def get_frontend_settings():
    try:
        return jsonify(frontend_settings), 200
    except Exception as e:
        logging.exception("Exception in /frontend_settings")
        return jsonify({"error": str(e)}), 500


## Conversation History API ##
@bp.route("/history/generate", methods=["POST"])
async def add_conversation():
    await cosmos_db_ready.wait()
    authenticated_user = get_authenticated_user_details(request_headers=request.headers)
    user_id = authenticated_user["user_principal_id"]

    ## check request for conversation_id
    request_json = await request.get_json()
    conversation_id = request_json.get("conversation_id", None)

    try:
        # make sure cosmos is configured
        if not current_app.cosmos_conversation_client:
            raise Exception("CosmosDB is not configured or not working")

        # check for the conversation_id, if the conversation is not set, we will create a new one
        history_metadata = {}
        if not conversation_id:
            title = await generate_title(request_json["messages"])
            conversation_dict = await current_app.cosmos_conversation_client.create_conversation(
                user_id=user_id, title=title
            )
            conversation_id = conversation_dict["id"]
            history_metadata["title"] = title
            history_metadata["date"] = conversation_dict["createdAt"]

        ## Format the incoming message object in the "chat/completions" messages format
        ## then write it to the conversation history in cosmos
        messages = request_json["messages"]
        if len(messages) > 0 and messages[-1]["role"] == "user":
            createdMessageValue = await current_app.cosmos_conversation_client.create_message(
                uuid=str(uuid.uuid4()),
                conversation_id=conversation_id,
                user_id=user_id,
                input_message=messages[-1],
            )
            if createdMessageValue == "Conversation not found":
                raise Exception(
                    "Conversation not found for the given conversation ID: "
                    + conversation_id
                    + "."
                )
        else:
            raise Exception("No user message found")

        # Submit request to Chat Completions for response
        request_body = await request.get_json()
        history_metadata["conversation_id"] = conversation_id
        request_body["history_metadata"] = history_metadata
        return await conversation_internal(request_body, request.headers)

    except Exception as e:
        logging.exception("Exception in /history/generate")
        return jsonify({"error": str(e)}), 500


@bp.route("/history/update", methods=["POST"])
async def update_conversation():
    await cosmos_db_ready.wait()
    authenticated_user = get_authenticated_user_details(request_headers=request.headers)
    user_id = authenticated_user["user_principal_id"]

    ## check request for conversation_id
    request_json = await request.get_json()
    conversation_id = request_json.get("conversation_id", None)

    try:
        # make sure cosmos is configured
        if not current_app.cosmos_conversation_client:
            raise Exception("CosmosDB is not configured or not working")

        # check for the conversation_id, if the conversation is not set, we will create a new one
        if not conversation_id:
            raise Exception("No conversation_id found")

        ## Format the incoming message object in the "chat/completions" messages format
        ## then write it to the conversation history in cosmos
        messages = request_json["messages"]
        if len(messages) > 0 and messages[-1]["role"] == "assistant":
            if len(messages) > 1 and messages[-2].get("role", None) == "tool":
                # write the tool message first
                await current_app.cosmos_conversation_client.create_message(
                    uuid=str(uuid.uuid4()),
                    conversation_id=conversation_id,
                    user_id=user_id,
                    input_message=messages[-2],
                )
            # write the assistant message
            await current_app.cosmos_conversation_client.create_message(
                uuid=messages[-1]["id"],
                conversation_id=conversation_id,
                user_id=user_id,
                input_message=messages[-1],
            )
        else:
            raise Exception("No bot messages found")

        # Submit request to Chat Completions for response
        response = {"success": True}
        return jsonify(response), 200

    except Exception as e:
        logging.exception("Exception in /history/update")
        return jsonify({"error": str(e)}), 500


@bp.route("/history/message_feedback", methods=["POST"])
async def update_message():
    await cosmos_db_ready.wait()
    authenticated_user = get_authenticated_user_details(request_headers=request.headers)
    user_id = authenticated_user["user_principal_id"]

    ## check request for message_id
    request_json = await request.get_json()
    message_id = request_json.get("message_id", None)
    message_feedback = request_json.get("message_feedback", None)
    try:
        if not message_id:
            return jsonify({"error": "message_id is required"}), 400

        if not message_feedback:
            return jsonify({"error": "message_feedback is required"}), 400

        ## update the message in cosmos
        updated_message = await current_app.cosmos_conversation_client.update_message_feedback(
            user_id, message_id, message_feedback
        )
        if updated_message:
            return (
                jsonify(
                    {
                        "message": f"Successfully updated message with feedback {message_feedback}",
                        "message_id": message_id,
                    }
                ),
                200,
            )
        else:
            return (
                jsonify(
                    {
                        "error": f"Unable to update message {message_id}. It either does not exist or the user does not have access to it."
                    }
                ),
                404,
            )

    except Exception as e:
        logging.exception("Exception in /history/message_feedback")
        return jsonify({"error": str(e)}), 500


@bp.route("/history/delete", methods=["DELETE"])
async def delete_conversation():
    await cosmos_db_ready.wait()
    ## get the user id from the request headers
    authenticated_user = get_authenticated_user_details(request_headers=request.headers)
    user_id = authenticated_user["user_principal_id"]

    ## check request for conversation_id
    request_json = await request.get_json()
    conversation_id = request_json.get("conversation_id", None)

    try:
        if not conversation_id:
            return jsonify({"error": "conversation_id is required"}), 400

        ## make sure cosmos is configured
        if not current_app.cosmos_conversation_client:
            raise Exception("CosmosDB is not configured or not working")

        ## delete the conversation messages from cosmos first
        deleted_messages = await current_app.cosmos_conversation_client.delete_messages(
            conversation_id, user_id
        )

        ## Now delete the conversation
        deleted_conversation = await current_app.cosmos_conversation_client.delete_conversation(
            user_id, conversation_id
        )

        return (
            jsonify(
                {
                    "message": "Successfully deleted conversation and messages",
                    "conversation_id": conversation_id,
                }
            ),
            200,
        )
    except Exception as e:
        logging.exception("Exception in /history/delete")
        return jsonify({"error": str(e)}), 500


@bp.route("/history/list", methods=["GET"])
async def list_conversations():
    await cosmos_db_ready.wait()
    offset = request.args.get("offset", 0)
    authenticated_user = get_authenticated_user_details(request_headers=request.headers)
    user_id = authenticated_user["user_principal_id"]

    ## make sure cosmos is configured
    if not current_app.cosmos_conversation_client:
        raise Exception("CosmosDB is not configured or not working")

    ## get the conversations from cosmos
    conversations = await current_app.cosmos_conversation_client.get_conversations(
        user_id, offset=offset, limit=25
    )
    if not isinstance(conversations, list):
        return jsonify({"error": f"No conversations for {user_id} were found"}), 404

    ## return the conversation ids

    return jsonify(conversations), 200


@bp.route("/history/read", methods=["POST"])
async def get_conversation():
    await cosmos_db_ready.wait()
    authenticated_user = get_authenticated_user_details(request_headers=request.headers)
    user_id = authenticated_user["user_principal_id"]

    ## check request for conversation_id
    request_json = await request.get_json()
    conversation_id = request_json.get("conversation_id", None)

    if not conversation_id:
        return jsonify({"error": "conversation_id is required"}), 400

    ## make sure cosmos is configured
    if not current_app.cosmos_conversation_client:
        raise Exception("CosmosDB is not configured or not working")

    ## get the conversation object and the related messages from cosmos
    conversation = await current_app.cosmos_conversation_client.get_conversation(
        user_id, conversation_id
    )
    ## return the conversation id and the messages in the bot frontend format
    if not conversation:
        return (
            jsonify(
                {
                    "error": f"Conversation {conversation_id} was not found. It either does not exist or the logged in user does not have access to it."
                }
            ),
            404,
        )

    # get the messages for the conversation from cosmos
    conversation_messages = await current_app.cosmos_conversation_client.get_messages(
        user_id, conversation_id
    )

    ## format the messages in the bot frontend format
    messages = [
        {
            "id": msg["id"],
            "role": msg["role"],
            "content": msg["content"],
            "createdAt": msg["createdAt"],
            "feedback": msg.get("feedback"),
        }
        for msg in conversation_messages
    ]

    return jsonify({"conversation_id": conversation_id, "messages": messages}), 200


@bp.route("/history/rename", methods=["POST"])
async def rename_conversation():
    await cosmos_db_ready.wait()
    authenticated_user = get_authenticated_user_details(request_headers=request.headers)
    user_id = authenticated_user["user_principal_id"]

    ## check request for conversation_id
    request_json = await request.get_json()
    conversation_id = request_json.get("conversation_id", None)

    if not conversation_id:
        return jsonify({"error": "conversation_id is required"}), 400

    ## make sure cosmos is configured
    if not current_app.cosmos_conversation_client:
        raise Exception("CosmosDB is not configured or not working")

    ## get the conversation from cosmos
    conversation = await current_app.cosmos_conversation_client.get_conversation(
        user_id, conversation_id
    )
    if not conversation:
        return (
            jsonify(
                {
                    "error": f"Conversation {conversation_id} was not found. It either does not exist or the logged in user does not have access to it."
                }
            ),
            404,
        )

    ## update the title
    title = request_json.get("title", None)
    if not title:
        return jsonify({"error": "title is required"}), 400
    conversation["title"] = title
    updated_conversation = await current_app.cosmos_conversation_client.upsert_conversation(
        conversation
    )

    return jsonify(updated_conversation), 200


@bp.route("/history/delete_all", methods=["DELETE"])
async def delete_all_conversations():
    await cosmos_db_ready.wait()
    ## get the user id from the request headers
    authenticated_user = get_authenticated_user_details(request_headers=request.headers)
    user_id = authenticated_user["user_principal_id"]

    # get conversations for user
    try:
        ## make sure cosmos is configured
        if not current_app.cosmos_conversation_client:
            raise Exception("CosmosDB is not configured or not working")

        conversations = await current_app.cosmos_conversation_client.get_conversations(
            user_id, offset=0, limit=None
        )
        if not conversations:
            return jsonify({"error": f"No conversations for {user_id} were found"}), 404

        # delete each conversation
        for conversation in conversations:
            ## delete the conversation messages from cosmos first
            deleted_messages = await current_app.cosmos_conversation_client.delete_messages(
                conversation["id"], user_id
            )

            ## Now delete the conversation
            deleted_conversation = await current_app.cosmos_conversation_client.delete_conversation(
                user_id, conversation["id"]
            )
        return (
            jsonify(
                {
                    "message": f"Successfully deleted conversation and messages for user {user_id}"
                }
            ),
            200,
        )

    except Exception as e:
        logging.exception("Exception in /history/delete_all")
        return jsonify({"error": str(e)}), 500


@bp.route("/history/clear", methods=["POST"])
async def clear_messages():
    await cosmos_db_ready.wait()
    ## get the user id from the request headers
    authenticated_user = get_authenticated_user_details(request_headers=request.headers)
    user_id = authenticated_user["user_principal_id"]

    ## check request for conversation_id
    request_json = await request.get_json()
    conversation_id = request_json.get("conversation_id", None)

    try:
        if not conversation_id:
            return jsonify({"error": "conversation_id is required"}), 400

        ## make sure cosmos is configured
        if not current_app.cosmos_conversation_client:
            raise Exception("CosmosDB is not configured or not working")

        ## delete the conversation messages from cosmos
        deleted_messages = await current_app.cosmos_conversation_client.delete_messages(
            conversation_id, user_id
        )

        return (
            jsonify(
                {
                    "message": "Successfully deleted messages in conversation",
                    "conversation_id": conversation_id,
                }
            ),
            200,
        )
    except Exception as e:
        logging.exception("Exception in /history/clear_messages")
        return jsonify({"error": str(e)}), 500


@bp.route("/history/ensure", methods=["GET"])
async def ensure_cosmos():
    await cosmos_db_ready.wait()
    if not app_settings.chat_history:
        return jsonify({"error": "CosmosDB is not configured"}), 404

    try:
        success, err = await current_app.cosmos_conversation_client.ensure()
        if not current_app.cosmos_conversation_client or not success:
            if err:
                return jsonify({"error": err}), 422
            return jsonify({"error": "CosmosDB is not configured or not working"}), 500

        return jsonify({"message": "CosmosDB is configured and working"}), 200
    except Exception as e:
        logging.exception("Exception in /history/ensure")
        cosmos_exception = str(e)
        if "Invalid credentials" in cosmos_exception:
            return jsonify({"error": cosmos_exception}), 401
        elif "Invalid CosmosDB database name" in cosmos_exception:
            return (
                jsonify(
                    {
                        "error": f"{cosmos_exception} {app_settings.chat_history.database} for account {app_settings.chat_history.account}"
                    }
                ),
                422,
            )
        elif "Invalid CosmosDB container name" in cosmos_exception:
            return (
                jsonify(
                    {
                        "error": f"{cosmos_exception}: {app_settings.chat_history.conversations_container}"
                    }
                ),
                422,
            )
        else:
            return jsonify({"error": "CosmosDB is not working"}), 500


async def generate_title(conversation_messages) -> str:
    ## make sure the messages are sorted by _ts descending
    title_prompt = "Summarize the conversation so far into a 4-word or less title. Do not use any quotation marks or punctuation. Do not include any other commentary or description."

    messages = [
        {"role": msg["role"], "content": msg["content"]}
        for msg in conversation_messages
    ]
    messages.append({"role": "user", "content": title_prompt})

    try:
        azure_openai_client = await init_openai_client()
        response = await azure_openai_client.chat.completions.create(
            model=app_settings.azure_openai.model, messages=messages, temperature=1, max_tokens=64
        )

        title = response.choices[0].message.content
        return title
    except Exception as e:
        logging.exception("Exception while generating title", e)
        return messages[-2]["content"]


app = create_app()
</file>

<file path="static/index.html">
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/x-icon" href="{{ favicon }}" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ title }}</title>
    <script type="module" crossorigin src="/assets/index-bb3e7532.js"></script>
    <link rel="stylesheet" href="/assets/index-ee1a1bf8.css">
  </head>
  <body>
    <div id="root"></div>
    
  </body>
</html>
</file>

</files>
